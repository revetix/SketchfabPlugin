using System;
using System.Globalization;
using System.IO;
using System.Text;

namespace SketchfabPlugin
{
	class BlenderScripts
	{
		public static string Static(int bindPose = 1, bool indexFix = false, string tempDir = "_sfTemp")
		{
			string blenderScript = Encoding.UTF8.GetString(Convert.FromBase64String("aW1wb3J0IG5ld0dhbWVMaWINCmZyb20gbmV3R2FtZUxpYiBpbXBvcnQgKg0KaW1wb3J0IEJsZW5kZXINCmltcG9ydCBzdWJwcm9jZXNzDQoNCkJJTkRQT1NFID0gMQ0KDQpjbGFzcyBOb2RlOg0KCWRlZiBfX2luaXRfXyhzZWxmKToNCgkJc2VsZi5uYW1lID0gTm9uZQ0KCQlzZWxmLmNoaWxkcmVuID0gW10NCgkJc2VsZi5vc2dDaGlsZHJlbiA9IFtdDQoJCXNlbGYub2Zmc2V0ID0gTm9uZQ0KCQlzZWxmLnN0YXJ0ID0gTm9uZQ0KCQlzZWxmLmVuZCA9IE5vbmUNCgkJc2VsZi5oZWFkZXIgPSAiIg0KCQlzZWxmLmRhdGEgPSAiIg0KDQpjbGFzcyBZc29uOg0KCWRlZiBfX2luaXRfXyhzZWxmKToNCgkJc2VsZi5pbnB1dCA9IE5vbmUNCgkJc2VsZi5maWxlbmFtZSA9IE5vbmUNCgkJc2VsZi5yb290ID0gTm9kZSgpDQoNCglkZWYgcGFyc2Uoc2VsZik6DQoJCWdsb2JhbCBvZmZzZXQsIHN0cmluZywgdHh0DQoJCWlmIHNlbGYuZmlsZW5hbWUgaXMgbm90IE5vbmU6DQoJCQlmaWxlID0gb3BlbigiLi97dGVtcFBhdGh9L2ZpbGUub3NnanMiLCAicmIiKQ0KCQkJc2VsZi5pbnB1dCA9IGZpbGUucmVhZCgpLnJlcGxhY2UoIlx4MjAiLCAiIikucmVwbGFjZSgiXHgwQSIsICIiKQ0KCQkJbGluZSA9IHNlbGYuaW5wdXQNCgkJCWlmIGxpbmUgaXMgbm90IE5vbmUgYW5kIGxlbihsaW5lKSA+IDA6DQoJCQkJb2Zmc2V0ID0gMA0KCQkJCW4gPSAwDQoJCQkJc3RyaW5nID0gW10NCgkJCQlzZWxmLnRyZWUoc2VsZi5yb290LCBuKQ0KCQkJZmlsZS5jbG9zZSgpDQoNCglkZWYgZ2V0VHJlZShzZWxmLCBwYXJlbnQsIGxpc3QsIGtleSk6DQoJCWZvciBjaGlsZCBpbiBwYXJlbnQuY2hpbGRyZW46DQoJCQlpZiBrZXkgaW4gY2hpbGQuaGVhZGVyOg0KCQkJCWxpc3QuYXBwZW5kKGNoaWxkKQ0KCQkJc2VsZi5nZXRUcmVlKGNoaWxkLCBsaXN0LCBrZXkpDQoNCglkZWYgdmFsdWVzKHNlbGYsIGRhdGEsIHR5cGUpOg0KCQlsaXN0ID0ge30NCgkJZGF0YVZhbHVlcyA9IGRhdGEuc3BsaXQoIiwiKQ0KCQlpZiB0eXBlID09ICI6IjoNCgkJCWZvciB2YWx1ZSBpbiBkYXRhVmFsdWVzOg0KCQkJCWlmICI6IiBpbiB2YWx1ZToNCgkJCQkJY29tcGxldGUgPSBGYWxzZQ0KCQkJCQlhbGlzdCA9IFtdDQoJCQkJCXN0cmluZyA9ICIiDQoJCQkJCWZvciBjaGFyIGluIHZhbHVlOg0KCQkJCQkJaWYgY2hhciA9PSAnIicgYW5kIG5vdCBjb21wbGV0ZToNCgkJCQkJCQlpZiBsZW4oc3RyaW5nKSA+IDA6DQoJCQkJCQkJCWFsaXN0LmFwcGVuZChzdHJpbmcpDQoJCQkJCQkJc3RyaW5nID0gIiIgKyBjaGFyDQoJCQkJCQkJY29tcGxldGUgPSBUcnVlDQoJCQkJCQllbGlmIGNoYXIgPT0gJyInIGFuZCBjb21wbGV0ZToNCgkJCQkJCQlzdHJpbmcgKz0gY2hhcg0KCQkJCQkJCWlmIGxlbihzdHJpbmcpID4gMDoNCgkJCQkJCQkJYWxpc3QuYXBwZW5kKHN0cmluZykNCgkJCQkJCQlzdHJpbmcgPSAiIg0KCQkJCQkJCWNvbXBsZXRlID0gRmFsc2UNCgkJCQkJCWVsaWYgY2hhciA9PSAiOiI6DQoJCQkJCQkJcGFzcw0KCQkJCQkJZWxzZToNCgkJCQkJCQlzdHJpbmcgKz0gY2hhcg0KCQkJCQlpZiBsZW4oc3RyaW5nKSA+IDA6DQoJCQkJCQlhbGlzdC5hcHBlbmQoc3RyaW5nKQ0KCQkJCQlpZiBsZW4oYWxpc3QpID09IDI6DQoJCQkJCQlsaXN0W2FsaXN0WzBdXSA9IGFsaXN0WzFdDQoJCWlmIHR5cGUgPT0gImYiOg0KCQkJbGlzdCA9IG1hcChmbG9hdCwgZGF0YVZhbHVlcykNCgkJaWYgdHlwZSA9PSAiaSI6DQoJCQlsaXN0ID0gbWFwKGludCwgZGF0YVZhbHVlcykNCgkJaWYgdHlwZSA9PSAicyI6DQoJCQlsaXN0ID0gZGF0YVZhbHVlcw0KCQlyZXR1cm4gbGlzdA0KDQoJZGVmIGdldFZhbHVlKHNlbGYsIHZhbHVlcywgbmFtZSwgdHlwZT1Ob25lKToNCgkJaWYgbmFtZSBpbiB2YWx1ZXM6DQoJCQlpZiB0eXBlID09ICciZiInOg0KCQkJCXJldHVybiBmbG9hdCh2YWx1ZXNbbmFtZV0uc3BsaXQoJyInKVsxXSkNCgkJCWVsaWYgdHlwZSA9PSAnImkiJzoNCgkJCQlyZXR1cm4gaW50KHZhbHVlc1tuYW1lXS5zcGxpdCgnIicpWzFdKQ0KCQkJZWxpZiB0eXBlID09ICJpIjoNCgkJCQlyZXR1cm4gaW50KHZhbHVlc1tuYW1lXS5yZXBsYWNlKCciJywgIiIpKQ0KCQkJZWxpZiB0eXBlID09ICciIic6DQoJCQkJcmV0dXJuIHZhbHVlc1tuYW1lXS5zcGxpdCgnIicpWzFdDQoJCQllbHNlOg0KCQkJCXJldHVybiB2YWx1ZXNbbmFtZV0NCgkJZWxzZToNCgkJCXJldHVybiBOb25lDQoNCglkZWYgZ2V0KHNlbGYsIG5vZGUsIGtleSk6DQoJCWxpc3QgPSBbXQ0KCQlzZWxmLmdldFRyZWUobm9kZSwgbGlzdCwga2V5KQ0KCQlpZiBsZW4obGlzdCkgPiAwOg0KCQkJcmV0dXJuIGxpc3QNCgkJZWxzZToNCgkJCXJldHVybiBOb25lDQoNCglkZWYgdHJlZShzZWxmLCBwYXJlbnROb2RlLCBuKToNCgkJZ2xvYmFsIG9mZnNldCwgc3RyaW5nDQoJCW4gKz0gNA0KCQlvZmZzZXQgKz0gMQ0KCQl3aGlsZSBUcnVlOg0KCQkJaWYgb2Zmc2V0ID49IGxlbihzZWxmLmlucHV0KToNCgkJCQlicmVhaw0KCQkJdmFsdWUgPSBzZWxmLmlucHV0W29mZnNldF0NCgkJCWlmIHZhbHVlID09ICJ9IjoNCgkJCQlpZiBsZW4oc3RyaW5nKSA+IDA6DQoJCQkJCXBhcmVudE5vZGUuZGF0YSA9IHNlbGYuaW5wdXRbc3RyaW5nWzBdIDogb2Zmc2V0XQ0KCQkJCXN0cmluZyA9IFtdDQoJCQkJb2Zmc2V0ICs9IDENCgkJCQlicmVhaw0KDQoJCQllbGlmIHZhbHVlID09ICJ7IjoNCgkJCQlub2RlID0gTm9kZSgpDQoJCQkJcGFyZW50Tm9kZS5jaGlsZHJlbi5hcHBlbmQobm9kZSkNCgkJCQlub2RlLm9mZnNldCA9IG9mZnNldA0KCQkJCWlmIGxlbihzdHJpbmcpID4gMDoNCgkJCQkJbm9kZS5oZWFkZXIgPSBzZWxmLmlucHV0W3N0cmluZ1swXSA6IG9mZnNldF0NCgkJCQlzdHJpbmcgPSBbXQ0KCQkJCXNlbGYudHJlZShub2RlLCBuKQ0KDQoJCQllbGlmIHZhbHVlID09ICJdIjoNCgkJCQlpZiBsZW4oc3RyaW5nKSA+IDA6DQoJCQkJCXBhcmVudE5vZGUuZGF0YSA9IHNlbGYuaW5wdXRbc3RyaW5nWzBdIDogb2Zmc2V0XQ0KCQkJCW9mZnNldCArPSAxDQoJCQkJc3RyaW5nID0gW10NCgkJCQlicmVhaw0KDQoJCQllbGlmIHZhbHVlID09ICJbIjoNCgkJCQlub2RlID0gTm9kZSgpDQoJCQkJcGFyZW50Tm9kZS5jaGlsZHJlbi5hcHBlbmQobm9kZSkNCgkJCQlub2RlLm9mZnNldCA9IG9mZnNldA0KCQkJCW5vZGUubmFtZSA9IHN0cmluZw0KCQkJCWlmIGxlbihzdHJpbmcpID4gMDoNCgkJCQkJbm9kZS5oZWFkZXIgPSBzZWxmLmlucHV0W3N0cmluZ1swXSA6IG9mZnNldF0NCgkJCQllbHNlOg0KCQkJCQlub2RlLmhlYWRlciA9ICIiDQoJCQkJc3RyaW5nID0gW10NCgkJCQlzZWxmLnRyZWUobm9kZSwgbikNCg0KCQkJZWxzZToNCgkJCQlpZiBsZW4oc3RyaW5nKSA9PSAwOg0KCQkJCQlzdHJpbmcuYXBwZW5kKG9mZnNldCkNCgkJCQlvZmZzZXQgKz0gMQ0KDQoNCmRlZiBkZWNvZGVWYXJpbnQoZmlsZVJlYWRlciwgb2Zmc2V0LCBzaXplLCB0eXBlKToNCglmaWxlUmVhZGVyLnNlZWsob2Zmc2V0KQ0KCWRlY29kZWQgPSBbMF0gKiBzaXplDQoJbnVtRGVjID0gMA0KCXdoaWxlIG51bURlYyAhPSBzaXplOg0KCQlzaGlmdCA9IDANCgkJcmVzdWx0ID0gMA0KCQl3aGlsZSBUcnVlOg0KCQkJYnl0ZSA9IGZpbGVSZWFkZXIuQigxKVswXQ0KCQkJcmVzdWx0IHw9IChieXRlICYgMTI3KSA8PCBzaGlmdA0KCQkJc2hpZnQgKz0gNw0KCQkJaWYgbm90IChieXRlICYgMHg4MCk6DQoJCQkJYnJlYWsNCgkJZGVjb2RlZFtudW1EZWNdID0gcmVzdWx0DQoJCW51bURlYyArPSAxDQoJaWYgdHlwZVswXSAhPSAiVSI6DQoJCWNvbXBsZXRlTnVtID0gMA0KCQl3aGlsZSBjb21wbGV0ZU51bSA8IHNpemU6DQoJCQl0bXAgPSBkZWNvZGVkW2NvbXBsZXRlTnVtXQ0KCQkJZGVjb2RlZFtjb21wbGV0ZU51bV0gPSB0bXAgPj4gMSBeIC0oMSAmIHRtcCkNCgkJCWNvbXBsZXRlTnVtICs9IDENCglyZXR1cm4gZGVjb2RlZA0KDQoNCmRlZiBkZWNvZGVEZWx0YSh0LCBlKToNCglpID0gZSB8IDANCgluID0gbGVuKHQpDQoJaWYgaSA+PSBsZW4odCk6DQoJCXIgPSBOb25lDQoJZWxzZToNCgkJciA9IHRbaV0NCglhID0gaSArIDENCgl3aGlsZSBhIDwgbjoNCgkJcyA9IHRbYV0NCgkJciA9IHRbYV0gPSByICsgKHMgPj4gMSBeIC0oMSAmIHMpKQ0KCQlhICs9IDENCglyZXR1cm4gdA0KDQoNCmRlZiBkZWNvZGVJbXBsaWNpdChpbnB1dCwgbik6DQoJZSA9IFswXSAqIGlucHV0WzBdDQoJYSA9IGlucHV0WzJdDQoJcyA9IGlucHV0WzFdDQoJbyA9IGlucHV0WzMgOiBzICsgM10NCglyID0gMg0KCXUgPSAzMiAqIHMgLSBsZW4oZSkNCglsID0gMSA8PCAzMQ0KCWggPSAwDQoJd2hpbGUgaCA8IHM6DQoJCWMgPSBvW2hdDQoJCWQgPSAzMg0KCQlwID0gaCAqIGQNCgkJaWYgaCA9PSBzIC0gMToNCgkJCWYgPSB1DQoJCWVsc2U6DQoJCQlmID0gMA0KCQlnMSA9IGYNCgkJd2hpbGUgZzEgPCBkOg0KCQkJaWYgYyAmIGwgPj4gZzE6DQoJCQkJZVtwXSA9IGlucHV0W25dDQoJCQkJbiArPSAxDQoJCQllbHNlOg0KCQkJCWlmIHI6DQoJCQkJCWVbcF0gPSBhDQoJCQkJZWxzZToNCgkJCQkJZVtwXSA9IGENCgkJCQkJYSArPSAxDQoJCQlnMSArPSAxDQoJCQlwICs9IDENCgkJaCArPSAxDQoJcmV0dXJuIGUNCg0KDQpkZWYgZGVjb2RlV2F0ZXJtYXJrKGJ5dGVzLCBpKToNCgludW0gPSBpWzBdDQoJYnl0ZXNTaXplID0gbGVuKGJ5dGVzKQ0KCWJ5dGVzQ29tcGxldGVkID0gMA0KCXdoaWxlIGJ5dGVzQ29tcGxldGVkIDwgYnl0ZXNTaXplOg0KCQlzID0gbnVtIC0gYnl0ZXNbYnl0ZXNDb21wbGV0ZWRdDQoJCWJ5dGVzW2J5dGVzQ29tcGxldGVkXSA9IHMNCgkJaWYgbnVtIDw9IHM6DQoJCQludW0gPSBzICsgMQ0KCQlieXRlc0NvbXBsZXRlZCArPSAxDQoJcmV0dXJuIGJ5dGVzLCBudW0NCg0KDQpkZWYgZ2V0SW5kaWNlcyhpdGVtc2l6ZSwgc2l6ZSwgb2Zmc2V0LCB0eXBlLCBmaWxlUmVhZGVyLCBtb2RlLCBtYWdpYyk6DQoJaWYgdHlwZSAhPSAiVWludDhBcnJheSI6DQoJCWJ5dGVzID0gZGVjb2RlVmFyaW50KGZpbGVSZWFkZXIsIG9mZnNldCwgc2l6ZSAqIGl0ZW1zaXplLCB0eXBlKQ0KCWVsc2U6DQoJCWZpbGVSZWFkZXIuc2VlayhvZmZzZXQpDQoJCWJ5dGVzID0gbGlzdChmaWxlUmVhZGVyLkIoc2l6ZSAqIGl0ZW1zaXplKSkNCglpbmRleEZpeCA9IEZhbHNlDQoJaWYgbm90IGluZGV4Rml4Og0KCQlpZiBtb2RlID09ICciVFJJQU5HTEVfU1RSSVAiJzoNCgkJCWsgPSAzICsgYnl0ZXNbMV0NCgkJCWJ5dGVzID0gZGVjb2RlRGVsdGEoYnl0ZXMsIGspDQoJCQlieXRlcyA9IGRlY29kZUltcGxpY2l0KGJ5dGVzLCBrKQ0KCQkJaSA9IFttYWdpY10NCgkJCWJ5dGVzLCBtYWdpYyA9IGRlY29kZVdhdGVybWFyayhieXRlcywgaSkNCgkJZWxpZiBtb2RlID09ICciVFJJQU5HTEVTIic6DQoJCQlrID0gMA0KCQkJYnl0ZXMgPSBkZWNvZGVEZWx0YShieXRlcywgaykNCgkJCWkgPSBbbWFnaWNdDQoJCQlieXRlcywgbWFnaWMgPSBkZWNvZGVXYXRlcm1hcmsoYnl0ZXMsIGkpDQoJcmV0dXJuIG1hZ2ljLCBieXRlcw0KDQoNCmRlZiBkZWNvZGVQcmVkaWN0KGluZGljZXMsIGlucHV0LCBpdGVtc2l6ZSk6DQoJdCA9IGlucHV0DQoJaWYgbGVuKGluZGljZXMpID4gMDoNCgkJdCA9IGlucHV0DQoJCWUgPSBpdGVtc2l6ZQ0KCQlpID0gaW5kaWNlcw0KCQluID0gbGVuKHQpIC8gZQ0KCQlyID0gWzBdICogbg0KCQlhID0gbGVuKGkpIC0gMQ0KCQlyW2lbMF1dID0gMQ0KCQlyW2lbMV1dID0gMQ0KCQlyW2lbMl1dID0gMQ0KCQlzID0gMg0KCQl3aGlsZSBzIDwgYToNCgkJCW8gPSBzIC0gMg0KCQkJdSA9IGlbb10NCgkJCWwgPSBpW28gKyAxXQ0KCQkJaCA9IGlbbyArIDJdDQoJCQljID0gaVtvICsgM10NCgkJCWlmIDEgIT0gcltjXToNCgkJCQlyW2NdID0gMQ0KCQkJCXUgKj0gZQ0KCQkJCWwgKj0gZQ0KCQkJCWggKj0gZQ0KCQkJCWMgKj0gZQ0KCQkJCWQgPSAwDQoJCQkJd2hpbGUgZCA8IGU6DQoJCQkJCXRbYyArIGRdID0gdFtjICsgZF0gKyB0W2wgKyBkXSArIHRbaCArIGRdIC0gdFt1ICsgZF0NCgkJCQkJZCArPSAxDQoJCQlzICs9IDENCglyZXR1cm4gdA0KDQoNCmRlZiBldGFwMShpbnB1dCwgSXRlbVNpemUpOg0KCW4gPSBsZW4oaW5wdXQpIC8gSXRlbVNpemUNCglyID0gMA0KCW91dHB1dCA9IFswXSAqIGxlbihpbnB1dCkNCgl3aGlsZSByIDwgbjoNCgkJYSA9IHIgKiBJdGVtU2l6ZQ0KCQlzID0gMA0KCQl3aGlsZSBzIDwgSXRlbVNpemU6DQoJCQlvdXRwdXRbYSArIHNdID0gaW5wdXRbciArIG4gKiBzXQ0KCQkJcyArPSAxDQoJCXIgKz0gMQ0KCXJldHVybiBvdXRwdXQNCg0KDQpkZWYgZXRhcDIoaW5wdXQsIEl0ZW1TaXplLCBhdHJpYnV0ZXMpOg0KCWkgPSBbYXRyaWJ1dGVzWyciYngiJ10sIGF0cmlidXRlc1snImJ5IiddLCBhdHJpYnV0ZXNbJyJieiInXV0NCgluID0gW2F0cmlidXRlc1snImh4IiddLCBhdHJpYnV0ZXNbJyJoeSInXSwgYXRyaWJ1dGVzWyciaHoiJ11dDQoNCglhID0gbGVuKGlucHV0KSAvIEl0ZW1TaXplDQoJcyA9IDANCglvdXRwdXQgPSBbMF0gKiBsZW4oaW5wdXQpDQoJd2hpbGUgcyA8IGE6DQoJCW8gPSBzICogSXRlbVNpemUNCgkJdSA9IDANCgkJd2hpbGUgdSA8IEl0ZW1TaXplOg0KCQkJb3V0cHV0W28gKyB1XSA9IGlbdV0gKyBpbnB1dFtvICsgdV0gKiBuW3VdDQoJCQl1ICs9IDENCgkJcyArPSAxDQoNCglyZXR1cm4gb3V0cHV0DQoNCg0KZGVmIGV0YXAzKGlucHV0LCBJdGVtU2l6ZSk6DQoJaSA9IEl0ZW1TaXplIHwgMQ0KCW4gPSAxDQoJciA9IGxlbihpbnB1dCkgLyBpDQoJd2hpbGUgbiA8IHI6DQoJCWEgPSAobiAtIDEpICogaQ0KCQlzID0gbiAqIGkNCgkJbyA9IDANCgkJd2hpbGUgbyA8IGk6DQoJCQlpbnB1dFtzICsgb10gKz0gaW5wdXRbYSArIG9dDQoJCQlvICs9IDENCgkJbiArPSAxDQoJcmV0dXJuIGlucHV0DQoNCg0KZGVmIGV0YXA0KGlucHV0KToNCgllID0gMQ0KCWkgPSBsZW4oaW5wdXQpIC8gNA0KCXdoaWxlIGUgPCBpOg0KCQluID0gNCAqIChlIC0gMSkNCgkJciA9IDQgKiBlDQoJCWEgPSBpbnB1dFtuXQ0KCQlzID0gaW5wdXRbbiArIDFdDQoJCW8gPSBpbnB1dFtuICsgMl0NCgkJdSA9IGlucHV0W24gKyAzXQ0KCQlsID0gaW5wdXRbcl0NCgkJaCA9IGlucHV0W3IgKyAxXQ0KCQljID0gaW5wdXRbciArIDJdDQoJCWQgPSBpbnB1dFtyICsgM10NCgkJaW5wdXRbcl0gPSBhICogZCArIHMgKiBjIC0gbyAqIGggKyB1ICogbA0KCQlpbnB1dFtyICsgMV0gPSAtYSAqIGMgKyBzICogZCArIG8gKiBsICsgdSAqIGgNCgkJaW5wdXRbciArIDJdID0gYSAqIGggLSBzICogbCArIG8gKiBkICsgdSAqIGMNCgkJaW5wdXRbciArIDNdID0gLWEgKiBsIC0gcyAqIGggLSBvICogYyArIHUgKiBkDQoJCWUgKz0gMQ0KCXJldHVybiBpbnB1dA0KDQoNCmRlZiBpbnQzZmxvYXQ0KGlucHV0LCBhdHJpYnV0ZXMsIEl0ZW1TaXplKToNCgljID0gNA0KCWQgPSBhdHJpYnV0ZXNbJyJlcHNpbG9uIiddDQoJcCA9IGludChhdHJpYnV0ZXNbJyJucGhpIiddKQ0KCWUgPSBbMF0gKiBsZW4oaW5wdXQpICogNA0KCWkgPSAxLjU3MDc5NjMyNjc5DQoJbiA9IDYuMjgzMTg1MzA3MTgNCglyID0gMy4xNDE1OTI2NTM1OQ0KCWEgPSAwLjAxNzQ1MzI5MjUxDQoJcyA9IDAuMjUNCglvID0gNzIwDQoJdSA9IDgzMg0KCWwgPSA0NzkzODM2MjU4NDE1MTYzNWUtMjENCgloID0ge30NCglmID0gVHJ1ZQ0KDQoJZCA9IGQgb3Igcw0KCXAgPSBwIG9yIG8NCglnID0gbWF0aC5jb3MoZCAqIGEpDQoJbSA9IDANCgl2ID0gMA0KCV8gPSBbXQ0KDQoJdiA9IChwICsgMSkgKiAodSArIDEpICogMw0KCV8gPSBbTm9uZV0gKiB2DQoNCgliID0gciAvIGZsb2F0KHAgLSAxKQ0KCXggPSBpIC8gZmxvYXQocCAtIDEpDQoNCglpZiBmOg0KCQl5ID0gMw0KCWVsc2U6DQoJCXkgPSAyDQoNCgltID0gMA0KCXYgPSBsZW4oaW5wdXQpIC8geQ0KCXdoaWxlIG0gPCB2Og0KCQlBID0gbSAqIGMNCgkJUyA9IG0gKiB5DQoJCUMgPSBpbnB1dFtTXQ0KCQl3ID0gaW5wdXRbUyArIDFdDQoJCWlmIGMgPT0gMDoNCgkJCWlmIGYgPT0gMDoNCgkJCQlpZiAoQyAmIC0xMDI1KSAhPSA0Og0KCQkJCQllW0EgKyAzXSA9IC0xDQoJCQkJZWxzZToNCgkJCQkJZVtBICsgM10gPSAxDQoJCU0gPSBOb25lDQoJCVQgPSBOb25lDQoJCUUgPSBOb25lDQoJCUkgPSAzICogKEMgKyBwICogdykNCgkJTSA9IF9bSV0NCgkJaWYgTSA9PSBOb25lOg0KCQkJTiA9IEMgKiBiDQoJCQlrID0gY29zKE4pDQoJCQlGID0gc2luKE4pDQoJCQlOICs9IHgNCgkJCUQgPSAoZyAtIGsgKiBjb3MoTikpIC8gZmxvYXQobWF4KDFlLTUsIEYgKiBzaW4oTikpKQ0KCQkJaWYgRCA+IDE6DQoJCQkJRCA9IDENCgkJCWVsc2U6DQoJCQkJaWYgRCA8IC0xOg0KCQkJCQlEID0gLTENCgkJCVAgPSB3ICogbiAvIGZsb2F0KG1hdGguY2VpbChyIC8gZmxvYXQobWF4KDFlLTUsIG1hdGguYWNvcyhEKSkpKSkNCgkJCU0gPSBfW0ldID0gRiAqIG1hdGguY29zKFApDQoJCQlUID0gX1tJICsgMV0gPSBGICogbWF0aC5zaW4oUCkNCgkJCUUgPSBfW0kgKyAyXSA9IGsNCgkJZWxzZToNCgkJCVQgPSBfW0kgKyAxXQ0KCQkJRSA9IF9bSSArIDJdDQoJCWlmIGY6DQoJCQlSID0gaW5wdXRbUyArIDJdICogbA0KCQkJTyA9IG1hdGguc2luKFIpDQoJCQllW0FdID0gTyAqIE0NCgkJCWVbQSArIDFdID0gTyAqIFQNCgkJCWVbQSArIDJdID0gTyAqIEUNCgkJCWVbQSArIDNdID0gbWF0aC5jb3MoUikNCgkJZWxzZToNCgkJCWVbQV0gPSBNDQoJCQllW0EgKyAxXSA9IFQNCgkJCWVbQSArIDJdID0gRQ0KCQltICs9IDENCg0KCSMjd3JpdGUobG9nLF8sMCkNCglyZXR1cm4gZQ0KDQoNCmRlZiBnZXRTcGxpdE5hbWUobmFtZSwgd2hhdCwgd2hpY2gpOg0KCWEgPSBOb25lDQoJaWYgd2hhdCBpbiBuYW1lOg0KCQlhID0gIiINCgkJc3BsaXRzID0gbmFtZS5zcGxpdCh3aGF0KQ0KCQlpZiB3aGljaCA8IDA6DQoJCQludW0gPSBsZW4oc3BsaXRzKSArIHdoaWNoIC0gMQ0KCQllbHNlOg0KCQkJbnVtID0gd2hpY2gNCgkJaWYgbnVtIDwgMDoNCgkJCWEgPSBuYW1lDQoJCWVsc2U6DQoJCQlpZiB3aGljaCA8IGxlbihzcGxpdHMpOg0KCQkJCWZvciBtIGluIHJhbmdlKG51bSk6DQoJCQkJCWEgKz0gc3BsaXRzW21dICsgd2hhdA0KCQkJCWEgKz0gc3BsaXRzW251bV0NCgkJCWVsc2U6DQoJCQkJYSA9IG5hbWUNCglyZXR1cm4gYQ0KDQoNCmRlZiBnZXRBbmltYXRpb24oeXMsIEEsIG4pOg0KCWFjdGlvbiA9IEFjdGlvbigpDQoJYWN0aW9uLkFSTUFUVVJFU1BBQ0UgPSBUcnVlDQoJYWN0aW9uLkJPTkVTT1JUID0gVHJ1ZQ0KCWFjdGlvbi5za2VsZXRvbiA9IHNrZWxldG9uLm5hbWUNCgluICs9IDQNCglDaGFubmVscyA9IHlzLmdldChBLCAnIkNoYW5uZWxzIicpDQoJYm9uZUxpc3QgPSB7fQ0KCWlmIENoYW5uZWxzOg0KCQl2YWx1ZXMgPSB5cy52YWx1ZXMoQ2hhbm5lbHNbMF0uaGVhZGVyLCAiOiIpDQoJCU5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciTmFtZSInKQ0KCQlhY3Rpb24ubmFtZSA9IE5hbWUNCgkJIyB3cml0ZShsb2csW05hbWVdLG4pDQoNCgkJZm9yIGEgaW4gQ2hhbm5lbHNbMF0uY2hpbGRyZW46DQoJCQkjIHdyaXRlKGxvZyxbJ0JvbmUnXSxuKQ0KCQkJVmVjM0xlcnBDaGFubmVsID0geXMuZ2V0KGEsICcib3NnQW5pbWF0aW9uLlZlYzNMZXJwQ2hhbm5lbCInKQ0KCQkJYm9uZSA9IE5vbmUNCgkJCWlmIFZlYzNMZXJwQ2hhbm5lbDoNCgkJCQlLZXlGcmFtZXMgPSB5cy5nZXQoYSwgJyJLZXlGcmFtZXMiJykNCgkJCQlpZiBLZXlGcmFtZXM6DQoJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhLZXlGcmFtZXNbMF0uaGVhZGVyLCAiOiIpDQoJCQkJCU5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciTmFtZSInKQ0KCQkJCQlUYXJnZXROYW1lID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlRhcmdldE5hbWUiJywgJyIiJykNCgkJCQkJIyB3cml0ZShsb2csWydWZWMzTGVycENoYW5uZWw6JyxOYW1lLCdUYXJnZXROYW1lOicsVGFyZ2V0TmFtZV0sbis0KQ0KCQkJCQluYW1lID0gZ2V0U3BsaXROYW1lKFRhcmdldE5hbWUsICJfIiwgLTEpDQoJCQkJCWlmIE5hbWUgPT0gJyJ0cmFuc2xhdGUiJzoNCgkJCQkJCWlmIG5hbWUgaW4gYm9uZUluZGVrc0xpc3Q6DQoJCQkJCQkJbmFtZSA9IGJvbmVJbmRla3NMaXN0W25hbWVdDQoJCQkJCQkJaWYgbmFtZSBub3QgaW4gYm9uZUxpc3Qua2V5cygpOg0KCQkJCQkJCQlib25lID0gQWN0aW9uQm9uZSgpDQoJCQkJCQkJCWFjdGlvbi5ib25lTGlzdC5hcHBlbmQoYm9uZSkNCgkJCQkJCQkJYm9uZS5uYW1lID0gbmFtZQ0KCQkJCQkJCQlib25lTGlzdFtuYW1lXSA9IGJvbmUNCgkJCQkJCQlib25lID0gYm9uZUxpc3RbbmFtZV0NCg0KCQkJCQkJS2V5ID0geXMuZ2V0KGEsICciS2V5IicpDQoJCQkJCQlpZiBLZXk6DQoJCQkJCQkJdmFsdWVzID0geXMudmFsdWVzKEtleVswXS5kYXRhLCAiOiIpDQoJCQkJCQkJSXRlbVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciSXRlbVNpemUiJywgImkiKQ0KCQkJCQkJCUZsb2F0MzJBcnJheSA9IHlzLmdldChLZXlbMF0sICciRmxvYXQzMkFycmF5IicpDQoJCQkJCQkJaWYgRmxvYXQzMkFycmF5Og0KCQkJCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsICI6IikNCgkJCQkJCQkJRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicpDQoJCQkJCQkJCVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInKQ0KCQkJCQkJCQlPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicpDQoJCQkJCQkJCSMgd3JpdGUobG9nLFtGaWxlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdJdGVtU2l6ZTonLEl0ZW1TaXplXSxuKzQpDQoJCQkJCQkJCXBhdGggPSBGaWxlDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KCQkJCQkJCQkJZmlsZSA9IG9wZW4ocGF0aCwgInJiIikNCgkJCQkJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJCWcuc2VlayhpbnQoT2Zmc2V0KSkNCgkJCQkJCQkJCWZvciBtIGluIHJhbmdlKGludChTaXplKSk6DQoJCQkJCQkJCQkJdmFsdWUgPSBnLmYoSXRlbVNpemUpDQoJCQkJCQkJCQkJIyB3cml0ZShsb2csdmFsdWUsbis4KQ0KCQkJCQkJCQkJCWlmIGJvbmU6DQoJCQkJCQkJCQkJCWJvbmVNYXRyaXggPSAoDQoJCQkJCQkJCQkJCQlza2VsZXRvbi5vYmplY3QuZ2V0RGF0YSgpDQoJCQkJCQkJCQkJCQkuYm9uZXNbYm9uZS5uYW1lXQ0KCQkJCQkJCQkJCQkJLm1hdHJpeFsiQVJNQVRVUkVTUEFDRSJdDQoJCQkJCQkJCQkJCSkNCgkJCQkJCQkJCQkJYm9uZS5wb3NLZXlMaXN0LmFwcGVuZCgNCgkJCQkJCQkJCQkJCWJvbmVNYXRyaXggKiBWZWN0b3JNYXRyaXgodmFsdWUpDQoJCQkJCQkJCQkJCSkNCgkJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KDQoJCQkJCQlUaW1lID0geXMuZ2V0KGEsICciVGltZSInKQ0KCQkJCQkJaWYgVGltZToNCgkJCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoVGltZVswXS5kYXRhLCAiOiIpDQoJCQkJCQkJSXRlbVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciSXRlbVNpemUiJywgImkiKQ0KCQkJCQkJCUZsb2F0MzJBcnJheSA9IHlzLmdldChUaW1lWzBdLCAnIkZsb2F0MzJBcnJheSInKQ0KCQkJCQkJCWlmIEZsb2F0MzJBcnJheToNCgkJCQkJCQkJdmFsdWVzID0geXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCAiOiIpDQoJCQkJCQkJCUZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInKQ0KCQkJCQkJCQlTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJykNCgkJCQkJCQkJT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInKQ0KCQkJCQkJCQkjIHdyaXRlKGxvZyxbRmlsZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnSXRlbVNpemU6JyxJdGVtU2l6ZV0sbis0KQ0KCQkJCQkJCQlwYXRoID0gRmlsZQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKToNCgkJCQkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCQlnLnNlZWsoaW50KE9mZnNldCkpDQoJCQkJCQkJCQlmb3IgbSBpbiByYW5nZShpbnQoU2l6ZSkpOg0KCQkJCQkJCQkJCXZhbHVlID0gZy5mKEl0ZW1TaXplKQ0KCQkJCQkJCQkJCWlmIEl0ZW1TaXplID09IDE6DQoJCQkJCQkJCQkJCXZhbHVlID0gdmFsdWVbMF0NCgkJCQkJCQkJCQkjI3dyaXRlKGxvZyxbdmFsdWVdLG4rOCkNCgkJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCQlib25lLnBvc0ZyYW1lTGlzdC5hcHBlbmQoaW50KHZhbHVlICogMzMpKQ0KCQkJCQkJCQkJZmlsZS5jbG9zZSgpDQoNCgkJCVZlYzNMZXJwQ2hhbm5lbENvbXByZXNzZWRQYWNrZWQgPSB5cy5nZXQoDQoJCQkJYSwgJyJvc2dBbmltYXRpb24uVmVjM0xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZCInDQoJCQkpDQoJCQlpZiBWZWMzTGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkOg0KDQoJCQkJYXRyaWJ1dGVzID0ge30NCgkJCQlVc2VyRGF0YUNvbnRhaW5lciA9IHlzLmdldCgNCgkJCQkJVmVjM0xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZFswXSwgJyJVc2VyRGF0YUNvbnRhaW5lciInDQoJCQkJKQ0KCQkJCWlmIFVzZXJEYXRhQ29udGFpbmVyOg0KCQkJCQlWYWx1ZXMgPSB5cy5nZXQoVXNlckRhdGFDb250YWluZXJbMF0sICciVmFsdWVzIicpDQoJCQkJCWlmIFZhbHVlczoNCgkJCQkJCWZvciBjaGlsZCBpbiBWYWx1ZXNbMF0uY2hpbGRyZW46DQoJCQkJCQkJdmFsdWVzID0geXMudmFsdWVzKGNoaWxkLmRhdGEsICI6IikNCgkJCQkJCQlOYW1lID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk5hbWUiJykNCgkJCQkJCQlWYWx1ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJWYWx1ZSInLCAnImYiJykNCgkJCQkJCQkjI3dyaXRlKGxvZyxbTmFtZSxWYWx1ZV0sbis0KQ0KCQkJCQkJCWF0cmlidXRlc1tOYW1lXSA9IFZhbHVlDQoNCgkJCQlLZXlGcmFtZXMgPSB5cy5nZXQoYSwgJyJLZXlGcmFtZXMiJykNCgkJCQlpZiBLZXlGcmFtZXM6DQoJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhLZXlGcmFtZXNbMF0uaGVhZGVyLCAiOiIpDQoJCQkJCU5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciTmFtZSInKQ0KCQkJCQlUYXJnZXROYW1lID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlRhcmdldE5hbWUiJywgJyIiJykNCgkJCQkJIyB3cml0ZShsb2csWydWZWMzTGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkOicsTmFtZSwnVGFyZ2V0TmFtZTonLFRhcmdldE5hbWVdLG4rNCkNCgkJCQkJbmFtZSA9IGdldFNwbGl0TmFtZShUYXJnZXROYW1lLCAiXyIsIC0xKQ0KCQkJCQlpZiBOYW1lID09ICcidHJhbnNsYXRlIic6DQoJCQkJCQlpZiBuYW1lIGluIGJvbmVJbmRla3NMaXN0Og0KCQkJCQkJCW5hbWUgPSBib25lSW5kZWtzTGlzdFtuYW1lXQ0KCQkJCQkJCWlmIG5hbWUgbm90IGluIGJvbmVMaXN0LmtleXMoKToNCgkJCQkJCQkJYm9uZSA9IEFjdGlvbkJvbmUoKQ0KCQkJCQkJCQlhY3Rpb24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpDQoJCQkJCQkJCWJvbmUubmFtZSA9IG5hbWUNCgkJCQkJCQkJYm9uZUxpc3RbbmFtZV0gPSBib25lDQoJCQkJCQkJYm9uZSA9IGJvbmVMaXN0W25hbWVdDQoNCgkJCQkJCUtleSA9IHlzLmdldChhLCAnIktleSInKQ0KCQkJCQkJaWYgS2V5Og0KCQkJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhLZXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQkJCUl0ZW1TaXplID0gaW50KHlzLmdldFZhbHVlKHZhbHVlcywgJyJJdGVtU2l6ZSInKSkNCgkJCQkJCQlVaW50MTZBcnJheSA9IHlzLmdldChLZXlbMF0sICciVWludDE2QXJyYXkiJykNCgkJCQkJCQl0eXBlID0gIlVpbnQxNkFycmF5Ig0KCQkJCQkJCWlmIFVpbnQxNkFycmF5Og0KCQkJCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoVWludDE2QXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQkJCQlGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJykNCgkJCQkJCQkJU2l6ZSA9IGludCh5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInKSkNCgkJCQkJCQkJT2Zmc2V0ID0gaW50KHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJykpDQoJCQkJCQkJCUVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicpDQoJCQkJCQkJCSMgd3JpdGUobG9nLFtGaWxlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nLCdJdGVtU2l6ZTonLEl0ZW1TaXplXSxuKzQpDQoJCQkJCQkJCXBhdGggPSBGaWxlDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KCQkJCQkJCQkJZmlsZSA9IG9wZW4ocGF0aCwgInJiIikNCgkJCQkJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCg0KCQkJCQkJCQkJbGlzdCA9IGRlY29kZVZhcmludCgNCgkJCQkJCQkJCQlnLCBPZmZzZXQsIFNpemUgKiBJdGVtU2l6ZSwgdHlwZQ0KCQkJCQkJCQkJKQ0KCQkJCQkJCQkJbGlzdDEgPSBldGFwMShsaXN0LCBJdGVtU2l6ZSkNCgkJCQkJCQkJCW91dCA9IGV0YXAyKGxpc3QxLCBJdGVtU2l6ZSwgYXRyaWJ1dGVzKQ0KCQkJCQkJCQkJbGlzdDIgPSBbDQoJCQkJCQkJCQkJYXRyaWJ1dGVzWycib3giJ10sDQoJCQkJCQkJCQkJYXRyaWJ1dGVzWycib3kiJ10sDQoJCQkJCQkJCQkJYXRyaWJ1dGVzWycib3oiJ10sDQoJCQkJCQkJCQldDQoJCQkJCQkJCQlsaXN0Mi5leHRlbmQob3V0KQ0KCQkJCQkJCQkJbGlzdDMgPSBldGFwMyhsaXN0MiwgSXRlbVNpemUpDQoJCQkJCQkJCQlmb3IgbSBpbiByYW5nZShTaXplICsgMSk6DQoJCQkJCQkJCQkJdmFsdWUgPSBsaXN0M1ttICogMyA6IG0gKiAzICsgM10NCgkJCQkJCQkJCQkjIHdyaXRlKGxvZyx2YWx1ZSxuKzgpDQoJCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQkJYm9uZU1hdHJpeCA9ICgNCgkJCQkJCQkJCQkJCXNrZWxldG9uLm9iamVjdC5nZXREYXRhKCkNCgkJCQkJCQkJCQkJCS5ib25lc1tib25lLm5hbWVdDQoJCQkJCQkJCQkJCQkubWF0cml4WyJBUk1BVFVSRVNQQUNFIl0NCgkJCQkJCQkJCQkJKQ0KCQkJCQkJCQkJCQlib25lLnBvc0tleUxpc3QuYXBwZW5kKA0KCQkJCQkJCQkJCQkJYm9uZU1hdHJpeCAqIFZlY3Rvck1hdHJpeCh2YWx1ZSkNCgkJCQkJCQkJCQkJKQ0KCQkJCQkJCQkJZmlsZS5jbG9zZSgpDQoNCgkJCQkJCVRpbWUgPSB5cy5nZXQoYSwgJyJUaW1lIicpDQoJCQkJCQlpZiBUaW1lOg0KCQkJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhUaW1lWzBdLmRhdGEsICI6IikNCgkJCQkJCQlJdGVtU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJJdGVtU2l6ZSInLCAiaSIpDQoJCQkJCQkJRmxvYXQzMkFycmF5ID0geXMuZ2V0KFRpbWVbMF0sICciRmxvYXQzMkFycmF5IicpDQoJCQkJCQkJaWYgRmxvYXQzMkFycmF5Og0KCQkJCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsICI6IikNCgkJCQkJCQkJRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicpDQoJCQkJCQkJCVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAiaSIpDQoJCQkJCQkJCU9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgImkiKQ0KCQkJCQkJCQkjIHdyaXRlKGxvZyxbRmlsZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnSXRlbVNpemU6JyxJdGVtU2l6ZV0sbis0KQ0KCQkJCQkJCQlwYXRoID0gRmlsZQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKToNCgkJCQkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCQlnLnNlZWsoaW50KE9mZnNldCkpDQoJCQkJCQkJCQlsaXN0ID0gZy5mKFNpemUgKiBJdGVtU2l6ZSkNCgkJCQkJCQkJCWxpc3QxID0gZXRhcDEobGlzdCwgSXRlbVNpemUpDQoJCQkJCQkJCQkjIG91dD1ldGFwMihsaXN0MSxJdGVtU2l6ZSxhdHJpYnV0ZXMpDQoJCQkJCQkJCQlsaXN0MiA9IFthdHJpYnV0ZXNbJyJvdCInXV0NCgkJCQkJCQkJCWxpc3QyLmV4dGVuZChsaXN0MSkNCgkJCQkJCQkJCWxpc3QzID0gZXRhcDMobGlzdDIsIEl0ZW1TaXplKQ0KCQkJCQkJCQkJIyN3cml0ZShsb2csbGlzdDMsMCkNCgkJCQkJCQkJCWZvciBtIGluIHJhbmdlKFNpemUgKyAxKToNCgkJCQkJCQkJCQl2YWx1ZSA9IGxpc3QzW21dDQoJCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQkJYm9uZS5wb3NGcmFtZUxpc3QuYXBwZW5kKGludCh2YWx1ZSAqIDMzKSkNCgkJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KDQoJCQlRdWF0U2xlcnBDaGFubmVsID0geXMuZ2V0KGEsICcib3NnQW5pbWF0aW9uLlF1YXRTbGVycENoYW5uZWwiJykNCgkJCWlmIFF1YXRTbGVycENoYW5uZWw6DQoJCQkJS2V5RnJhbWVzID0geXMuZ2V0KGEsICciS2V5RnJhbWVzIicpDQoJCQkJaWYgS2V5RnJhbWVzOg0KCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoS2V5RnJhbWVzWzBdLmhlYWRlciwgIjoiKQ0KCQkJCQlOYW1lID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk5hbWUiJykNCgkJCQkJVGFyZ2V0TmFtZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJUYXJnZXROYW1lIicsICciIicpDQoJCQkJCSMgd3JpdGUobG9nLFsnUXVhdFNsZXJwQ2hhbm5lbDonLE5hbWUsJ1RhcmdldE5hbWU6JyxUYXJnZXROYW1lXSxuKzQpDQoJCQkJCW5hbWUgPSBnZXRTcGxpdE5hbWUoVGFyZ2V0TmFtZSwgIl8iLCAtMSkNCgkJCQkJaWYgbmFtZSBpbiBib25lSW5kZWtzTGlzdDoNCgkJCQkJCW5hbWUgPSBib25lSW5kZWtzTGlzdFtuYW1lXQ0KCQkJCQkJaWYgbmFtZSBub3QgaW4gYm9uZUxpc3Qua2V5cygpOg0KCQkJCQkJCWJvbmUgPSBBY3Rpb25Cb25lKCkNCgkJCQkJCQlhY3Rpb24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpDQoJCQkJCQkJYm9uZS5uYW1lID0gbmFtZQ0KCQkJCQkJCWJvbmVMaXN0W25hbWVdID0gYm9uZQ0KCQkJCQkJYm9uZSA9IGJvbmVMaXN0W25hbWVdDQoNCgkJCQkJS2V5ID0geXMuZ2V0KGEsICciS2V5IicpDQoJCQkJCWlmIEtleToNCgkJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhLZXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQkJSXRlbVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciSXRlbVNpemUiJykNCgkJCQkJCUZsb2F0MzJBcnJheSA9IHlzLmdldChLZXlbMF0sICciRmxvYXQzMkFycmF5IicpDQoJCQkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCQkJdmFsdWVzID0geXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCAiOiIpDQoJCQkJCQkJRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicpDQoJCQkJCQkJU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicpDQoJCQkJCQkJT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInKQ0KCQkJCQkJCSMgd3JpdGUobG9nLFtGaWxlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdJdGVtU2l6ZTonLEl0ZW1TaXplXSxuKzQpDQoJCQkJCQkJcGF0aCA9IEZpbGUNCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKToNCgkJCQkJCQkJZmlsZSA9IG9wZW4ocGF0aCwgInJiIikNCgkJCQkJCQkJZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQlnLnNlZWsoaW50KE9mZnNldCkpDQoJCQkJCQkJCWZvciBtIGluIHJhbmdlKGludChTaXplKSk6DQoJCQkJCQkJCQl2YWx1ZSA9IGcuZig0KQ0KCQkJCQkJCQkJdmFsdWUgPSBRdWF0ZXJuaW9uKHZhbHVlKQ0KCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQlib25lTWF0cml4ID0gKA0KCQkJCQkJCQkJCQlza2VsZXRvbi5vYmplY3QuZ2V0RGF0YSgpDQoJCQkJCQkJCQkJCS5ib25lc1tib25lLm5hbWVdDQoJCQkJCQkJCQkJCS5tYXRyaXhbIkFSTUFUVVJFU1BBQ0UiXQ0KCQkJCQkJCQkJCSkNCgkJCQkJCQkJCQlib25lLnJvdEtleUxpc3QuYXBwZW5kKA0KCQkJCQkJCQkJCQlib25lTWF0cml4ICogUXVhdE1hdHJpeCh2YWx1ZSkucmVzaXplNHg0KCkNCgkJCQkJCQkJCQkpDQoJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KDQoJCQkJCVRpbWUgPSB5cy5nZXQoYSwgJyJUaW1lIicpDQoJCQkJCWlmIFRpbWU6DQoJCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoVGltZVswXS5kYXRhLCAiOiIpDQoJCQkJCQlJdGVtU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJJdGVtU2l6ZSInLCAiaSIpDQoJCQkJCQlGbG9hdDMyQXJyYXkgPSB5cy5nZXQoVGltZVswXSwgJyJGbG9hdDMyQXJyYXkiJykNCgkJCQkJCWlmIEZsb2F0MzJBcnJheToNCgkJCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsICI6IikNCgkJCQkJCQlGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJykNCgkJCQkJCQlTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJykNCgkJCQkJCQlPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicpDQoJCQkJCQkJIyB3cml0ZShsb2csW0ZpbGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0l0ZW1TaXplOicsSXRlbVNpemVdLG4rNCkNCgkJCQkJCQlwYXRoID0gRmlsZQ0KCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KCQkJCQkJCQlmaWxlID0gb3BlbihwYXRoLCAicmIiKQ0KCQkJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCWcuc2VlayhpbnQoT2Zmc2V0KSkNCgkJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoaW50KFNpemUpKToNCgkJCQkJCQkJCXZhbHVlID0gZy5mKEl0ZW1TaXplKQ0KCQkJCQkJCQkJaWYgSXRlbVNpemUgPT0gMToNCgkJCQkJCQkJCQl2YWx1ZSA9IHZhbHVlWzBdDQoJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCWJvbmUucm90RnJhbWVMaXN0LmFwcGVuZChpbnQodmFsdWUgKiAzMykpDQoJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KDQoJCQlRdWF0U2xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZCA9IHlzLmdldCgNCgkJCQlhLCAnIm9zZ0FuaW1hdGlvbi5RdWF0U2xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZCInDQoJCQkpDQoJCQlpZiBRdWF0U2xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZDoNCg0KCQkJCWF0cmlidXRlcyA9IHt9DQoJCQkJVXNlckRhdGFDb250YWluZXIgPSB5cy5nZXQoDQoJCQkJCVF1YXRTbGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkWzBdLCAnIlVzZXJEYXRhQ29udGFpbmVyIicNCgkJCQkpDQoJCQkJaWYgVXNlckRhdGFDb250YWluZXI6DQoJCQkJCVZhbHVlcyA9IHlzLmdldChVc2VyRGF0YUNvbnRhaW5lclswXSwgJyJWYWx1ZXMiJykNCgkJCQkJaWYgVmFsdWVzOg0KCQkJCQkJZm9yIGNoaWxkIGluIFZhbHVlc1swXS5jaGlsZHJlbjoNCgkJCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoY2hpbGQuZGF0YSwgIjoiKQ0KCQkJCQkJCU5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciTmFtZSInKQ0KCQkJCQkJCVZhbHVlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlZhbHVlIicsICciZiInKQ0KCQkJCQkJCSMjd3JpdGUobG9nLFtOYW1lLFZhbHVlXSxuKzQpDQoJCQkJCQkJYXRyaWJ1dGVzW05hbWVdID0gVmFsdWUNCg0KCQkJCUtleUZyYW1lcyA9IHlzLmdldChhLCAnIktleUZyYW1lcyInKQ0KCQkJCWlmIEtleUZyYW1lczoNCgkJCQkJdmFsdWVzID0geXMudmFsdWVzKEtleUZyYW1lc1swXS5oZWFkZXIsICI6IikNCgkJCQkJTmFtZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJOYW1lIicpDQoJCQkJCVRhcmdldE5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciVGFyZ2V0TmFtZSInLCAnIiInKQ0KCQkJCQkjIHdyaXRlKGxvZyxbJ1F1YXRTbGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkOicsTmFtZSwnVGFyZ2V0TmFtZTonLFRhcmdldE5hbWVdLG4rNCkNCgkJCQkJbmFtZSA9IGdldFNwbGl0TmFtZShUYXJnZXROYW1lLCAiXyIsIC0xKQ0KCQkJCQlpZiBuYW1lIGluIGJvbmVJbmRla3NMaXN0Og0KCQkJCQkJbmFtZSA9IGJvbmVJbmRla3NMaXN0W25hbWVdDQoJCQkJCQlpZiBuYW1lIG5vdCBpbiBib25lTGlzdC5rZXlzKCk6DQoJCQkJCQkJYm9uZSA9IEFjdGlvbkJvbmUoKQ0KCQkJCQkJCWFjdGlvbi5ib25lTGlzdC5hcHBlbmQoYm9uZSkNCgkJCQkJCQlib25lLm5hbWUgPSBuYW1lDQoJCQkJCQkJYm9uZUxpc3RbbmFtZV0gPSBib25lDQoJCQkJCQlib25lID0gYm9uZUxpc3RbbmFtZV0NCg0KCQkJCQlLZXkgPSB5cy5nZXQoYSwgJyJLZXkiJykNCgkJCQkJaWYgS2V5Og0KCQkJCQkJdmFsdWVzID0geXMudmFsdWVzKEtleVswXS5kYXRhLCAiOiIpDQoJCQkJCQlJdGVtU2l6ZSA9IGludCh5cy5nZXRWYWx1ZSh2YWx1ZXMsICciSXRlbVNpemUiJykpDQoJCQkJCQlVaW50MTZBcnJheSA9IHlzLmdldChLZXlbMF0sICciVWludDE2QXJyYXkiJykNCgkJCQkJCXR5cGUgPSAiVWludDE2QXJyYXkiDQoJCQkJCQlpZiBVaW50MTZBcnJheToNCgkJCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoVWludDE2QXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQkJCUZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInKQ0KCQkJCQkJCVNpemUgPSBpbnQoeXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJykpDQoJCQkJCQkJT2Zmc2V0ID0gaW50KHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJykpDQoJCQkJCQkJRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJykNCgkJCQkJCQkjIHdyaXRlKGxvZyxbRmlsZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZywnSXRlbVNpemU6JyxJdGVtU2l6ZV0sbis0KQ0KCQkJCQkJCXBhdGggPSBGaWxlDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk6DQoJCQkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCg0KCQkJCQkJCQlsaXN0ID0gZGVjb2RlVmFyaW50KGcsIE9mZnNldCwgU2l6ZSAqIEl0ZW1TaXplLCB0eXBlKQ0KCQkJCQkJCQkjI3dyaXRlKGxvZyxsaXN0LDApDQoJCQkJCQkJCWxpc3QxID0gZXRhcDEobGlzdCwgSXRlbVNpemUpDQoJCQkJCQkJCSMjd3JpdGUobG9nLGxpc3QxLDApDQoNCgkJCQkJCQkJbGlzdDIgPSBpbnQzZmxvYXQ0KGxpc3QxLCBhdHJpYnV0ZXMsIEl0ZW1TaXplKQ0KCQkJCQkJCQkjI3dyaXRlKGxvZyxsaXN0MiwwKQ0KCQkJCQkJCQlsaXN0MyA9IFsNCgkJCQkJCQkJCWF0cmlidXRlc1snIm94IiddLA0KCQkJCQkJCQkJYXRyaWJ1dGVzWycib3kiJ10sDQoJCQkJCQkJCQlhdHJpYnV0ZXNbJyJveiInXSwNCgkJCQkJCQkJCWF0cmlidXRlc1snIm93IiddLA0KCQkJCQkJCQldDQoJCQkJCQkJCWxpc3QzLmV4dGVuZChsaXN0MikNCgkJCQkJCQkJbGlzdDQgPSBldGFwNChsaXN0MykNCgkJCQkJCQkJIyN3cml0ZShsb2csbGlzdDQsMCkNCg0KCQkJCQkJCQlmb3IgbSBpbiByYW5nZShTaXplICsgMSk6DQoJCQkJCQkJCQl2YWx1ZSA9IGxpc3Q0W20gKiA0IDogbSAqIDQgKyA0XQ0KCQkJCQkJCQkJdmFsdWUgPSBRdWF0ZXJuaW9uKHZhbHVlKQ0KCQkJCQkJCQkJIyN3cml0ZShsb2csdmFsdWUsbis4KQ0KCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQlib25lTWF0cml4ID0gKA0KCQkJCQkJCQkJCQlza2VsZXRvbi5vYmplY3QuZ2V0RGF0YSgpDQoJCQkJCQkJCQkJCS5ib25lc1tib25lLm5hbWVdDQoJCQkJCQkJCQkJCS5tYXRyaXhbIkFSTUFUVVJFU1BBQ0UiXQ0KCQkJCQkJCQkJCSkNCgkJCQkJCQkJCQkjI2JvbmUucm90S2V5TGlzdC5hcHBlbmQoKGJvbmVNYXRyaXgucm90YXRpb25QYXJ0KCkqUXVhdE1hdHJpeCh2YWx1ZSkpLnJlc2l6ZTR4NCgpKQ0KCQkJCQkJCQkJCWJvbmUucm90S2V5TGlzdC5hcHBlbmQoDQoJCQkJCQkJCQkJCWJvbmVNYXRyaXggKiBRdWF0TWF0cml4KHZhbHVlKS5yZXNpemU0eDQoKQ0KCQkJCQkJCQkJCSkNCgkJCQkJCQkJZmlsZS5jbG9zZSgpDQoNCgkJCQkJVGltZSA9IHlzLmdldChhLCAnIlRpbWUiJykNCgkJCQkJaWYgVGltZToNCgkJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhUaW1lWzBdLmRhdGEsICI6IikNCgkJCQkJCUl0ZW1TaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkl0ZW1TaXplIicsICJpIikNCgkJCQkJCUZsb2F0MzJBcnJheSA9IHlzLmdldChUaW1lWzBdLCAnIkZsb2F0MzJBcnJheSInKQ0KCQkJCQkJaWYgRmxvYXQzMkFycmF5Og0KCQkJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQkJCUZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInKQ0KCQkJCQkJCVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAiaSIpDQoJCQkJCQkJT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAiaSIpDQoJCQkJCQkJIyB3cml0ZShsb2csW0ZpbGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0l0ZW1TaXplOicsSXRlbVNpemVdLG4rNCkNCgkJCQkJCQlwYXRoID0gRmlsZQ0KCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KCQkJCQkJCQlmaWxlID0gb3BlbihwYXRoLCAicmIiKQ0KCQkJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCWcuc2VlayhpbnQoT2Zmc2V0KSkNCgkJCQkJCQkJbGlzdCA9IGcuZihTaXplICogSXRlbVNpemUpDQoJCQkJCQkJCWxpc3QxID0gZXRhcDEobGlzdCwgSXRlbVNpemUpDQoJCQkJCQkJCSMgb3V0PWV0YXAyKGxpc3QxLEl0ZW1TaXplLGF0cmlidXRlcykNCgkJCQkJCQkJbGlzdDIgPSBbYXRyaWJ1dGVzWycib3QiJ11dDQoJCQkJCQkJCWxpc3QyLmV4dGVuZChsaXN0MSkNCgkJCQkJCQkJbGlzdDMgPSBldGFwMyhsaXN0MiwgSXRlbVNpemUpDQoJCQkJCQkJCSMjd3JpdGUobG9nLGxpc3QzLDApDQoJCQkJCQkJCWZvciBtIGluIHJhbmdlKFNpemUgKyAxKToNCgkJCQkJCQkJCXZhbHVlID0gbGlzdDJbbV0NCgkJCQkJCQkJCWlmIGJvbmU6DQoJCQkJCQkJCQkJYm9uZS5yb3RGcmFtZUxpc3QuYXBwZW5kKGludCh2YWx1ZSAqIDMzKSkNCgkJCQkJCQkJZmlsZS5jbG9zZSgpDQoNCgkJCWlmIGJvbmU6DQoJCQkJcHJpbnQgbmFtZSwgYm9uZS5uYW1lDQoNCglhY3Rpb24uZHJhdygpDQoJYWN0aW9uLnNldENvbnRleHQoKQ0KDQoNCmRlZiBnZXRQcmltaXRpdmVTZXRMaXN0KHlzLCBQcmltaXRpdmVTZXRMaXN0LCBuKToNCglnbG9iYWwgbWFnaWMNCgltb2RlID0gTm9uZQ0KCW1hZ2ljID0gMA0KCWluZGljZUFycmF5ID0gW10NCglmb3IgY2hpbGQgaW4gUHJpbWl0aXZlU2V0TGlzdFswXS5jaGlsZHJlbjoNCgkJZm9yIGIgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQlpZiAnIkRyYXdFbGVtZW50c1VJbnQiJyBpbiBiLmhlYWRlcjoNCgkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoYi5kYXRhLCAiOiIpDQoJCQkJbW9kZSA9IHZhbHVlc1snIk1vZGUiJ10NCgkJCQlTaXplID0gTm9uZQ0KCQkJCU9mZnNldCA9IE5vbmUNCgkJCQlFbmNvZGluZyA9IE5vbmUNCgkJCQlJdGVtU2l6ZSA9IE5vbmUNCgkJCQl0eXBlID0gTm9uZQ0KCQkJCWlmIG1vZGUgIT0gJyJMSU5FUyInOg0KCQkJCQlJbmRpY2VzID0geXMuZ2V0KGIsICciSW5kaWNlcyInKQ0KCQkJCQlpZiBJbmRpY2VzOg0KCQkJCQkJdmFsdWVzID0geXMudmFsdWVzKEluZGljZXNbMF0uZGF0YSwgIjoiKQ0KCQkJCQkJSXRlbVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciSXRlbVNpemUiJywgImkiKQ0KCQkJCQkJVWludDMyQXJyYXkgPSB5cy5nZXQoSW5kaWNlc1swXSwgJyJVaW50MzJBcnJheSInKQ0KCQkJCQkJdHlwZSA9ICJVaW50MzJBcnJheSINCgkJCQkJCXByaW50ICJEcmF3RWxlbWVudHNVSW50IiwgdHlwZQ0KCQkJCQkJaWYgVWludDMyQXJyYXk6DQoJCQkJCQkJdmFsdWVzID0geXMudmFsdWVzKFVpbnQzMkFycmF5WzBdLmRhdGEsICI6IikNCgkJCQkJCQlTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgImkiKQ0KCQkJCQkJCU9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgImkiKQ0KCQkJCQkJCUVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicsICciIicpDQoJCQkJCQkJIyB3cml0ZShsb2csWydJbmRpY2U6JywnbW9kZTonLG1vZGUsdHlwZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZywnbWFnaWM6JyxtYWdpY10sbikNCgkJCQkJCQlpZiBFbmNvZGluZyA9PSAidmFyaW50IjoNCgkJCQkJCQkJcGF0aCA9ICIuL3t0ZW1wUGF0aH0vbW9kZWxfZmlsZS5iaW4uZ3oiDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpID09IEZhbHNlOg0KCQkJCQkJCQkJcGF0aCA9ICIuL3t0ZW1wUGF0aH0vbW9kZWxfZmlsZS5iaW4iDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpID09IFRydWU6DQoJCQkJCQkJCQlmaWxlID0gb3BlbihwYXRoLCAicmIiKQ0KCQkJCQkJCQkJZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQkJbWFnaWMsIGluZGljZUxpc3QgPSBnZXRJbmRpY2VzKA0KCQkJCQkJCQkJCUl0ZW1TaXplLCBTaXplLCBPZmZzZXQsIHR5cGUsIGcsIG1vZGUsIG1hZ2ljDQoJCQkJCQkJCQkpDQoJCQkJCQkJCQlpbmRpY2VBcnJheS5hcHBlbmQoW2luZGljZUxpc3QsIG1vZGVdKQ0KCQkJCQkJCQkJZmlsZS5jbG9zZSgpDQoJCQkJZWxzZToNCgkJCQkJcHJpbnQgIkxJTkVTIg0KDQoJCQlpZiAnIkRyYXdFbGVtZW50c1VTaG9ydCInIGluIGIuaGVhZGVyOg0KCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhiLmRhdGEsICI6IikNCgkJCQltb2RlID0gdmFsdWVzWyciTW9kZSInXQ0KCQkJCVNpemUgPSBOb25lDQoJCQkJT2Zmc2V0ID0gTm9uZQ0KCQkJCUVuY29kaW5nID0gTm9uZQ0KCQkJCUl0ZW1TaXplID0gTm9uZQ0KCQkJCXR5cGUgPSBOb25lDQoJCQkJaWYgbW9kZSAhPSAnIkxJTkVTIic6DQoJCQkJCUluZGljZXMgPSB5cy5nZXQoYiwgJyJJbmRpY2VzIicpDQoJCQkJCWlmIEluZGljZXM6DQoJCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoSW5kaWNlc1swXS5kYXRhLCAiOiIpDQoJCQkJCQlJdGVtU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJJdGVtU2l6ZSInLCAiaSIpDQoJCQkJCQlVaW50MTZBcnJheSA9IHlzLmdldChJbmRpY2VzWzBdLCAnIlVpbnQxNkFycmF5IicpDQoJCQkJCQl0eXBlID0gIlVpbnQxNkFycmF5Ig0KCQkJCQkJcHJpbnQgIkRyYXdFbGVtZW50c1VTaG9ydCIsIHR5cGUNCgkJCQkJCWlmIFVpbnQxNkFycmF5Og0KCQkJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhVaW50MTZBcnJheVswXS5kYXRhLCAiOiIpDQoJCQkJCQkJU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICJpIikNCgkJCQkJCQlPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicsICJpIikNCgkJCQkJCQlFbmNvZGluZyA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJFbmNvZGluZyInLCAnIiInKQ0KCQkJCQkJCSMgd3JpdGUobG9nLFsnSW5kaWNlOicsJ21vZGU6Jyxtb2RlLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmcsJ21hZ2ljOicsbWFnaWNdLG4pDQoJCQkJCQkJcHJpbnQgRW5jb2RpbmcNCgkJCQkJCQlpZiBFbmNvZGluZyA9PSAidmFyaW50IjoNCgkJCQkJCQkJcGF0aCA9ICIuL3t0ZW1wUGF0aH0vbW9kZWxfZmlsZS5iaW4uZ3oiDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpID09IEZhbHNlOg0KCQkJCQkJCQkJcGF0aCA9ICIuL3t0ZW1wUGF0aH0vbW9kZWxfZmlsZS5iaW4iDQoNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCkgPT0gVHJ1ZToNCgkJCQkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCQltYWdpYywgaW5kaWNlTGlzdCA9IGdldEluZGljZXMoDQoJCQkJCQkJCQkJSXRlbVNpemUsIFNpemUsIE9mZnNldCwgdHlwZSwgZywgbW9kZSwgbWFnaWMNCgkJCQkJCQkJCSkNCgkJCQkJCQkJCWluZGljZUFycmF5LmFwcGVuZChbaW5kaWNlTGlzdCwgbW9kZV0pDQoJCQkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQkJCQllbHNlOg0KCQkJCQkJCQlwYXRoID0gIi4ve3RlbXBQYXRofS9tb2RlbF9maWxlLmJpbi5neiINCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCkgPT0gRmFsc2U6DQoJCQkJCQkJCQlwYXRoID0gIi4ve3RlbXBQYXRofS9tb2RlbF9maWxlLmJpbiINCg0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKSA9PSBUcnVlOg0KCQkJCQkJCQkJZmlsZSA9IG9wZW4ocGF0aCwgInJiIikNCgkJCQkJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJCWcuc2VlayhPZmZzZXQpDQoJCQkJCQkJCQlpbmRpY2VMaXN0ID0gZy5IKEl0ZW1TaXplICogU2l6ZSkNCgkJCQkJCQkJCWluZGljZUFycmF5LmFwcGVuZChbaW5kaWNlTGlzdCwgbW9kZV0pDQoJCQkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQllbHNlOg0KCQkJCQlwcmludCAiTElORVMiDQoNCgkJCWlmICciRHJhd0VsZW1lbnRzVUJ5dGUiJyBpbiBiLmhlYWRlcjoNCgkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoYi5kYXRhLCAiOiIpDQoJCQkJbW9kZSA9IHZhbHVlc1snIk1vZGUiJ10NCgkJCQlTaXplID0gTm9uZQ0KCQkJCU9mZnNldCA9IE5vbmUNCgkJCQlFbmNvZGluZyA9IE5vbmUNCgkJCQlJdGVtU2l6ZSA9IE5vbmUNCgkJCQl0eXBlID0gTm9uZQ0KCQkJCWlmIG1vZGUgIT0gJyJMSU5FUyInOg0KCQkJCQlJbmRpY2VzID0geXMuZ2V0KGIsICciSW5kaWNlcyInKQ0KCQkJCQlpZiBJbmRpY2VzOg0KCQkJCQkJdmFsdWVzID0geXMudmFsdWVzKEluZGljZXNbMF0uZGF0YSwgIjoiKQ0KCQkJCQkJSXRlbVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciSXRlbVNpemUiJywgImkiKQ0KCQkJCQkJVWludDhBcnJheSA9IHlzLmdldChJbmRpY2VzWzBdLCAnIlVpbnQ4QXJyYXkiJykNCgkJCQkJCXR5cGUgPSAiVWludDhBcnJheSINCgkJCQkJCXByaW50ICJEcmF3RWxlbWVudHNVQnl0ZSIsIHR5cGUNCgkJCQkJCWlmIFVpbnQ4QXJyYXk6DQoJCQkJCQkJdmFsdWVzID0geXMudmFsdWVzKFVpbnQ4QXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQkJCVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAiaSIpDQoJCQkJCQkJT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAiaSIpDQoJCQkJCQkJRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJywgJyIiJykNCgkJCQkJCQkjIHdyaXRlKGxvZyxbJ0luZGljZTonLCdtb2RlOicsbW9kZSx0eXBlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nLCdtYWdpYzonLG1hZ2ljXSxuKQ0KCQkJCQkJCXBhdGggPSAiLi97dGVtcFBhdGh9L21vZGVsX2ZpbGUuYmluLmd6Ig0KCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpID09IEZhbHNlOg0KCQkJCQkJCQlwYXRoID0gIi4ve3RlbXBQYXRofS9tb2RlbF9maWxlLmJpbiINCg0KCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpID09IFRydWU6DQoJCQkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJbWFnaWMsIGluZGljZUxpc3QgPSBnZXRJbmRpY2VzKA0KCQkJCQkJCQkJSXRlbVNpemUsIFNpemUsIE9mZnNldCwgdHlwZSwgZywgbW9kZSwgbWFnaWMNCgkJCQkJCQkJKQ0KCQkJCQkJCQlpbmRpY2VBcnJheS5hcHBlbmQoW2luZGljZUxpc3QsIG1vZGVdKQ0KCQkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQllbHNlOg0KCQkJCQlwcmludCAiTElORVMiDQoNCglyZXR1cm4gaW5kaWNlQXJyYXkNCg0KDQpkZWYgZ2V0UGF0aChGaWxlKToNCglwYXRoID0gIi4ve3RlbXBQYXRofS9tb2RlbF9maWxlLmJpbiINCglpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKSA9PSBGYWxzZToNCgkJcGF0aCA9IG9zLnBhdGguZGlybmFtZShpbnB1dC5maWxlbmFtZSkgKyBvcy5zZXAgKyBGaWxlDQoJaWYgb3MucGF0aC5leGlzdHMocGF0aCkgPT0gVHJ1ZToNCgkJcmV0dXJuIHBhdGgNCgllbHNlOg0KCQlyZXR1cm4gTm9uZQ0KDQpkZWYgcmVhZEZsb2F0cyhicixvZmZzZXQsc2l6ZSxpdGVtU2l6ZSk6DQoJaWYgYnIuaW5wdXRGaWxlLm1vZGU9PSdyYic6DQoJCWJyLnNlZWsob2Zmc2V0KQ0KCQlpID0gMA0KCQludW1iZXJzID0gW10NCgkJd2hpbGUgaSA8IHNpemUgKiBpdGVtU2l6ZToNCgkJCW51bWJlcnMuYXBwZW5kKGZsb2F0KHN0cnVjdC51bnBhY2soJzxmJyxici5pbnB1dEZpbGUucmVhZCg0KSlbMF0pKQ0KCQkJaSArPSAxDQoJCXJldHVybiBudW1iZXJzDQoNCmRlZiBnZXRWZXJ0ZXhBdHRyaWJ1dGVMaXN0KHlzLCBWZXJ0ZXhBdHRyaWJ1dGVMaXN0LCBuKToNCgl2ZXJ0ZXhBcnJheSA9IFtdDQoJdGV4QXJyYXkwID0gW10NCgl0ZXhBcnJheTEgPSBbXQ0KCXRleEFycmF5MiA9IFtdDQoJdGV4QXJyYXkzID0gW10NCgl0ZXhBcnJheTQgPSBbXQ0KCXRleEFycmF5NSA9IFtdDQoJdGV4QXJyYXk2ID0gW10NCgl0ZXhBcnJheTcgPSBbXQ0KCXRleEFycmF5OCA9IFtdDQoJdGV4QXJyYXk5ID0gW10NCgl0ZXhBcnJheTEwID0gW10NCgl0YW5nZW50QXJyYXkgPSBbXQ0KCW5vcm1hbEFycmF5ID0gW10NCg0KCXRyeToNCgkJTm9ybWFsID0geXMuZ2V0KFZlcnRleEF0dHJpYnV0ZUxpc3RbMF0sICciTm9ybWFsIicpDQoJCW1vZGUgPSAiTm9ybWFsIg0KCQlmb3IgYiBpbiBOb3JtYWw6DQoJCQlTaXplID0gTm9uZQ0KCQkJT2Zmc2V0ID0gTm9uZQ0KCQkJRW5jb2RpbmcgPSBOb25lDQoJCQlJdGVtU2l6ZSA9IE5vbmUNCgkJCXR5cGUgPSBOb25lDQoJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoYi5kYXRhLCAiOiIpDQoJCQlpZiAnIkl0ZW1TaXplIicgaW4gdmFsdWVzOg0KCQkJCUl0ZW1TaXplID0gaW50KHZhbHVlc1snIkl0ZW1TaXplIiddKQ0KCQkJCVVpbnQzMkFycmF5ID0geXMuZ2V0KGIsICciVWludDMyQXJyYXkiJykNCgkJCQlpZiBVaW50MzJBcnJheToNCgkJCQkJdHlwZSA9ICJVaW50MzJBcnJheSINCgkJCQkJcHJpbnQgbW9kZSwgdHlwZQ0KCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoVWludDMyQXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQlTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgImkiKQ0KCQkJCQlPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicsICJpIikNCgkJCQkJRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicsICciIicpDQoJCQkJCUVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicpDQoJCQkJCXByaW50IFsnTm9ybWFsOicsJ01vZGU6Jyxtb2RlLCdUeXBlOicsdHlwZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZ10NCgkJCQkJaWYgRW5jb2RpbmcgPT0gJyJ2YXJpbnQiJzoNCgkJCQkJCXBhdGggPSBnZXRQYXRoKEZpbGUpDQoJCQkJCQlpZiBwYXRoOg0KCQkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQkJZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCWJ5dGVzID0gZGVjb2RlVmFyaW50KGcsIE9mZnNldCwgU2l6ZSAqIEl0ZW1TaXplLCB0eXBlKQ0KCQkJCQkJCW5vcm1hbEFycmF5LmFwcGVuZChbYnl0ZXMsIEVuY29kaW5nLCBJdGVtU2l6ZV0pDQoJCQkJCQkJZmlsZS5jbG9zZSgpDQoNCgkJCQlGbG9hdDMyQXJyYXkgPSB5cy5nZXQoYiwgJyJGbG9hdDMyQXJyYXkiJykNCgkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCXR5cGUgPSAiRmxvYXQzMkFycmF5Ig0KCQkJCQlwcmludCBtb2RlLCB0eXBlDQoJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQlTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgImkiKQ0KCQkJCQlPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicsICJpIikNCgkJCQkJRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicsICciIicpDQoJCQkJCUVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicpDQoJCQkJCXByaW50IFsnVmVydGV4OicsJ01vZGU6Jyxtb2RlLCdUeXBlOicsdHlwZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZ10NCgkJCQkJaWYgRW5jb2RpbmcgIT0gJyJ2YXJpbnQiJzoNCgkJCQkJCXBhdGggPSBnZXRQYXRoKEZpbGUpDQoJCQkJCQlpZiBwYXRoOg0KCQkJCQkJCWdsb2JhbCBtb2RlbElEDQoJCQkJCQkJZmlsZSA9IG9wZW4ocGF0aCwgInJiIikNCgkJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJYnl0ZXMgPSByZWFkRmxvYXRzKGcsIE9mZnNldCwgU2l6ZSwgSXRlbVNpemUpDQoJCQkJCQkJd2l0aCBvcGVuKCIuL3t0ZW1wUGF0aH0vdmVydGV4Tm9ybWFsRGF0YS8iICsgc3RyKG1vZGVsSUQpICsgIi5kYXQiLCAiYSIpIGFzIG1vZGVsRGF0YToNCgkJCQkJCQkJbW9kZWxJRCArPSAxDQoJCQkJCQkJCWZvciBsaW5lIGluIGJ5dGVzOg0KCQkJCQkJCQkJbW9kZWxEYXRhLndyaXRlKHN0cihsaW5lKSArICJcbiIpDQoJCQkJCQkJbm9ybWFsQXJyYXkuYXBwZW5kKFtieXRlcywgRW5jb2RpbmcsIEl0ZW1TaXplXSkNCgkJCQkJCQlmaWxlLmNsb3NlKCkNCglleGNlcHQ6DQoJCXBhc3MNCg0KCXRyeToNCgkJVGFuZ2VudCA9IHlzLmdldChWZXJ0ZXhBdHRyaWJ1dGVMaXN0WzBdLCAnIlRhbmdlbnQiJykNCgkJbW9kZSA9ICJUYW5nZW50Ig0KCQlmb3IgYiBpbiBUYW5nZW50Og0KCQkJU2l6ZSA9IE5vbmUNCgkJCU9mZnNldCA9IE5vbmUNCgkJCUVuY29kaW5nID0gTm9uZQ0KCQkJSXRlbVNpemUgPSBOb25lDQoJCQl0eXBlID0gTm9uZQ0KCQkJdmFsdWVzID0geXMudmFsdWVzKGIuZGF0YSwgIjoiKQ0KCQkJaWYgJyJJdGVtU2l6ZSInIGluIHZhbHVlczoNCgkJCQlJdGVtU2l6ZSA9IGludCh2YWx1ZXNbJyJJdGVtU2l6ZSInXSkNCgkJCQlVaW50MzJBcnJheSA9IHlzLmdldChiLCAnIlVpbnQzMkFycmF5IicpDQoJCQkJaWYgVWludDMyQXJyYXk6DQoJCQkJCXR5cGUgPSAiVWludDMyQXJyYXkiDQoJCQkJCXByaW50IG1vZGUsIHR5cGUNCgkJCQkJdmFsdWVzID0geXMudmFsdWVzKFVpbnQzMkFycmF5WzBdLmRhdGEsICI6IikNCgkJCQkJU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICJpIikNCgkJCQkJT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAiaSIpDQoJCQkJCUZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInLCAnIiInKQ0KCQkJCQlFbmNvZGluZyA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJFbmNvZGluZyInKQ0KCQkJCQlwcmludCBbJ1RhbmdlbnQ6JywnTW9kZTonLG1vZGUsJ1R5cGU6Jyx0eXBlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nXQ0KCQkJCQlpZiBFbmNvZGluZyA9PSAnInZhcmludCInOg0KCQkJCQkJcGF0aCA9IGdldFBhdGgoRmlsZSkNCgkJCQkJCWlmIHBhdGg6DQoJCQkJCQkJZmlsZSA9IG9wZW4ocGF0aCwgInJiIikNCgkJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJYnl0ZXMgPSBkZWNvZGVWYXJpbnQoZywgT2Zmc2V0LCBTaXplICogSXRlbVNpemUsIHR5cGUpDQoJCQkJCQkJdGFuZ2VudEFycmF5LmFwcGVuZChbYnl0ZXMsIEVuY29kaW5nLCBJdGVtU2l6ZV0pDQoJCQkJCQkJZmlsZS5jbG9zZSgpDQoNCgkJCQknJydGbG9hdDMyQXJyYXkgPSB5cy5nZXQoYiwgJyJGbG9hdDMyQXJyYXkiJykNCgkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCXR5cGUgPSAiRmxvYXQzMkFycmF5Ig0KCQkJCQlwcmludCBtb2RlLCB0eXBlDQoJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQlTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgImkiKQ0KCQkJCQlPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicsICJpIikNCgkJCQkJRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicsICciIicpDQoJCQkJCUVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicpDQoJCQkJCXByaW50IFsnVmVydGV4OicsJ01vZGU6Jyxtb2RlLCdUeXBlOicsdHlwZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZ10NCgkJCQkJaWYgRW5jb2RpbmcgIT0gJyJ2YXJpbnQiJzoNCgkJCQkJCXBhdGggPSBnZXRQYXRoKEZpbGUpDQoJCQkJCQlpZiBwYXRoOg0KCQkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQkJZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCWcuc2VlayhPZmZzZXQpDQoJCQkJCQkJYnl0ZXMgPSBnLmYoU2l6ZSAqIEl0ZW1TaXplKQ0KCQkJCQkJCWxpc3QgPSBbXQ0KCQkJCQkJCWZvciBtIGluIHJhbmdlKFNpemUpOg0KCQkJCQkJCQlsaXN0LmFwcGVuZChieXRlc1ttICogSXRlbVNpemUgOiBtICogSXRlbVNpemUgKyBJdGVtU2l6ZV0pDQoJCQkJCQkJdmVydGV4QXJyYXkuYXBwZW5kKFtsaXN0LCBFbmNvZGluZ10pDQoJCQkJCQkJZmlsZS5jbG9zZSgpJycnDQoJZXhjZXB0Og0KCQlwYXNzDQoNCglWZXJ0ZXggPSB5cy5nZXQoVmVydGV4QXR0cmlidXRlTGlzdFswXSwgJyJWZXJ0ZXgiJykNCgltb2RlID0gIlZlcnRleCINCglmb3IgYiBpbiBWZXJ0ZXg6DQoJCVNpemUgPSBOb25lDQoJCU9mZnNldCA9IE5vbmUNCgkJRW5jb2RpbmcgPSBOb25lDQoJCUl0ZW1TaXplID0gTm9uZQ0KCQl0eXBlID0gTm9uZQ0KCQl2YWx1ZXMgPSB5cy52YWx1ZXMoYi5kYXRhLCAiOiIpDQoJCWlmICciSXRlbVNpemUiJyBpbiB2YWx1ZXM6DQoJCQlJdGVtU2l6ZSA9IGludCh2YWx1ZXNbJyJJdGVtU2l6ZSInXSkNCgkJCUludDMyQXJyYXkgPSB5cy5nZXQoYiwgJyJJbnQzMkFycmF5IicpDQoJCQlpZiBJbnQzMkFycmF5Og0KCQkJCXR5cGUgPSAiSW50MzJBcnJheSINCgkJCQlwcmludCBtb2RlLCB0eXBlDQoJCQkJdmFsdWVzID0geXMudmFsdWVzKEludDMyQXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAiaSIpDQoJCQkJT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAiaSIpDQoJCQkJRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicsICciIicpDQoJCQkJRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJykNCgkJCQlwcmludCBbJ1ZlcnRleDonLCdNb2RlOicsbW9kZSwnVHlwZTonLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmddDQoJCQkJaWYgRW5jb2RpbmcgPT0gJyJ2YXJpbnQiJzoNCgkJCQkJcGF0aCA9IGdldFBhdGgoRmlsZSkNCgkJCQkJaWYgcGF0aDoNCgkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQlieXRlcyA9IGRlY29kZVZhcmludChnLCBPZmZzZXQsIFNpemUgKiBJdGVtU2l6ZSwgdHlwZSkNCgkJCQkJCXZlcnRleEFycmF5LmFwcGVuZChbYnl0ZXMsIEVuY29kaW5nLCBJdGVtU2l6ZV0pDQoJCQkJCQlmaWxlLmNsb3NlKCkNCg0KCQkJRmxvYXQzMkFycmF5ID0geXMuZ2V0KGIsICciRmxvYXQzMkFycmF5IicpDQoJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJdHlwZSA9ICJGbG9hdDMyQXJyYXkiDQoJCQkJcHJpbnQgbW9kZSwgdHlwZQ0KCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAiaSIpDQoJCQkJT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAiaSIpDQoJCQkJRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicsICciIicpDQoJCQkJRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJykNCgkJCQlwcmludCBbJ1ZlcnRleDonLCdNb2RlOicsbW9kZSwnVHlwZTonLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmddDQoJCQkJaWYgRW5jb2RpbmcgIT0gJyJ2YXJpbnQiJzoNCgkJCQkJcGF0aCA9IGdldFBhdGgoRmlsZSkNCgkJCQkJaWYgcGF0aDoNCgkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQlnLnNlZWsoT2Zmc2V0KQ0KCQkJCQkJYnl0ZXMgPSBnLmYoU2l6ZSAqIEl0ZW1TaXplKQ0KCQkJCQkJbGlzdCA9IFtdDQoJCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCQlsaXN0LmFwcGVuZChieXRlc1ttICogSXRlbVNpemUgOiBtICogSXRlbVNpemUgKyBJdGVtU2l6ZV0pDQoJCQkJCQl2ZXJ0ZXhBcnJheS5hcHBlbmQoW2xpc3QsIEVuY29kaW5nXSkNCgkJCQkJCWZpbGUuY2xvc2UoKQ0KDQoJVGV4Q29vcmQwID0geXMuZ2V0KFZlcnRleEF0dHJpYnV0ZUxpc3RbMF0sICciVGV4Q29vcmQwIicpDQoJaWYgVGV4Q29vcmQwOg0KCQltb2RlID0gIlRleENvb3JkMCINCgkJZm9yIGIgaW4gVGV4Q29vcmQwOg0KCQkJU2l6ZSA9IE5vbmUNCgkJCU9mZnNldCA9IE5vbmUNCgkJCUVuY29kaW5nID0gTm9uZQ0KCQkJSXRlbVNpemUgPSBOb25lDQoJCQl0eXBlID0gTm9uZQ0KCQkJdmFsdWVzID0geXMudmFsdWVzKGIuZGF0YSwgIjoiKQ0KCQkJaWYgJyJJdGVtU2l6ZSInIGluIHZhbHVlczoNCgkJCQlJdGVtU2l6ZSA9IGludCh2YWx1ZXNbJyJJdGVtU2l6ZSInXSkNCgkJCQlJbnQzMkFycmF5ID0geXMuZ2V0KGIsICciSW50MzJBcnJheSInKQ0KCQkJCWlmIEludDMyQXJyYXk6DQoJCQkJCXR5cGUgPSAiSW50MzJBcnJheSINCgkJCQkJcHJpbnQgbW9kZSwgdHlwZQ0KCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoSW50MzJBcnJheVswXS5kYXRhLCAiOiIpDQoJCQkJCVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAiaSIpDQoJCQkJCU9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgImkiKQ0KCQkJCQlGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCgkJCQkJRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJykNCgkJCQkJcHJpbnQgWydUZXhDb29yZDA6JywnTW9kZTonLG1vZGUsJ1R5cGU6Jyx0eXBlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nXQ0KCQkJCQlpZiBFbmNvZGluZyA9PSAnInZhcmludCInOg0KCQkJCQkJcGF0aCA9IGdldFBhdGgoRmlsZSkNCgkJCQkJCWlmIHBhdGg6DQoJCQkJCQkJZmlsZSA9IG9wZW4ocGF0aCwgInJiIikNCgkJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJYnl0ZXMgPSBkZWNvZGVWYXJpbnQoZywgT2Zmc2V0LCBTaXplICogSXRlbVNpemUsIHR5cGUpDQoJCQkJCQkJdGV4QXJyYXkwLmFwcGVuZChbYnl0ZXMsIEVuY29kaW5nLCBJdGVtU2l6ZV0pDQoJCQkJCQkJdGV4QXJyYXkwLmFwcGVuZChbYnl0ZXMsIEVuY29kaW5nLCBJdGVtU2l6ZV0pDQoJCQkJCQkJZmlsZS5jbG9zZSgpDQoNCgkJCQlGbG9hdDMyQXJyYXkgPSB5cy5nZXQoYiwgJyJGbG9hdDMyQXJyYXkiJykNCgkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCXR5cGUgPSAiRmxvYXQzMkFycmF5Ig0KCQkJCQlwcmludCBtb2RlLCB0eXBlDQoJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQlTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgImkiKQ0KCQkJCQlPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicsICJpIikNCgkJCQkJRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicsICciIicpDQoJCQkJCUVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicpDQoJCQkJCSMgd3JpdGUobG9nLFsnVGV4Q29vcmQwOicsJ21vZGU6Jyxtb2RlLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmddLG4pDQoJCQkJCWlmIEVuY29kaW5nICE9ICcidmFyaW50Iic6DQoJCQkJCQlwYXRoID0gZ2V0UGF0aChGaWxlKQ0KCQkJCQkJaWYgcGF0aDoNCgkJCQkJCQlmaWxlID0gb3BlbihwYXRoLCAicmIiKQ0KCQkJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQlnLnNlZWsoT2Zmc2V0KQ0KCQkJCQkJCWJ5dGVzID0gZy5mKFNpemUgKiBJdGVtU2l6ZSkNCgkJCQkJCQlsaXN0ID0gW10NCgkJCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCQkJdSwgdiA9IGJ5dGVzW20gKiBJdGVtU2l6ZSA6IG0gKiBJdGVtU2l6ZSArIEl0ZW1TaXplXQ0KCQkJCQkJCQlsaXN0LmFwcGVuZChbdSwgMSAtIHZdKQ0KCQkJCQkJCXRleEFycmF5MC5hcHBlbmQoW2xpc3QsIEVuY29kaW5nXSkNCgkJCQkJCQlmaWxlLmNsb3NlKCkNCg0KCVRleENvb3JkMSA9IHlzLmdldChWZXJ0ZXhBdHRyaWJ1dGVMaXN0WzBdLCAnIlRleENvb3JkMSInKQ0KCWlmIFRleENvb3JkMToNCgkJbW9kZSA9ICJUZXhDb29yZDEiDQoJCWZvciBiIGluIFRleENvb3JkMToNCgkJCVNpemUgPSBOb25lDQoJCQlPZmZzZXQgPSBOb25lDQoJCQlFbmNvZGluZyA9IE5vbmUNCgkJCUl0ZW1TaXplID0gTm9uZQ0KCQkJdHlwZSA9IE5vbmUNCgkJCXZhbHVlcyA9IHlzLnZhbHVlcyhiLmRhdGEsICI6IikNCgkJCWlmICciSXRlbVNpemUiJyBpbiB2YWx1ZXM6DQoJCQkJSXRlbVNpemUgPSBpbnQodmFsdWVzWyciSXRlbVNpemUiJ10pDQoJCQkJSW50MzJBcnJheSA9IHlzLmdldChiLCAnIkludDMyQXJyYXkiJykNCgkJCQlpZiBJbnQzMkFycmF5Og0KCQkJCQl0eXBlID0gIkludDMyQXJyYXkiDQoJCQkJCXByaW50IG1vZGUsIHR5cGUNCgkJCQkJdmFsdWVzID0geXMudmFsdWVzKEludDMyQXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQlTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgImkiKQ0KCQkJCQlPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicsICJpIikNCgkJCQkJRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicsICciIicpDQoJCQkJCUVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicpDQoJCQkJCXByaW50IFsnVGV4Q29vcmQxOicsJ01vZGU6Jyxtb2RlLCdUeXBlOicsdHlwZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZ10NCgkJCQkJaWYgRW5jb2RpbmcgPT0gJyJ2YXJpbnQiJzoNCgkJCQkJCXBhdGggPSBnZXRQYXRoKEZpbGUpDQoJCQkJCQlpZiBwYXRoOg0KCQkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQkJZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCWJ5dGVzID0gZGVjb2RlVmFyaW50KGcsIE9mZnNldCwgU2l6ZSAqIEl0ZW1TaXplLCB0eXBlKQ0KCQkJCQkJCXRleEFycmF5MS5hcHBlbmQoW2J5dGVzLCBFbmNvZGluZywgSXRlbVNpemVdKQ0KCQkJCQkJCWZpbGUuY2xvc2UoKQ0KDQoJCQkJRmxvYXQzMkFycmF5ID0geXMuZ2V0KGIsICciRmxvYXQzMkFycmF5IicpDQoJCQkJaWYgRmxvYXQzMkFycmF5Og0KCQkJCQl0eXBlID0gIkZsb2F0MzJBcnJheSINCgkJCQkJcHJpbnQgbW9kZSwgdHlwZQ0KCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsICI6IikNCgkJCQkJU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICJpIikNCgkJCQkJT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAiaSIpDQoJCQkJCUZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInLCAnIiInKQ0KCQkJCQlFbmNvZGluZyA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJFbmNvZGluZyInKQ0KCQkJCQkjIHdyaXRlKGxvZyxbJ1RleENvb3JkMTonLCdtb2RlOicsbW9kZSx0eXBlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nXSxuKQ0KCQkJCQlpZiBFbmNvZGluZyAhPSAnInZhcmludCInOg0KCQkJCQkJcGF0aCA9IGdldFBhdGgoRmlsZSkNCgkJCQkJCWlmIHBhdGg6DQoJCQkJCQkJZmlsZSA9IG9wZW4ocGF0aCwgInJiIikNCgkJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJZy5zZWVrKE9mZnNldCkNCgkJCQkJCQlieXRlcyA9IGcuZihTaXplICogSXRlbVNpemUpDQoJCQkJCQkJbGlzdCA9IFtdDQoJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQoJCQkJCQkJCXUsIHYgPSBieXRlc1ttICogSXRlbVNpemUgOiBtICogSXRlbVNpemUgKyBJdGVtU2l6ZV0NCgkJCQkJCQkJbGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQkJCQl0ZXhBcnJheTEuYXBwZW5kKFtsaXN0LCBFbmNvZGluZ10pDQoJCQkJCQkJZmlsZS5jbG9zZSgpDQoNCglUZXhDb29yZDIgPSB5cy5nZXQoVmVydGV4QXR0cmlidXRlTGlzdFswXSwgJyJUZXhDb29yZDIiJykNCglpZiBUZXhDb29yZDI6DQoJCW1vZGUgPSAiVGV4Q29vcmQyIg0KCQlmb3IgYiBpbiBUZXhDb29yZDI6DQoJCQlTaXplID0gTm9uZQ0KCQkJT2Zmc2V0ID0gTm9uZQ0KCQkJRW5jb2RpbmcgPSBOb25lDQoJCQlJdGVtU2l6ZSA9IE5vbmUNCgkJCXR5cGUgPSBOb25lDQoJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoYi5kYXRhLCAiOiIpDQoJCQlpZiAnIkl0ZW1TaXplIicgaW4gdmFsdWVzOg0KCQkJCUl0ZW1TaXplID0gaW50KHZhbHVlc1snIkl0ZW1TaXplIiddKQ0KCQkJCUludDMyQXJyYXkgPSB5cy5nZXQoYiwgJyJJbnQzMkFycmF5IicpDQoJCQkJaWYgSW50MzJBcnJheToNCgkJCQkJdHlwZSA9ICJJbnQzMkFycmF5Ig0KCQkJCQlwcmludCBtb2RlLCB0eXBlDQoJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhJbnQzMkFycmF5WzBdLmRhdGEsICI6IikNCgkJCQkJU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICJpIikNCgkJCQkJT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAiaSIpDQoJCQkJCUZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInLCAnIiInKQ0KCQkJCQlFbmNvZGluZyA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJFbmNvZGluZyInKQ0KCQkJCQlwcmludCBbJ1RleENvb3JkMjonLCdNb2RlOicsbW9kZSwnVHlwZTonLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmddDQoJCQkJCWlmIEVuY29kaW5nID09ICcidmFyaW50Iic6DQoJCQkJCQlwYXRoID0gZ2V0UGF0aChGaWxlKQ0KCQkJCQkJaWYgcGF0aDoNCgkJCQkJCQlmaWxlID0gb3BlbihwYXRoLCAicmIiKQ0KCQkJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQlieXRlcyA9IGRlY29kZVZhcmludChnLCBPZmZzZXQsIFNpemUgKiBJdGVtU2l6ZSwgdHlwZSkNCgkJCQkJCQl0ZXhBcnJheTIuYXBwZW5kKFtieXRlcywgRW5jb2RpbmcsIEl0ZW1TaXplXSkNCgkJCQkJCQlmaWxlLmNsb3NlKCkNCg0KCQkJCUZsb2F0MzJBcnJheSA9IHlzLmdldChiLCAnIkZsb2F0MzJBcnJheSInKQ0KCQkJCWlmIEZsb2F0MzJBcnJheToNCgkJCQkJdHlwZSA9ICJGbG9hdDMyQXJyYXkiDQoJCQkJCXByaW50IG1vZGUsIHR5cGUNCgkJCQkJdmFsdWVzID0geXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCAiOiIpDQoJCQkJCVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAiaSIpDQoJCQkJCU9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgImkiKQ0KCQkJCQlGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCgkJCQkJRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJykNCgkJCQkJIyB3cml0ZShsb2csWydUZXhDb29yZDI6JywnbW9kZTonLG1vZGUsdHlwZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZ10sbikNCgkJCQkJaWYgRW5jb2RpbmcgIT0gJyJ2YXJpbnQiJzoNCgkJCQkJCXBhdGggPSBnZXRQYXRoKEZpbGUpDQoJCQkJCQlpZiBwYXRoOg0KCQkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQkJZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCWcuc2VlayhPZmZzZXQpDQoJCQkJCQkJYnl0ZXMgPSBnLmYoU2l6ZSAqIEl0ZW1TaXplKQ0KCQkJCQkJCWxpc3QgPSBbXQ0KCQkJCQkJCWZvciBtIGluIHJhbmdlKFNpemUpOg0KCQkJCQkJCQl1LCB2ID0gYnl0ZXNbbSAqIEl0ZW1TaXplIDogbSAqIEl0ZW1TaXplICsgSXRlbVNpemVdDQoJCQkJCQkJCWxpc3QuYXBwZW5kKFt1LCAxIC0gdl0pDQoJCQkJCQkJdGV4QXJyYXkyLmFwcGVuZChbbGlzdCwgRW5jb2RpbmddKQ0KCQkJCQkJCWZpbGUuY2xvc2UoKQ0KDQoJVGV4Q29vcmQzID0geXMuZ2V0KFZlcnRleEF0dHJpYnV0ZUxpc3RbMF0sICciVGV4Q29vcmQzIicpDQoJaWYgVGV4Q29vcmQzOg0KCQltb2RlID0gIlRleENvb3JkMyINCgkJZm9yIGIgaW4gVGV4Q29vcmQzOg0KCQkJU2l6ZSA9IE5vbmUNCgkJCU9mZnNldCA9IE5vbmUNCgkJCUVuY29kaW5nID0gTm9uZQ0KCQkJSXRlbVNpemUgPSBOb25lDQoJCQl0eXBlID0gTm9uZQ0KCQkJdmFsdWVzID0geXMudmFsdWVzKGIuZGF0YSwgIjoiKQ0KCQkJaWYgJyJJdGVtU2l6ZSInIGluIHZhbHVlczoNCgkJCQlJdGVtU2l6ZSA9IGludCh2YWx1ZXNbJyJJdGVtU2l6ZSInXSkNCgkJCQlJbnQzMkFycmF5ID0geXMuZ2V0KGIsICciSW50MzJBcnJheSInKQ0KCQkJCWlmIEludDMyQXJyYXk6DQoJCQkJCXR5cGUgPSAiSW50MzJBcnJheSINCgkJCQkJcHJpbnQgbW9kZSwgdHlwZQ0KCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoSW50MzJBcnJheVswXS5kYXRhLCAiOiIpDQoJCQkJCVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAiaSIpDQoJCQkJCU9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgImkiKQ0KCQkJCQlGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCgkJCQkJRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJykNCgkJCQkJcHJpbnQgWydUZXhDb29yZDM6JywnTW9kZTonLG1vZGUsJ1R5cGU6Jyx0eXBlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nXQ0KCQkJCQlpZiBFbmNvZGluZyA9PSAnInZhcmludCInOg0KCQkJCQkJcGF0aCA9IGdldFBhdGgoRmlsZSkNCgkJCQkJCWlmIHBhdGg6DQoJCQkJCQkJZmlsZSA9IG9wZW4ocGF0aCwgInJiIikNCgkJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJYnl0ZXMgPSBkZWNvZGVWYXJpbnQoZywgT2Zmc2V0LCBTaXplICogSXRlbVNpemUsIHR5cGUpDQoJCQkJCQkJdGV4QXJyYXkzLmFwcGVuZChbYnl0ZXMsIEVuY29kaW5nLCBJdGVtU2l6ZV0pDQoJCQkJCQkJZmlsZS5jbG9zZSgpDQoNCgkJCQlGbG9hdDMyQXJyYXkgPSB5cy5nZXQoYiwgJyJGbG9hdDMyQXJyYXkiJykNCgkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCXR5cGUgPSAiRmxvYXQzMkFycmF5Ig0KCQkJCQlwcmludCBtb2RlLCB0eXBlDQoJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQlTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgImkiKQ0KCQkJCQlPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicsICJpIikNCgkJCQkJRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicsICciIicpDQoJCQkJCUVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicpDQoJCQkJCSMgd3JpdGUobG9nLFsnVGV4Q29vcmQzOicsJ21vZGU6Jyxtb2RlLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmddLG4pDQoJCQkJCWlmIEVuY29kaW5nICE9ICcidmFyaW50Iic6DQoJCQkJCQlwYXRoID0gZ2V0UGF0aChGaWxlKQ0KCQkJCQkJaWYgcGF0aDoNCgkJCQkJCQlmaWxlID0gb3BlbihwYXRoLCAicmIiKQ0KCQkJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQlnLnNlZWsoT2Zmc2V0KQ0KCQkJCQkJCWJ5dGVzID0gZy5mKFNpemUgKiBJdGVtU2l6ZSkNCgkJCQkJCQlsaXN0ID0gW10NCgkJCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCQkJdSwgdiA9IGJ5dGVzW20gKiBJdGVtU2l6ZSA6IG0gKiBJdGVtU2l6ZSArIEl0ZW1TaXplXQ0KCQkJCQkJCQlsaXN0LmFwcGVuZChbdSwgMSAtIHZdKQ0KCQkJCQkJCXRleEFycmF5My5hcHBlbmQoW2xpc3QsIEVuY29kaW5nXSkNCgkJCQkJCQlmaWxlLmNsb3NlKCkNCg0KCVRleENvb3JkNCA9IHlzLmdldChWZXJ0ZXhBdHRyaWJ1dGVMaXN0WzBdLCAnIlRleENvb3JkNCInKQ0KCWlmIFRleENvb3JkNDoNCgkJbW9kZSA9ICJUZXhDb29yZDQiDQoJCWZvciBiIGluIFRleENvb3JkNDoNCgkJCVNpemUgPSBOb25lDQoJCQlPZmZzZXQgPSBOb25lDQoJCQlFbmNvZGluZyA9IE5vbmUNCgkJCUl0ZW1TaXplID0gTm9uZQ0KCQkJdHlwZSA9IE5vbmUNCgkJCXZhbHVlcyA9IHlzLnZhbHVlcyhiLmRhdGEsICI6IikNCgkJCWlmICciSXRlbVNpemUiJyBpbiB2YWx1ZXM6DQoJCQkJSXRlbVNpemUgPSBpbnQodmFsdWVzWyciSXRlbVNpemUiJ10pDQoJCQkJSW50MzJBcnJheSA9IHlzLmdldChiLCAnIkludDMyQXJyYXkiJykNCgkJCQlpZiBJbnQzMkFycmF5Og0KCQkJCQl0eXBlID0gIkludDMyQXJyYXkiDQoJCQkJCXByaW50IG1vZGUsIHR5cGUNCgkJCQkJdmFsdWVzID0geXMudmFsdWVzKEludDMyQXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQlTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgImkiKQ0KCQkJCQlPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicsICJpIikNCgkJCQkJRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicsICciIicpDQoJCQkJCUVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicpDQoJCQkJCXByaW50IFsnVGV4Q29vcmQ0OicsJ01vZGU6Jyxtb2RlLCdUeXBlOicsdHlwZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZ10NCgkJCQkJaWYgRW5jb2RpbmcgPT0gJyJ2YXJpbnQiJzoNCgkJCQkJCXBhdGggPSBnZXRQYXRoKEZpbGUpDQoJCQkJCQlpZiBwYXRoOg0KCQkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQkJZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCWJ5dGVzID0gZGVjb2RlVmFyaW50KGcsIE9mZnNldCwgU2l6ZSAqIEl0ZW1TaXplLCB0eXBlKQ0KCQkJCQkJCXRleEFycmF5NC5hcHBlbmQoW2J5dGVzLCBFbmNvZGluZywgSXRlbVNpemVdKQ0KCQkJCQkJCWZpbGUuY2xvc2UoKQ0KDQoJCQkJRmxvYXQzMkFycmF5ID0geXMuZ2V0KGIsICciRmxvYXQzMkFycmF5IicpDQoJCQkJaWYgRmxvYXQzMkFycmF5Og0KCQkJCQl0eXBlID0gIkZsb2F0MzJBcnJheSINCgkJCQkJcHJpbnQgbW9kZSwgdHlwZQ0KCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsICI6IikNCgkJCQkJU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICJpIikNCgkJCQkJT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAiaSIpDQoJCQkJCUZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInLCAnIiInKQ0KCQkJCQlFbmNvZGluZyA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJFbmNvZGluZyInKQ0KCQkJCQkjIHdyaXRlKGxvZyxbJ1RleENvb3JkNDonLCdtb2RlOicsbW9kZSx0eXBlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nXSxuKQ0KCQkJCQlpZiBFbmNvZGluZyAhPSAnInZhcmludCInOg0KCQkJCQkJcGF0aCA9IGdldFBhdGgoRmlsZSkNCgkJCQkJCWlmIHBhdGg6DQoJCQkJCQkJZmlsZSA9IG9wZW4ocGF0aCwgInJiIikNCgkJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJZy5zZWVrKE9mZnNldCkNCgkJCQkJCQlieXRlcyA9IGcuZihTaXplICogSXRlbVNpemUpDQoJCQkJCQkJbGlzdCA9IFtdDQoJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQoJCQkJCQkJCXUsIHYgPSBieXRlc1ttICogSXRlbVNpemUgOiBtICogSXRlbVNpemUgKyBJdGVtU2l6ZV0NCgkJCQkJCQkJbGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQkJCQl0ZXhBcnJheTQuYXBwZW5kKFtsaXN0LCBFbmNvZGluZ10pDQoJCQkJCQkJZmlsZS5jbG9zZSgpDQoNCglUZXhDb29yZDUgPSB5cy5nZXQoVmVydGV4QXR0cmlidXRlTGlzdFswXSwgJyJUZXhDb29yZDUiJykNCglpZiBUZXhDb29yZDU6DQoJCW1vZGUgPSAiVGV4Q29vcmQ1Ig0KCQlmb3IgYiBpbiBUZXhDb29yZDU6DQoJCQlTaXplID0gTm9uZQ0KCQkJT2Zmc2V0ID0gTm9uZQ0KCQkJRW5jb2RpbmcgPSBOb25lDQoJCQlJdGVtU2l6ZSA9IE5vbmUNCgkJCXR5cGUgPSBOb25lDQoJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoYi5kYXRhLCAiOiIpDQoJCQlpZiAnIkl0ZW1TaXplIicgaW4gdmFsdWVzOg0KCQkJCUl0ZW1TaXplID0gaW50KHZhbHVlc1snIkl0ZW1TaXplIiddKQ0KCQkJCUludDMyQXJyYXkgPSB5cy5nZXQoYiwgJyJJbnQzMkFycmF5IicpDQoJCQkJaWYgSW50MzJBcnJheToNCgkJCQkJdHlwZSA9ICJJbnQzMkFycmF5Ig0KCQkJCQlwcmludCBtb2RlLCB0eXBlDQoJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhJbnQzMkFycmF5WzBdLmRhdGEsICI6IikNCgkJCQkJU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICJpIikNCgkJCQkJT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAiaSIpDQoJCQkJCUZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInLCAnIiInKQ0KCQkJCQlFbmNvZGluZyA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJFbmNvZGluZyInKQ0KCQkJCQlwcmludCBbJ1RleENvb3JkNTonLCdNb2RlOicsbW9kZSwnVHlwZTonLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmddDQoJCQkJCWlmIEVuY29kaW5nID09ICcidmFyaW50Iic6DQoJCQkJCQlwYXRoID0gZ2V0UGF0aChGaWxlKQ0KCQkJCQkJaWYgcGF0aDoNCgkJCQkJCQlmaWxlID0gb3BlbihwYXRoLCAicmIiKQ0KCQkJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQlieXRlcyA9IGRlY29kZVZhcmludChnLCBPZmZzZXQsIFNpemUgKiBJdGVtU2l6ZSwgdHlwZSkNCgkJCQkJCQl0ZXhBcnJheTUuYXBwZW5kKFtieXRlcywgRW5jb2RpbmcsIEl0ZW1TaXplXSkNCgkJCQkJCQlmaWxlLmNsb3NlKCkNCg0KCQkJCUZsb2F0MzJBcnJheSA9IHlzLmdldChiLCAnIkZsb2F0MzJBcnJheSInKQ0KCQkJCWlmIEZsb2F0MzJBcnJheToNCgkJCQkJdHlwZSA9ICJGbG9hdDMyQXJyYXkiDQoJCQkJCXByaW50IG1vZGUsIHR5cGUNCgkJCQkJdmFsdWVzID0geXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCAiOiIpDQoJCQkJCVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAiaSIpDQoJCQkJCU9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgImkiKQ0KCQkJCQlGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCgkJCQkJRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJykNCgkJCQkJIyB3cml0ZShsb2csWydUZXhDb29yZDU6JywnbW9kZTonLG1vZGUsdHlwZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZ10sbikNCgkJCQkJaWYgRW5jb2RpbmcgIT0gJyJ2YXJpbnQiJzoNCgkJCQkJCXBhdGggPSBnZXRQYXRoKEZpbGUpDQoJCQkJCQlpZiBwYXRoOg0KCQkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQkJZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCWcuc2VlayhPZmZzZXQpDQoJCQkJCQkJYnl0ZXMgPSBnLmYoU2l6ZSAqIEl0ZW1TaXplKQ0KCQkJCQkJCWxpc3QgPSBbXQ0KCQkJCQkJCWZvciBtIGluIHJhbmdlKFNpemUpOg0KCQkJCQkJCQl1LCB2ID0gYnl0ZXNbbSAqIEl0ZW1TaXplIDogbSAqIEl0ZW1TaXplICsgSXRlbVNpemVdDQoJCQkJCQkJCWxpc3QuYXBwZW5kKFt1LCAxIC0gdl0pDQoJCQkJCQkJdGV4QXJyYXk1LmFwcGVuZChbbGlzdCwgRW5jb2RpbmddKQ0KCQkJCQkJCWZpbGUuY2xvc2UoKQ0KDQoJVGV4Q29vcmQ2ID0geXMuZ2V0KFZlcnRleEF0dHJpYnV0ZUxpc3RbMF0sICciVGV4Q29vcmQ2IicpDQoJaWYgVGV4Q29vcmQ2Og0KCQltb2RlID0gIlRleENvb3JkNiINCgkJZm9yIGIgaW4gVGV4Q29vcmQ2Og0KCQkJU2l6ZSA9IE5vbmUNCgkJCU9mZnNldCA9IE5vbmUNCgkJCUVuY29kaW5nID0gTm9uZQ0KCQkJSXRlbVNpemUgPSBOb25lDQoJCQl0eXBlID0gTm9uZQ0KCQkJdmFsdWVzID0geXMudmFsdWVzKGIuZGF0YSwgIjoiKQ0KCQkJaWYgJyJJdGVtU2l6ZSInIGluIHZhbHVlczoNCgkJCQlJdGVtU2l6ZSA9IGludCh2YWx1ZXNbJyJJdGVtU2l6ZSInXSkNCgkJCQlJbnQzMkFycmF5ID0geXMuZ2V0KGIsICciSW50MzJBcnJheSInKQ0KCQkJCWlmIEludDMyQXJyYXk6DQoJCQkJCXR5cGUgPSAiSW50MzJBcnJheSINCgkJCQkJcHJpbnQgbW9kZSwgdHlwZQ0KCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoSW50MzJBcnJheVswXS5kYXRhLCAiOiIpDQoJCQkJCVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAiaSIpDQoJCQkJCU9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgImkiKQ0KCQkJCQlGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCgkJCQkJRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJykNCgkJCQkJcHJpbnQgWydUZXhDb29yZDY6JywnTW9kZTonLG1vZGUsJ1R5cGU6Jyx0eXBlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nXQ0KCQkJCQlpZiBFbmNvZGluZyA9PSAnInZhcmludCInOg0KCQkJCQkJcGF0aCA9IGdldFBhdGgoRmlsZSkNCgkJCQkJCWlmIHBhdGg6DQoJCQkJCQkJZmlsZSA9IG9wZW4ocGF0aCwgInJiIikNCgkJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJYnl0ZXMgPSBkZWNvZGVWYXJpbnQoZywgT2Zmc2V0LCBTaXplICogSXRlbVNpemUsIHR5cGUpDQoJCQkJCQkJdGV4QXJyYXk2LmFwcGVuZChbYnl0ZXMsIEVuY29kaW5nLCBJdGVtU2l6ZV0pDQoJCQkJCQkJZmlsZS5jbG9zZSgpDQoNCgkJCQlGbG9hdDMyQXJyYXkgPSB5cy5nZXQoYiwgJyJGbG9hdDMyQXJyYXkiJykNCgkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCXR5cGUgPSAiRmxvYXQzMkFycmF5Ig0KCQkJCQlwcmludCBtb2RlLCB0eXBlDQoJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQlTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgImkiKQ0KCQkJCQlPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicsICJpIikNCgkJCQkJRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicsICciIicpDQoJCQkJCUVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicpDQoJCQkJCSMgd3JpdGUobG9nLFsnVGV4Q29vcmQ2OicsJ21vZGU6Jyxtb2RlLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmddLG4pDQoJCQkJCWlmIEVuY29kaW5nICE9ICcidmFyaW50Iic6DQoJCQkJCQlwYXRoID0gZ2V0UGF0aChGaWxlKQ0KCQkJCQkJaWYgcGF0aDoNCgkJCQkJCQlmaWxlID0gb3BlbihwYXRoLCAicmIiKQ0KCQkJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQlnLnNlZWsoT2Zmc2V0KQ0KCQkJCQkJCWJ5dGVzID0gZy5mKFNpemUgKiBJdGVtU2l6ZSkNCgkJCQkJCQlsaXN0ID0gW10NCgkJCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCQkJdSwgdiA9IGJ5dGVzW20gKiBJdGVtU2l6ZSA6IG0gKiBJdGVtU2l6ZSArIEl0ZW1TaXplXQ0KCQkJCQkJCQlsaXN0LmFwcGVuZChbdSwgMSAtIHZdKQ0KCQkJCQkJCXRleEFycmF5Ni5hcHBlbmQoW2xpc3QsIEVuY29kaW5nXSkNCgkJCQkJCQlmaWxlLmNsb3NlKCkNCg0KCVRleENvb3JkNyA9IHlzLmdldChWZXJ0ZXhBdHRyaWJ1dGVMaXN0WzBdLCAnIlRleENvb3JkNyInKQ0KCWlmIFRleENvb3JkNzoNCgkJbW9kZSA9ICJUZXhDb29yZDciDQoJCWZvciBiIGluIFRleENvb3JkNzoNCgkJCVNpemUgPSBOb25lDQoJCQlPZmZzZXQgPSBOb25lDQoJCQlFbmNvZGluZyA9IE5vbmUNCgkJCUl0ZW1TaXplID0gTm9uZQ0KCQkJdHlwZSA9IE5vbmUNCgkJCXZhbHVlcyA9IHlzLnZhbHVlcyhiLmRhdGEsICI6IikNCgkJCWlmICciSXRlbVNpemUiJyBpbiB2YWx1ZXM6DQoJCQkJSXRlbVNpemUgPSBpbnQodmFsdWVzWyciSXRlbVNpemUiJ10pDQoJCQkJSW50MzJBcnJheSA9IHlzLmdldChiLCAnIkludDMyQXJyYXkiJykNCgkJCQlpZiBJbnQzMkFycmF5Og0KCQkJCQl0eXBlID0gIkludDMyQXJyYXkiDQoJCQkJCXByaW50IG1vZGUsIHR5cGUNCgkJCQkJdmFsdWVzID0geXMudmFsdWVzKEludDMyQXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQlTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgImkiKQ0KCQkJCQlPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicsICJpIikNCgkJCQkJRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicsICciIicpDQoJCQkJCUVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicpDQoJCQkJCXByaW50IFsnVGV4Q29vcmQ3OicsJ01vZGU6Jyxtb2RlLCdUeXBlOicsdHlwZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZ10NCgkJCQkJaWYgRW5jb2RpbmcgPT0gJyJ2YXJpbnQiJzoNCgkJCQkJCXBhdGggPSBnZXRQYXRoKEZpbGUpDQoJCQkJCQlpZiBwYXRoOg0KCQkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQkJZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCWJ5dGVzID0gZGVjb2RlVmFyaW50KGcsIE9mZnNldCwgU2l6ZSAqIEl0ZW1TaXplLCB0eXBlKQ0KCQkJCQkJCXRleEFycmF5Ny5hcHBlbmQoW2J5dGVzLCBFbmNvZGluZywgSXRlbVNpemVdKQ0KCQkJCQkJCWZpbGUuY2xvc2UoKQ0KDQoJCQkJRmxvYXQzMkFycmF5ID0geXMuZ2V0KGIsICciRmxvYXQzMkFycmF5IicpDQoJCQkJaWYgRmxvYXQzMkFycmF5Og0KCQkJCQl0eXBlID0gIkZsb2F0MzJBcnJheSINCgkJCQkJcHJpbnQgbW9kZSwgdHlwZQ0KCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsICI6IikNCgkJCQkJU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICJpIikNCgkJCQkJT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAiaSIpDQoJCQkJCUZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInLCAnIiInKQ0KCQkJCQlFbmNvZGluZyA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJFbmNvZGluZyInKQ0KCQkJCQkjIHdyaXRlKGxvZyxbJ1RleENvb3JkNzonLCdtb2RlOicsbW9kZSx0eXBlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nXSxuKQ0KCQkJCQlpZiBFbmNvZGluZyAhPSAnInZhcmludCInOg0KCQkJCQkJcGF0aCA9IGdldFBhdGgoRmlsZSkNCgkJCQkJCWlmIHBhdGg6DQoJCQkJCQkJZmlsZSA9IG9wZW4ocGF0aCwgInJiIikNCgkJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJZy5zZWVrKE9mZnNldCkNCgkJCQkJCQlieXRlcyA9IGcuZihTaXplICogSXRlbVNpemUpDQoJCQkJCQkJbGlzdCA9IFtdDQoJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQoJCQkJCQkJCXUsIHYgPSBieXRlc1ttICogSXRlbVNpemUgOiBtICogSXRlbVNpemUgKyBJdGVtU2l6ZV0NCgkJCQkJCQkJbGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQkJCQl0ZXhBcnJheTcuYXBwZW5kKFtsaXN0LCBFbmNvZGluZ10pDQoJCQkJCQkJZmlsZS5jbG9zZSgpDQoNCglUZXhDb29yZDggPSB5cy5nZXQoVmVydGV4QXR0cmlidXRlTGlzdFswXSwgJyJUZXhDb29yZDgiJykNCglpZiBUZXhDb29yZDg6DQoJCW1vZGUgPSAiVGV4Q29vcmQ4Ig0KCQlmb3IgYiBpbiBUZXhDb29yZDg6DQoJCQlTaXplID0gTm9uZQ0KCQkJT2Zmc2V0ID0gTm9uZQ0KCQkJRW5jb2RpbmcgPSBOb25lDQoJCQlJdGVtU2l6ZSA9IE5vbmUNCgkJCXR5cGUgPSBOb25lDQoJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoYi5kYXRhLCAiOiIpDQoJCQlpZiAnIkl0ZW1TaXplIicgaW4gdmFsdWVzOg0KCQkJCUl0ZW1TaXplID0gaW50KHZhbHVlc1snIkl0ZW1TaXplIiddKQ0KCQkJCUludDMyQXJyYXkgPSB5cy5nZXQoYiwgJyJJbnQzMkFycmF5IicpDQoJCQkJaWYgSW50MzJBcnJheToNCgkJCQkJdHlwZSA9ICJJbnQzMkFycmF5Ig0KCQkJCQlwcmludCBtb2RlLCB0eXBlDQoJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhJbnQzMkFycmF5WzBdLmRhdGEsICI6IikNCgkJCQkJU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICJpIikNCgkJCQkJT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAiaSIpDQoJCQkJCUZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInLCAnIiInKQ0KCQkJCQlFbmNvZGluZyA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJFbmNvZGluZyInKQ0KCQkJCQlwcmludCBbJ1RleENvb3JkODonLCdNb2RlOicsbW9kZSwnVHlwZTonLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmddDQoJCQkJCWlmIEVuY29kaW5nID09ICcidmFyaW50Iic6DQoJCQkJCQlwYXRoID0gZ2V0UGF0aChGaWxlKQ0KCQkJCQkJaWYgcGF0aDoNCgkJCQkJCQlmaWxlID0gb3BlbihwYXRoLCAicmIiKQ0KCQkJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQlieXRlcyA9IGRlY29kZVZhcmludChnLCBPZmZzZXQsIFNpemUgKiBJdGVtU2l6ZSwgdHlwZSkNCgkJCQkJCQl0ZXhBcnJheTguYXBwZW5kKFtieXRlcywgRW5jb2RpbmcsIEl0ZW1TaXplXSkNCgkJCQkJCQlmaWxlLmNsb3NlKCkNCg0KCQkJCUZsb2F0MzJBcnJheSA9IHlzLmdldChiLCAnIkZsb2F0MzJBcnJheSInKQ0KCQkJCWlmIEZsb2F0MzJBcnJheToNCgkJCQkJdHlwZSA9ICJGbG9hdDMyQXJyYXkiDQoJCQkJCXByaW50IG1vZGUsIHR5cGUNCgkJCQkJdmFsdWVzID0geXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCAiOiIpDQoJCQkJCVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAiaSIpDQoJCQkJCU9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgImkiKQ0KCQkJCQlGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCgkJCQkJRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJykNCgkJCQkJIyB3cml0ZShsb2csWydUZXhDb29yZDg6JywnbW9kZTonLG1vZGUsdHlwZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZ10sbikNCgkJCQkJaWYgRW5jb2RpbmcgIT0gJyJ2YXJpbnQiJzoNCgkJCQkJCXBhdGggPSBnZXRQYXRoKEZpbGUpDQoJCQkJCQlpZiBwYXRoOg0KCQkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQkJZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCWcuc2VlayhPZmZzZXQpDQoJCQkJCQkJYnl0ZXMgPSBnLmYoU2l6ZSAqIEl0ZW1TaXplKQ0KCQkJCQkJCWxpc3QgPSBbXQ0KCQkJCQkJCWZvciBtIGluIHJhbmdlKFNpemUpOg0KCQkJCQkJCQl1LCB2ID0gYnl0ZXNbbSAqIEl0ZW1TaXplIDogbSAqIEl0ZW1TaXplICsgSXRlbVNpemVdDQoJCQkJCQkJCWxpc3QuYXBwZW5kKFt1LCAxIC0gdl0pDQoJCQkJCQkJdGV4QXJyYXk4LmFwcGVuZChbbGlzdCwgRW5jb2RpbmddKQ0KCQkJCQkJCWZpbGUuY2xvc2UoKQ0KDQoJVGV4Q29vcmQ5ID0geXMuZ2V0KFZlcnRleEF0dHJpYnV0ZUxpc3RbMF0sICciVGV4Q29vcmQ5IicpDQoJaWYgVGV4Q29vcmQ5Og0KCQltb2RlID0gIlRleENvb3JkOSINCgkJZm9yIGIgaW4gVGV4Q29vcmQ5Og0KCQkJU2l6ZSA9IE5vbmUNCgkJCU9mZnNldCA9IE5vbmUNCgkJCUVuY29kaW5nID0gTm9uZQ0KCQkJSXRlbVNpemUgPSBOb25lDQoJCQl0eXBlID0gTm9uZQ0KCQkJdmFsdWVzID0geXMudmFsdWVzKGIuZGF0YSwgIjoiKQ0KCQkJaWYgJyJJdGVtU2l6ZSInIGluIHZhbHVlczoNCgkJCQlJdGVtU2l6ZSA9IGludCh2YWx1ZXNbJyJJdGVtU2l6ZSInXSkNCgkJCQlJbnQzMkFycmF5ID0geXMuZ2V0KGIsICciSW50MzJBcnJheSInKQ0KCQkJCWlmIEludDMyQXJyYXk6DQoJCQkJCXR5cGUgPSAiSW50MzJBcnJheSINCgkJCQkJcHJpbnQgbW9kZSwgdHlwZQ0KCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoSW50MzJBcnJheVswXS5kYXRhLCAiOiIpDQoJCQkJCVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAiaSIpDQoJCQkJCU9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgImkiKQ0KCQkJCQlGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCgkJCQkJRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJykNCgkJCQkJcHJpbnQgWydUZXhDb29yZDk6JywnTW9kZTonLG1vZGUsJ1R5cGU6Jyx0eXBlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nXQ0KCQkJCQlpZiBFbmNvZGluZyA9PSAnInZhcmludCInOg0KCQkJCQkJcGF0aCA9IGdldFBhdGgoRmlsZSkNCgkJCQkJCWlmIHBhdGg6DQoJCQkJCQkJZmlsZSA9IG9wZW4ocGF0aCwgInJiIikNCgkJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJYnl0ZXMgPSBkZWNvZGVWYXJpbnQoZywgT2Zmc2V0LCBTaXplICogSXRlbVNpemUsIHR5cGUpDQoJCQkJCQkJdGV4QXJyYXk5LmFwcGVuZChbYnl0ZXMsIEVuY29kaW5nLCBJdGVtU2l6ZV0pDQoJCQkJCQkJZmlsZS5jbG9zZSgpDQoNCgkJCQlGbG9hdDMyQXJyYXkgPSB5cy5nZXQoYiwgJyJGbG9hdDMyQXJyYXkiJykNCgkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCXR5cGUgPSAiRmxvYXQzMkFycmF5Ig0KCQkJCQlwcmludCBtb2RlLCB0eXBlDQoJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQlTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgImkiKQ0KCQkJCQlPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicsICJpIikNCgkJCQkJRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicsICciIicpDQoJCQkJCUVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicpDQoJCQkJCSMgd3JpdGUobG9nLFsnVGV4Q29vcmQ5OicsJ21vZGU6Jyxtb2RlLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmddLG4pDQoJCQkJCWlmIEVuY29kaW5nICE9ICcidmFyaW50Iic6DQoJCQkJCQlwYXRoID0gZ2V0UGF0aChGaWxlKQ0KCQkJCQkJaWYgcGF0aDoNCgkJCQkJCQlmaWxlID0gb3BlbihwYXRoLCAicmIiKQ0KCQkJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQlnLnNlZWsoT2Zmc2V0KQ0KCQkJCQkJCWJ5dGVzID0gZy5mKFNpemUgKiBJdGVtU2l6ZSkNCgkJCQkJCQlsaXN0ID0gW10NCgkJCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCQkJdSwgdiA9IGJ5dGVzW20gKiBJdGVtU2l6ZSA6IG0gKiBJdGVtU2l6ZSArIEl0ZW1TaXplXQ0KCQkJCQkJCQlsaXN0LmFwcGVuZChbdSwgMSAtIHZdKQ0KCQkJCQkJCXRleEFycmF5OS5hcHBlbmQoW2xpc3QsIEVuY29kaW5nXSkNCgkJCQkJCQlmaWxlLmNsb3NlKCkNCg0KCVRleENvb3JkMTAgPSB5cy5nZXQoVmVydGV4QXR0cmlidXRlTGlzdFswXSwgJyJUZXhDb29yZDEwIicpDQoJaWYgVGV4Q29vcmQxMDoNCgkJbW9kZSA9ICJUZXhDb29yZDEwIg0KCQlmb3IgYiBpbiBUZXhDb29yZDEwOg0KCQkJU2l6ZSA9IE5vbmUNCgkJCU9mZnNldCA9IE5vbmUNCgkJCUVuY29kaW5nID0gTm9uZQ0KCQkJSXRlbVNpemUgPSBOb25lDQoJCQl0eXBlID0gTm9uZQ0KCQkJdmFsdWVzID0geXMudmFsdWVzKGIuZGF0YSwgIjoiKQ0KCQkJaWYgJyJJdGVtU2l6ZSInIGluIHZhbHVlczoNCgkJCQlJdGVtU2l6ZSA9IGludCh2YWx1ZXNbJyJJdGVtU2l6ZSInXSkNCgkJCQlJbnQzMkFycmF5ID0geXMuZ2V0KGIsICciSW50MzJBcnJheSInKQ0KCQkJCWlmIEludDMyQXJyYXk6DQoJCQkJCXR5cGUgPSAiSW50MzJBcnJheSINCgkJCQkJcHJpbnQgbW9kZSwgdHlwZQ0KCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoSW50MzJBcnJheVswXS5kYXRhLCAiOiIpDQoJCQkJCVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAiaSIpDQoJCQkJCU9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgImkiKQ0KCQkJCQlGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCgkJCQkJRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJykNCgkJCQkJcHJpbnQgWydUZXhDb29yZDEwOicsJ01vZGU6Jyxtb2RlLCdUeXBlOicsdHlwZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZ10NCgkJCQkJaWYgRW5jb2RpbmcgPT0gJyJ2YXJpbnQiJzoNCgkJCQkJCXBhdGggPSBnZXRQYXRoKEZpbGUpDQoJCQkJCQlpZiBwYXRoOg0KCQkJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCQkJZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCWJ5dGVzID0gZGVjb2RlVmFyaW50KGcsIE9mZnNldCwgU2l6ZSAqIEl0ZW1TaXplLCB0eXBlKQ0KCQkJCQkJCXRleEFycmF5MTAuYXBwZW5kKFtieXRlcywgRW5jb2RpbmcsIEl0ZW1TaXplXSkNCgkJCQkJCQlmaWxlLmNsb3NlKCkNCg0KCQkJCUZsb2F0MzJBcnJheSA9IHlzLmdldChiLCAnIkZsb2F0MzJBcnJheSInKQ0KCQkJCWlmIEZsb2F0MzJBcnJheToNCgkJCQkJdHlwZSA9ICJGbG9hdDMyQXJyYXkiDQoJCQkJCXByaW50IG1vZGUsIHR5cGUNCgkJCQkJdmFsdWVzID0geXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCAiOiIpDQoJCQkJCVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAiaSIpDQoJCQkJCU9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgImkiKQ0KCQkJCQlGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCgkJCQkJRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJykNCgkJCQkJIyB3cml0ZShsb2csWydUZXhDb29yZDEwOicsJ21vZGU6Jyxtb2RlLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmddLG4pDQoJCQkJCWlmIEVuY29kaW5nICE9ICcidmFyaW50Iic6DQoJCQkJCQlwYXRoID0gZ2V0UGF0aChGaWxlKQ0KCQkJCQkJaWYgcGF0aDoNCgkJCQkJCQlmaWxlID0gb3BlbihwYXRoLCAicmIiKQ0KCQkJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQlnLnNlZWsoT2Zmc2V0KQ0KCQkJCQkJCWJ5dGVzID0gZy5mKFNpemUgKiBJdGVtU2l6ZSkNCgkJCQkJCQlsaXN0ID0gW10NCgkJCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCQkJdSwgdiA9IGJ5dGVzW20gKiBJdGVtU2l6ZSA6IG0gKiBJdGVtU2l6ZSArIEl0ZW1TaXplXQ0KCQkJCQkJCQlsaXN0LmFwcGVuZChbdSwgMSAtIHZdKQ0KCQkJCQkJCXRleEFycmF5MTAuYXBwZW5kKFtsaXN0LCBFbmNvZGluZ10pDQoJCQkJCQkJZmlsZS5jbG9zZSgpDQoNCglyZXR1cm4gdmVydGV4QXJyYXksIHRleEFycmF5MCwgdGV4QXJyYXkxLCB0ZXhBcnJheTIsIHRleEFycmF5MywgdGV4QXJyYXk0LCB0ZXhBcnJheTUsIHRleEFycmF5NiwgdGV4QXJyYXk3LCB0ZXhBcnJheTgsIHRleEFycmF5OSwgdGV4QXJyYXkxMCwgbm9ybWFsQXJyYXkNCg0KZGVmIGdldFJpZ0dlb21ldHJ5KHlzLCBwYXJlbnQsIG4pOg0KCXByaW50ICIjIiAqIDUwLCAiUmlnR2VvbWV0cnkiDQoJbiArPSA0DQoJQm9uZU1hcCA9IFswXSAqIDEwMDANCglib25lcyA9IFtdDQoJd2VpZ2h0cyA9IFtdDQoJbW9kZSA9IE5vbmUNCglpbmRpY2VBcnJheSA9IFtdDQoJdmVydGV4QXJyYXkgPSBbXQ0KCXRleEFycmF5MCA9IFtdDQoJdGV4QXJyYXkxID0gW10NCgl0ZXhBcnJheTIgPSBbXQ0KCXRleEFycmF5MyA9IFtdDQoJdGV4QXJyYXk0ID0gW10NCgl0ZXhBcnJheTUgPSBbXQ0KCXRleEFycmF5NiA9IFtdDQoJdGV4QXJyYXk3ID0gW10NCgl0ZXhBcnJheTggPSBbXQ0KCXRleEFycmF5OSA9IFtdDQoJdGV4QXJyYXkxMCA9IFtdDQoJbm9ybUFycmF5ID0gW10NCglhdHJpYnV0ZXMgPSB7fQ0KCWZvciBjaGlsZCBpbiBwYXJlbnQuY2hpbGRyZW46DQoJCWlmICJCb25lTWFwIiBpbiBjaGlsZC5oZWFkZXI6DQoJCQkjIHdyaXRlKGxvZyxbJ0JvbmVNYXAnXSxuKQ0KCQkJdmFsdWVzID0geXMudmFsdWVzKGNoaWxkLmRhdGEsICI6IikNCgkJCSMgcHJpbnQgdmFsdWVzDQoJCQlmb3IgdmFsdWUgaW4gdmFsdWVzOg0KCQkJCWlkID0geXMuZ2V0VmFsdWUodmFsdWVzLCB2YWx1ZSwgImkiKQ0KCQkJCW5hbWUgPSB2YWx1ZS5yZXBsYWNlKCciJywgIiIpDQoJCQkJQm9uZU1hcFtpZF0gPSBnZXRTcGxpdE5hbWUobmFtZSwgIl8iLCAtMSkNCgkJaWYgIlNvdXJjZUdlb21ldHJ5IiBpbiBjaGlsZC5oZWFkZXI6DQoJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoY2hpbGQuZGF0YSwgIjoiKQ0KCQkJUHJpbWl0aXZlU2V0TGlzdCA9IHlzLmdldChjaGlsZCwgJyJQcmltaXRpdmVTZXRMaXN0IicpDQoJCQlpZiBQcmltaXRpdmVTZXRMaXN0Og0KCQkJCWluZGljZUFycmF5ID0gZ2V0UHJpbWl0aXZlU2V0TGlzdCh5cywgUHJpbWl0aXZlU2V0TGlzdCwgbikNCg0KCQkJVXNlckRhdGFDb250YWluZXIgPSB5cy5nZXQoY2hpbGQsICciVXNlckRhdGFDb250YWluZXIiJykNCgkJCWlmIFVzZXJEYXRhQ29udGFpbmVyOg0KCQkJCWZvciBVc2VyRGF0YSBpbiBVc2VyRGF0YUNvbnRhaW5lcjoNCgkJCQkJVmFsdWVzID0geXMuZ2V0KFVzZXJEYXRhLCAnIlZhbHVlcyInKQ0KCQkJCQlpZiBWYWx1ZXM6DQoJCQkJCQlmb3IgYSBpbiBWYWx1ZXNbMF0uY2hpbGRyZW46DQoJCQkJCQkJdmFsdWVzID0geXMudmFsdWVzKGEuZGF0YSwgIjoiKQ0KCQkJCQkJCU5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciTmFtZSInLCAnIiInKQ0KCQkJCQkJCVZhbHVlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlZhbHVlIicsICciIicpDQoJCQkJCQkJaWYgTmFtZToNCgkJCQkJCQkJYXRyaWJ1dGVzW05hbWVdID0gVmFsdWUNCg0KCQkJVmVydGV4QXR0cmlidXRlTGlzdCA9IHlzLmdldChjaGlsZCwgJyJWZXJ0ZXhBdHRyaWJ1dGVMaXN0IicpDQoJCQlpZiBWZXJ0ZXhBdHRyaWJ1dGVMaXN0Og0KCQkJCXZlcnRleEFycmF5LCB0ZXhBcnJheTAsIHRleEFycmF5MSwgdGV4QXJyYXkyLCB0ZXhBcnJheTMsIHRleEFycmF5NCwgdGV4QXJyYXk1LCB0ZXhBcnJheTYsIHRleEFycmF5NywgdGV4QXJyYXk4LCB0ZXhBcnJheTksIHRleEFycmF5MTAsIG5vcm1BcnJheSA9IGdldFZlcnRleEF0dHJpYnV0ZUxpc3QoDQoJCQkJCXlzLCBWZXJ0ZXhBdHRyaWJ1dGVMaXN0LCBuDQoJCQkJKQ0KDQoJCWlmICJVc2VyRGF0YUNvbnRhaW5lciIgaW4gY2hpbGQuaGVhZGVyOg0KCQkJIyB3cml0ZShsb2csWydVc2VyRGF0YUNvbnRhaW5lciddLG4pDQoJCQlWYWx1ZXMgPSB5cy5nZXQoY2hpbGQsICciVmFsdWVzIicpDQoJCQlpZiBWYWx1ZXM6DQoJCQkJZm9yIGEgaW4gVmFsdWVzWzBdLmNoaWxkcmVuOg0KCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoYS5kYXRhLCAiOiIpDQoJCQkJCWZvciB2YWx1ZSBpbiB2YWx1ZXM6DQoJCQkJCQlpZCA9IHlzLmdldFZhbHVlKHZhbHVlcywgdmFsdWUpDQoJCQkJCQkjIHdyaXRlKGxvZyxbdmFsdWUsJzonLGlkXSxuKzQpDQoJCWlmICJWZXJ0ZXhBdHRyaWJ1dGVMaXN0IiBpbiBjaGlsZC5oZWFkZXI6DQoJCQkjIHdyaXRlKGxvZyxbJ1ZlcnRleEF0dHJpYnV0ZUxpc3QnXSxuKQ0KCQkJQm9uZXMgPSB5cy5nZXQoY2hpbGQsICciQm9uZXMiJykNCgkJCWlmIEJvbmVzOg0KCQkJCSMgd3JpdGUobG9nLFsnQm9uZXMnXSxuKzQpDQoJCQkJdmFsdWVzID0geXMudmFsdWVzKEJvbmVzWzBdLmRhdGEsICI6IikNCgkJCQlJdGVtU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJJdGVtU2l6ZSInLCAiaSIpDQoJCQkJIyB3cml0ZShsb2csWyciSXRlbVNpemUiJywnOicsSXRlbVNpemVdLG4rOCkNCgkJCQlVaW50MTZBcnJheSA9IHlzLmdldChCb25lc1swXSwgJyJVaW50MTZBcnJheSInKQ0KCQkJCWlmIFVpbnQxNkFycmF5Og0KCQkJCQl0eXBlID0gIlVpbnQxNkFycmF5Ig0KCQkJCQl2YWx1ZXMgPSB5cy52YWx1ZXMoVWludDE2QXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQlGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCgkJCQkJU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICJpIikNCgkJCQkJT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAiaSIpDQoJCQkJCUVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicsICciIicpDQoJCQkJCSMgd3JpdGUobG9nLFsnIkZpbGUiJywnOicsRmlsZV0sbis4KQ0KCQkJCQkjIHdyaXRlKGxvZyxbJyJTaXplIicsJzonLFNpemVdLG4rOCkNCgkJCQkJIyB3cml0ZShsb2csWyciT2Zmc2V0IicsJzonLE9mZnNldF0sbis4KQ0KCQkJCQkjIHdyaXRlKGxvZyxbJyJFbmNvZGluZyInLCc6JyxFbmNvZGluZ10sbis4KQ0KDQoJCQkJCWlmIEVuY29kaW5nID09ICJ2YXJpbnQiOg0KCQkJCQkJcGF0aCA9ICgNCgkJCQkJCQlvcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpDQoJCQkJCQkJKyBvcy5zZXANCgkJCQkJCQkrICIuL3t0ZW1wUGF0aH0vbW9kZWxfZmlsZS5iaW4uZ3oudHh0Ig0KCQkJCQkJKQ0KCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCkgPT0gRmFsc2U6DQoJCQkJCQkJcGF0aCA9ICgNCgkJCQkJCQkJb3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKQ0KCQkJCQkJCQkrIG9zLnNlcA0KCQkJCQkJCQkrICIuL3t0ZW1wUGF0aH0vbW9kZWxfZmlsZS5iaW4iDQoJCQkJCQkJKQ0KCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCkgPT0gRmFsc2U6DQoJCQkJCQkJcGF0aCA9ICgNCgkJCQkJCQkJb3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKQ0KCQkJCQkJCQkrIG9zLnNlcA0KCQkJCQkJCQkrIHZhbHVlc1snIkZpbGUiJ10uc3BsaXQoJyInKVsxXQ0KCQkJCQkJCSkgICMgKycudHh0Jw0KCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCkgPT0gVHJ1ZToNCgkJCQkJCQlmaWxlID0gb3BlbihwYXRoLCAicmIiKQ0KCQkJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQlsaXN0ID0gZGVjb2RlVmFyaW50KGcsIE9mZnNldCwgU2l6ZSAqIEl0ZW1TaXplLCB0eXBlKQ0KCQkJCQkJCSMjd3JpdGUobG9nLGxpc3QsMCkNCgkJCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCQkJYm9uZXMuYXBwZW5kKA0KCQkJCQkJCQkJbGlzdFttICogSXRlbVNpemUgOiBtICogSXRlbVNpemUgKyBJdGVtU2l6ZV0NCgkJCQkJCQkJKQ0KCQkJCQkJCWZpbGUuY2xvc2UoKQ0KDQoJCQlXZWlnaHRzID0geXMuZ2V0KGNoaWxkLCAnIldlaWdodHMiJykNCgkJCWlmIFdlaWdodHM6DQoJCQkJIyB3cml0ZShsb2csWydXZWlnaHRzJ10sbis0KQ0KCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhXZWlnaHRzWzBdLmRhdGEsICI6IikNCgkJCQlJdGVtU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJJdGVtU2l6ZSInLCAiaSIpDQoJCQkJIyB3cml0ZShsb2csWyciSXRlbVNpemUiJywnOicsSXRlbVNpemVdLG4rOCkNCgkJCQlGbG9hdDMyQXJyYXkgPSB5cy5nZXQoV2VpZ2h0c1swXSwgJyJGbG9hdDMyQXJyYXkiJykNCgkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgIjoiKQ0KCQkJCQlGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCgkJCQkJU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICJpIikNCgkJCQkJT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAiaSIpDQoJCQkJCUVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicsICciIicpDQoJCQkJCSMgd3JpdGUobG9nLFsnIkZpbGUiJywnOicsRmlsZV0sbis4KQ0KCQkJCQkjIHdyaXRlKGxvZyxbJyJTaXplIicsJzonLFNpemVdLG4rOCkNCgkJCQkJIyB3cml0ZShsb2csWyciT2Zmc2V0IicsJzonLE9mZnNldF0sbis4KQ0KCQkJCQkjIHdyaXRlKGxvZyxbJyJFbmNvZGluZyInLCc6JyxFbmNvZGluZ10sbis4KQ0KDQoJCQkJCWlmIEVuY29kaW5nID09ICJ2YXJpbnQiOg0KCQkJCQkJcGF0aCA9ICgNCgkJCQkJCQlvcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpDQoJCQkJCQkJKyBvcy5zZXANCgkJCQkJCQkrICIuL3t0ZW1wUGF0aH0vbW9kZWxfZmlsZS5iaW4uZ3oudHh0Ig0KCQkJCQkJKQ0KCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCkgPT0gRmFsc2U6DQoJCQkJCQkJcGF0aCA9ICgNCgkJCQkJCQkJb3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKQ0KCQkJCQkJCQkrIG9zLnNlcA0KCQkJCQkJCQkrICIuL3t0ZW1wUGF0aH0vbW9kZWxfZmlsZS5iaW4iDQoJCQkJCQkJKQ0KCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCkgPT0gRmFsc2U6DQoJCQkJCQkJcGF0aCA9ICgNCgkJCQkJCQkJb3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKQ0KCQkJCQkJCQkrIG9zLnNlcA0KCQkJCQkJCQkrIHZhbHVlc1snIkZpbGUiJ10uc3BsaXQoJyInKVsxXQ0KCQkJCQkJCSkgICMgKycudHh0Jw0KCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCkgPT0gVHJ1ZToNCgkJCQkJCQlmaWxlID0gb3BlbihwYXRoLCAicmIiKQ0KCQkJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQlsaXN0ID0gZGVjb2RlVmFyaW50KGcsIE9mZnNldCwgU2l6ZSAqIEl0ZW1TaXplLCB0eXBlKQ0KCQkJCQkJCSMjd3JpdGUobG9nLGxpc3QsMCkNCgkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQkJZWxzZToNCgkJCQkJCXBhdGggPSAoDQoJCQkJCQkJb3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKQ0KCQkJCQkJCSsgb3Muc2VwDQoJCQkJCQkJKyAiLi97dGVtcFBhdGh9L21vZGVsX2ZpbGUuYmluLmd6LnR4dCINCgkJCQkJCSkNCgkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpID09IEZhbHNlOg0KCQkJCQkJCXBhdGggPSAoDQoJCQkJCQkJCW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkNCgkJCQkJCQkJKyBvcy5zZXANCgkJCQkJCQkJKyAiLi97dGVtcFBhdGh9L21vZGVsX2ZpbGUuYmluIg0KCQkJCQkJCSkNCgkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpID09IEZhbHNlOg0KCQkJCQkJCXBhdGggPSAoDQoJCQkJCQkJCW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkNCgkJCQkJCQkJKyBvcy5zZXANCgkJCQkJCQkJKyB2YWx1ZXNbJyJGaWxlIiddLnNwbGl0KCciJylbMV0NCgkJCQkJCQkpICAjICsnLnR4dCcNCgkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpID09IFRydWU6DQoJCQkJCQkJZmlsZSA9IG9wZW4ocGF0aCwgInJiIikNCgkJCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJZy5zZWVrKE9mZnNldCkNCgkJCQkJCQlsaXN0ID0gZy5mKFNpemUgKiBJdGVtU2l6ZSkNCgkJCQkJCQkjI3dyaXRlKGxvZyxsaXN0LDApDQoJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQoJCQkJCQkJCXdlaWdodHMuYXBwZW5kKA0KCQkJCQkJCQkJbGlzdFttICogSXRlbVNpemUgOiBtICogSXRlbVNpemUgKyBJdGVtU2l6ZV0NCgkJCQkJCQkJKQ0KCQkJCQkJCWZpbGUuY2xvc2UoKQ0KDQoJIyBwcmludCBhdHJpYnV0ZXMNCgltZXNoID0gTWVzaCgpDQoJaWYgbGVuKGJvbmVzKSA+IDAgYW5kIGxlbihXZWlnaHRzKSA+IDA6DQoJCW1lc2guQm9uZU1hcCA9IEJvbmVNYXANCgkJc2tpbiA9IFNraW4oKQ0KCQltZXNoLnNraW5MaXN0LmFwcGVuZChza2luKQ0KCQltZXNoLnNraW5JbmRpY2VMaXN0ID0gYm9uZXMNCgkJbWVzaC5za2luV2VpZ2h0TGlzdCA9IHdlaWdodHMNCglpZiBsZW4oaW5kaWNlQXJyYXkpID4gMDoNCgkJZm9yIFtpbmRpY2VzLCBtb2RlXSBpbiBpbmRpY2VBcnJheToNCgkJCXByaW50IG1vZGUsIGxlbihpbmRpY2VzKQ0KCQkJbWF0ID0gTWF0KCkNCgkJCW1lc2gubWF0TGlzdC5hcHBlbmQobWF0KQ0KCQkJbWF0LklEU3RhcnQgPSBsZW4obWVzaC5pbmRpY2VMaXN0KQ0KCQkJbWF0LklEQ291bnQgPSBsZW4oaW5kaWNlcykNCgkJCW1lc2guaW5kaWNlTGlzdC5leHRlbmQoaW5kaWNlcykNCgkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCW1hdC5UUklTVFJJUCA9IFRydWUNCgkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRVMiJzoNCgkJCQltYXQuVFJJQU5HTEUgPSBUcnVlDQoNCgkJaW5kaWNlcyA9IGluZGljZUFycmF5WzBdWzBdDQoJCW1vZGUgPSBpbmRpY2VBcnJheVswXVsxXQ0KCQlpZiBsZW4obm9ybUFycmF5KSA9PSAxOg0KCQkJaWYgbm9ybUFycmF5WzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSBub3JtQXJyYXlbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IG5vcm1BcnJheVswXVsyXQ0KCQkJCWVwcyA9IGZsb2F0KGF0cmlidXRlc1siZXBzaWxvbiJdKQ0KCQkJCW5waGkgPSBmbG9hdChhdHJpYnV0ZXNbIm5waGkiXSkNCgkJCQlzaXplID0gbGVuKGJ5dGVzKSAvIEl0ZW1TaXplDQoJCQkJaW50cyA9IGJ5dGVzDQoJCQkJZ2xvYmFsIG1vZGVsSUQNCgkJCQkNCgkJCQlpZiBvcy5wYXRoLmV4aXN0cygiLi97dGVtcFBhdGh9L21vZGVsRGF0YS5qcyIpOg0KCQkJCQlvcy5yZW1vdmUoIi4ve3RlbXBQYXRofS9tb2RlbERhdGEuanMiKQ0KCQkJCWlmIG9zLnBhdGguZXhpc3RzKCIuL3t0ZW1wUGF0aH0vbm9ybWFscy5kYXQiKToNCgkJCQkJb3MucmVtb3ZlKCIuL3t0ZW1wUGF0aH0vbm9ybWFscy5kYXQiKQ0KCQkJCXdpdGggb3BlbigiLi97dGVtcFBhdGh9L21vZGVsRGF0YS5qcyIsICJhIikgYXMgbW9kZWxEYXRhOg0KCQkJCQltb2RlbElEICs9IDENCgkJCQkJbW9kZWxEYXRhLndyaXRlKCJtb2R1bGUuZXhwb3J0cy5lcHMgPSAiICsgc3RyKGVwcykgKyAiO1xuIikNCgkJCQkJbW9kZWxEYXRhLndyaXRlKCJtb2R1bGUuZXhwb3J0cy5ucGhpID0gIiArIHN0cihucGhpKSArICI7XG4iKQ0KCQkJCQltb2RlbERhdGEud3JpdGUoIm1vZHVsZS5leHBvcnRzLnNpemUgPSAiICsgc3RyKHNpemUpICsgIjtcbiIpDQoJCQkJCW1vZGVsRGF0YS53cml0ZSgibW9kdWxlLmV4cG9ydHMuaWQgPSAiICsgc3RyKG1vZGVsSUQpICsgIjtcbiIpDQoJCQkJCW1vZGVsRGF0YS53cml0ZSgibW9kdWxlLmV4cG9ydHMuaW50cyA9ICIgKyBzdHIoYnl0ZXMpICsgIjtcbiIpDQoJCQkJDQoJCQkJc3VicHJvY2Vzcy5jYWxsKCgnbm9kZS5leGUgLi97dGVtcFBhdGh9L2NhbGNWZXJ0ZXhOb3JtYWxzLmpzJykpDQoJCQkJDQoJCQkJJycnZmxvYXRGaWxlID0gb3Blbigibm9ybWFscy5kYXQiLCAiciIpDQoJCQkJZmxvYXRMaW5lcyA9IGZsb2F0RmlsZS5yZWFkbGluZXMoKQ0KCQkJCW5vcm1EYXRhID0gW10NCgkJCQlyZWFkRGF0YSA9IDANCgkJCQl3aGlsZSByZWFkRGF0YSA8IHNpemUgKiAzOg0KCQkJCQlub3JtRGF0YS5hcHBlbmQoW2Zsb2F0KGZsb2F0TGluZXNbcmVhZERhdGFdKSwgZmxvYXQoZmxvYXRMaW5lc1tyZWFkRGF0YSArIDFdKSwgZmxvYXQoZmxvYXRMaW5lc1tyZWFkRGF0YSArIDJdKV0pDQoJCQkJCXJlYWREYXRhICs9IDMNCgkJCQltZXNoLnZlcnROb3JtTGlzdCA9IG5vcm1EYXRhDQoJCQllbHNlOg0KCQkJCWxpc3QgPSBub3JtQXJyYXlbMF1bMF0NCgkJCQltZXNoLnZlcnROb3JtTGlzdCA9IGxpc3QnJycNCg0KCQlpZiBsZW4odmVydGV4QXJyYXkpID09IDE6DQoJCQlpZiB2ZXJ0ZXhBcnJheVswXVsxXSA9PSAnInZhcmludCInOg0KCQkJCWJ5dGVzID0gdmVydGV4QXJyYXlbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHZlcnRleEFycmF5WzBdWzJdDQoJCQkJaWYgbW9kZSA9PSAnIlRSSUFOR0xFX1NUUklQIic6DQoJCQkJCWJ5dGVzID0gZGVjb2RlUHJlZGljdChpbmRpY2VzLCBieXRlcywgSXRlbVNpemUpDQoJCQkJczEgPSBmbG9hdChhdHJpYnV0ZXNbInZ0eF9iYmxfeCJdKQ0KCQkJCXMyID0gZmxvYXQoYXRyaWJ1dGVzWyJ2dHhfYmJsX3kiXSkNCgkJCQlzMyA9IGZsb2F0KGF0cmlidXRlc1sidnR4X2JibF96Il0pDQoJCQkJcyA9IFtzMSwgczIsIHMzXQ0KCQkJCWExID0gZmxvYXQoYXRyaWJ1dGVzWyJ2dHhfaF94Il0pDQoJCQkJYTIgPSBmbG9hdChhdHJpYnV0ZXNbInZ0eF9oX3kiXSkNCgkJCQlhMyA9IGZsb2F0KGF0cmlidXRlc1sidnR4X2hfeiJdKQ0KCQkJCWEgPSBbYTEsIGEyLCBhM10NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJbWVzaC52ZXJ0UG9zTGlzdCA9IFsNCgkJCQkJZmxvYXRzW20gOiBtICsgSXRlbVNpemVdIGZvciBtIGluIHJhbmdlKDAsIGxlbihmbG9hdHMpLCAzKQ0KCQkJCV0NCgkJCWVsc2U6DQoJCQkJbGlzdCA9IHZlcnRleEFycmF5WzBdWzBdDQoJCQkJbWVzaC52ZXJ0UG9zTGlzdCA9IGxpc3QNCgkJDQoJCXV2TGlzdHMgPSBbXQ0KCQlpZiBsZW4odGV4QXJyYXkwKSA+PSAxOg0KCQkJaWYgdGV4QXJyYXkwWzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTBbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5MFswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl8wX2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzBfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfMF9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfMF9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5MFswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXkxKSA+PSAxOg0KCQkJaWYgdGV4QXJyYXkxWzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTFbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5MVswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl8xX2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzFfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfMV9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfMV9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5MVswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXkyKSA+PSAxOg0KCQkJaWYgdGV4QXJyYXkyWzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTJbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5MlswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl8yX2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzJfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfMl9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfMl9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5MlswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXkzKSA+PSAxOg0KCQkJaWYgdGV4QXJyYXkzWzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTNbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5M1swXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl8zX2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzNfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfM19oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfM19oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5M1swXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXk0KSA+PSAxOg0KCQkJaWYgdGV4QXJyYXk0WzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTRbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5NFswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl80X2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzRfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfNF9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfNF9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5NFswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXk1KSA+PSAxOg0KCQkJaWYgdGV4QXJyYXk1WzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTVbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5NVswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl81X2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzVfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfNV9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfNV9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5NVswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXk2KSA+PSAxOg0KCQkJaWYgdGV4QXJyYXk2WzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTZbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5NlswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl82X2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzZfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfNl9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfNl9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5NlswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXk3KSA+PSAxOg0KCQkJaWYgdGV4QXJyYXk3WzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTdbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5N1swXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl83X2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzdfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfN19oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfN19oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5N1swXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXk4KSA+PSAxOg0KCQkJaWYgdGV4QXJyYXk4WzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheThbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5OFswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl84X2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzhfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfOF9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfOF9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5OFswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXk5KSA+PSAxOg0KCQkJaWYgdGV4QXJyYXk5WzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTlbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5OVswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl85X2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzlfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfOV9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfOV9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5OVswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXkxMCkgPj0gMToNCgkJCWlmIHRleEFycmF5MTBbMF1bMV0gPT0gJyJ2YXJpbnQiJzoNCgkJCQlieXRlcyA9IHRleEFycmF5MTBbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5MTBbMF1bMl0NCgkJCQlpZiBtb2RlID09ICciVFJJQU5HTEVfU1RSSVAiJzoNCgkJCQkJYnl0ZXMgPSBkZWNvZGVQcmVkaWN0KGluZGljZXMsIGJ5dGVzLCBJdGVtU2l6ZSkNCgkJCQlzMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfMTBfYmJsX3giXSkNCgkJCQlzMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfMTBfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfMTBfaF94Il0pDQoJCQkJYTIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzEwX2hfeSJdKQ0KCQkJCWEgPSBbYTEsIGEyXQ0KCQkJCWZsb2F0cyA9IGRlY29kZVF1YW50aXplKGJ5dGVzLCBzLCBhLCBJdGVtU2l6ZSkNCgkJCQl1dkxpc3QgPSBbXQ0KCQkJCWZvciBtIGluIHJhbmdlKDAsIGxlbihmbG9hdHMpLCBJdGVtU2l6ZSk6DQoJCQkJCXUsIHYgPSBmbG9hdHNbbSA6IG0gKyBJdGVtU2l6ZV0NCgkJCQkJdXZMaXN0LmFwcGVuZChbdSwgMSAtIHZdKQ0KCQkJCXV2TGlzdHMuYXBwZW5kKHV2TGlzdCkNCgkJCWVsc2U6DQoJCQkJdXZMaXN0cy5hcHBlbmQodGV4QXJyYXkxMFswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KDQoJCWlmIGxlbih1dkxpc3RzKSA+PSAxOg0KCQkJZm9yIGxpc3QgaW4gdXZMaXN0czoNCgkJCQltZXNoLnZlcnRVVkxpc3RzLmFwcGVuZChsaXN0KQ0KCXJldHVybiBtZXNoDQoNCg0KZGVmIGRlY29kZVF1YW50aXplKGlucHV0LCBzLCBhLCBpdGVtc2l6ZSk6DQoJeCA9IFswXSAqIGxlbihpbnB1dCkNCglpZCA9IDANCglmb3IgciBpbiByYW5nZShsZW4oaW5wdXQpIC8gaXRlbXNpemUpOg0KCQlmb3IgbCBpbiByYW5nZShpdGVtc2l6ZSk6DQoJCQl4W2lkXSA9IHNbbF0gKyBpbnB1dFtpZF0gKiBhW2xdDQoJCQlpZCArPSAxDQoJcmV0dXJuIHgNCg0KDQpkZWYgZ2V0R2VvbWV0cnkoeXMsIHBhcmVudCwgbik6DQoJcHJpbnQgIiMiICogNTAsICJHZW9tZXRyeSINCgluICs9IDQNCgltb2RlID0gTm9uZQ0KCWluZGljZUFycmF5ID0gW10NCgl2ZXJ0ZXhBcnJheSA9IFtdDQoJdGV4QXJyYXkwID0gW10NCgl0ZXhBcnJheTEgPSBbXQ0KCXRleEFycmF5MiA9IFtdDQoJdGV4QXJyYXkzID0gW10NCgl0ZXhBcnJheTQgPSBbXQ0KCXRleEFycmF5NSA9IFtdDQoJdGV4QXJyYXk2ID0gW10NCgl0ZXhBcnJheTcgPSBbXQ0KCXRleEFycmF5OCA9IFtdDQoJdGV4QXJyYXk5ID0gW10NCgl0ZXhBcnJheTEwID0gW10NCglub3JtQXJyYXkgPSBbXQ0KCWF0cmlidXRlcyA9IHt9DQoNCgkjIHdyaXRlKGxvZyxbJ0dlb21ldHJ5J10sbikNCglQcmltaXRpdmVTZXRMaXN0ID0geXMuZ2V0KHBhcmVudCwgJyJQcmltaXRpdmVTZXRMaXN0IicpDQoJaWYgUHJpbWl0aXZlU2V0TGlzdDoNCgkJaW5kaWNlQXJyYXkgPSBnZXRQcmltaXRpdmVTZXRMaXN0KHlzLCBQcmltaXRpdmVTZXRMaXN0LCBuKQ0KDQoJVXNlckRhdGFDb250YWluZXIgPSB5cy5nZXQocGFyZW50LCAnIlVzZXJEYXRhQ29udGFpbmVyIicpDQoJaWYgVXNlckRhdGFDb250YWluZXI6DQoJCWZvciBVc2VyRGF0YSBpbiBVc2VyRGF0YUNvbnRhaW5lcjoNCgkJCVZhbHVlcyA9IHlzLmdldChVc2VyRGF0YSwgJyJWYWx1ZXMiJykNCgkJCWlmIFZhbHVlczoNCgkJCQlmb3IgYSBpbiBWYWx1ZXNbMF0uY2hpbGRyZW46DQoJCQkJCXZhbHVlcyA9IHlzLnZhbHVlcyhhLmRhdGEsICI6IikNCgkJCQkJTmFtZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJOYW1lIicsICciIicpDQoJCQkJCVZhbHVlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlZhbHVlIicsICciIicpDQoJCQkJCSMgaWYgTmFtZTojd3JpdGUobG9nLFtOYW1lLFZhbHVlXSxuKzQpDQoJCQkJCWlmIE5hbWU6DQoJCQkJCQlhdHJpYnV0ZXNbTmFtZV0gPSBWYWx1ZQ0KDQoJVmVydGV4QXR0cmlidXRlTGlzdCA9IHlzLmdldChwYXJlbnQsICciVmVydGV4QXR0cmlidXRlTGlzdCInKQ0KCWlmIFZlcnRleEF0dHJpYnV0ZUxpc3Q6DQoJCXZlcnRleEFycmF5LCB0ZXhBcnJheTAsIHRleEFycmF5MSwgdGV4QXJyYXkyLCB0ZXhBcnJheTMsIHRleEFycmF5NCwgdGV4QXJyYXk1LCB0ZXhBcnJheTYsIHRleEFycmF5NywgdGV4QXJyYXk4LCB0ZXhBcnJheTksIHRleEFycmF5MTAsIG5vcm1BcnJheSA9IGdldFZlcnRleEF0dHJpYnV0ZUxpc3QoeXMsIFZlcnRleEF0dHJpYnV0ZUxpc3QsIG4pDQoNCgkjIHByaW50IGF0cmlidXRlcw0KCW1lc2ggPSBNZXNoKCkNCglpZiBsZW4oaW5kaWNlQXJyYXkpID4gMDoNCgkJZm9yIFtpbmRpY2VzLCBtb2RlXSBpbiBpbmRpY2VBcnJheToNCgkJCXByaW50IG1vZGUsIGxlbihpbmRpY2VzKQ0KCQkJbWF0ID0gTWF0KCkNCgkJCW1lc2gubWF0TGlzdC5hcHBlbmQobWF0KQ0KCQkJbWF0LklEU3RhcnQgPSBsZW4obWVzaC5pbmRpY2VMaXN0KQ0KCQkJbWF0LklEQ291bnQgPSBsZW4oaW5kaWNlcykNCgkJCW1lc2guaW5kaWNlTGlzdC5leHRlbmQoaW5kaWNlcykNCgkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCW1hdC5UUklTVFJJUCA9IFRydWUNCgkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRVMiJzoNCgkJCQltYXQuVFJJQU5HTEUgPSBUcnVlDQoNCgkJaW5kaWNlcyA9IGluZGljZUFycmF5WzBdWzBdDQoJCW1vZGUgPSBpbmRpY2VBcnJheVswXVsxXQ0KCQlpZiBsZW4obm9ybUFycmF5KSA9PSAxOg0KCQkJaWYgbm9ybUFycmF5WzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSBub3JtQXJyYXlbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IG5vcm1BcnJheVswXVsyXQ0KCQkJCWVwcyA9IGZsb2F0KGF0cmlidXRlc1siZXBzaWxvbiJdKQ0KCQkJCW5waGkgPSBmbG9hdChhdHJpYnV0ZXNbIm5waGkiXSkNCgkJCQlzaXplID0gbGVuKGJ5dGVzKSAvIEl0ZW1TaXplDQoJCQkJaW50cyA9IGJ5dGVzDQoJCQkJZ2xvYmFsIG1vZGVsSUQNCgkJCQkNCgkJCQlpZiBvcy5wYXRoLmV4aXN0cygiLi97dGVtcFBhdGh9L21vZGVsRGF0YS5qcyIpOg0KCQkJCQlvcy5yZW1vdmUoIi4ve3RlbXBQYXRofS9tb2RlbERhdGEuanMiKQ0KCQkJCWlmIG9zLnBhdGguZXhpc3RzKCIuL3t0ZW1wUGF0aH0vbm9ybWFscy5kYXQiKToNCgkJCQkJb3MucmVtb3ZlKCIuL3t0ZW1wUGF0aH0vbm9ybWFscy5kYXQiKQ0KCQkJCXdpdGggb3BlbigiLi97dGVtcFBhdGh9L21vZGVsRGF0YS5qcyIsICJhIikgYXMgbW9kZWxEYXRhOg0KCQkJCQltb2RlbElEICs9IDENCgkJCQkJbW9kZWxEYXRhLndyaXRlKCJtb2R1bGUuZXhwb3J0cy5lcHMgPSAiICsgc3RyKGVwcykgKyAiO1xuIikNCgkJCQkJbW9kZWxEYXRhLndyaXRlKCJtb2R1bGUuZXhwb3J0cy5ucGhpID0gIiArIHN0cihucGhpKSArICI7XG4iKQ0KCQkJCQltb2RlbERhdGEud3JpdGUoIm1vZHVsZS5leHBvcnRzLnNpemUgPSAiICsgc3RyKHNpemUpICsgIjtcbiIpDQoJCQkJCW1vZGVsRGF0YS53cml0ZSgibW9kdWxlLmV4cG9ydHMuaWQgPSAiICsgc3RyKG1vZGVsSUQpICsgIjtcbiIpDQoJCQkJCW1vZGVsRGF0YS53cml0ZSgibW9kdWxlLmV4cG9ydHMuaW50cyA9ICIgKyBzdHIoYnl0ZXMpICsgIjtcbiIpDQoJCQkJDQoJCQkJc3VicHJvY2Vzcy5jYWxsKCgnbm9kZS5leGUgLi97dGVtcFBhdGh9L2NhbGNWZXJ0ZXhOb3JtYWxzLmpzJykpDQoJCQkJDQoJCQkJJycnZmxvYXRGaWxlID0gb3Blbigibm9ybWFscy5kYXQiLCAiciIpDQoJCQkJZmxvYXRMaW5lcyA9IGZsb2F0RmlsZS5yZWFkbGluZXMoKQ0KCQkJCW5vcm1EYXRhID0gW10NCgkJCQlyZWFkRGF0YSA9IDANCgkJCQl3aGlsZSByZWFkRGF0YSA8IHNpemUgKiAzOg0KCQkJCQlub3JtRGF0YS5hcHBlbmQoW2Zsb2F0KGZsb2F0TGluZXNbcmVhZERhdGFdKSwgZmxvYXQoZmxvYXRMaW5lc1tyZWFkRGF0YSArIDFdKSwgZmxvYXQoZmxvYXRMaW5lc1tyZWFkRGF0YSArIDJdKV0pDQoJCQkJCXJlYWREYXRhICs9IDMNCgkJCQltZXNoLnZlcnROb3JtTGlzdCA9IG5vcm1EYXRhDQoJCQllbHNlOg0KCQkJCWxpc3QgPSBub3JtQXJyYXlbMF1bMF0NCgkJCQltZXNoLnZlcnROb3JtTGlzdCA9IGxpc3QnJycNCg0KCQlpZiBsZW4odmVydGV4QXJyYXkpID09IDE6DQoJCQlpZiB2ZXJ0ZXhBcnJheVswXVsxXSA9PSAnInZhcmludCInOg0KCQkJCWJ5dGVzID0gdmVydGV4QXJyYXlbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHZlcnRleEFycmF5WzBdWzJdDQoJCQkJaWYgbW9kZSA9PSAnIlRSSUFOR0xFX1NUUklQIic6DQoJCQkJCWJ5dGVzID0gZGVjb2RlUHJlZGljdChpbmRpY2VzLCBieXRlcywgSXRlbVNpemUpDQoJCQkJczEgPSBmbG9hdChhdHJpYnV0ZXNbInZ0eF9iYmxfeCJdKQ0KCQkJCXMyID0gZmxvYXQoYXRyaWJ1dGVzWyJ2dHhfYmJsX3kiXSkNCgkJCQlzMyA9IGZsb2F0KGF0cmlidXRlc1sidnR4X2JibF96Il0pDQoJCQkJcyA9IFtzMSwgczIsIHMzXQ0KCQkJCWExID0gZmxvYXQoYXRyaWJ1dGVzWyJ2dHhfaF94Il0pDQoJCQkJYTIgPSBmbG9hdChhdHJpYnV0ZXNbInZ0eF9oX3kiXSkNCgkJCQlhMyA9IGZsb2F0KGF0cmlidXRlc1sidnR4X2hfeiJdKQ0KCQkJCWEgPSBbYTEsIGEyLCBhM10NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJbWVzaC52ZXJ0UG9zTGlzdCA9IFsNCgkJCQkJZmxvYXRzW20gOiBtICsgSXRlbVNpemVdIGZvciBtIGluIHJhbmdlKDAsIGxlbihmbG9hdHMpLCAzKQ0KCQkJCV0NCgkJCWVsc2U6DQoJCQkJbGlzdCA9IHZlcnRleEFycmF5WzBdWzBdDQoJCQkJbWVzaC52ZXJ0UG9zTGlzdCA9IGxpc3QNCgkJDQoJCXV2TGlzdHMgPSBbXQ0KCQlpZiBsZW4odGV4QXJyYXkwKSA+PSAxOg0KCQkJaWYgdGV4QXJyYXkwWzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTBbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5MFswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl8wX2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzBfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfMF9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfMF9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5MFswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXkxKSA+PSAxOg0KCQkJaWYgdGV4QXJyYXkxWzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTFbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5MVswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl8xX2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzFfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfMV9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfMV9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5MVswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXkyKSA+PSAxOg0KCQkJaWYgdGV4QXJyYXkyWzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTJbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5MlswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl8yX2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzJfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfMl9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfMl9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5MlswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXkzKSA+PSAxOg0KCQkJaWYgdGV4QXJyYXkzWzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTNbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5M1swXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl8zX2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzNfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfM19oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfM19oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5M1swXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXk0KSA+PSAxOg0KCQkJaWYgdGV4QXJyYXk0WzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTRbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5NFswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl80X2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzRfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfNF9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfNF9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5NFswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXk1KSA+PSAxOg0KCQkJaWYgdGV4QXJyYXk1WzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTVbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5NVswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl81X2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzVfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfNV9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfNV9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5NVswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXk2KSA+PSAxOg0KCQkJaWYgdGV4QXJyYXk2WzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTZbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5NlswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl82X2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzZfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfNl9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfNl9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5NlswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXk3KSA+PSAxOg0KCQkJaWYgdGV4QXJyYXk3WzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTdbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5N1swXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl83X2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzdfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfN19oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfN19oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5N1swXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXk4KSA+PSAxOg0KCQkJaWYgdGV4QXJyYXk4WzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheThbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5OFswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl84X2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzhfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfOF9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfOF9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5OFswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXk5KSA+PSAxOg0KCQkJaWYgdGV4QXJyYXk5WzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSB0ZXhBcnJheTlbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5OVswXVsyXQ0KCQkJCWlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KCQkJCXMxID0gZmxvYXQoYXRyaWJ1dGVzWyJ1dl85X2JibF94Il0pDQoJCQkJczIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzlfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfOV9oX3giXSkNCgkJCQlhMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfOV9oX3kiXSkNCgkJCQlhID0gW2ExLCBhMl0NCgkJCQlmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQoJCQkJdXZMaXN0ID0gW10NCgkJCQlmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KCQkJCQl1LCB2ID0gZmxvYXRzW20gOiBtICsgSXRlbVNpemVdDQoJCQkJCXV2TGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCgkJCQl1dkxpc3RzLmFwcGVuZCh1dkxpc3QpDQoJCQllbHNlOg0KCQkJCXV2TGlzdHMuYXBwZW5kKHRleEFycmF5OVswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KCQlpZiBsZW4odGV4QXJyYXkxMCkgPj0gMToNCgkJCWlmIHRleEFycmF5MTBbMF1bMV0gPT0gJyJ2YXJpbnQiJzoNCgkJCQlieXRlcyA9IHRleEFycmF5MTBbMF1bMF0NCgkJCQlJdGVtU2l6ZSA9IHRleEFycmF5MTBbMF1bMl0NCgkJCQlpZiBtb2RlID09ICciVFJJQU5HTEVfU1RSSVAiJzoNCgkJCQkJYnl0ZXMgPSBkZWNvZGVQcmVkaWN0KGluZGljZXMsIGJ5dGVzLCBJdGVtU2l6ZSkNCgkJCQlzMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfMTBfYmJsX3giXSkNCgkJCQlzMiA9IGZsb2F0KGF0cmlidXRlc1sidXZfMTBfYmJsX3kiXSkNCgkJCQlzID0gW3MxLCBzMl0NCgkJCQlhMSA9IGZsb2F0KGF0cmlidXRlc1sidXZfMTBfaF94Il0pDQoJCQkJYTIgPSBmbG9hdChhdHJpYnV0ZXNbInV2XzEwX2hfeSJdKQ0KCQkJCWEgPSBbYTEsIGEyXQ0KCQkJCWZsb2F0cyA9IGRlY29kZVF1YW50aXplKGJ5dGVzLCBzLCBhLCBJdGVtU2l6ZSkNCgkJCQl1dkxpc3QgPSBbXQ0KCQkJCWZvciBtIGluIHJhbmdlKDAsIGxlbihmbG9hdHMpLCBJdGVtU2l6ZSk6DQoJCQkJCXUsIHYgPSBmbG9hdHNbbSA6IG0gKyBJdGVtU2l6ZV0NCgkJCQkJdXZMaXN0LmFwcGVuZChbdSwgMSAtIHZdKQ0KCQkJCXV2TGlzdHMuYXBwZW5kKHV2TGlzdCkNCgkJCWVsc2U6DQoJCQkJdXZMaXN0cy5hcHBlbmQodGV4QXJyYXkxMFswXVswXSkNCgkJZWxzZToNCgkJCXV2TGlzdHMuYXBwZW5kKFtdKQ0KDQoJCWlmIGxlbih1dkxpc3RzKSA+PSAxOg0KCQkJZm9yIGxpc3QgaW4gdXZMaXN0czoNCgkJCQltZXNoLnZlcnRVVkxpc3RzLmFwcGVuZChsaXN0KQ0KCXJldHVybiBtZXNoDQoNCg0KZGVmIGdldE1hdHJpeFRyYW5zZm9ybSh5cywgcGFyZW50LCBuLCBib25lUGFyZW50KToNCgkjIHdyaXRlKGxvZyxbJ01hdHJpeFRyYW5zZm9ybSddLG4pDQoJbiArPSA0DQoJYm9uZSA9IEJvbmUoKQ0KCWJvbmUubmFtZSA9IHN0cihsZW4oc2tlbGV0b24uYm9uZUxpc3QpKQ0KCXNrZWxldG9uLmJvbmVMaXN0LmFwcGVuZChib25lKQ0KCWJvbmUucGFyZW50TmFtZSA9IGJvbmVQYXJlbnQubmFtZQ0KDQoJTmFtZSA9IE5vbmUNCglmb3IgY2hpbGQgaW4gcGFyZW50LmNoaWxkcmVuOg0KCQl2YWx1ZXMgPSB5cy52YWx1ZXMoY2hpbGQuaGVhZGVyLCAiOiIpDQoJCU5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciTmFtZSInLCAnIiInKQ0KCQlpZiBOYW1lOg0KCQkJTmFtZSA9IGdldFNwbGl0TmFtZShOYW1lLCAiXyIsIC0xKQ0KCQkJIyB3cml0ZShsb2csW05hbWVdLG4pDQoJCQkjIGlmIGxlbihOYW1lKTwyNTpib25lLm5hbWU9TmFtZQ0KCQkJYm9uZUluZGVrc0xpc3RbTmFtZV0gPSBib25lLm5hbWUNCg0KCWZvciBjaGlsZCBpbiBwYXJlbnQuY2hpbGRyZW46DQoJCWlmICciTWF0cml4IicgaW4gY2hpbGQuaGVhZGVyOg0KCQkJZmxvYXRzID0geXMudmFsdWVzKGNoaWxkLmRhdGEsICJmIikNCgkJCSMgd3JpdGUobG9nLGZsb2F0cyxuKQ0KCQkJYm9uZS5tYXRyaXggPSBNYXRyaXg0eDQoZmxvYXRzKQ0KCQkJYm9uZS5tYXRyaXggKj0gYm9uZVBhcmVudC5tYXRyaXgNCglmb3IgY2hpbGQgaW4gcGFyZW50LmNoaWxkcmVuOg0KCQlpZiAnIkNoaWxkcmVuIicgaW4gY2hpbGQuaGVhZGVyOg0KCQkJZ2V0Q2hpbGRyZW4oeXMsIGNoaWxkLCBuLCBib25lKQ0KDQoNCmRlZiBnZXRTa2VsZXRvbk5vZGUoeXMsIHBhcmVudCwgbiwgYm9uZVBhcmVudCk6DQoJZ2xvYmFsIGZpcnN0bWF0cml4DQoJIyB3cml0ZShsb2csWydTa2VsZXRvbiddLG4pDQoJbiArPSA0DQoJYm9uZSA9IEJvbmUoKQ0KCWJvbmUubmFtZSA9IHN0cihsZW4oc2tlbGV0b24uYm9uZUxpc3QpKQ0KCXNrZWxldG9uLmJvbmVMaXN0LmFwcGVuZChib25lKQ0KCWJvbmUucGFyZW50TmFtZSA9IGJvbmVQYXJlbnQubmFtZQ0KDQoJZmlyc3RtYXRyaXggPSBib25lUGFyZW50Lm1hdHJpeA0KDQoJTmFtZSA9IE5vbmUNCglmb3IgY2hpbGQgaW4gcGFyZW50LmNoaWxkcmVuOg0KCQl2YWx1ZXMgPSB5cy52YWx1ZXMoY2hpbGQuaGVhZGVyLCAiOiIpDQoJCU5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciTmFtZSInLCAnIiInKQ0KCQlpZiBOYW1lOg0KCQkJTmFtZSA9IGdldFNwbGl0TmFtZShOYW1lLCAiXyIsIC0xKQ0KCQkJIyBwcmludCBOYW1lDQoJCQkjIHdyaXRlKGxvZyxbTmFtZV0sbikNCgkJCSMgaWYgbGVuKE5hbWUpPDI1OmJvbmUubmFtZT1OYW1lDQoJCQlib25lSW5kZWtzTGlzdFtOYW1lXSA9IGJvbmUubmFtZQ0KDQoJZm9yIGNoaWxkIGluIHBhcmVudC5jaGlsZHJlbjoNCgkJaWYgJyJNYXRyaXgiJyBpbiBjaGlsZC5oZWFkZXI6DQoJCQlmbG9hdHMgPSB5cy52YWx1ZXMoY2hpbGQuZGF0YSwgImYiKQ0KCQkJIyB3cml0ZShsb2csZmxvYXRzLG4pDQoJCQlib25lLm1hdHJpeCA9IE1hdHJpeDR4NChmbG9hdHMpDQoJCQlib25lLm1hdHJpeCAqPSBib25lUGFyZW50Lm1hdHJpeA0KCWZvciBjaGlsZCBpbiBwYXJlbnQuY2hpbGRyZW46DQoJCWlmICciQ2hpbGRyZW4iJyBpbiBjaGlsZC5oZWFkZXI6DQoJCQlnZXRDaGlsZHJlbih5cywgY2hpbGQsIG4sIGJvbmUpDQoNCg0KZGVmIGdldFJpZ0dlb21ldHJ5Tm9kZSh5cywgcGFyZW50LCBuLCBib25lUGFyZW50KToNCgkjIHdyaXRlKGxvZyxbJ1JpZ0dlb21ldHJ5J10sbikNCgltZXNoID0gZ2V0UmlnR2VvbWV0cnkoeXMsIHBhcmVudCwgbikNCglpZiBsZW4obWVzaC52ZXJ0UG9zTGlzdCkgPiAwOg0KCQltb2RlbC5tZXNoTGlzdC5hcHBlbmQobWVzaCkNCgkJbWVzaC5tYXRyaXggPSBib25lUGFyZW50Lm1hdHJpeA0KCQltZXNoLmRyYXcoKQ0KCQlpZiBtZXNoLm9iamVjdDoNCgkJCWlmIGxlbihtZXNoLnNraW5MaXN0KSA+IDA6DQoJCQkJaWYgQklORFBPU0UgPT0gMToNCgkJCQkJaWYgYmluZHNrZWxldG9uLm9iamVjdCBhbmQgc2tlbGV0b24ub2JqZWN0Og0KCQkJCQkJbWVzaC5vYmplY3QuZ2V0RGF0YShtZXNoPTEpLnRyYW5zZm9ybShtZXNoLm1hdHJpeCkNCgkJCQkJCW1lc2gub2JqZWN0LmdldERhdGEobWVzaD0xKS51cGRhdGUoKQ0KCQkJCQkJIyNtZXNoLm9iamVjdC5zZXRNYXRyaXgobWVzaC5tYXRyaXgpDQoJCQkJCQliaW5kUG9zZShiaW5kc2tlbGV0b24ub2JqZWN0LCBza2VsZXRvbi5vYmplY3QsIG1lc2gub2JqZWN0KQ0KCQkJCQkJIyNtZXNoLm9iamVjdC5zZXRNYXRyaXgobWVzaC5tYXRyaXguaW52ZXJ0KCkqbWVzaC5vYmplY3QubWF0cml4V29ybGQpDQoJCQkJCQlzY2VuZSA9IGJweS5kYXRhLnNjZW5lcy5hY3RpdmUNCgkJCQkJCXNjZW5lLm9iamVjdHMudW5saW5rKGJpbmRza2VsZXRvbi5vYmplY3QpDQoJCQkJZWxzZToNCgkJCQkJaWYgYmluZHNrZWxldG9uLm9iamVjdCBhbmQgc2tlbGV0b24ub2JqZWN0Og0KCQkJCQkJbWVzaC5vYmplY3QuZ2V0RGF0YShtZXNoPTEpLnRyYW5zZm9ybShtZXNoLm1hdHJpeCkNCgkJCQkJCW1lc2gub2JqZWN0LmdldERhdGEobWVzaD0xKS51cGRhdGUoKQ0KDQoJCQllbHNlOg0KCQkJCW1lc2gub2JqZWN0LnNldE1hdHJpeChtZXNoLm1hdHJpeCkNCgkJcHJpbnQgIlRyaWFuZ2xlczogIiArIHN0cihsZW4obWVzaC50cmlhbmdsZUxpc3QpKQ0KDQoJbiArPSA0DQoJZm9yIGNoaWxkIGluIHBhcmVudC5jaGlsZHJlbjoNCgkJaWYgJyJDaGlsZHJlbiInIGluIGNoaWxkLmhlYWRlcjoNCgkJCWdldENoaWxkcmVuKHlzLCBjaGlsZCwgbiwgYm9uZVBhcmVudCkNCg0KDQpkZWYgZ2V0R2VvbWV0cnlOb2RlKHlzLCBwYXJlbnQsIG4sIGJvbmVQYXJlbnQpOg0KCSMgd3JpdGUobG9nLFsnR2VvbWV0cnknXSxuKQ0KCW1lc2ggPSBnZXRHZW9tZXRyeSh5cywgcGFyZW50LCBuKQ0KCWlmIGxlbihtZXNoLnZlcnRQb3NMaXN0KSA+IDA6DQoJCW1vZGVsLm1lc2hMaXN0LmFwcGVuZChtZXNoKQ0KCQltZXNoLm1hdHJpeCA9IGJvbmVQYXJlbnQubWF0cml4DQoJCW1lc2guZHJhdygpDQoJCWlmIG1lc2gub2JqZWN0Og0KCQkJaWYgbGVuKG1lc2guc2tpbkxpc3QpID4gMDoNCgkJCQlpZiBCSU5EUE9TRSA9PSAxOg0KCQkJCQlpZiBiaW5kc2tlbGV0b24ub2JqZWN0IGFuZCBza2VsZXRvbi5vYmplY3Q6DQoJCQkJCQltZXNoLm9iamVjdC5nZXREYXRhKG1lc2g9MSkudHJhbnNmb3JtKG1lc2gubWF0cml4KQ0KCQkJCQkJbWVzaC5vYmplY3QuZ2V0RGF0YShtZXNoPTEpLnVwZGF0ZSgpDQoJCQkJCQkjI21lc2gub2JqZWN0LnNldE1hdHJpeChtZXNoLm1hdHJpeCkNCgkJCQkJCWJpbmRQb3NlKGJpbmRza2VsZXRvbi5vYmplY3QsIHNrZWxldG9uLm9iamVjdCwgbWVzaC5vYmplY3QpDQoJCQkJCQkjI21lc2gub2JqZWN0LnNldE1hdHJpeChtZXNoLm1hdHJpeC5pbnZlcnQoKSptZXNoLm9iamVjdC5tYXRyaXhXb3JsZCkNCgkJCQkJCXNjZW5lID0gYnB5LmRhdGEuc2NlbmVzLmFjdGl2ZQ0KCQkJCQkJc2NlbmUub2JqZWN0cy51bmxpbmsoYmluZHNrZWxldG9uLm9iamVjdCkNCgkJCQllbHNlOg0KCQkJCQlpZiBiaW5kc2tlbGV0b24ub2JqZWN0IGFuZCBza2VsZXRvbi5vYmplY3Q6DQoJCQkJCQltZXNoLm9iamVjdC5nZXREYXRhKG1lc2g9MSkudHJhbnNmb3JtKG1lc2gubWF0cml4KQ0KCQkJCQkJbWVzaC5vYmplY3QuZ2V0RGF0YShtZXNoPTEpLnVwZGF0ZSgpDQoNCgkJCWVsc2U6DQoJCQkJbWVzaC5vYmplY3Quc2V0TWF0cml4KG1lc2gubWF0cml4KQ0KCQlwcmludCAiVHJpYW5nbGVzOiAiICsgc3RyKGxlbihtZXNoLnRyaWFuZ2xlTGlzdCkpDQoNCgluICs9IDQNCglmb3IgY2hpbGQgaW4gcGFyZW50LmNoaWxkcmVuOg0KCQlpZiAnIkNoaWxkcmVuIicgaW4gY2hpbGQuaGVhZGVyOg0KCQkJZ2V0Q2hpbGRyZW4oeXMsIGNoaWxkLCBuLCBib25lUGFyZW50KQ0KDQoNCmRlZiBnZXRCb25lTm9kZSh5cywgcGFyZW50LCBuLCBib25lUGFyZW50KToNCgkjIHdyaXRlKGxvZyxbJ0JvbmUnXSxuKQ0KCWJvbmUgPSBCb25lKCkNCglib25lLnBhcmVudE5hbWUgPSBib25lUGFyZW50Lm5hbWUNCglib25lLm5hbWUgPSBzdHIobGVuKHNrZWxldG9uLmJvbmVMaXN0KSkNCglza2VsZXRvbi5ib25lTGlzdC5hcHBlbmQoYm9uZSkNCg0KCW4gKz0gNA0KCU5hbWUgPSBOb25lDQoJZm9yIGNoaWxkIGluIHBhcmVudC5jaGlsZHJlbjoNCgkJdmFsdWVzID0geXMudmFsdWVzKGNoaWxkLmhlYWRlciwgIjoiKQ0KCQkjIHByaW50IGNoaWxkLmhlYWRlcg0KCQlOYW1lID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk5hbWUiJywgJyIiJykNCgkJaWYgTmFtZToNCgkJCU5hbWUgPSBnZXRTcGxpdE5hbWUoTmFtZSwgIl8iLCAtMSkNCgkJCSMgd3JpdGUobG9nLFtOYW1lXSxuKQ0KCQkJIyBwcmludCBOYW1lDQoJCQkjIGlmIGxlbihOYW1lKTwyNTpib25lLm5hbWU9TmFtZQ0KCQkJYm9uZUluZGVrc0xpc3RbTmFtZV0gPSBib25lLm5hbWUNCg0KCWZvciBjaGlsZCBpbiBwYXJlbnQuY2hpbGRyZW46DQoJCWlmICciTWF0cml4IicgaW4gY2hpbGQuaGVhZGVyOg0KCQkJdmFsdWVzID0geXMudmFsdWVzKGNoaWxkLmhlYWRlciwgIjoiKQ0KCQkJZmxvYXRzID0geXMudmFsdWVzKGNoaWxkLmRhdGEsICJmIikNCgkJCWJvbmUubWF0cml4ID0gTWF0cml4NHg0KGZsb2F0cykNCgkJCWJvbmUubWF0cml4ICo9IGJvbmVQYXJlbnQubWF0cml4DQoNCgkJaWYgJyJJbnZCaW5kTWF0cml4SW5Ta2VsZXRvblNwYWNlIicgaW4gY2hpbGQuaGVhZGVyOg0KCQkJYmluZGJvbmUgPSBCb25lKCkNCgkJCSMgaWYgTmFtZTpiaW5kYm9uZS5uYW1lPU5hbWUNCgkJCWJpbmRib25lLm5hbWUgPSBib25lLm5hbWUNCgkJCWJpbmRza2VsZXRvbi5ib25lTGlzdC5hcHBlbmQoYmluZGJvbmUpDQoJCQlmbG9hdHMgPSB5cy52YWx1ZXMoY2hpbGQuZGF0YSwgImYiKQ0KCQkJIyB3cml0ZShsb2csW2Zsb2F0c10sbis0KQ0KCQkJbWF0cml4ID0gTWF0cml4NHg0KGZsb2F0cykuaW52ZXJ0KCkNCgkJCWJpbmRib25lLm1hdHJpeCA9IG1hdHJpeCAqIGZpcnN0bWF0cml4DQoNCglmb3IgY2hpbGQgaW4gcGFyZW50LmNoaWxkcmVuOg0KCQlpZiAnIkNoaWxkcmVuIicgaW4gY2hpbGQuaGVhZGVyOg0KCQkJZ2V0Q2hpbGRyZW4oeXMsIGNoaWxkLCBuLCBib25lKQ0KDQoNCmRlZiBnZXRDaGlsZHJlbih5cywgcGFyZW50LCBuLCBib25lUGFyZW50KToNCgkjIHdyaXRlKGxvZyxbJ0NoaWxkcmVuJ10sbikNCgluICs9IDQNCglmb3IgY2hpbGQgaW4gcGFyZW50LmNoaWxkcmVuOg0KCQlmb3IgYSBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCWlmICcib3NnLk1hdHJpeFRyYW5zZm9ybSInIGluIGEuaGVhZGVyOg0KCQkJCWdldE1hdHJpeFRyYW5zZm9ybSh5cywgYSwgbiwgYm9uZVBhcmVudCkNCgkJCWlmICcib3NnLk5vZGUiJyBpbiBhLmhlYWRlcjoNCgkJCQlnZXROb2RlKHlzLCBhLCBuLCBib25lUGFyZW50KQ0KCQkJaWYgJyJvc2dBbmltYXRpb24uU2tlbGV0b24iJyBpbiBhLmhlYWRlcjoNCgkJCQlnZXRTa2VsZXRvbk5vZGUoeXMsIGEsIG4sIGJvbmVQYXJlbnQpDQoJCQlpZiAnIm9zZ0FuaW1hdGlvbi5SaWdHZW9tZXRyeSInIGluIGEuaGVhZGVyOg0KCQkJCWdldFJpZ0dlb21ldHJ5Tm9kZSh5cywgYSwgbiwgYm9uZVBhcmVudCkNCgkJCWlmICcib3NnLkdlb21ldHJ5IicgaW4gYS5oZWFkZXI6DQoJCQkJZ2V0R2VvbWV0cnlOb2RlKHlzLCBhLCBuLCBib25lUGFyZW50KQ0KCQkJaWYgJyJvc2dBbmltYXRpb24uQm9uZSInIGluIGEuaGVhZGVyOg0KCQkJCWdldEJvbmVOb2RlKHlzLCBhLCBuLCBib25lUGFyZW50KQ0KDQoNCmRlZiBnZXROb2RlKHlzLCBwYXJlbnQsIG4sIGJvbmVQYXJlbnQpOg0KCSMgd3JpdGUobG9nLFsnTm9kZSddLG4pDQoJbiArPSA0DQoNCglib25lID0gQm9uZSgpDQoJYm9uZS5uYW1lID0gc3RyKGxlbihza2VsZXRvbi5ib25lTGlzdCkpDQoJc2tlbGV0b24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpDQoJYm9uZS5wYXJlbnROYW1lID0gYm9uZVBhcmVudC5uYW1lDQoJYm9uZS5tYXRyaXggPSBib25lUGFyZW50Lm1hdHJpeA0KDQoJTmFtZSA9IE5vbmUNCglmb3IgY2hpbGQgaW4gcGFyZW50LmNoaWxkcmVuOg0KCQl2YWx1ZXMgPSB5cy52YWx1ZXMoY2hpbGQuaGVhZGVyLCAiOiIpDQoJCU5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciTmFtZSInLCAnIiInKQ0KCQlpZiBOYW1lOg0KCQkJIyBOYW1lPWdldFNwbGl0TmFtZShOYW1lLCdfJywtMSkNCgkJCSMgd3JpdGUobG9nLFtOYW1lXSxuKQ0KCQkJIyBpZiBsZW4oTmFtZSk8MjU6Ym9uZS5uYW1lPU5hbWUNCgkJCWJvbmVJbmRla3NMaXN0W05hbWVdID0gYm9uZS5uYW1lDQoNCglmb3IgY2hpbGQgaW4gcGFyZW50LmNoaWxkcmVuOg0KCQlpZiAnIkNoaWxkcmVuIicgaW4gY2hpbGQuaGVhZGVyOg0KCQkJZ2V0Q2hpbGRyZW4oeXMsIGNoaWxkLCBuLCBib25lKQ0KDQoNCmRlZiBiaW5kUG9zZShiaW5kU2tlbGV0b24sIHBvc2VTa2VsZXRvbiwgbWVzaE9iamVjdCk6DQoJIyBwcmludCAnQklORFBPU0UnDQoJbWVzaCA9IG1lc2hPYmplY3QuZ2V0RGF0YShtZXNoPTEpDQoJcG9zZUJvbmVzID0gcG9zZVNrZWxldG9uLmdldERhdGEoKS5ib25lcw0KCWJpbmRCb25lcyA9IGJpbmRTa2VsZXRvbi5nZXREYXRhKCkuYm9uZXMNCgkjIG1lc2gudHJhbnNmb3JtKG1lc2hPYmplY3QubWF0cml4V29ybGQpDQoJbWVzaC51cGRhdGUoKQ0KCWZvciB2ZXJ0IGluIG1lc2gudmVydHM6DQoJCWluZGV4ID0gdmVydC5pbmRleA0KCQlza2luTGlzdCA9IG1lc2guZ2V0VmVydGV4SW5mbHVlbmNlcyhpbmRleCkNCgkJdmNvID0gdmVydC5jby5jb3B5KCkgKiBtZXNoT2JqZWN0Lm1hdHJpeFdvcmxkDQoJCXZlY3RvciA9IFZlY3RvcigpDQoJCXN1bSA9IDANCgkJZm9yIHNraW4gaW4gc2tpbkxpc3Q6DQoJCQlib25lID0gc2tpblswXQ0KCQkJd2VpZ2h0ID0gc2tpblsxXQ0KCQkJaWYgYm9uZSBpbiBiaW5kQm9uZXMua2V5cygpIGFuZCBib25lIGluIHBvc2VCb25lcy5rZXlzKCk6DQoJCQkJbWF0QSA9ICgNCgkJCQkJYmluZEJvbmVzW2JvbmVdLm1hdHJpeFsiQVJNQVRVUkVTUEFDRSJdICogYmluZFNrZWxldG9uLm1hdHJpeFdvcmxkDQoJCQkJKQ0KCQkJCW1hdEIgPSAoDQoJCQkJCXBvc2VCb25lc1tib25lXS5tYXRyaXhbIkFSTUFUVVJFU1BBQ0UiXSAqIHBvc2VTa2VsZXRvbi5tYXRyaXhXb3JsZA0KCQkJCSkNCgkJCQl2ZWN0b3IgKz0gdmNvICogbWF0QS5pbnZlcnQoKSAqIG1hdEIgKiB3ZWlnaHQNCgkJCQlzdW0gKz0gd2VpZ2h0DQoJCQllbHNlOg0KCQkJCXZlY3RvciA9IHZjbw0KCQkJCWJyZWFrDQoJCXZlcnQuY28gPSB2ZWN0b3INCgltZXNoLnVwZGF0ZSgpDQoJQmxlbmRlci5XaW5kb3cuUmVkcmF3QWxsKCkNCg0KDQpkZWYgb3NnUGFyc2VyKGZpbGVuYW1lKToNCglnbG9iYWwgc2tlbGV0b24sIGJpbmRza2VsZXRvbiwgbW9kZWwsIGJvbmVJbmRla3NMaXN0LCBmaXJzdG1hdHJpeA0KCWJvbmVJbmRla3NMaXN0ID0ge30NCgltb2RlbCA9IE1vZGVsKGZpbGVuYW1lKQ0KCXNrZWxldG9uID0gU2tlbGV0b24oKQ0KCXNrZWxldG9uLkFSTUFUVVJFU1BBQ0UgPSBUcnVlDQoJYmluZHNrZWxldG9uID0gU2tlbGV0b24oKQ0KCWJpbmRza2VsZXRvbi5OSUNFID0gVHJ1ZQ0KCWJpbmRza2VsZXRvbi5BUk1BVFVSRVNQQUNFID0gVHJ1ZQ0KCXlzID0gWXNvbigpDQoJeXMubG9nID0gVHJ1ZQ0KCXlzLmZpbGVuYW1lID0gZmlsZW5hbWUNCgl5cy5wYXJzZSgpDQoNCglmaXJzdG1hdHJpeCA9IE1hdHJpeDR4NChbMSwgMCwgMCwgMCwgMCwgMCwgMSwgMCwgMCwgLTEsIDAsIDAsIDAsIDAsIDAsIDFdKQ0KDQoJbiA9IDANCglib25lID0gQm9uZSgpDQoJYm9uZS5tYXRyaXggPSBNYXRyaXgoKS5yZXNpemU0eDQoKQ0KCWJvbmUubmFtZSA9IHN0cihsZW4oc2tlbGV0b24uYm9uZUxpc3QpKQ0KCWJvbmUubmFtZSA9ICJzY2VuZSINCglza2VsZXRvbi5ib25lTGlzdC5hcHBlbmQoYm9uZSkNCglOb2RlID0geXMuZ2V0KHlzLnJvb3QsICcib3NnLk5vZGUiJykNCglpZiBOb2RlOg0KCQlnZXROb2RlKHlzLCBOb2RlWzBdLCBuLCBib25lKQ0KCWlmIGxlbihiaW5kc2tlbGV0b24uYm9uZUxpc3QpID4gMDoNCgkJYmluZHNrZWxldG9uLmRyYXcoKQ0KDQoJZm9yIG1lc2ggaW4gbW9kZWwubWVzaExpc3Q6DQoJCWlmIGxlbihtZXNoLnNraW5MaXN0KSA+IDA6DQoJCQlmb3IgbWFwIGluIG1lc2guQm9uZU1hcDoNCgkJCQlpZiBtYXAgPT0gMDoNCgkJCQkJYnJlYWsNCgkJCQltZXNoLmJvbmVOYW1lTGlzdC5hcHBlbmQoYm9uZUluZGVrc0xpc3RbbWFwXSkNCg0KCWZvciBtZXNoIGluIG1vZGVsLm1lc2hMaXN0Og0KCQlpZiBsZW4obWVzaC5za2luTGlzdCkgPiAwOg0KCQkJc2tlbGV0b24uTklDRSA9IFRydWUNCgkJCXNrZWxldG9uLmRyYXcoKQ0KCQkJYnJlYWsNCg0KCW4gPSAwDQoJQW5pbWF0aW9ucyA9IHlzLmdldCh5cy5yb290LCAnIm9zZ0FuaW1hdGlvbi5BbmltYXRpb24iJykNCglpZiBBbmltYXRpb25zOg0KCQlmb3IgYW5pbWF0aW9uIGluIEFuaW1hdGlvbnM6DQoJCQlnZXRBbmltYXRpb24oeXMsIGFuaW1hdGlvbiwgbikNCg0KDQpkZWYgUGFyc2VyKCk6DQoJZ2xvYmFsIGxvZw0KCSMgbG9nPW9wZW4oJ2xvZy50eHQnLCd3JykNCglmaWxlbmFtZSA9IGlucHV0LmZpbGVuYW1lDQoJcHJpbnQNCglwcmludCBmaWxlbmFtZQ0KCXByaW50DQoJb3Muc3lzdGVtKCJjbHMiKQ0KCWV4dCA9IGZpbGVuYW1lLnNwbGl0KCIuIilbLTFdLmxvd2VyKCkNCglvc2dQYXJzZXIoZmlsZW5hbWUpDQoJbG9nLmNsb3NlKCkNCg0KDQpkZWYgb3BlbkZpbGUoZmxhZ0xpc3QpOg0KCWdsb2JhbCBpbnB1dCwgb3V0cHV0DQoJaW5wdXQgPSBJbnB1dChmbGFnTGlzdCkNCglvdXRwdXQgPSBPdXRwdXQoZmxhZ0xpc3QpDQoJcGFyc2VyID0gUGFyc2VyKCkNCg0KbW9kZWxJRCA9IDANCm9zZ1BhcnNlcigiLi97dGVtcFBhdGh9L2ZpbGUub3NnanMiKQ0K"));
			blenderScript = blenderScript.Replace("{tempPath}", tempDir);
			if (bindPose == 0)
			{
				blenderScript = blenderScript.Replace("BINDPOSE = 1", "BINDPOSE = 0");
			}
			if (indexFix)
			{
				blenderScript = blenderScript.Replace("indexFix = False", "indexFix = True");
			}
			return blenderScript;
		}

		public static string RiggedAnimated(int bindPose = 1, bool indexFix = false, bool animated = false, string fileName = "./_sfTemp/file.osgjs")
		{
			string blenderScript = Encoding.UTF8.GetString(Convert.FromBase64String("IyEvdXNyL2Jpbi9weXRob24NCiMgLSotIGNvZGluZzogdXRmLTggLSotDQppbXBvcnQgbmV3R2FtZUxpYiwgQmxlbmRlciwgYXJyYXksIHN1YnByb2Nlc3MsIHN5cyBhcyBzeXMyDQpmcm9tIG5ld0dhbWVMaWIgaW1wb3J0ICoNCg0KZGVmIGdldE1hdE5hbWUoeXMsIHBhcmVudCk6DQogICAgbWF0TmFtZSA9IE5vbmUNCiAgICBpZiBtYXROYW1lIG5vdCBpbiBNQVRFUklBTFMua2V5cygpOg0KICAgICAgICBVbmlxdWVJRCA9IHlzLmdldChwYXJlbnQsICciVW5pcXVlSUQiJykNCiAgICAgICAgaWYgVW5pcXVlSUQ6DQogICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoVW5pcXVlSURbMF0uaGVhZGVyLCAncycpDQogICAgICAgICAgICBpZiBsZW4odmFsdWVzKSA+IDE6DQogICAgICAgICAgICAgICAgaWYgJyInIGluIHZhbHVlc1sxXSBhbmQgJ18nIGluIHZhbHVlc1sxXToNCiAgICAgICAgICAgICAgICAgICAgbWF0TmFtZSA9IHZhbHVlc1sxXS5zcGxpdCgnIicpWzNdLnNwbGl0KCdfJylbLTJdDQogICAgcmdiYSA9IE5vbmUNCiAgICBBdHRyaWJ1dGVMaXN0ID0geXMuZ2V0KHBhcmVudCwgJyJBdHRyaWJ1dGVMaXN0IicpDQogICAgaWYgQXR0cmlidXRlTGlzdDoNCiAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKEF0dHJpYnV0ZUxpc3RbMF0uaGVhZGVyLCAnOicpDQogICAgICAgIFVuaXF1ZUlEID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlVuaXF1ZUlEIicsICdpJykNCiAgICAgICAgRGlmZnVzZSA9IHlzLmdldChwYXJlbnQsICciRGlmZnVzZSInKQ0KICAgICAgICBpZiBEaWZmdXNlOg0KICAgICAgICAgICAgcmdiYSA9IHlzLnZhbHVlcyhEaWZmdXNlWzBdLmRhdGEsICdmJykNCiAgICAgICAgaWYgbWF0TmFtZSBub3QgaW4gTUFURVJJQUxTLmtleXMoKToNCiAgICAgICAgICAgIE1hdGVyaWFsID0geXMuZ2V0KEF0dHJpYnV0ZUxpc3RbMF0sICcib3NnLk1hdGVyaWFsIicpDQogICAgICAgICAgICBpZiBNYXRlcmlhbDoNCiAgICAgICAgICAgICAgICBmb3IgYSBpbiBNYXRlcmlhbFswXS5jaGlsZHJlbjoNCiAgICAgICAgICAgICAgICAgICAgaWYgJyJOYW1lIicgaW4gYS5oZWFkZXI6DQogICAgICAgICAgICAgICAgICAgICAgICBzcGxpdHMgPSBhLmhlYWRlci5zcGxpdCgnIicpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBsZW4oc3BsaXRzKSA+IDQ6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0TmFtZSA9IHNwbGl0c1s1XQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICc6JyBpbiBtYXROYW1lOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXROYW1lID0gbWF0TmFtZS5yZXBsYWNlKCc6JywgJycpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwubWF0TGlzdFtVbmlxdWVJRF0gPSBtYXROYW1lDQogICAgaWYgbWF0TmFtZSBub3QgaW4gTUFURVJJQUxTLmtleXMoKToNCiAgICAgICAgU3RhdGVTZXQgPSB5cy5nZXQocGFyZW50LCAnIlN0YXRlU2V0IicpDQogICAgICAgIGlmIFN0YXRlU2V0Og0KICAgICAgICAgICAgb3NnU3RhdGVTZXQgPSB5cy5nZXQoU3RhdGVTZXRbMF0sICcib3NnLlN0YXRlU2V0IicpDQogICAgICAgICAgICBpZiBvc2dTdGF0ZVNldDoNCiAgICAgICAgICAgICAgICBpZiBsZW4ob3NnU3RhdGVTZXRbMF0uY2hpbGRyZW4pID4gMDoNCiAgICAgICAgICAgICAgICAgICAgZm9yIGNoaWxkIGluIG9zZ1N0YXRlU2V0WzBdLmNoaWxkcmVuOg0KICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKGNoaWxkLmhlYWRlciwgJzonKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJVbmlxdWVJRCInIGluIHZhbHVlcyBhbmQgJyJOYW1lIicgaW4gdmFsdWVzOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVuaXF1ZUlEID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlVuaXF1ZUlEIicsICdpJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXROYW1lID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk5hbWUiJywgJyIiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5tYXRMaXN0W1VuaXF1ZUlEXSA9IG1hdE5hbWUNCiAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMob3NnU3RhdGVTZXRbMF0uZGF0YSwgJzonKQ0KICAgICAgICAgICAgICAgICAgICBpZiAnIkF0dHJpYnV0ZUxpc3QiJyBub3QgaW4gdmFsdWVzOg0KICAgICAgICAgICAgICAgICAgICAgICAgVW5pcXVlSUQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciVW5pcXVlSUQiJywgJ2knKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgVW5pcXVlSUQgaW4gbW9kZWwubWF0TGlzdDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXROYW1lID0gbW9kZWwubWF0TGlzdFtVbmlxdWVJRF0NCiAgICBpZiBtYXROYW1lOg0KICAgICAgICBpZiBsZW4obWF0TmFtZSkgPT0gMDoNCiAgICAgICAgICAgIG1hdE5hbWUgPSAnUm9vdE5vZGUnDQogICAgICAgIGlmICdceGVmJyBpbiBtYXROYW1lOg0KICAgICAgICAgICAgbWF0TmFtZSA9IG1hdE5hbWUuc3BsaXQoJ1x4ZWYnKVswXQ0KICAgIGRpZmZ1c2UgPSBOb25lDQogICAgbm9ybWFsID0gTm9uZQ0KICAgIHNwZWN1bGFyID0gTm9uZQ0KICAgIHRyYW5zID0gTm9uZQ0KICAgIGFvID0gTm9uZQ0KICAgIHJnYkNvbCA9IE5vbmUNCiAgICByZ2JTcGVjID0gTm9uZQ0KICAgIGlmIGxlbihNQVRFUklBTFMua2V5cygpKSA9PSAxOg0KICAgICAgICBrZXkgPSBNQVRFUklBTFMua2V5cygpWzBdDQogICAgICAgIGZvciBpbWFnZVR5cGUgaW4gTUFURVJJQUxTW2tleV06DQogICAgICAgICAgICBpZiBNQVRFUklBTFNba2V5XVtpbWFnZVR5cGVdWzBdID09ICd0ZXh0dXJlJzoNCiAgICAgICAgICAgICAgICBoYXNoID0gTUFURVJJQUxTW2tleV1baW1hZ2VUeXBlXVsxXQ0KICAgICAgICAgICAgICAgIGlmIGhhc2ggaW4gSU1BR0VTLmtleXMoKToNCiAgICAgICAgICAgICAgICAgICAgaWYgSU1BR0VTW2hhc2hdWydSR0InXToNCiAgICAgICAgICAgICAgICAgICAgICAgIChwYXRoLCBleGlzdHMsIHF1YWxpdHkpID0gSU1BR0VTW2hhc2hdWydSR0InXQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgZXhpc3RzID09IDE6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaW1hZ2VUeXBlID09ICdPcGFjaXR5JzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnMgPSBwYXRoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaW1hZ2VUeXBlID09ICdBbGJlZG9QQlInOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmdXNlID0gcGF0aA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGltYWdlVHlwZSA9PSAnRGlmZnVzZUNvbG9yJzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZnVzZSA9IHBhdGgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ05vcm1hbE1hcCc6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vcm1hbCA9IHBhdGgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ1NwZWN1bGFyQ29sb3InOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGVjdWxhciA9IHBhdGgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ0RpZmZ1c2VQQlInOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmdXNlID0gcGF0aA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGltYWdlVHlwZSA9PSAnU3BlY3VsYXJGMCc6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwZWN1bGFyID0gcGF0aA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGltYWdlVHlwZSA9PSAnU3BlY3VsYXJDb2xvcic6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwZWN1bGFyID0gcGF0aA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGltYWdlVHlwZSA9PSAnRGlmZnVzZUludGVuc2l0eSc6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFvID0gcGF0aA0KICAgICAgICAgICAgICAgICAgICBpZiBJTUFHRVNbaGFzaF1bJ0EnXToNCiAgICAgICAgICAgICAgICAgICAgICAgIChwYXRoLCBleGlzdHMsIHF1YWxpdHkpID0gSU1BR0VTW2hhc2hdWydBJ10NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGV4aXN0cyA9PSAxOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zID0gcGF0aA0KICAgICAgICAgICAgICAgICAgICBpZiBJTUFHRVNbaGFzaF1bJ04nXToNCiAgICAgICAgICAgICAgICAgICAgICAgIChwYXRoLCBleGlzdHMsIHF1YWxpdHkpID0gSU1BR0VTW2hhc2hdWydOJ10NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGV4aXN0cyA9PSAxOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGltYWdlVHlwZSA9PSAnTm9ybWFsTWFwJzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsID0gcGF0aA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGltYWdlVHlwZSA9PSAnQnVtcE1hcCc6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vcm1hbCA9IHBhdGgNCiAgICAgICAgICAgICAgICAgICAgaWYgSU1BR0VTW2hhc2hdWydSJ106DQogICAgICAgICAgICAgICAgICAgICAgICAocGF0aCwgZXhpc3RzLCBxdWFsaXR5KSA9IElNQUdFU1toYXNoXVsnUiddDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBleGlzdHMgPT0gMToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ09wYWNpdHknOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFucyA9IHBhdGgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ1NwZWN1bGFyRjAnOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGVjdWxhciA9IHBhdGgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ0FPUEJSJzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW8gPSBwYXRoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaW1hZ2VUeXBlID09ICdSb3VnaG5lc3NQQlInOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGVjdWxhciA9IHBhdGgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ0dsb3NzaW5lc3NQQlInOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGVjdWxhciA9IHBhdGgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ0J1bXBNYXAnOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3JtYWwgPSBwYXRoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaW1hZ2VUeXBlID09ICdTcGVjdWxhckNvbG9yJzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BlY3VsYXIgPSBwYXRoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaW1hZ2VUeXBlID09ICdEaWZmdXNlSW50ZW5zaXR5JzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW8gPSBwYXRoDQogICAgICAgICAgICBpZiBNQVRFUklBTFNba2V5XVtpbWFnZVR5cGVdWzBdID09ICdjb2xvcic6DQogICAgICAgICAgICAgICAgaWYgaW1hZ2VUeXBlID09ICdEaWZmdXNlQ29sb3InOg0KICAgICAgICAgICAgICAgICAgICByZ2JDb2wgPSBNQVRFUklBTFNba2V5XVtpbWFnZVR5cGVdWzFdDQogICAgZWxzZToNCiAgICAgICAgZm9yIGtleSBpbiBNQVRFUklBTFMua2V5cygpOg0KICAgICAgICAgICAgaWYga2V5ID09IG1hdE5hbWU6DQogICAgICAgICAgICAgICAgZm9yIGltYWdlVHlwZSBpbiBNQVRFUklBTFNba2V5XToNCiAgICAgICAgICAgICAgICAgICAgaWYgTUFURVJJQUxTW2tleV1baW1hZ2VUeXBlXVswXSA9PSAndGV4dHVyZSc6DQogICAgICAgICAgICAgICAgICAgICAgICBoYXNoID0gTUFURVJJQUxTW2tleV1baW1hZ2VUeXBlXVsxXQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgaGFzaCBpbiBJTUFHRVMua2V5cygpOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIElNQUdFU1toYXNoXVsnUkdCJ106DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChwYXRoLCBleGlzdHMsIHF1YWxpdHkpID0gSU1BR0VTW2hhc2hdWydSR0InXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBleGlzdHMgPT0gMToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGltYWdlVHlwZSA9PSAnQWxiZWRvUEJSJzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmdXNlID0gcGF0aA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaW1hZ2VUeXBlID09ICdEaWZmdXNlQ29sb3InOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZ1c2UgPSBwYXRoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ0RpZmZ1c2VQQlInOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZ1c2UgPSBwYXRoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ05vcm1hbE1hcCc6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsID0gcGF0aA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaW1hZ2VUeXBlID09ICdFbWl0Q29sb3InOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZ1c2UgPSBwYXRoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ1NwZWN1bGFyUEJSJzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGVjdWxhciA9IHBhdGgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGltYWdlVHlwZSA9PSAnT3BhY2l0eSc6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnMgPSBwYXRoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ1NwZWN1bGFyRjAnOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwZWN1bGFyID0gcGF0aA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaW1hZ2VUeXBlID09ICdTcGVjdWxhckNvbG9yJzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGVjdWxhciA9IHBhdGgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGltYWdlVHlwZSA9PSAnRGlmZnVzZUludGVuc2l0eSc6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW8gPSBwYXRoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgSU1BR0VTW2hhc2hdWydBJ106DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChwYXRoLCBleGlzdHMsIHF1YWxpdHkpID0gSU1BR0VTW2hhc2hdWydBJ10NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZXhpc3RzID09IDE6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFucyA9IHBhdGgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBJTUFHRVNbaGFzaF1bJ04nXToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHBhdGgsIGV4aXN0cywgcXVhbGl0eSkgPSBJTUFHRVNbaGFzaF1bJ04nXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBleGlzdHMgPT0gMToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGltYWdlVHlwZSA9PSAnTm9ybWFsTWFwJzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3JtYWwgPSBwYXRoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ0J1bXBNYXAnOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vcm1hbCA9IHBhdGgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBJTUFHRVNbaGFzaF1bJ1InXToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHBhdGgsIGV4aXN0cywgcXVhbGl0eSkgPSBJTUFHRVNbaGFzaF1bJ1InXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBleGlzdHMgPT0gMToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGltYWdlVHlwZSA9PSAnT3BhY2l0eSc6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnMgPSBwYXRoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ1NwZWN1bGFyRjAnOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwZWN1bGFyID0gcGF0aA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaW1hZ2VUeXBlID09ICdBT1BCUic6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW8gPSBwYXRoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ1JvdWdobmVzc1BCUic6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BlY3VsYXIgPSBwYXRoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ0dsb3NzaW5lc3NQQlInOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwZWN1bGFyID0gcGF0aA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaW1hZ2VUeXBlID09ICdCdW1wTWFwJzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3JtYWwgPSBwYXRoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ1NwZWN1bGFyQ29sb3InOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwZWN1bGFyID0gcGF0aA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaW1hZ2VUeXBlID09ICdEaWZmdXNlSW50ZW5zaXR5JzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbyA9IHBhdGgNCiAgICAgICAgICAgICAgICAgICAgaWYgTUFURVJJQUxTW2tleV1baW1hZ2VUeXBlXVswXSA9PSAnY29sb3InOg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgaW1hZ2VUeXBlID09ICdEaWZmdXNlQ29sb3InOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJnYkNvbCA9IE1BVEVSSUFMU1trZXldW2ltYWdlVHlwZV1bMV0NCiAgICBUZXh0dXJlQXR0cmlidXRlTGlzdCA9IHlzLmdldChwYXJlbnQsICciVGV4dHVyZUF0dHJpYnV0ZUxpc3QiJykNCiAgICBpZiBUZXh0dXJlQXR0cmlidXRlTGlzdDoNCiAgICAgICAgb3NnX1RleHR1cmUgPSB5cy5nZXQocGFyZW50LCAnIm9zZy5UZXh0dXJlIicpDQogICAgICAgIGlmIG9zZ19UZXh0dXJlOg0KICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKG9zZ19UZXh0dXJlWzBdLmRhdGEsICc6JykNCiAgICAgICAgICAgIGhhc2ggPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInLCAnIiInKQ0KICAgICAgICAgICAgaWYgaGFzaDoNCiAgICAgICAgICAgICAgICBpZiAnLycgaW4gaGFzaDoNCiAgICAgICAgICAgICAgICAgICAgaGFzaCA9IGhhc2guc3BsaXQoJy8nKVsxXQ0KICAgICAgICAgICAgICAgICAgICBpZiBoYXNoIGluIElNQUdFUy5rZXlzKCk6DQogICAgICAgICAgICAgICAgICAgICAgICBpZiBJTUFHRVNbaGFzaF1bJ1JHQiddOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIChwYXRoLCBleGlzdHMsIHF1YWxpdHkpID0gSU1BR0VTW2hhc2hdWydSR0InXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGV4aXN0cyA9PSAxOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmdXNlID0gcGF0aA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgSU1BR0VTW2hhc2hdWydBJ106DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKHBhdGgsIGV4aXN0cywgcXVhbGl0eSkgPSBJTUFHRVNbaGFzaF1bJ0EnXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGV4aXN0cyA9PSAxOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFucyA9IHBhdGgNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIElNQUdFU1toYXNoXVsnTiddOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIChwYXRoLCBleGlzdHMsIHF1YWxpdHkpID0gSU1BR0VTW2hhc2hdWydOJ10NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBleGlzdHMgPT0gMToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaW1hZ2VUeXBlID09ICdOb3JtYWxNYXAnOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsID0gcGF0aA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpbWFnZVR5cGUgPT0gJ0J1bXBNYXAnOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsID0gcGF0aA0KICAgIHJldHVybiAobWF0TmFtZSwgZGlmZnVzZSwgc3BlY3VsYXIsIG5vcm1hbCwgYW8sIHRyYW5zLCByZ2JDb2wsIHJnYlNwZWMsIHJnYmEpDQpkZWYgZ2V0U3BsaXROYW1lKG5hbWUsIHdoYXQsIHdoaWNoKToNCiAgICBhID0gTm9uZQ0KICAgIGlmIHdoYXQgaW4gbmFtZToNCiAgICAgICAgYSA9ICcnDQogICAgICAgIHNwbGl0cyA9IG5hbWUuc3BsaXQod2hhdCkNCiAgICAgICAgaWYgd2hpY2ggPCAwOg0KICAgICAgICAgICAgbnVtID0gbGVuKHNwbGl0cykgKyB3aGljaCAtIDENCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIG51bSA9IHdoaWNoDQogICAgICAgIGlmIG51bSA8IDA6DQogICAgICAgICAgICBhID0gbmFtZQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgaWYgd2hpY2ggPCBsZW4oc3BsaXRzKToNCiAgICAgICAgICAgICAgICBmb3IgbSBpbiByYW5nZShudW0pOg0KICAgICAgICAgICAgICAgICAgICBhICs9IHNwbGl0c1ttXSArIHdoYXQNCiAgICAgICAgICAgICAgICBhICs9IHNwbGl0c1tudW1dDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIGEgPSBuYW1lDQogICAgcmV0dXJuIGENCmRlZiBldGFwMShpbnB1dCwgSXRlbVNpemUpOg0KICAgIG4gPSBsZW4oaW5wdXQpIC8gSXRlbVNpemUNCiAgICByID0gMA0KICAgIG91dHB1dCA9IFswXSAqIGxlbihpbnB1dCkNCiAgICB3aGlsZSByIDwgbjoNCiAgICAgICAgYSA9IHIgKiBJdGVtU2l6ZQ0KICAgICAgICBzID0gMA0KICAgICAgICB3aGlsZSBzIDwgSXRlbVNpemU6DQogICAgICAgICAgICBvdXRwdXRbYSArIHNdID0gaW5wdXRbciArIG4gKiBzXQ0KICAgICAgICAgICAgcyArPSAxDQogICAgICAgIHIgKz0gMQ0KICAgIHJldHVybiBvdXRwdXQNCmRlZiBldGFwMihpbnB1dCwgSXRlbVNpemUsIGF0cmlidXRlcyk6DQogICAgaSA9IFthdHJpYnV0ZXNbJyJieCInXSwgYXRyaWJ1dGVzWyciYnkiJ10sIGF0cmlidXRlc1snImJ6IiddXQ0KICAgIG4gPSBbYXRyaWJ1dGVzWyciaHgiJ10sIGF0cmlidXRlc1snImh5IiddLCBhdHJpYnV0ZXNbJyJoeiInXV0NCiAgICBhID0gbGVuKGlucHV0KSAvIEl0ZW1TaXplDQogICAgcyA9IDANCiAgICBvdXRwdXQgPSBbMF0gKiBsZW4oaW5wdXQpDQogICAgd2hpbGUgcyA8IGE6DQogICAgICAgIG8gPSBzICogSXRlbVNpemUNCiAgICAgICAgdSA9IDANCiAgICAgICAgd2hpbGUgdSA8IEl0ZW1TaXplOg0KICAgICAgICAgICAgb3V0cHV0W28gKyB1XSA9IGlbdV0gKyBpbnB1dFtvICsgdV0gKiBuW3VdDQogICAgICAgICAgICB1ICs9IDENCiAgICAgICAgcyArPSAxDQogICAgcmV0dXJuIG91dHB1dA0KZGVmIGV0YXAzKGlucHV0LCBJdGVtU2l6ZSk6DQogICAgaSA9IEl0ZW1TaXplIHwgMQ0KICAgIG4gPSAxDQogICAgciA9IGxlbihpbnB1dCkgLyBpDQogICAgd2hpbGUgbiA8IHI6DQogICAgICAgIGEgPSAobiAtIDEpICogaQ0KICAgICAgICBzID0gbiAqIGkNCiAgICAgICAgbyA9IDANCiAgICAgICAgd2hpbGUgbyA8IGk6DQogICAgICAgICAgICBpbnB1dFtzICsgb10gKz0gaW5wdXRbYSArIG9dDQogICAgICAgICAgICBvICs9IDENCiAgICAgICAgbiArPSAxDQogICAgcmV0dXJuIGlucHV0DQpkZWYgZXRhcDQoaW5wdXQpOg0KICAgIGUgPSAxDQogICAgaSA9IGxlbihpbnB1dCkgLyA0DQogICAgd2hpbGUgZSA8IGk6DQogICAgICAgIG4gPSA0ICogKGUgLSAxKQ0KICAgICAgICByID0gNCAqIGUNCiAgICAgICAgYSA9IGlucHV0W25dDQogICAgICAgIHMgPSBpbnB1dFtuICsgMV0NCiAgICAgICAgbyA9IGlucHV0W24gKyAyXQ0KICAgICAgICB1ID0gaW5wdXRbbiArIDNdDQogICAgICAgIGwgPSBpbnB1dFtyXQ0KICAgICAgICBoID0gaW5wdXRbciArIDFdDQogICAgICAgIGMgPSBpbnB1dFtyICsgMl0NCiAgICAgICAgZCA9IGlucHV0W3IgKyAzXQ0KICAgICAgICBpbnB1dFtyXSA9IGEgKiBkICsgcyAqIGMgLSBvICogaCArIHUgKiBsDQogICAgICAgIGlucHV0W3IgKyAxXSA9IC1hICogYyArIHMgKiBkICsgbyAqIGwgKyB1ICogaA0KICAgICAgICBpbnB1dFtyICsgMl0gPSBhICogaCAtIHMgKiBsICsgbyAqIGQgKyB1ICogYw0KICAgICAgICBpbnB1dFtyICsgM10gPSAtYSAqIGwgLSBzICogaCAtIG8gKiBjICsgdSAqIGQNCiAgICAgICAgZSArPSAxDQogICAgcmV0dXJuIGlucHV0DQpkZWYgaW50M2Zsb2F0NChpbnB1dCwgYXRyaWJ1dGVzLCBJdGVtU2l6ZSk6DQogICAgYyA9IDQNCiAgICBkID0gYXRyaWJ1dGVzWyciZXBzaWxvbiInXQ0KICAgIHAgPSBpbnQoYXRyaWJ1dGVzWycibnBoaSInXSkNCiAgICBlID0gWzBdICogbGVuKGlucHV0KSAqIDQNCiAgICBpID0gMS41NzA3OTYzMjY3OQ0KICAgIG4gPSA2LjI4MzE4NTMwNzE4DQogICAgciA9IDMuMTQxNTkyNjUzNTkNCiAgICBhID0gMC4wMTc0NTMyOTI1MQ0KICAgIHMgPSAwLjI1DQogICAgbyA9IDcyMA0KICAgIHUgPSA4MzINCiAgICBsID0gNDc5MzgzNjI1ODQxNTE2MzVlLTIxDQogICAgaCA9IHt9DQogICAgZiA9IFRydWUNCiAgICBkID0gZCBvciBzDQogICAgcCA9IHAgb3Igbw0KICAgIGcgPSBtYXRoLmNvcyhkICogYSkNCiAgICBtID0gMA0KICAgIHYgPSAwDQogICAgXyA9IFtdDQogICAgdiA9IChwICsgMSkgKiAodSArIDEpICogMw0KICAgIF8gPSBbTm9uZV0gKiB2DQogICAgYiA9IHIgLyBmbG9hdChwIC0gMSkNCiAgICB4ID0gaSAvIGZsb2F0KHAgLSAxKQ0KICAgIGlmIGY6DQogICAgICAgIHkgPSAzDQogICAgZWxzZToNCiAgICAgICAgeSA9IDINCiAgICBtID0gMA0KICAgIHYgPSBsZW4oaW5wdXQpIC8geQ0KICAgIHdoaWxlIG0gPCB2Og0KICAgICAgICBBID0gbSAqIGMNCiAgICAgICAgUyA9IG0gKiB5DQogICAgICAgIEMgPSBpbnB1dFtTXQ0KICAgICAgICB3ID0gaW5wdXRbUyArIDFdDQogICAgICAgIGlmIGMgPT0gMDoNCiAgICAgICAgICAgIGlmIGYgPT0gMDoNCiAgICAgICAgICAgICAgICBpZiBDICYgLTEwMjUgIT0gNDoNCiAgICAgICAgICAgICAgICAgICAgZVtBICsgM10gPSAtMQ0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIGVbQSArIDNdID0gMQ0KICAgICAgICBNID0gTm9uZQ0KICAgICAgICBUID0gTm9uZQ0KICAgICAgICBFID0gTm9uZQ0KICAgICAgICBJID0gMyAqIChDICsgcCAqIHcpDQogICAgICAgIE0gPSBfW0ldDQogICAgICAgIGlmIE0gPT0gTm9uZToNCiAgICAgICAgICAgIE4gPSBDICogYg0KICAgICAgICAgICAgayA9IGNvcyhOKQ0KICAgICAgICAgICAgRiA9IHNpbihOKQ0KICAgICAgICAgICAgTiArPSB4DQogICAgICAgICAgICBEID0gKGcgLSBrICogY29zKE4pKSAvIGZsb2F0KG1heCgxZS01LCBGICogc2luKE4pKSkNCiAgICAgICAgICAgIGlmIEQgPiAxOg0KICAgICAgICAgICAgICAgIEQgPSAxDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIGlmIEQgPCAtMToNCiAgICAgICAgICAgICAgICAgICAgRCA9IC0xDQogICAgICAgICAgICBQID0gdyAqIG4gLyBmbG9hdChtYXRoLmNlaWwociAvIGZsb2F0KG1heCgxZS01LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0aC5hY29zKEQpKSkpKQ0KICAgICAgICAgICAgTSA9IF9bSV0gPSBGICogbWF0aC5jb3MoUCkNCiAgICAgICAgICAgIFQgPSBfW0kgKyAxXSA9IEYgKiBtYXRoLnNpbihQKQ0KICAgICAgICAgICAgRSA9IF9bSSArIDJdID0gaw0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgVCA9IF9bSSArIDFdDQogICAgICAgICAgICBFID0gX1tJICsgMl0NCiAgICAgICAgaWYgZjoNCiAgICAgICAgICAgIFIgPSBpbnB1dFtTICsgMl0gKiBsDQogICAgICAgICAgICBPID0gbWF0aC5zaW4oUikNCiAgICAgICAgICAgIGVbQV0gPSBPICogTQ0KICAgICAgICAgICAgZVtBICsgMV0gPSBPICogVA0KICAgICAgICAgICAgZVtBICsgMl0gPSBPICogRQ0KICAgICAgICAgICAgZVtBICsgM10gPSBtYXRoLmNvcyhSKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgZVtBXSA9IE0NCiAgICAgICAgICAgIGVbQSArIDFdID0gVA0KICAgICAgICAgICAgZVtBICsgMl0gPSBFDQogICAgICAgIG0gKz0gMQ0KICAgIHJldHVybiBlDQpkZWYgZ2V0QW5pbWF0aW9uKHlzLCBBLCBuKToNCiAgICBhY3Rpb24gPSBBY3Rpb24oKQ0KICAgIGFjdGlvbi5CT05FU1BBQ0UgPSBUcnVlDQogICAgYWN0aW9uLkZSQU1FU09SVCA9IFRydWUNCiAgICBhY3Rpb24uc2tlbGV0b24gPSBza2VsZXRvbi5uYW1lDQogICAgbiArPSA0DQogICAgQ2hhbm5lbHMgPSB5cy5nZXQoQSwgJyJDaGFubmVscyInKQ0KICAgIGJvbmVMaXN0ID0ge30NCiAgICBpZiBDaGFubmVsczoNCiAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKENoYW5uZWxzWzBdLmhlYWRlciwgJzonKQ0KICAgICAgICBOYW1lID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk5hbWUiJykNCiAgICAgICAgYWN0aW9uLm5hbWUgPSBOYW1lDQogICAgICAgIG5ldyA9IE5ldyhOYW1lLnJlcGxhY2UoJyInLCAnJykucmVwbGFjZSgnfCcsICcnKSArICcuYWN0aW9uJywgJ3diJywgc3lzKS5vcGVuKCkNCiAgICAgICAgcHJpbnQgbmV3DQogICAgICAgIGZvciBhIGluIENoYW5uZWxzWzBdLmNoaWxkcmVuOg0KICAgICAgICAgICAgVmVjM0xlcnBDaGFubmVsID0geXMuZ2V0KGEsICcib3NnQW5pbWF0aW9uLlZlYzNMZXJwQ2hhbm5lbCInKQ0KICAgICAgICAgICAgaWYgVmVjM0xlcnBDaGFubmVsOg0KICAgICAgICAgICAgICAgIEtleUZyYW1lcyA9IHlzLmdldChhLCAnIktleUZyYW1lcyInKQ0KICAgICAgICAgICAgICAgIGlmIEtleUZyYW1lczoNCiAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKEtleUZyYW1lc1swXS5oZWFkZXIsICc6JykNCiAgICAgICAgICAgICAgICAgICAgTmFtZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJOYW1lIicpDQogICAgICAgICAgICAgICAgICAgIFRhcmdldE5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciVGFyZ2V0TmFtZSInLCAnIiInKQ0KICAgICAgICAgICAgICAgICAgICBuYW1lID0gZ2V0U3BsaXROYW1lKFRhcmdldE5hbWUsICdfJywgLTEpDQogICAgICAgICAgICAgICAgICAgIGlmIE5hbWUgPT0gJyJ0cmFuc2xhdGUiJzoNCiAgICAgICAgICAgICAgICAgICAgICAgIGJvbmUgPSBOb25lDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBUYXJnZXROYW1lIGluIGJvbmVJbmRla3NMaXN0Og0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSBib25lSW5kZWtzTGlzdFtUYXJnZXROYW1lXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5hbWUgbm90IGluIGJvbmVMaXN0LmtleXMoKToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9uZSA9IEFjdGlvbkJvbmUoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvbmUubmFtZSA9IG5hbWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9uZUxpc3RbbmFtZV0gPSBib25lDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9uZSA9IGJvbmVMaXN0W25hbWVdDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIEtleSA9IHlzLmdldChhLCAnIktleSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgS2V5Og0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhLZXlbMF0uZGF0YSwgJzonKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEl0ZW1TaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkl0ZW1TaXplIicsICdpJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBGbG9hdDMyQXJyYXkgPSB5cy5nZXQoS2V5WzBdLCAnIkZsb2F0MzJBcnJheSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIEZsb2F0MzJBcnJheToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCAnOicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gb3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKSArIG9zLnNlcCArIEZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMocGF0aCk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlID0gb3BlbihwYXRoLCAncmInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZy5zZWVrKGludChPZmZzZXQpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgYm9uZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcud3JpdGUoYm9uZS5uYW1lICsgJ1x4MDAnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldy53cml0ZSgndHJhbnNsYXRlJyArICdceDAwJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcuaShbaW50KFNpemUpXSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBtIGluIHJhbmdlKGludChTaXplKSk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBnLmYoSXRlbVNpemUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgYm9uZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3LmYodmFsdWUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvbmVNYXRyaXggPSBza2VsZXRvbi5vYmplY3QuZ2V0RGF0YSgpLmJvbmVzW2JvbmUubmFtZV0ubWF0cml4WydBUk1BVFVSRVNQQUNFJ10NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0cml4ID0gVmVjdG9yTWF0cml4KHZhbHVlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib25lLnBvc0tleUxpc3QuYXBwZW5kKG1hdHJpeCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUuY2xvc2UoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgVGltZSA9IHlzLmdldChhLCAnIlRpbWUiJykNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIFRpbWU6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKFRpbWVbMF0uZGF0YSwgJzonKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEl0ZW1TaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkl0ZW1TaXplIicsICdpJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBGbG9hdDMyQXJyYXkgPSB5cy5nZXQoVGltZVswXSwgJyJGbG9hdDMyQXJyYXkiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBGbG9hdDMyQXJyYXk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgJzonKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IG9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkgKyBvcy5zZXAgKyBGaWxlLnNwbGl0KCciJylbMV0uc3BsaXQoJy5neicpWzBdDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZSA9IG9wZW4ocGF0aCwgJ3JiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcuc2VlayhpbnQoT2Zmc2V0KSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGJvbmU6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3LmkoW2ludChTaXplKV0pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgbSBpbiByYW5nZShpbnQoU2l6ZSkpOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZy5mKEl0ZW1TaXplKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIEl0ZW1TaXplID09IDE6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWVbMF0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBib25lOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcuZihbdmFsdWVdKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib25lLnBvc0ZyYW1lTGlzdC5hcHBlbmQoaW50KHZhbHVlICogMzMpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS5jbG9zZSgpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzDQogICAgICAgICAgICAgICAgICAgIGlmIE5hbWUgPT0gJyJzY2FsZSInOg0KICAgICAgICAgICAgICAgICAgICAgICAgYm9uZSA9IE5vbmUNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIFRhcmdldE5hbWUgaW4gYm9uZUluZGVrc0xpc3Q6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9IGJvbmVJbmRla3NMaXN0W1RhcmdldE5hbWVdDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbmFtZSBub3QgaW4gYm9uZUxpc3Qua2V5cygpOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib25lID0gQWN0aW9uQm9uZSgpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ib25lTGlzdC5hcHBlbmQoYm9uZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9uZS5uYW1lID0gbmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib25lTGlzdFtuYW1lXSA9IGJvbmUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib25lID0gYm9uZUxpc3RbbmFtZV0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgS2V5ID0geXMuZ2V0KGEsICciS2V5IicpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBLZXk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKEtleVswXS5kYXRhLCAnOicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSXRlbVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciSXRlbVNpemUiJywgJ2knKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZsb2F0MzJBcnJheSA9IHlzLmdldChLZXlbMF0sICciRmxvYXQzMkFycmF5IicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgRmxvYXQzMkFycmF5Og0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsICc6JykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSBvcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpICsgb3Muc2VwICsgRmlsZS5zcGxpdCgnIicpWzFdLnNwbGl0KCcuZ3onKVswXQ0KCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZSA9IG9wZW4ocGF0aCwgJ3JiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcuc2VlayhpbnQoT2Zmc2V0KSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGJvbmU6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3LndyaXRlKGJvbmUubmFtZSArICdceDAwJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcud3JpdGUoJ3NpemUnICsgJ1x4MDAnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldy5pKFtpbnQoU2l6ZSldKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIG0gaW4gcmFuZ2UoaW50KFNpemUpKToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGcuZihJdGVtU2l6ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBib25lOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcuZih2YWx1ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9uZU1hdHJpeCA9IHNrZWxldG9uLm9iamVjdC5nZXREYXRhKCkuYm9uZXNbYm9uZS5uYW1lXS5tYXRyaXhbJ0FSTUFUVVJFU1BBQ0UnXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRyaXggPSBWZWN0b3JNYXRyaXgodmFsdWUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvbmUuc2l6ZUtleUxpc3QuYXBwZW5kKG1hdHJpeCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUuY2xvc2UoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgVGltZSA9IHlzLmdldChhLCAnIlRpbWUiJykNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIFRpbWU6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKFRpbWVbMF0uZGF0YSwgJzonKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEl0ZW1TaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkl0ZW1TaXplIicsICdpJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBGbG9hdDMyQXJyYXkgPSB5cy5nZXQoVGltZVswXSwgJyJGbG9hdDMyQXJyYXkiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBGbG9hdDMyQXJyYXk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgJzonKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IG9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkgKyBvcy5zZXAgKyBGaWxlLnNwbGl0KCciJylbMV0uc3BsaXQoJy5neicpWzBdDQoJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlID0gb3BlbihwYXRoLCAncmInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZy5zZWVrKGludChPZmZzZXQpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgYm9uZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcuaShbaW50KFNpemUpXSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBtIGluIHJhbmdlKGludChTaXplKSk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBnLmYoSXRlbVNpemUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgSXRlbVNpemUgPT0gMToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZVswXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGJvbmU6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldy5mKFt2YWx1ZV0pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvbmUuc2l6ZUZyYW1lTGlzdC5hcHBlbmQoaW50KHZhbHVlICogMzMpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS5jbG9zZSgpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzDQogICAgICAgICAgICBWZWMzTGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkID0geXMuZ2V0KGEsICcib3NnQW5pbWF0aW9uLlZlYzNMZXJwQ2hhbm5lbENvbXByZXNzZWRQYWNrZWQiJykNCiAgICAgICAgICAgIGlmIFZlYzNMZXJwQ2hhbm5lbENvbXByZXNzZWRQYWNrZWQ6DQogICAgICAgICAgICAgICAgYXRyaWJ1dGVzID0ge30NCiAgICAgICAgICAgICAgICBVc2VyRGF0YUNvbnRhaW5lciA9IHlzLmdldChWZWMzTGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkWzBdLCAnIlVzZXJEYXRhQ29udGFpbmVyIicpDQogICAgICAgICAgICAgICAgaWYgVXNlckRhdGFDb250YWluZXI6DQogICAgICAgICAgICAgICAgICAgIFZhbHVlcyA9IHlzLmdldChVc2VyRGF0YUNvbnRhaW5lclswXSwgJyJWYWx1ZXMiJykNCiAgICAgICAgICAgICAgICAgICAgaWYgVmFsdWVzOg0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGNoaWxkIGluIFZhbHVlc1swXS5jaGlsZHJlbjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoY2hpbGQuZGF0YSwgJzonKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciTmFtZSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlZhbHVlIicsICciZiInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0cmlidXRlc1tOYW1lXSA9IFZhbHVlDQogICAgICAgICAgICAgICAgS2V5RnJhbWVzID0geXMuZ2V0KGEsICciS2V5RnJhbWVzIicpDQogICAgICAgICAgICAgICAgaWYgS2V5RnJhbWVzOg0KICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoS2V5RnJhbWVzWzBdLmhlYWRlciwgJzonKQ0KICAgICAgICAgICAgICAgICAgICBOYW1lID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk5hbWUiJykNCiAgICAgICAgICAgICAgICAgICAgVGFyZ2V0TmFtZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJUYXJnZXROYW1lIicsICciIicpDQogICAgICAgICAgICAgICAgICAgIG5hbWUgPSBnZXRTcGxpdE5hbWUoVGFyZ2V0TmFtZSwgJ18nLCAtMSkNCiAgICAgICAgICAgICAgICAgICAgaWYgTmFtZSA9PSAnInRyYW5zbGF0ZSInOg0KICAgICAgICAgICAgICAgICAgICAgICAgYm9uZSA9IE5vbmUNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIFRhcmdldE5hbWUgaW4gYm9uZUluZGVrc0xpc3Q6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9IGJvbmVJbmRla3NMaXN0W1RhcmdldE5hbWVdDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbmFtZSBub3QgaW4gYm9uZUxpc3Qua2V5cygpOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib25lID0gQWN0aW9uQm9uZSgpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ib25lTGlzdC5hcHBlbmQoYm9uZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9uZS5uYW1lID0gbmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib25lTGlzdFtuYW1lXSA9IGJvbmUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib25lID0gYm9uZUxpc3RbbmFtZV0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgS2V5ID0geXMuZ2V0KGEsICciS2V5IicpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBLZXk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKEtleVswXS5kYXRhLCAnOicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSXRlbVNpemUgPSBpbnQoeXMuZ2V0VmFsdWUodmFsdWVzLCAnIkl0ZW1TaXplIicpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVpbnQxNkFycmF5ID0geXMuZ2V0KEtleVswXSwgJyJVaW50MTZBcnJheSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnVWludDE2QXJyYXknDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgVWludDE2QXJyYXk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhVaW50MTZBcnJheVswXS5kYXRhLCAnOicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaXplID0gaW50KHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPZmZzZXQgPSBpbnQoeXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IG9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkgKyBvcy5zZXAgKyBGaWxlLnNwbGl0KCciJylbMV0uc3BsaXQoJy5neicpWzBdDQoJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlID0gb3BlbihwYXRoLCAncmInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdCA9IGRlY29kZVZhcmludChnLCBPZmZzZXQsIFNpemUqIEl0ZW1TaXplLCB0eXBlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdDEgPSBldGFwMShsaXN0LCBJdGVtU2l6ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dCA9IGV0YXAyKGxpc3QxLCBJdGVtU2l6ZSwgYXRyaWJ1dGVzKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdDIgPSBbYXRyaWJ1dGVzWycib3giJ10sIGF0cmlidXRlc1snIm95IiddLCBhdHJpYnV0ZXNbJyJveiInXV0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QyLmV4dGVuZChvdXQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0MyA9IGV0YXAzKGxpc3QyLCBJdGVtU2l6ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGJvbmU6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3LndyaXRlKGJvbmUubmFtZSArICdceDAwJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcud3JpdGUoJ3RyYW5zbGF0ZScgKyAnXHgwMCcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3LmkoW1NpemVdKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBsaXN0M1ttICogMzptICogMyArIDNdDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgYm9uZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3LmYodmFsdWUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGJvbmUubmFtZSBpbiBza2VsZXRvbi5vYmplY3QuZ2V0RGF0YSgpLmJvbmVzLmtleXMoKToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvbmVNYXRyaXggPSBza2VsZXRvbi5vYmplY3QuZ2V0RGF0YSgpLmJvbmVzW2JvbmUubmFtZV0ubWF0cml4WydBUk1BVFVSRVNQQUNFJ10NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdHJpeCA9IFZlY3Rvck1hdHJpeCh2YWx1ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvbmUucG9zS2V5TGlzdC5hcHBlbmQobWF0cml4KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS5jbG9zZSgpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBUaW1lID0geXMuZ2V0KGEsICciVGltZSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgVGltZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoVGltZVswXS5kYXRhLCAnOicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSXRlbVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciSXRlbVNpemUiJywgJ2knKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZsb2F0MzJBcnJheSA9IHlzLmdldChUaW1lWzBdLCAnIkZsb2F0MzJBcnJheSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIEZsb2F0MzJBcnJheToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCAnOicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgJ2knKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicsICdpJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IG9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkgKyBvcy5zZXAgKyBGaWxlLnNwbGl0KCciJylbMV0uc3BsaXQoJy5neicpWzBdDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZSA9IG9wZW4ocGF0aCwgJ3JiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcuc2VlayhpbnQoT2Zmc2V0KSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QgPSBnLmYoU2l6ZSAqIEl0ZW1TaXplKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdDEgPSBldGFwMShsaXN0LCBJdGVtU2l6ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QyID0gW2F0cmlidXRlc1snIm90IiddXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdDIuZXh0ZW5kKGxpc3QxKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdDMgPSBldGFwMyhsaXN0MiwgSXRlbVNpemUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBib25lOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldy5pKFtTaXplXSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBtIGluIHJhbmdlKFNpemUpOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gbGlzdDNbbV0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBib25lOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcuZihbdmFsdWVdKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib25lLnBvc0ZyYW1lTGlzdC5hcHBlbmQoaW50KHZhbHVlICogMzMpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS5jbG9zZSgpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzDQogICAgICAgICAgICBRdWF0U2xlcnBDaGFubmVsID0geXMuZ2V0KGEsICcib3NnQW5pbWF0aW9uLlF1YXRTbGVycENoYW5uZWwiJykNCiAgICAgICAgICAgIGlmIFF1YXRTbGVycENoYW5uZWw6DQogICAgICAgICAgICAgICAgS2V5RnJhbWVzID0geXMuZ2V0KGEsICciS2V5RnJhbWVzIicpDQogICAgICAgICAgICAgICAgaWYgS2V5RnJhbWVzOg0KICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoS2V5RnJhbWVzWzBdLmhlYWRlciwgJzonKQ0KICAgICAgICAgICAgICAgICAgICBOYW1lID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk5hbWUiJykNCiAgICAgICAgICAgICAgICAgICAgVGFyZ2V0TmFtZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJUYXJnZXROYW1lIicsICciIicpDQogICAgICAgICAgICAgICAgICAgIG5hbWUgPSBnZXRTcGxpdE5hbWUoVGFyZ2V0TmFtZSwgJ18nLCAtMSkNCiAgICAgICAgICAgICAgICAgICAgYm9uZSA9IE5vbmUNCiAgICAgICAgICAgICAgICAgICAgaWYgVGFyZ2V0TmFtZSBpbiBib25lSW5kZWtzTGlzdDoNCiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSBib25lSW5kZWtzTGlzdFtUYXJnZXROYW1lXQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgbmFtZSBub3QgaW4gYm9uZUxpc3Qua2V5cygpOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvbmUgPSBBY3Rpb25Cb25lKCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9uZS5uYW1lID0gbmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvbmVMaXN0W25hbWVdID0gYm9uZQ0KICAgICAgICAgICAgICAgICAgICAgICAgYm9uZSA9IGJvbmVMaXN0W25hbWVdDQogICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICBwYXNzDQogICAgICAgICAgICAgICAgICAgIEtleSA9IHlzLmdldChhLCAnIktleSInKQ0KICAgICAgICAgICAgICAgICAgICBpZiBLZXk6DQogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoS2V5WzBdLmRhdGEsICc6JykNCiAgICAgICAgICAgICAgICAgICAgICAgIEl0ZW1TaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkl0ZW1TaXplIicpDQogICAgICAgICAgICAgICAgICAgICAgICBGbG9hdDMyQXJyYXkgPSB5cy5nZXQoS2V5WzBdLCAnIkZsb2F0MzJBcnJheSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgRmxvYXQzMkFycmF5Og0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgJzonKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gb3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKSArIG9zLnNlcCArIEZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCSAgICBpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZSA9IG9wZW4ocGF0aCwgJ3JiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnNlZWsoaW50KE9mZnNldCkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGJvbmU6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcud3JpdGUoYm9uZS5uYW1lICsgJ1x4MDAnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3LndyaXRlKCdxdWF0ZXJuaW9uJyArICdceDAwJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldy5pKFtpbnQoU2l6ZSldKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgbSBpbiByYW5nZShpbnQoU2l6ZSkpOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBnLmYoNCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGJvbmU6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3LmYodmFsdWUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IFF1YXRlcm5pb24odmFsdWUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBib25lOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvbmVNYXRyaXggPSBza2VsZXRvbi5vYmplY3QuZ2V0RGF0YSgpLmJvbmVzW2JvbmUubmFtZV0ubWF0cml4WydBUk1BVFVSRVNQQUNFJ10NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRyaXggPSBRdWF0TWF0cml4KHZhbHVlKS5yZXNpemU0eDQoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvbmUucm90S2V5TGlzdC5hcHBlbmQobWF0cml4KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLmNsb3NlKCkNCiAgICAgICAgICAgICAgICAgICAgVGltZSA9IHlzLmdldChhLCAnIlRpbWUiJykNCiAgICAgICAgICAgICAgICAgICAgaWYgVGltZToNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhUaW1lWzBdLmRhdGEsICc6JykNCiAgICAgICAgICAgICAgICAgICAgICAgIEl0ZW1TaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkl0ZW1TaXplIicsICdpJykNCiAgICAgICAgICAgICAgICAgICAgICAgIEZsb2F0MzJBcnJheSA9IHlzLmdldChUaW1lWzBdLCAnIkZsb2F0MzJBcnJheSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgRmxvYXQzMkFycmF5Og0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgJzonKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gb3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKSArIG9zLnNlcCArIEZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCSAgICBpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZSA9IG9wZW4ocGF0aCwgJ3JiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnNlZWsoaW50KE9mZnNldCkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGJvbmU6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcuaShbaW50KFNpemUpXSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIG0gaW4gcmFuZ2UoaW50KFNpemUpKToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZy5mKEl0ZW1TaXplKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgSXRlbVNpemUgPT0gMToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlWzBdDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBib25lOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldy5mKFt2YWx1ZV0pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9uZS5yb3RGcmFtZUxpc3QuYXBwZW5kKGludCh2YWx1ZSAqIDMzKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS5jbG9zZSgpDQogICAgICAgICAgICBRdWF0U2xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZCA9IHlzLmdldChhLCAnIm9zZ0FuaW1hdGlvbi5RdWF0U2xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZCInKQ0KICAgICAgICAgICAgaWYgUXVhdFNsZXJwQ2hhbm5lbENvbXByZXNzZWRQYWNrZWQ6DQogICAgICAgICAgICAgICAgVGFyZ2V0TmFtZSA9IE5vbmUNCiAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgIGF0cmlidXRlcyA9IHt9DQogICAgICAgICAgICAgICAgICAgIFVzZXJEYXRhQ29udGFpbmVyID0geXMuZ2V0KFF1YXRTbGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkWzBdLCAnIlVzZXJEYXRhQ29udGFpbmVyIicpDQogICAgICAgICAgICAgICAgICAgIGlmIFVzZXJEYXRhQ29udGFpbmVyOg0KICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWVzID0geXMuZ2V0KFVzZXJEYXRhQ29udGFpbmVyWzBdLCAnIlZhbHVlcyInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgVmFsdWVzOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBjaGlsZCBpbiBWYWx1ZXNbMF0uY2hpbGRyZW46DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhjaGlsZC5kYXRhLCAnOicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciTmFtZSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJWYWx1ZSInLCAnImYiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRyaWJ1dGVzW05hbWVdID0gVmFsdWUNCiAgICAgICAgICAgICAgICAgICAgS2V5RnJhbWVzID0geXMuZ2V0KGEsICciS2V5RnJhbWVzIicpDQogICAgICAgICAgICAgICAgICAgIGlmIEtleUZyYW1lczoNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhLZXlGcmFtZXNbMF0uaGVhZGVyLCAnOicpDQogICAgICAgICAgICAgICAgICAgICAgICBOYW1lID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk5hbWUiJykNCiAgICAgICAgICAgICAgICAgICAgICAgIFRhcmdldE5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciVGFyZ2V0TmFtZSInLCAnIiInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9IGdldFNwbGl0TmFtZShUYXJnZXROYW1lLCAnXycsIC0xKQ0KICAgICAgICAgICAgICAgICAgICAgICAgYm9uZSA9IE5vbmUNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIFRhcmdldE5hbWUgaW4gYm9uZUluZGVrc0xpc3Q6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9IGJvbmVJbmRla3NMaXN0W1RhcmdldE5hbWVdDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbmFtZSBub3QgaW4gYm9uZUxpc3Qua2V5cygpOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib25lID0gQWN0aW9uQm9uZSgpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ib25lTGlzdC5hcHBlbmQoYm9uZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9uZS5uYW1lID0gbmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib25lTGlzdFtuYW1lXSA9IGJvbmUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib25lID0gYm9uZUxpc3RbbmFtZV0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgS2V5ID0geXMuZ2V0KGEsICciS2V5IicpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBLZXk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKEtleVswXS5kYXRhLCAnOicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSXRlbVNpemUgPSBpbnQoeXMuZ2V0VmFsdWUodmFsdWVzLCAnIkl0ZW1TaXplIicpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVpbnQxNkFycmF5ID0geXMuZ2V0KEtleVswXSwgJyJVaW50MTZBcnJheSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnVWludDE2QXJyYXknDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgVWludDE2QXJyYXk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhVaW50MTZBcnJheVswXS5kYXRhLCAnOicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaXplID0gaW50KHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPZmZzZXQgPSBpbnQoeXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IG9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkgKyBvcy5zZXAgKyBGaWxlLnNwbGl0KCciJylbMV0uc3BsaXQoJy5neicpWzBdDQoJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlID0gb3BlbihwYXRoLCAncmInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdCA9IGRlY29kZVZhcmludChnLCBPZmZzZXQsIFNpemUgKiBJdGVtU2l6ZSwgdHlwZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QxID0gZXRhcDEobGlzdCwgSXRlbVNpemUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAnIm94IicgaW4gYXRyaWJ1dGVzOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QyID0gaW50M2Zsb2F0NChsaXN0MSwgYXRyaWJ1dGVzLCBJdGVtU2l6ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0MyA9IFthdHJpYnV0ZXNbJyJveCInXSwgYXRyaWJ1dGVzWycib3kiJ10sIGF0cmlidXRlc1snIm96IiddLCBhdHJpYnV0ZXNbJyJvdyInXV0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0My5leHRlbmQobGlzdDIpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdDQgPSBldGFwNChsaXN0MykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBib25lOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcud3JpdGUoYm9uZS5uYW1lICsgJ1x4MDAnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcud3JpdGUoJ3F1YXRlcm5pb24nICsgJ1x4MDAnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcuaShbU2l6ZV0pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gbGlzdDRbbSAqIDQ6bSAqIDQgKyA0XQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBib25lOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3LmYodmFsdWUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gUXVhdGVybmlvbih2YWx1ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgYm9uZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvbmVNYXRyaXggPSBza2VsZXRvbi5vYmplY3QuZ2V0RGF0YSgpLmJvbmVzW2JvbmUubmFtZV0ubWF0cml4WydBUk1BVFVSRVNQQUNFJ10NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdHJpeCA9IFF1YXRNYXRyaXgodmFsdWUpLnJlc2l6ZTR4NCgpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib25lLnJvdEtleUxpc3QuYXBwZW5kKG1hdHJpeCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUuY2xvc2UoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgVGltZSA9IHlzLmdldChhLCAnIlRpbWUiJykNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIFRpbWU6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKFRpbWVbMF0uZGF0YSwgJzonKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEl0ZW1TaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkl0ZW1TaXplIicsICdpJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBGbG9hdDMyQXJyYXkgPSB5cy5nZXQoVGltZVswXSwgJyJGbG9hdDMyQXJyYXkiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBGbG9hdDMyQXJyYXk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgJzonKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICdpJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAnaScpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSBvcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpICsgb3Muc2VwICsgRmlsZS5zcGxpdCgnIicpWzFdLnNwbGl0KCcuZ3onKVswXQ0KCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZSA9IG9wZW4ocGF0aCwgJ3JiJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcuc2VlayhpbnQoT2Zmc2V0KSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QgPSBnLmYoU2l6ZSAqIEl0ZW1TaXplKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdDEgPSBldGFwMShsaXN0LCBJdGVtU2l6ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICcib3QiJyBpbiBhdHJpYnV0ZXM6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdDIgPSBbYXRyaWJ1dGVzWycib3QiJ11dDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdDIuZXh0ZW5kKGxpc3QxKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QzID0gZXRhcDMobGlzdDIsIEl0ZW1TaXplKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGJvbmU6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldy5pKFtTaXplXSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgbSBpbiByYW5nZShTaXplKToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBsaXN0MlttXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBib25lOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3LmYoW3ZhbHVlXSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvbmUucm90RnJhbWVMaXN0LmFwcGVuZChpbnQodmFsdWUgKiAzMykpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLmNsb3NlKCkNCiAgICAgICAgICAgICAgICBleGNlcHQ6DQogICAgICAgICAgICAgICAgICAgIHBhc3MNCiAgICAgICAgbmV3LmNsb3NlKCkNCmRlZiBkZWNvZGVWYXJpbnQoZywgb2Zmc2V0LCBzaXplLCB0eXBlKToNCiAgICBnLnNlZWsob2Zmc2V0KQ0KICAgIG4gPSBbMF0gKiBzaXplDQogICAgYSA9IDANCiAgICBzID0gMA0KICAgIHdoaWxlIGEgIT0gc2l6ZToNCiAgICAgICAgc2hpZnQgPSAwDQogICAgICAgIHJlc3VsdCA9IDANCiAgICAgICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgICAgIGJ5dGUgPSBnLkIoMSlbMF0NCiAgICAgICAgICAgIHJlc3VsdCB8PSAoYnl0ZSAmIDEyNykgPDwgc2hpZnQNCiAgICAgICAgICAgIHNoaWZ0ICs9IDcNCiAgICAgICAgICAgIGlmIG5vdCBieXRlICYgMHg4MDoNCiAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICBuW2FdID0gcmVzdWx0DQogICAgICAgIGEgKz0gMQ0KICAgIGlmIHR5cGVbMF0gIT0gJ1UnOg0KICAgICAgICBsID0gMA0KICAgICAgICB3aGlsZSBsIDwgc2l6ZToNCiAgICAgICAgICAgIGggPSBuW2xdDQogICAgICAgICAgICBuW2xdID0gaCA+PiAxIF4gLSgxICYgaCkNCiAgICAgICAgICAgIGwgKz0gMQ0KICAgIHJldHVybiBuDQpkZWYgZGVjb2RlRGVsdGEodCwgZSk6DQogICAgaSA9IGUgfCAwDQogICAgbiA9IGxlbih0KQ0KICAgIGlmIGkgPj0gbGVuKHQpOg0KICAgICAgICByID0gTm9uZQ0KICAgIGVsc2U6DQogICAgICAgIHIgPSB0W2ldDQogICAgYSA9IGkgKyAxDQogICAgd2hpbGUgYSA8IG46DQogICAgICAgIHMgPSB0W2FdDQogICAgICAgIHIgPSB0W2FdID0gciArIChzID4+IDEgXiAtKDEgJiBzKSkNCiAgICAgICAgYSArPSAxDQogICAgcmV0dXJuIHQNCmRlZiBkZWNvZGVJbXBsaWNpdChpbnB1dCwgbik6DQogICAgSU1QTElDSVRfSEVBREVSX0xFTkdUSCA9IDMNCiAgICBJTVBMSUNJVF9IRUFERVJfTUFTS19MRU5HVEggPSAxDQogICAgSU1QTElDSVRfSEVBREVSX1BSSU1JVElWRV9MRU5HVEggPSAwDQogICAgSU1QTElDSVRfSEVBREVSX0VYUEVDVEVEX0lOREVYID0gMg0KICAgIGhpZ2hXYXRlcm1hcmsgPSAyDQogICAgdCA9IGlucHV0DQogICAgZSA9IFswXSAqIHRbSU1QTElDSVRfSEVBREVSX1BSSU1JVElWRV9MRU5HVEhdDQogICAgYSA9IHRbSU1QTElDSVRfSEVBREVSX0VYUEVDVEVEX0lOREVYXQ0KICAgIHMgPSB0W0lNUExJQ0lUX0hFQURFUl9NQVNLX0xFTkdUSF0NCiAgICBvID0gdFtJTVBMSUNJVF9IRUFERVJfTEVOR1RIOnMgKyBJTVBMSUNJVF9IRUFERVJfTEVOR1RIXQ0KICAgIHIgPSBoaWdoV2F0ZXJtYXJrDQogICAgdSA9IDMyICogcyAtIGxlbihlKQ0KICAgIGwgPSAxIDw8IDMxDQogICAgaCA9IDANCiAgICB3aGlsZSBoIDwgczoNCiAgICAgICAgYyA9IG9baF0NCiAgICAgICAgZCA9IDMyDQogICAgICAgIHAgPSBoICogZA0KICAgICAgICBpZiBoID09IHMgLSAxOg0KICAgICAgICAgICAgZiA9IHUNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIGYgPSAwDQogICAgICAgIGcxID0gZg0KICAgICAgICB3aGlsZSBnMSA8IGQ6DQogICAgICAgICAgICBpZiBjICYgbCA+PiBnMToNCiAgICAgICAgICAgICAgICBlW3BdID0gdFtuXQ0KICAgICAgICAgICAgICAgIG4gKz0gMQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBpZiByOg0KICAgICAgICAgICAgICAgICAgICBlW3BdID0gYQ0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIGVbcF0gPSBhDQogICAgICAgICAgICAgICAgICAgIGEgKz0gMQ0KICAgICAgICAgICAgZzEgKz0gMQ0KICAgICAgICAgICAgcCArPSAxDQogICAgICAgIGggKz0gMQ0KICAgIHJldHVybiBlDQpkZWYgZGVjb2RlV2F0ZXJtYXJrKHQsIGUsIGkpOg0KICAgIG4gPSBpWzBdDQogICAgciA9IGxlbih0KQ0KICAgIGEgPSAwDQogICAgd2hpbGUgYSA8IHI6DQogICAgICAgIHMgPSBuIC0gdFthXQ0KICAgICAgICBlW2FdID0gcw0KICAgICAgICBpZiBuIDw9IHM6DQogICAgICAgICAgICBuID0gcyArIDENCiAgICAgICAgYSArPSAxDQogICAgcmV0dXJuIChlLCBuKQ0KZGVmIGRlY29kZVF1YW50aXplKGlucHV0LCBzLCBhLCBpdGVtc2l6ZSk6DQogICAgeCA9IFswXSAqIGxlbihpbnB1dCkNCiAgICBpZCA9IDANCiAgICBmb3IgciBpbiByYW5nZShsZW4oaW5wdXQpIC8gaXRlbXNpemUpOg0KICAgICAgICBmb3IgbCBpbiByYW5nZShpdGVtc2l6ZSk6DQogICAgICAgICAgICB4W2lkXSA9IHNbbF0gKyBpbnB1dFtpZF0gKiBhW2xdDQogICAgICAgICAgICBpZCArPSAxDQogICAgcmV0dXJuIHgNCmRlZiBkZWNvZGVQcmVkaWN0KGluZGljZXMsIGlucHV0LCBpdGVtc2l6ZSk6DQogICAgdCA9IGlucHV0DQogICAgaWYgbGVuKGluZGljZXMpID4gMDoNCiAgICAgICAgdCA9IGlucHV0DQogICAgICAgIGUgPSBpdGVtc2l6ZQ0KICAgICAgICBpID0gaW5kaWNlcw0KICAgICAgICBuID0gbGVuKHQpIC8gZQ0KICAgICAgICByID0gWzBdICogbg0KICAgICAgICBhID0gbGVuKGkpIC0gMQ0KICAgICAgICByW2lbMF1dID0gMQ0KICAgICAgICByW2lbMV1dID0gMQ0KICAgICAgICByW2lbMl1dID0gMQ0KICAgICAgICBzID0gMg0KICAgICAgICB3aGlsZSBzIDwgYToNCiAgICAgICAgICAgIG8gPSBzIC0gMg0KICAgICAgICAgICAgdSA9IGlbb10NCiAgICAgICAgICAgIGwgPSBpW28gKyAxXQ0KICAgICAgICAgICAgaCA9IGlbbyArIDJdDQogICAgICAgICAgICBjID0gaVtvICsgM10NCiAgICAgICAgICAgIGlmIDEgIT0gcltjXToNCiAgICAgICAgICAgICAgICByW2NdID0gMQ0KICAgICAgICAgICAgICAgIHUgKj0gZQ0KICAgICAgICAgICAgICAgIGwgKj0gZQ0KICAgICAgICAgICAgICAgIGggKj0gZQ0KICAgICAgICAgICAgICAgIGMgKj0gZQ0KICAgICAgICAgICAgICAgIGQgPSAwDQogICAgICAgICAgICAgICAgd2hpbGUgZCA8IGU6DQogICAgICAgICAgICAgICAgICAgIHRbYyArIGRdID0gdFtjICsgZF0gKyB0W2wgKyBkXSArIHRbaCArIGRdIC0gdFt1ICsgZF0NCiAgICAgICAgICAgICAgICAgICAgZCArPSAxDQogICAgICAgICAgICBzICs9IDENCiAgICByZXR1cm4gdA0KY2xhc3MgTm9kZToNCiAgICBkZWYgX19pbml0X18oc2VsZik6DQogICAgICAgIHNlbGYubmFtZSA9IE5vbmUNCiAgICAgICAgc2VsZi5jaGlsZHJlbiA9IFtdDQogICAgICAgIHNlbGYub3NnQ2hpbGRyZW4gPSBbXQ0KICAgICAgICBzZWxmLm9mZnNldCA9IE5vbmUNCiAgICAgICAgc2VsZi5zdGFydCA9IE5vbmUNCiAgICAgICAgc2VsZi5lbmQgPSBOb25lDQogICAgICAgIHNlbGYuaGVhZGVyID0gJycNCiAgICAgICAgc2VsZi5kYXRhID0gJycNCiAgICAgICAgc2VsZi5wYXJlbnQgPSBOb25lDQpjbGFzcyBZc29uOg0KICAgIGRlZiBfX2luaXRfXyhzZWxmKToNCiAgICAgICAgc2VsZi5pbnB1dCA9IE5vbmUNCiAgICAgICAgc2VsZi5maWxlbmFtZSA9IE5vbmUNCiAgICAgICAgc2VsZi5yb290ID0gTm9kZSgpDQogICAgZGVmIHBhcnNlKHNlbGYpOg0KICAgICAgICBnbG9iYWwgb2Zmc2V0LCBzdHJpbmcNCiAgICAgICAgaWYgc2VsZi5maWxlbmFtZSBpcyBub3QgTm9uZToNCiAgICAgICAgICAgIGZpbGUgPSBvcGVuKHNlbGYuZmlsZW5hbWUsICdyYicpDQogICAgICAgICAgICBzZWxmLmlucHV0ID0gZmlsZS5yZWFkKCkucmVwbGFjZSgnXHgyMCcsICcnKS5yZXBsYWNlKCdceDBBJywgJycpLnJlcGxhY2UoJyYjMzQ7JywgJyInKQ0KICAgICAgICAgICAgbGluZSA9IHNlbGYuaW5wdXQNCiAgICAgICAgICAgIGlmIGxpbmUgaXMgbm90IE5vbmUgYW5kIGxlbihsaW5lKSA+IDA6DQogICAgICAgICAgICAgICAgb2Zmc2V0ID0gMA0KICAgICAgICAgICAgICAgIG4gPSAwDQogICAgICAgICAgICAgICAgc3RyaW5nID0gW10NCiAgICAgICAgICAgICAgICBzZWxmLnRyZWUoc2VsZi5yb290LCBuKQ0KICAgICAgICAgICAgZmlsZS5jbG9zZSgpDQogICAgZGVmIGdldFRyZWUxKHNlbGYsIHBhcmVudCwgbGlzdCwga2V5KToNCiAgICAgICAgZm9yIGNoaWxkIGluIHBhcmVudC5jaGlsZHJlbjoNCiAgICAgICAgICAgIGlmIGtleSBpbiBjaGlsZC5oZWFkZXI6DQogICAgICAgICAgICAgICAgbGlzdC5hcHBlbmQoY2hpbGQpDQogICAgICAgICAgICBzZWxmLmdldFRyZWUoY2hpbGQsIGxpc3QsIGtleSkNCiAgICBkZWYgZ2V0VHJlZShzZWxmLCBwYXJlbnQsIGxpc3QsIGtleSk6DQogICAgICAgIGlmIGtleSBpbiBwYXJlbnQuaGVhZGVyIG9yIGtleSBpbiBwYXJlbnQuZGF0YToNCiAgICAgICAgICAgIGxpc3QuYXBwZW5kKHBhcmVudCkNCiAgICAgICAgZm9yIGNoaWxkIGluIHBhcmVudC5jaGlsZHJlbjoNCiAgICAgICAgICAgIHNlbGYuZ2V0VHJlZShjaGlsZCwgbGlzdCwga2V5KQ0KICAgIGRlZiB2YWx1ZXMoc2VsZiwgZGF0YSwgdHlwZSk6DQogICAgICAgIGxpc3QgPSB7fQ0KICAgICAgICBBID0gZGF0YS5zcGxpdCgnLCcpDQogICAgICAgIGlmIHR5cGUgPT0gJzonOg0KICAgICAgICAgICAgZm9yIGEgaW4gQToNCiAgICAgICAgICAgICAgICBpZiAnOicgaW4gYToNCiAgICAgICAgICAgICAgICAgICAgYyA9IDANCiAgICAgICAgICAgICAgICAgICAgYWxpc3QgPSBbXQ0KICAgICAgICAgICAgICAgICAgICBzdHJpbmcgPSAnJw0KICAgICAgICAgICAgICAgICAgICBmb3IgYiBpbiBhOg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgYiA9PSAnIicgYW5kIGMgPT0gMDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBsZW4oc3RyaW5nKSA+IDA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsaXN0LmFwcGVuZChzdHJpbmcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nID0gJycNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmcgKz0gYg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAxDQogICAgICAgICAgICAgICAgICAgICAgICBlbGlmIGIgPT0gJyInIGFuZCBjID09IDE6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nICs9IGINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBsZW4oc3RyaW5nKSA+IDA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsaXN0LmFwcGVuZChzdHJpbmcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nID0gJycNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gMA0KICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBiID09ICc6JzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZyArPSBiDQogICAgICAgICAgICAgICAgICAgIGlmIGxlbihzdHJpbmcpID4gMDoNCiAgICAgICAgICAgICAgICAgICAgICAgIGFsaXN0LmFwcGVuZChzdHJpbmcpDQogICAgICAgICAgICAgICAgICAgIGlmIGxlbihhbGlzdCkgPT0gMjoNCiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RbYWxpc3RbMF1dID0gYWxpc3RbMV0NCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKGFsaXN0KSA9PSAxOg0KICAgICAgICAgICAgICAgICAgICAgICAgbGlzdFthbGlzdFswXV0gPSAnTm9uZScNCiAgICAgICAgaWYgdHlwZSA9PSAnZic6DQogICAgICAgICAgICBsaXN0ID0gbWFwKGZsb2F0LCBBKQ0KICAgICAgICBpZiB0eXBlID09ICdpJzoNCiAgICAgICAgICAgIGxpc3QgPSBtYXAoaW50LCBBKQ0KICAgICAgICBpZiB0eXBlID09ICdzJzoNCiAgICAgICAgICAgIGxpc3QgPSBBDQogICAgICAgIHJldHVybiBsaXN0DQogICAgZGVmIGdldFZhbHVlKHNlbGYsIHZhbHVlcywgbmFtZSwgdHlwZT1Ob25lKToNCiAgICAgICAgaWYgbmFtZSBpbiB2YWx1ZXM6DQogICAgICAgICAgICBpZiB0eXBlID09ICciZiInOg0KICAgICAgICAgICAgICAgIHJldHVybiBmbG9hdCh2YWx1ZXNbbmFtZV0uc3BsaXQoJyInKVsxXSkNCiAgICAgICAgICAgIGVsaWYgdHlwZSA9PSAnImkiJzoNCiAgICAgICAgICAgICAgICByZXR1cm4gaW50KHZhbHVlc1tuYW1lXS5zcGxpdCgnIicpWzFdKQ0KICAgICAgICAgICAgZWxpZiB0eXBlID09ICdpJzoNCiAgICAgICAgICAgICAgICBpZiB2YWx1ZXNbbmFtZV0gIT0gJ05vbmUnOg0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW50KHZhbHVlc1tuYW1lXS5yZXBsYWNlKCciJywgJycpKQ0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBOb25lDQogICAgICAgICAgICBlbGlmIHR5cGUgPT0gJyIiJzoNCiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWVzW25hbWVdLnNwbGl0KCciJylbMV0NCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlc1tuYW1lXQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgcmV0dXJuIE5vbmUNCiAgICBkZWYgZ2V0KHNlbGYsIG5vZGUsIGtleSk6DQogICAgICAgIGxpc3QgPSBbXQ0KICAgICAgICBzZWxmLmdldFRyZWUobm9kZSwgbGlzdCwga2V5KQ0KICAgICAgICBpZiBsZW4obGlzdCkgPiAwOg0KICAgICAgICAgICAgcmV0dXJuIGxpc3QNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHJldHVybiBOb25lDQogICAgZGVmIHRyZWUoc2VsZiwgcGFyZW50Tm9kZSwgbik6DQogICAgICAgIGdsb2JhbCBvZmZzZXQsIHN0cmluZw0KICAgICAgICBuICs9IDQNCiAgICAgICAgb2Zmc2V0ICs9IDENCiAgICAgICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgICAgIGlmIG9mZnNldCA+PSBsZW4oc2VsZi5pbnB1dCk6DQogICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgIHZhbHVlID0gc2VsZi5pbnB1dFtvZmZzZXRdDQogICAgICAgICAgICBpZiB2YWx1ZSA9PSAifSI6DQogICAgICAgICAgICAgICAgaWYgbGVuKHN0cmluZykgPiAwOg0KICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlLmRhdGEgPSBzZWxmLmlucHV0W3N0cmluZ1swXSA6IG9mZnNldF0NCiAgICAgICAgICAgICAgICBzdHJpbmcgPSBbXQ0KICAgICAgICAgICAgICAgIG9mZnNldCArPSAxDQogICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgIGVsaWYgdmFsdWUgPT0gInsiOg0KICAgICAgICAgICAgICAgIG5vZGUgPSBOb2RlKCkNCiAgICAgICAgICAgICAgICBwYXJlbnROb2RlLmNoaWxkcmVuLmFwcGVuZChub2RlKQ0KICAgICAgICAgICAgICAgIG5vZGUub2Zmc2V0ID0gb2Zmc2V0DQogICAgICAgICAgICAgICAgaWYgbGVuKHN0cmluZykgPiAwOg0KICAgICAgICAgICAgICAgICAgICBub2RlLmhlYWRlciA9IHNlbGYuaW5wdXRbc3RyaW5nWzBdIDogb2Zmc2V0XQ0KICAgICAgICAgICAgICAgIHN0cmluZyA9IFtdDQogICAgICAgICAgICAgICAgc2VsZi50cmVlKG5vZGUsIG4pDQogICAgICAgICAgICBlbGlmIHZhbHVlID09ICJdIjoNCiAgICAgICAgICAgICAgICBpZiBsZW4oc3RyaW5nKSA+IDA6DQogICAgICAgICAgICAgICAgICAgIHBhcmVudE5vZGUuZGF0YSA9IHNlbGYuaW5wdXRbc3RyaW5nWzBdIDogb2Zmc2V0XQ0KICAgICAgICAgICAgICAgIG9mZnNldCArPSAxDQogICAgICAgICAgICAgICAgc3RyaW5nID0gW10NCiAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgZWxpZiB2YWx1ZSA9PSAiWyI6DQogICAgICAgICAgICAgICAgbm9kZSA9IE5vZGUoKQ0KICAgICAgICAgICAgICAgIHBhcmVudE5vZGUuY2hpbGRyZW4uYXBwZW5kKG5vZGUpDQogICAgICAgICAgICAgICAgbm9kZS5vZmZzZXQgPSBvZmZzZXQNCiAgICAgICAgICAgICAgICBub2RlLm5hbWUgPSBzdHJpbmcNCiAgICAgICAgICAgICAgICBpZiBsZW4oc3RyaW5nKSA+IDA6DQogICAgICAgICAgICAgICAgICAgIG5vZGUuaGVhZGVyID0gc2VsZi5pbnB1dFtzdHJpbmdbMF0gOiBvZmZzZXRdDQogICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgbm9kZS5oZWFkZXIgPSAiIg0KICAgICAgICAgICAgICAgIHN0cmluZyA9IFtdDQogICAgICAgICAgICAgICAgc2VsZi50cmVlKG5vZGUsIG4pDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIGlmIGxlbihzdHJpbmcpID09IDA6DQogICAgICAgICAgICAgICAgICAgIHN0cmluZy5hcHBlbmQob2Zmc2V0KQ0KICAgICAgICAgICAgICAgIG9mZnNldCArPSAxDQpkZWYgZ2V0VW5pcXVlSUQoeXMsIGRhdGEpOg0KICAgIFVuaXF1ZUlEID0gTm9uZQ0KICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhkYXRhLCAnOicpDQogICAgaWYgJyJVbmlxdWVJRCInIGluIHZhbHVlczoNCiAgICAgICAgVW5pcXVlSUQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciVW5pcXVlSUQiJywgJ2knKQ0KICAgIHJldHVybiBVbmlxdWVJRA0KY2xhc3MgTmV3Tm9kZToNCiAgICBkZWYgX19pbml0X18oc2VsZik6DQogICAgICAgIHNlbGYubm9kZSA9IE5vbmUNCiAgICAgICAgc2VsZi5wYXJlbnQgPSBOb25lDQogICAgICAgIHNlbGYuY2hpbGRyZW4gPSBbXQ0KICAgICAgICBzZWxmLlVuaXF1ZUlEID0gTm9uZQ0KZGVmIGdldElEVHJlZSh5cywgcGFyZW50Tm9kZSwgbiwgcGFyZW50TmV3Tm9kZSk6DQogICAgaWYgbGVuKHBhcmVudE5vZGUuaGVhZGVyKSAhPSAwIGFuZCBwYXJlbnROb2RlLmhlYWRlciAhPSAnLCc6DQogICAgICAgIG4gKz0gNA0KICAgIFVuaXF1ZUlEID0gZ2V0VW5pcXVlSUQoeXMsIHBhcmVudE5vZGUuZGF0YSkNCiAgICBpZiBVbmlxdWVJRDoNCiAgICAgICAgcGFyZW50TmV3Tm9kZS5VbmlxdWVJRCA9IFVuaXF1ZUlEDQogICAgZm9yIGNoaWxkIGluIHBhcmVudE5vZGUuY2hpbGRyZW46DQogICAgICAgIGlmIGxlbihjaGlsZC5oZWFkZXIpICE9IDAgYW5kIGNoaWxkLmhlYWRlciAhPSAnLCc6DQogICAgICAgICAgICBuZXdOb2RlID0gTmV3Tm9kZSgpDQogICAgICAgICAgICBVbmlxdWVJRCA9IGdldFVuaXF1ZUlEKHlzLCBjaGlsZC5oZWFkZXIpDQogICAgICAgICAgICBpZiBVbmlxdWVJRDoNCiAgICAgICAgICAgICAgICBwYXJlbnROZXdOb2RlLlVuaXF1ZUlEID0gVW5pcXVlSUQNCiAgICAgICAgICAgIG5ld05vZGUubm9kZSA9IGNoaWxkDQogICAgICAgICAgICBwYXJlbnROZXdOb2RlLmNoaWxkcmVuLmFwcGVuZChuZXdOb2RlKQ0KICAgICAgICAgICAgbmV3Tm9kZUxpc3QuYXBwZW5kKG5ld05vZGUpDQogICAgICAgICAgICBuZXdOb2RlLnBhcmVudCA9IHBhcmVudE5vZGUNCiAgICAgICAgICAgIHBhcmVudE5ld05vZGUxID0gbmV3Tm9kZQ0KICAgICAgICAgICAgZ2V0SURUcmVlKHlzLCBjaGlsZCwgbiwgcGFyZW50TmV3Tm9kZTEpDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBnZXRJRFRyZWUoeXMsIGNoaWxkLCBuLCBwYXJlbnROZXdOb2RlKQ0KZGVmIGdldFBhdGgoRmlsZSk6DQogICAgcGF0aCA9IG9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkgKyBvcy5zZXAgKyBGaWxlLnNwbGl0KCcuZ3onKVswXQ0KICAgIGlmIG9zLnBhdGguZXhpc3RzKHBhdGgpID09IEZhbHNlOg0KICAgICAgICBwYXRoID0gb3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKSArIG9zLnNlcCArICdtb2RlbF9maWxlLmJpbnonDQogICAgaWYgb3MucGF0aC5leGlzdHMocGF0aCkgPT0gRmFsc2U6DQogICAgICAgIHBhdGggPSBvcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpICsgb3Muc2VwICsgJ21vZGVsX2ZpbGUuYmluJw0KICAgIGlmIG9zLnBhdGguZXhpc3RzKHBhdGgpID09IEZhbHNlOg0KICAgICAgICBwYXRoID0gb3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKSArIG9zLnNlcCArIEZpbGUNCiAgICBpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKSA9PSBUcnVlOiAgICANCiAgICAgICAgcmV0dXJuIHBhdGgNCiAgICBlbHNlOg0KICAgICAgICByZXR1cm4gTm9uZQ0KZGVmIHJlYWRGbG9hdHMoYnIsIG9mZnNldCwgc2l6ZSwgaXRlbVNpemUpOg0KICAgIGlmIGJyLmlucHV0RmlsZS5tb2RlID09ICdyYic6DQogICAgICAgIGJyLnNlZWsob2Zmc2V0KQ0KICAgICAgICBpID0gMA0KICAgICAgICBudW1iZXJzID0gW10NCiAgICAgICAgd2hpbGUgaSA8IHNpemUgKiBpdGVtU2l6ZToNCiAgICAgICAgICAgIG51bWJlcnMuYXBwZW5kKGZsb2F0KHN0cnVjdC51bnBhY2soJzxmJywgYnIuaW5wdXRGaWxlLnJlYWQoNCkpWzBdKSkNCiAgICAgICAgICAgIGkgKz0gMQ0KICAgICAgICByZXR1cm4gbnVtYmVycw0KZGVmIFZlcnRleE5vcm1hbCh5cywgYik6DQogICAgbiA9IDIwDQogICAgU2l6ZSA9IE5vbmUNCiAgICBPZmZzZXQgPSBOb25lDQogICAgRW5jb2RpbmcgPSBOb25lDQogICAgSXRlbVNpemUgPSBOb25lDQogICAgdHlwZSA9IE5vbmUNCiAgICBub3JtYWxBcnJheSA9IFtdDQogICAgdmFsdWVzID0geXMudmFsdWVzKGIuZGF0YSwgJzonKQ0KICAgIGlmICciSXRlbVNpemUiJyBpbiB2YWx1ZXM6DQogICAgICAgIEl0ZW1TaXplID0gaW50KHZhbHVlc1snIkl0ZW1TaXplIiddKQ0KICAgICAgICBVaW50MzJBcnJheSA9IHlzLmdldChiLCAnIlVpbnQzMkFycmF5IicpDQogICAgICAgIGlmIFVpbnQzMkFycmF5Og0KICAgICAgICAgICAgdHlwZSA9ICdVaW50MzJBcnJheScNCiAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhVaW50MzJBcnJheVswXS5kYXRhLCAnOicpDQogICAgICAgICAgICBTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgJ2knKQ0KICAgICAgICAgICAgT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAnaScpDQogICAgICAgICAgICBGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCiAgICAgICAgICAgIEVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicpDQogICAgICAgICAgICBpZiBFbmNvZGluZyA9PSAnInZhcmludCInOg0KICAgICAgICAgICAgICAgIHBhdGggPSBnZXRQYXRoKEZpbGUpDQogICAgICAgICAgICAgICAgaWYgcGF0aDoNCiAgICAgICAgICAgICAgICAgICAgZmlsZSA9IG9wZW4ocGF0aCwgJ3JiJykNCiAgICAgICAgICAgICAgICAgICAgZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KICAgICAgICAgICAgICAgICAgICBieXRlcyA9IGRlY29kZVZhcmludChnLCBPZmZzZXQsIFNpemUgKiBJdGVtU2l6ZSwgdHlwZSkNCiAgICAgICAgICAgICAgICAgICAgbm9ybWFsQXJyYXkuYXBwZW5kKFtieXRlcywgRW5jb2RpbmcsIEl0ZW1TaXplXSkNCiAgICAgICAgICAgICAgICAgICAgZmlsZS5jbG9zZSgpDQogICAgICAgIEZsb2F0MzJBcnJheSA9IHlzLmdldChiLCAnIkZsb2F0MzJBcnJheSInKQ0KICAgICAgICBpZiBGbG9hdDMyQXJyYXk6DQogICAgICAgICAgICB0eXBlID0gJ0Zsb2F0MzJBcnJheScNCiAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgJzonKQ0KICAgICAgICAgICAgU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICdpJykNCiAgICAgICAgICAgIE9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgJ2knKQ0KICAgICAgICAgICAgRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicsICciIicpDQogICAgICAgICAgICBFbmNvZGluZyA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJFbmNvZGluZyInKQ0KICAgICAgICAgICAgaWYgRW5jb2RpbmcgIT0gJyJ2YXJpbnQiJzoNCiAgICAgICAgICAgICAgICBwYXRoID0gZ2V0UGF0aChGaWxlKQ0KICAgICAgICAgICAgICAgIGlmIHBhdGg6DQogICAgICAgICAgICAgICAgICAgIGdsb2JhbCBtb2RlbElEDQogICAgICAgICAgICAgICAgICAgIGZpbGUgPSBvcGVuKHBhdGgsICdyYicpDQogICAgICAgICAgICAgICAgICAgIGcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCiAgICAgICAgICAgICAgICAgICAgYnl0ZXMgPSByZWFkRmxvYXRzKGcsIE9mZnNldCwgU2l6ZSwgSXRlbVNpemUpDQogICAgICAgICAgICAgICAgICAgIHdpdGggb3BlbignLi92ZXJ0ZXhOb3JtYWxEYXRhLycgKyBzdHIobW9kZWxJRCkgKyAnLmRhdCcsICdhJykgYXMgXA0KICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxEYXRhOg0KICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxJRCArPSAxDQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgbGluZSBpbiBieXRlczoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbERhdGEud3JpdGUoc3RyKGxpbmUpICsgJ1x4MEEnKQ0KICAgICAgICAgICAgICAgICAgICBub3JtYWxBcnJheS5hcHBlbmQoW2J5dGVzLCBFbmNvZGluZywgSXRlbVNpemVdKQ0KICAgICAgICAgICAgICAgICAgICBmaWxlLmNsb3NlKCkNCiAgICByZXR1cm4gbm9ybWFsQXJyYXkNCmRlZiBWZXJ0ZXgoeXMsIGIpOg0KICAgIG4gPSAyMA0KICAgIFNpemUgPSBOb25lDQogICAgT2Zmc2V0ID0gTm9uZQ0KICAgIEVuY29kaW5nID0gTm9uZQ0KICAgIEl0ZW1TaXplID0gTm9uZQ0KICAgIHR5cGUgPSBOb25lDQogICAgdmVydGV4QXJyYXkgPSBbXQ0KICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhiLmRhdGEsICc6JykNCiAgICBpZiAnIkl0ZW1TaXplIicgaW4gdmFsdWVzOg0KICAgICAgICBJdGVtU2l6ZSA9IGludCh2YWx1ZXNbJyJJdGVtU2l6ZSInXSkNCiAgICAgICAgSW50MzJBcnJheSA9IHlzLmdldChiLCAnIkludDMyQXJyYXkiJykNCiAgICAgICAgaWYgSW50MzJBcnJheToNCiAgICAgICAgICAgIHR5cGUgPSAnSW50MzJBcnJheScNCiAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhJbnQzMkFycmF5WzBdLmRhdGEsICc6JykNCiAgICAgICAgICAgIFNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAnaScpDQogICAgICAgICAgICBPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicsICdpJykNCiAgICAgICAgICAgIEZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInLCAnIiInKQ0KICAgICAgICAgICAgRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJykNCiAgICAgICAgICAgIGlmIEVuY29kaW5nID09ICcidmFyaW50Iic6DQogICAgICAgICAgICAgICAgcGF0aCA9IGdldFBhdGgoRmlsZSkNCiAgICAgICAgICAgICAgICBpZiBwYXRoOg0KICAgICAgICAgICAgICAgICAgICBmaWxlID0gb3BlbihwYXRoLCAncmInKQ0KICAgICAgICAgICAgICAgICAgICBnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQogICAgICAgICAgICAgICAgICAgIGJ5dGVzID0gZGVjb2RlVmFyaW50KGcsIE9mZnNldCwgU2l6ZSAqIEl0ZW1TaXplLCB0eXBlKQ0KICAgICAgICAgICAgICAgICAgICB2ZXJ0ZXhBcnJheS5hcHBlbmQoW2J5dGVzLCBFbmNvZGluZywgSXRlbVNpemVdKQ0KICAgICAgICAgICAgICAgICAgICBmaWxlLmNsb3NlKCkNCiAgICAgICAgRmxvYXQzMkFycmF5ID0geXMuZ2V0KGIsICciRmxvYXQzMkFycmF5IicpDQogICAgICAgIGlmIEZsb2F0MzJBcnJheToNCiAgICAgICAgICAgIHR5cGUgPSAnRmxvYXQzMkFycmF5Jw0KICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCAnOicpDQogICAgICAgICAgICBTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgJ2knKQ0KICAgICAgICAgICAgT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAnaScpDQogICAgICAgICAgICBGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCiAgICAgICAgICAgIEVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicpDQogICAgICAgICAgICBpZiBFbmNvZGluZyAhPSAnInZhcmludCInOg0KICAgICAgICAgICAgICAgIHBhdGggPSBnZXRQYXRoKEZpbGUpDQogICAgICAgICAgICAgICAgaWYgcGF0aDoNCiAgICAgICAgICAgICAgICAgICAgZmlsZSA9IG9wZW4ocGF0aCwgJ3JiJykNCiAgICAgICAgICAgICAgICAgICAgZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KICAgICAgICAgICAgICAgICAgICBnLnNlZWsoT2Zmc2V0KQ0KICAgICAgICAgICAgICAgICAgICBieXRlcyA9IGcuZihTaXplICogSXRlbVNpemUpDQogICAgICAgICAgICAgICAgICAgIGxpc3QgPSBbXQ0KICAgICAgICAgICAgICAgICAgICBmb3IgbSBpbiByYW5nZShTaXplKToNCiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QuYXBwZW5kKGJ5dGVzW20gKiBJdGVtU2l6ZTptICogSXRlbVNpemUgKyBJdGVtU2l6ZV0pDQogICAgICAgICAgICAgICAgICAgIHZlcnRleEFycmF5LmFwcGVuZChbbGlzdCwgRW5jb2RpbmddKQ0KICAgICAgICAgICAgICAgICAgICBmaWxlLmNsb3NlKCkNCiAgICByZXR1cm4gdmVydGV4QXJyYXkNCmRlZiBUZXhDb29yZCh5cywgYik6DQogICAgbiA9IDIwDQogICAgU2l6ZSA9IE5vbmUNCiAgICBPZmZzZXQgPSBOb25lDQogICAgRW5jb2RpbmcgPSBOb25lDQogICAgSXRlbVNpemUgPSBOb25lDQogICAgdHlwZSA9IE5vbmUNCiAgICBUZXhDb29yZEFycmF5ID0gW10NCiAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoYi5kYXRhLCAnOicpDQogICAgaWYgJyJJdGVtU2l6ZSInIGluIHZhbHVlczoNCiAgICAgICAgSXRlbVNpemUgPSBpbnQodmFsdWVzWyciSXRlbVNpemUiJ10pDQogICAgICAgIEludDMyQXJyYXkgPSB5cy5nZXQoYiwgJyJJbnQzMkFycmF5IicpDQogICAgICAgIGlmIEludDMyQXJyYXk6DQogICAgICAgICAgICB0eXBlID0gJ0ludDMyQXJyYXknDQogICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoSW50MzJBcnJheVswXS5kYXRhLCAnOicpDQogICAgICAgICAgICBTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgJ2knKQ0KICAgICAgICAgICAgT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAnaScpDQogICAgICAgICAgICBGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCiAgICAgICAgICAgIEVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicpDQogICAgICAgICAgICBpZiBFbmNvZGluZyA9PSAnInZhcmludCInOg0KICAgICAgICAgICAgICAgIHBhdGggPSBnZXRQYXRoKEZpbGUpDQogICAgICAgICAgICAgICAgaWYgcGF0aDoNCiAgICAgICAgICAgICAgICAgICAgZmlsZSA9IG9wZW4ocGF0aCwgJ3JiJykNCiAgICAgICAgICAgICAgICAgICAgZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KICAgICAgICAgICAgICAgICAgICBieXRlcyA9IGRlY29kZVZhcmludChnLCBPZmZzZXQsIFNpemUgKiBJdGVtU2l6ZSwgdHlwZSkNCiAgICAgICAgICAgICAgICAgICAgVGV4Q29vcmRBcnJheS5hcHBlbmQoW2J5dGVzLCBFbmNvZGluZywgSXRlbVNpemVdKQ0KICAgICAgICAgICAgICAgICAgICBmaWxlLmNsb3NlKCkNCiAgICAgICAgRmxvYXQzMkFycmF5ID0geXMuZ2V0KGIsICciRmxvYXQzMkFycmF5IicpDQogICAgICAgIGlmIEZsb2F0MzJBcnJheToNCiAgICAgICAgICAgIHR5cGUgPSAnRmxvYXQzMkFycmF5Jw0KICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCAnOicpDQogICAgICAgICAgICBTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgJ2knKQ0KICAgICAgICAgICAgT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAnaScpDQogICAgICAgICAgICBGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCiAgICAgICAgICAgIEVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicpDQogICAgICAgICAgICBpZiBFbmNvZGluZyAhPSAnInZhcmludCInOg0KICAgICAgICAgICAgICAgIHBhdGggPSBnZXRQYXRoKEZpbGUpDQogICAgICAgICAgICAgICAgaWYgcGF0aDoNCiAgICAgICAgICAgICAgICAgICAgZmlsZSA9IG9wZW4ocGF0aCwgJ3JiJykNCiAgICAgICAgICAgICAgICAgICAgZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KICAgICAgICAgICAgICAgICAgICBnLnNlZWsoT2Zmc2V0KQ0KICAgICAgICAgICAgICAgICAgICBieXRlcyA9IGcuZihTaXplICogSXRlbVNpemUpDQogICAgICAgICAgICAgICAgICAgIGxpc3QgPSBbXQ0KICAgICAgICAgICAgICAgICAgICBmb3IgbSBpbiByYW5nZShTaXplKToNCiAgICAgICAgICAgICAgICAgICAgICAgICh1LCB2KSA9IGJ5dGVzW20gKiBJdGVtU2l6ZTptICogSXRlbVNpemUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIEl0ZW1TaXplXQ0KICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCiAgICAgICAgICAgICAgICAgICAgVGV4Q29vcmRBcnJheS5hcHBlbmQoW2xpc3QsIEVuY29kaW5nXSkNCiAgICAgICAgICAgICAgICAgICAgZmlsZS5jbG9zZSgpDQogICAgcmV0dXJuIFRleENvb3JkQXJyYXkNCmRlZiBDb2xvcih5cywgYik6DQogICAgbiA9IDIwDQogICAgU2l6ZSA9IE5vbmUNCiAgICBPZmZzZXQgPSBOb25lDQogICAgRW5jb2RpbmcgPSBOb25lDQogICAgSXRlbVNpemUgPSBOb25lDQogICAgdHlwZSA9IE5vbmUNCiAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoYi5kYXRhLCAnOicpDQogICAgY29sb3JBcnJheSA9IFtdDQogICAgaWYgJyJJdGVtU2l6ZSInIGluIHZhbHVlczoNCiAgICAgICAgSXRlbVNpemUgPSBpbnQodmFsdWVzWyciSXRlbVNpemUiJ10pDQogICAgICAgIFVpbnQ4QXJyYXkgPSB5cy5nZXQoYiwgJyJVaW50OEFycmF5IicpDQogICAgICAgIGlmIFVpbnQ4QXJyYXk6DQogICAgICAgICAgICB0eXBlID0gJ1VpbnQ4QXJyYXknDQogICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoVWludDhBcnJheVswXS5kYXRhLCAnOicpDQogICAgICAgICAgICBTaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIlNpemUiJywgJ2knKQ0KICAgICAgICAgICAgT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAnaScpDQogICAgICAgICAgICBFbmNvZGluZyA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJFbmNvZGluZyInLCAnIiInKQ0KICAgICAgICAgICAgRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicsICciIicpDQogICAgICAgICAgICBwYXRoID0gZ2V0UGF0aChGaWxlKQ0KICAgICAgICAgICAgaWYgcGF0aDoNCiAgICAgICAgICAgICAgICBpZiBFbmNvZGluZyAhPSAnInZhcmludCInOg0KICAgICAgICAgICAgICAgICAgICBmaWxlID0gb3BlbihwYXRoLCAncmInKQ0KICAgICAgICAgICAgICAgICAgICBnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQogICAgICAgICAgICAgICAgICAgIGcuc2VlayhPZmZzZXQpDQogICAgICAgICAgICAgICAgICAgIGJ5dGVzID0gZy5CKFNpemUgKiBJdGVtU2l6ZSkNCiAgICAgICAgICAgICAgICAgICAgbGlzdCA9IFtdDQogICAgICAgICAgICAgICAgICAgIGZvciBtIGluIHJhbmdlKFNpemUpOg0KICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC5hcHBlbmQoYnl0ZXNbbSAqIEl0ZW1TaXplOm0gKiBJdGVtU2l6ZSArIEl0ZW1TaXplXSkNCiAgICAgICAgICAgICAgICAgICAgY29sb3JBcnJheSA9IGxpc3QNCiAgICAgICAgICAgICAgICAgICAgZmlsZS5jbG9zZSgpDQogICAgICAgIEZsb2F0MzJBcnJheSA9IHlzLmdldChiLCAnIkZsb2F0MzJBcnJheSInKQ0KICAgICAgICBpZiBGbG9hdDMyQXJyYXk6DQogICAgICAgICAgICB0eXBlID0gJ0Zsb2F0MzJBcnJheScNCiAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgJzonKQ0KICAgICAgICAgICAgU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICdpJykNCiAgICAgICAgICAgIE9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgJ2knKQ0KICAgICAgICAgICAgRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJywgJyIiJykNCiAgICAgICAgICAgIEZpbGUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRmlsZSInLCAnIiInKQ0KICAgICAgICAgICAgcGF0aCA9IGdldFBhdGgoRmlsZSkNCiAgICAgICAgICAgIGlmIHBhdGg6DQogICAgICAgICAgICAgICAgaWYgRW5jb2RpbmcgIT0gJyJ2YXJpbnQiJzoNCiAgICAgICAgICAgICAgICAgICAgZmlsZSA9IG9wZW4ocGF0aCwgJ3JiJykNCiAgICAgICAgICAgICAgICAgICAgZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KICAgICAgICAgICAgICAgICAgICBnLnNlZWsoT2Zmc2V0KQ0KICAgICAgICAgICAgICAgICAgICBieXRlcyA9IGcuZihTaXplICogSXRlbVNpemUpDQogICAgICAgICAgICAgICAgICAgIGxpc3QgPSBbXQ0KICAgICAgICAgICAgICAgICAgICBmb3IgbSBpbiByYW5nZShTaXplKToNCiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zID0gYnl0ZXNbbSAqIEl0ZW1TaXplOm0gKiBJdGVtU2l6ZSArIEl0ZW1TaXplXQ0KICAgICAgICAgICAgICAgICAgICAgICAgQSA9IFtdDQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgaXRlbSBpbiBpdGVtczoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBLmFwcGVuZChpbnQoaXRlbSAqIDI1NikpDQogICAgICAgICAgICAgICAgICAgICAgICBsaXN0LmFwcGVuZChBKQ0KICAgICAgICAgICAgICAgICAgICBjb2xvckFycmF5ID0gbGlzdA0KICAgICAgICAgICAgICAgICAgICBmaWxlLmNsb3NlKCkNCiAgICByZXR1cm4gY29sb3JBcnJheQ0KZGVmIGdldEluZGljZXMoaXRlbXNpemUsIHNpemUsIG9mZnNldCwgdHlwZSwgZywgbW9kZSwgbWFnaWMpOg0KICAgIGlmIHR5cGUgIT0gJ1VpbnQ4QXJyYXknOg0KICAgICAgICBieXRlcyA9IGRlY29kZVZhcmludChnLCBvZmZzZXQsIHNpemUgKiBpdGVtc2l6ZSwgdHlwZSkNCiAgICBlbHNlOg0KICAgICAgICBnLnNlZWsob2Zmc2V0KQ0KICAgICAgICBieXRlcyA9IGxpc3QoZy5CKHNpemUgKiBpdGVtc2l6ZSkpDQogICAgSU1QTElDSVRfSEVBREVSX0xFTkdUSCA9IDMNCiAgICBJTVBMSUNJVF9IRUFERVJfTUFTS19MRU5HVEggPSAxDQogICAgSU1QTElDSVRfSEVBREVSX1BSSU1JVElWRV9MRU5HVEggPSAwDQogICAgSU1QTElDSVRfSEVBREVSX0VYUEVDVEVEX0lOREVYID0gMg0KICAgIGhpZ2hXYXRlcm1hcmsgPSAyDQogICAgaWYgbm90IGluZGV4Rml4Og0KICAgICAgICBpZiBtb2RlID09ICciVFJJQU5HTEVfU1RSSVAiJzoNCiAgICAgICAgICAgIGsgPSBJTVBMSUNJVF9IRUFERVJfTEVOR1RIICsgYnl0ZXNbSU1QTElDSVRfSEVBREVSX01BU0tfTEVOR1RIXQ0KICAgICAgICAgICAgYnl0ZXMgPSBkZWNvZGVEZWx0YShieXRlcywgaykNCiAgICAgICAgICAgIGJ5dGVzID0gZGVjb2RlSW1wbGljaXQoYnl0ZXMsIGspDQogICAgICAgICAgICBpID0gW21hZ2ljXQ0KICAgICAgICAgICAgKGJ5dGVzLCBtYWdpYykgPSBkZWNvZGVXYXRlcm1hcmsoYnl0ZXMsIGJ5dGVzLCBpKQ0KICAgICAgICBlbGlmIG1vZGUgPT0gJyJUUklBTkdMRVMiJzoNCiAgICAgICAgICAgIGsgPSAwDQogICAgICAgICAgICBieXRlcyA9IGRlY29kZURlbHRhKGJ5dGVzLCBrKQ0KICAgICAgICAgICAgaSA9IFttYWdpY10NCiAgICAgICAgICAgIChieXRlcywgbWFnaWMpID0gZGVjb2RlV2F0ZXJtYXJrKGJ5dGVzLCBieXRlcywgaSkNCiAgICByZXR1cm4gKG1hZ2ljLCBieXRlcykNCmRlZiBQcmltaXRpdmVTZXRMaXN0KHlzLCBjaGlsZCk6DQogICAgZ2xvYmFsIG1hZ2ljDQogICAgbW9kZSA9IE5vbmUNCiAgICBtYWdpYyA9IDANCiAgICBuID0gMTYNCiAgICBpbmRpY2VBcnJheSA9IFtdDQogICAgZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KICAgICAgICBiID0gY2hpbGQubm9kZQ0KICAgICAgICBpZiAnIkRyYXdFbGVtZW50c1VJbnQiJyBpbiBiLmhlYWRlcjoNCiAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhiLmRhdGEsICc6JykNCiAgICAgICAgICAgIG1vZGUgPSB2YWx1ZXNbJyJNb2RlIiddDQogICAgICAgICAgICBTaXplID0gTm9uZQ0KICAgICAgICAgICAgT2Zmc2V0ID0gTm9uZQ0KICAgICAgICAgICAgRW5jb2RpbmcgPSBOb25lDQogICAgICAgICAgICBJdGVtU2l6ZSA9IE5vbmUNCiAgICAgICAgICAgIHR5cGUgPSBOb25lDQogICAgICAgICAgICBpZiBtb2RlICE9ICciTElORVMiJzoNCiAgICAgICAgICAgICAgICBJbmRpY2VzID0geXMuZ2V0KGIsICciSW5kaWNlcyInKQ0KICAgICAgICAgICAgICAgIGlmIEluZGljZXM6DQogICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhJbmRpY2VzWzBdLmRhdGEsICc6JykNCiAgICAgICAgICAgICAgICAgICAgSXRlbVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciSXRlbVNpemUiJywgJ2knKQ0KICAgICAgICAgICAgICAgICAgICBVaW50MzJBcnJheSA9IHlzLmdldChJbmRpY2VzWzBdLCAnIlVpbnQzMkFycmF5IicpDQogICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnVWludDMyQXJyYXknDQogICAgICAgICAgICAgICAgICAgIGlmIFVpbnQzMkFycmF5Og0KICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKFVpbnQzMkFycmF5WzBdLmRhdGEsICc6JykNCiAgICAgICAgICAgICAgICAgICAgICAgIFNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAnaScpDQogICAgICAgICAgICAgICAgICAgICAgICBPZmZzZXQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciT2Zmc2V0IicsICdpJykNCiAgICAgICAgICAgICAgICAgICAgICAgIEVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicsICciIicpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBFbmNvZGluZyA9PSAndmFyaW50JzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gb3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKSArIG9zLnNlcCArICdtb2RlbF9maWxlLmJpbi5neicNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKSA9PSBGYWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IG9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkgKyBvcy5zZXAgKyAnbW9kZWxfZmlsZS5iaW56Jw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKHBhdGgpID09IEZhbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gb3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKSArIG9zLnNlcCArICdtb2RlbF9maWxlLmJpbicNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKSA9PSBGYWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IG9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkgKyBvcy5zZXAgKyB2YWx1ZXNbJyJGaWxlIiddLnNwbGl0KCciJylbMV0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKSA9PSBUcnVlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlID0gb3BlbihwYXRoLCAncmInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChtYWdpYywgaW5kaWNlTGlzdCkgPSBnZXRJbmRpY2VzKEl0ZW1TaXplLCBTaXplLCBPZmZzZXQsIHR5cGUsIGcsIG1vZGUsIG1hZ2ljKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2VBcnJheS5hcHBlbmQoW2luZGljZUxpc3QsIG1vZGVdKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLmNsb3NlKCkNCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgcGFzcw0KICAgICAgICBpZiAnIkRyYXdFbGVtZW50c1VTaG9ydCInIGluIGIuaGVhZGVyOg0KICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKGIuZGF0YSwgJzonKQ0KICAgICAgICAgICAgbW9kZSA9IHZhbHVlc1snIk1vZGUiJ10NCiAgICAgICAgICAgIFNpemUgPSBOb25lDQogICAgICAgICAgICBPZmZzZXQgPSBOb25lDQogICAgICAgICAgICBFbmNvZGluZyA9IE5vbmUNCiAgICAgICAgICAgIEl0ZW1TaXplID0gTm9uZQ0KICAgICAgICAgICAgdHlwZSA9IE5vbmUNCiAgICAgICAgICAgIGlmIG1vZGUgIT0gJyJMSU5FUyInOg0KICAgICAgICAgICAgICAgIEluZGljZXMgPSB5cy5nZXQoYiwgJyJJbmRpY2VzIicpDQogICAgICAgICAgICAgICAgaWYgSW5kaWNlczoNCiAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKEluZGljZXNbMF0uZGF0YSwgJzonKQ0KICAgICAgICAgICAgICAgICAgICBJdGVtU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJJdGVtU2l6ZSInLCAnaScpDQogICAgICAgICAgICAgICAgICAgIFVpbnQxNkFycmF5ID0geXMuZ2V0KEluZGljZXNbMF0sICciVWludDE2QXJyYXkiJykNCiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICdVaW50MTZBcnJheScNCiAgICAgICAgICAgICAgICAgICAgaWYgVWludDE2QXJyYXk6DQogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoVWludDE2QXJyYXlbMF0uZGF0YSwgJzonKQ0KICAgICAgICAgICAgICAgICAgICAgICAgU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICdpJykNCiAgICAgICAgICAgICAgICAgICAgICAgIE9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgJ2knKQ0KICAgICAgICAgICAgICAgICAgICAgICAgRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJywgJyIiJykNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIEVuY29kaW5nID09ICd2YXJpbnQnOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSBvcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpICsgb3Muc2VwICsgJ21vZGVsX2ZpbGUuYmluLmd6Jw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKHBhdGgpID09IEZhbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gb3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKSArIG9zLnNlcCArICdtb2RlbF9maWxlLmJpbnonDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMocGF0aCkgPT0gRmFsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSBvcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpICsgb3Muc2VwICsgJ21vZGVsX2ZpbGUuYmluJw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKHBhdGgpID09IEZhbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gb3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKSArIG9zLnNlcCArIHZhbHVlc1snIkZpbGUiJ10uc3BsaXQoJyInKVsxXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKHBhdGgpID09IFRydWU6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUgPSBvcGVuKHBhdGgsICdyYicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG1hZ2ljLCBpbmRpY2VMaXN0KSA9IGdldEluZGljZXMoSXRlbVNpemUsIFNpemUsIE9mZnNldCwgdHlwZSwgZywgbW9kZSwgbWFnaWMpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGljZUFycmF5LmFwcGVuZChbaW5kaWNlTGlzdCwgbW9kZV0pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUuY2xvc2UoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gb3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKSArIG9zLnNlcCArICdtb2RlbF9maWxlLmJpbi5neicNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKSA9PSBGYWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IG9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkgKyBvcy5zZXAgKyAnbW9kZWxfZmlsZS5iaW56Jw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKHBhdGgpID09IEZhbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gb3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKSArIG9zLnNlcCArICdtb2RlbF9maWxlLmJpbicNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKSA9PSBGYWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IG9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkgKyBvcy5zZXAgKyB2YWx1ZXNbJyJGaWxlIiddLnNwbGl0KCciJylbMV0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKSA9PSBUcnVlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlID0gb3BlbihwYXRoLCAncmInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcuc2VlayhPZmZzZXQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGljZUxpc3QgPSBnLkgoSXRlbVNpemUgKiBTaXplKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2VBcnJheS5hcHBlbmQoW2luZGljZUxpc3QsIG1vZGVdKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLmNsb3NlKCkNCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgcGFzcw0KICAgICAgICBpZiAnIkRyYXdFbGVtZW50c1VCeXRlIicgaW4gYi5oZWFkZXI6DQogICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoYi5kYXRhLCAnOicpDQogICAgICAgICAgICBtb2RlID0gdmFsdWVzWyciTW9kZSInXQ0KICAgICAgICAgICAgU2l6ZSA9IE5vbmUNCiAgICAgICAgICAgIE9mZnNldCA9IE5vbmUNCiAgICAgICAgICAgIEVuY29kaW5nID0gTm9uZQ0KICAgICAgICAgICAgSXRlbVNpemUgPSBOb25lDQogICAgICAgICAgICB0eXBlID0gTm9uZQ0KICAgICAgICAgICAgaWYgbW9kZSAhPSAnIkxJTkVTIic6DQogICAgICAgICAgICAgICAgSW5kaWNlcyA9IHlzLmdldChiLCAnIkluZGljZXMiJykNCiAgICAgICAgICAgICAgICBpZiBJbmRpY2VzOg0KICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoSW5kaWNlc1swXS5kYXRhLCAnOicpDQogICAgICAgICAgICAgICAgICAgIEl0ZW1TaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkl0ZW1TaXplIicsICdpJykNCiAgICAgICAgICAgICAgICAgICAgVWludDhBcnJheSA9IHlzLmdldChJbmRpY2VzWzBdLCAnIlVpbnQ4QXJyYXkiJykNCiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICdVaW50OEFycmF5Jw0KICAgICAgICAgICAgICAgICAgICBpZiBVaW50OEFycmF5Og0KICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKFVpbnQ4QXJyYXlbMF0uZGF0YSwgJzonKQ0KICAgICAgICAgICAgICAgICAgICAgICAgU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICdpJykNCiAgICAgICAgICAgICAgICAgICAgICAgIE9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgJ2knKQ0KICAgICAgICAgICAgICAgICAgICAgICAgRW5jb2RpbmcgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciRW5jb2RpbmciJywgJyIiJykNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSBvcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpICsgb3Muc2VwICsgJ21vZGVsX2ZpbGUuYmluLmd6Jw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMocGF0aCkgPT0gRmFsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IG9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkgKyBvcy5zZXAgKyAnbW9kZWxfZmlsZS5iaW56Jw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMocGF0aCkgPT0gRmFsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IG9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkgKyBvcy5zZXAgKyAnbW9kZWxfZmlsZS5iaW4nDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKSA9PSBGYWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gb3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKSArIG9zLnNlcCArIHZhbHVlc1snIkZpbGUiJ10uc3BsaXQoJyInKVsxXQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMocGF0aCkgPT0gVHJ1ZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlID0gb3BlbihwYXRoLCAncmInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAobWFnaWMsIGluZGljZUxpc3QpID0gZ2V0SW5kaWNlcyhJdGVtU2l6ZSwgU2l6ZSwgT2Zmc2V0LCB0eXBlLCBnLCBtb2RlLCBtYWdpYykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2VBcnJheS5hcHBlbmQoW2luZGljZUxpc3QsIG1vZGVdKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUuY2xvc2UoKQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBwYXNzDQogICAgcmV0dXJuIGluZGljZUFycmF5DQpkZWYgQm9uZXMoeXMsIGIpOg0KICAgIG4gPSAyMA0KICAgIGJvbmVzID0gW10NCiAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoYi5kYXRhLCAnOicpDQogICAgSXRlbVNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciSXRlbVNpemUiJywgJ2knKQ0KICAgIFVpbnQxNkFycmF5ID0geXMuZ2V0KGIsICciVWludDE2QXJyYXkiJykNCiAgICBpZiBVaW50MTZBcnJheToNCiAgICAgICAgdHlwZSA9ICdVaW50MTZBcnJheScNCiAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKFVpbnQxNkFycmF5WzBdLmRhdGEsICc6JykNCiAgICAgICAgRmlsZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJGaWxlIicsICciIicpDQogICAgICAgIFNpemUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciU2l6ZSInLCAnaScpDQogICAgICAgIE9mZnNldCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJPZmZzZXQiJywgJ2knKQ0KICAgICAgICBFbmNvZGluZyA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJFbmNvZGluZyInLCAnIiInKQ0KICAgICAgICBpZiBFbmNvZGluZyA9PSAndmFyaW50JzoNCiAgICAgICAgICAgIHBhdGggPSBnZXRQYXRoKEZpbGUpDQogICAgICAgICAgICBpZiBwYXRoOg0KICAgICAgICAgICAgICAgIGZpbGUgPSBvcGVuKHBhdGgsICdyYicpDQogICAgICAgICAgICAgICAgZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KICAgICAgICAgICAgICAgIGxpc3QgPSBkZWNvZGVWYXJpbnQoZywgT2Zmc2V0LCBTaXplICogSXRlbVNpemUsIHR5cGUpDQogICAgICAgICAgICAgICAgZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQogICAgICAgICAgICAgICAgICAgIGJvbmVzLmFwcGVuZChsaXN0W20gKiBJdGVtU2l6ZTptICogSXRlbVNpemUgKyBJdGVtU2l6ZV0pDQogICAgICAgICAgICAgICAgZmlsZS5jbG9zZSgpDQogICAgcmV0dXJuIGJvbmVzDQpkZWYgV2VpZ2h0cyh5cywgYik6DQogICAgbiA9IDIwDQogICAgd2VpZ2h0cyA9IFtdDQogICAgdmFsdWVzID0geXMudmFsdWVzKGIuZGF0YSwgJzonKQ0KICAgIEl0ZW1TaXplID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkl0ZW1TaXplIicsICdpJykNCiAgICBGbG9hdDMyQXJyYXkgPSB5cy5nZXQoYiwgJyJGbG9hdDMyQXJyYXkiJykNCiAgICBpZiBGbG9hdDMyQXJyYXk6DQogICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwgJzonKQ0KICAgICAgICBGaWxlID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkZpbGUiJywgJyIiJykNCiAgICAgICAgU2l6ZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJTaXplIicsICdpJykNCiAgICAgICAgT2Zmc2V0ID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk9mZnNldCInLCAnaScpDQogICAgICAgIEVuY29kaW5nID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIkVuY29kaW5nIicsICciIicpDQogICAgICAgIGlmIEVuY29kaW5nID09ICd2YXJpbnQnOg0KICAgICAgICAgICAgcGF0aCA9IGdldFBhdGgoRmlsZSkNCiAgICAgICAgICAgIGlmIHBhdGg6DQogICAgICAgICAgICAgICAgZmlsZSA9IG9wZW4ocGF0aCwgJ3JiJykNCiAgICAgICAgICAgICAgICBnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQogICAgICAgICAgICAgICAgbGlzdCA9IGRlY29kZVZhcmludChnLCBPZmZzZXQsIFNpemUgKiBJdGVtU2l6ZSwgdHlwZSkNCiAgICAgICAgICAgICAgICBmaWxlLmNsb3NlKCkNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHBhdGggPSBnZXRQYXRoKEZpbGUpDQogICAgICAgICAgICBpZiBwYXRoOg0KICAgICAgICAgICAgICAgIGZpbGUgPSBvcGVuKHBhdGgsICdyYicpDQogICAgICAgICAgICAgICAgZyA9IEJpbmFyeVJlYWRlcihmaWxlKQ0KICAgICAgICAgICAgICAgIGcuc2VlayhPZmZzZXQpDQogICAgICAgICAgICAgICAgbGlzdCA9IGcuZihTaXplICogSXRlbVNpemUpDQogICAgICAgICAgICAgICAgZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQogICAgICAgICAgICAgICAgICAgIHdlaWdodHMuYXBwZW5kKGxpc3RbbSAqIEl0ZW1TaXplOm0gKiBJdGVtU2l6ZSArIEl0ZW1TaXplXSkNCiAgICAgICAgICAgICAgICBmaWxlLmNsb3NlKCkNCiAgICByZXR1cm4gd2VpZ2h0cw0KZGVmIEJvbmVNYXAoeXMsIGIpOg0KICAgIEJvbmVNYXAgPSB7fQ0KICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhiLmRhdGEsICc6JykNCiAgICBmb3IgdmFsdWUgaW4gdmFsdWVzOg0KICAgICAgICBpZCA9IHlzLmdldFZhbHVlKHZhbHVlcywgdmFsdWUsICdpJykNCiAgICAgICAgbmFtZSA9IHZhbHVlLnJlcGxhY2UoJyInLCAnJykNCiAgICAgICAgQm9uZU1hcFtuYW1lXSA9IGlkDQogICAgcmV0dXJuIEJvbmVNYXANCmRlZiBvc2dBbmltYXRpb25SaWdHZW9tZXRyeSh5cywgcGFyZW50TmV3Tm9kZSk6DQogICAgbWVzaCA9IE1lc2goKQ0KICAgIG1lc2gudmVydGV4QXJyYXkgPSBbXQ0KICAgIG1lc2guaW5kaWNlQXJyYXkgPSBbXQ0KICAgIG1lc2guVGV4Q29vcmQwQXJyYXkgPSBbXQ0KICAgIG1lc2guVGV4Q29vcmQxQXJyYXkgPSBbXQ0KICAgIG1lc2guVGV4Q29vcmQzQXJyYXkgPSBbXQ0KICAgIG1lc2guVGV4Q29vcmQ1QXJyYXkgPSBbXQ0KICAgIG1lc2guVGV4Q29vcmQ2QXJyYXkgPSBbXQ0KICAgIG1lc2guY29sb3JBcnJheSA9IFtdDQogICAgbWVzaC5ub3JtYWxBcnJheSA9IFtdDQogICAgbWVzaC5tb3JwaEFycmF5ID0ge30NCiAgICBtZXNoLkJvbmVzID0gW10NCiAgICBtZXNoLldlaWdodHMgPSBbXQ0KICAgIG1lc2guQm9uZU1hcCA9IHt9DQogICAgbWVzaC5hdHJpYnV0ZXMgPSB7fQ0KICAgIG1lc2gucGFyZW50Tm9kZSA9IHBhcmVudE5ld05vZGUubm9kZQ0KICAgIGZvciBjaGlsZCBpbiBwYXJlbnROZXdOb2RlLmNoaWxkcmVuOg0KICAgICAgICBpZiAnIlNvdXJjZUdlb21ldHJ5IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICBmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQogICAgICAgICAgICAgICAgaWYgJyJvc2dBbmltYXRpb24uTW9ycGhHZW9tZXRyeSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICBmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAnIlZlcnRleEF0dHJpYnV0ZUxpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICciVmVydGV4IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNoLnZlcnRleEFycmF5ID0gVmVydGV4KHlzLCBjaGlsZC5ub2RlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAnIk5vcm1hbCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzaC5ub3JtYWxBcnJheSA9IFZlcnRleE5vcm1hbCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJUZXhDb29yZDAiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc2guVGV4Q29vcmQwQXJyYXkgPSBUZXhDb29yZCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJUZXhDb29yZDEiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc2guVGV4Q29vcmQxQXJyYXkgPSBUZXhDb29yZCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJUZXhDb29yZDMiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc2guVGV4Q29vcmQzQXJyYXkgPSBUZXhDb29yZCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJUZXhDb29yZDUiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc2guVGV4Q29vcmQ1QXJyYXkgPSBUZXhDb29yZCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJUZXhDb29yZDYiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc2guVGV4Q29vcmQ2QXJyYXkgPSBUZXhDb29yZCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJDb2xvciInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzaC5jb2xvckFycmF5ID0gQ29sb3IoeXMsIGNoaWxkLm5vZGUpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAnIlByaW1pdGl2ZVNldExpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNoLmluZGljZUFycmF5ID0gUHJpbWl0aXZlU2V0TGlzdCh5cywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJVc2VyRGF0YUNvbnRhaW5lciInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc2guYXRyaWJ1dGVzID0gVXNlckRhdGFDb250YWluZXIoeXMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZCkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICciTW9ycGhUYXJnZXRzIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAnIm9zZy5HZW9tZXRyeSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTmFtZSA9IE5vbmUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAnIlZlcnRleEF0dHJpYnV0ZUxpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJWZXJ0ZXgiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBOYW1lOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNoLm1vcnBoQXJyYXlbTmFtZV0gPSBWZXJ0ZXgoeXMsIGNoaWxkLm5vZGUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJVbmlxdWVJRCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoY2hpbGQubm9kZS5oZWFkZXIsICc6JykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVW5pcXVlSUQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciVW5pcXVlSUQiJywgJ2knKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOYW1lID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk5hbWUiJywgJyIiJykNCiAgICAgICAgICAgICAgICBpZiAnIm9zZy5HZW9tZXRyeSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICBmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAnIlZlcnRleEF0dHJpYnV0ZUxpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICciVmVydGV4IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNoLnZlcnRleEFycmF5ID0gVmVydGV4KHlzLCBjaGlsZC5ub2RlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAnIk5vcm1hbCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzaC5ub3JtYWxBcnJheSA9IFZlcnRleE5vcm1hbCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJUZXhDb29yZDAiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc2guVGV4Q29vcmQwQXJyYXkgPSBUZXhDb29yZCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJUZXhDb29yZDEiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc2guVGV4Q29vcmQxQXJyYXkgPSBUZXhDb29yZCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJUZXhDb29yZDMiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc2guVGV4Q29vcmQzQXJyYXkgPSBUZXhDb29yZCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJUZXhDb29yZDUiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc2guVGV4Q29vcmQ1QXJyYXkgPSBUZXhDb29yZCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJUZXhDb29yZDYiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc2guVGV4Q29vcmQ2QXJyYXkgPSBUZXhDb29yZCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJDb2xvciInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzaC5jb2xvckFycmF5ID0gQ29sb3IoeXMsIGNoaWxkLm5vZGUpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAnIlByaW1pdGl2ZVNldExpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNoLmluZGljZUFycmF5ID0gUHJpbWl0aXZlU2V0TGlzdCh5cywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJVc2VyRGF0YUNvbnRhaW5lciInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc2guYXRyaWJ1dGVzID0gVXNlckRhdGFDb250YWluZXIoeXMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZCkNCiAgICAgICAgaWYgJyJWZXJ0ZXhBdHRyaWJ1dGVMaXN0IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICBmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQogICAgICAgICAgICAgICAgaWYgJyJCb25lcyInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICBtZXNoLkJvbmVzID0gQm9uZXMoeXMsIGNoaWxkLm5vZGUpDQogICAgICAgICAgICAgICAgaWYgJyJXZWlnaHRzIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICAgICAgICAgIG1lc2guV2VpZ2h0cyA9IFdlaWdodHMoeXMsIGNoaWxkLm5vZGUpDQogICAgICAgIGlmICciQm9uZU1hcCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgbWVzaC5Cb25lTWFwID0gQm9uZU1hcCh5cywgY2hpbGQubm9kZSkNCiAgICByZXR1cm4gbWVzaA0KZGVmIG9zZ0dlb21ldHJ5KHlzLCBwYXJlbnROZXdOb2RlKToNCiAgICBtZXNoID0gTWVzaCgpDQogICAgbWVzaC52ZXJ0ZXhBcnJheSA9IFtdDQogICAgbWVzaC5pbmRpY2VBcnJheSA9IFtdDQogICAgbWVzaC5UZXhDb29yZDBBcnJheSA9IFtdDQogICAgbWVzaC5UZXhDb29yZDFBcnJheSA9IFtdDQogICAgbWVzaC5UZXhDb29yZDNBcnJheSA9IFtdDQogICAgbWVzaC5UZXhDb29yZDVBcnJheSA9IFtdDQogICAgbWVzaC5UZXhDb29yZDZBcnJheSA9IFtdDQogICAgbWVzaC5jb2xvckFycmF5ID0gW10NCiAgICBtZXNoLm5vcm1hbEFycmF5ID0gW10NCiAgICBtZXNoLm1vcnBoQXJyYXkgPSB7fQ0KICAgIG1lc2guQm9uZXMgPSBbXQ0KICAgIG1lc2guV2VpZ2h0cyA9IFtdDQogICAgbWVzaC5Cb25lTWFwID0ge30NCiAgICBtZXNoLmF0cmlidXRlcyA9IHt9DQogICAgbWVzaC5wYXJlbnROb2RlID0gcGFyZW50TmV3Tm9kZS5ub2RlDQogICAgZm9yIGNoaWxkIGluIHBhcmVudE5ld05vZGUuY2hpbGRyZW46DQogICAgICAgIGlmICciVmVydGV4QXR0cmlidXRlTGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KICAgICAgICAgICAgICAgIGlmICciVmVydGV4IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICAgICAgICAgIG1lc2gudmVydGV4QXJyYXkgPSBWZXJ0ZXgoeXMsIGNoaWxkLm5vZGUpDQogICAgICAgICAgICAgICAgaWYgJyJOb3JtYWwiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgbWVzaC5ub3JtYWxBcnJheSA9IFZlcnRleE5vcm1hbCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICBpZiAnIlRleENvb3JkMCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICBtZXNoLlRleENvb3JkMEFycmF5ID0gVGV4Q29vcmQoeXMsIGNoaWxkLm5vZGUpDQogICAgICAgICAgICAgICAgaWYgJyJUZXhDb29yZDEiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgbWVzaC5UZXhDb29yZDFBcnJheSA9IFRleENvb3JkKHlzLCBjaGlsZC5ub2RlKQ0KICAgICAgICAgICAgICAgIGlmICciVGV4Q29vcmQzIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICAgICAgICAgIG1lc2guVGV4Q29vcmQzQXJyYXkgPSBUZXhDb29yZCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICBpZiAnIlRleENvb3JkNSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICBtZXNoLlRleENvb3JkNUFycmF5ID0gVGV4Q29vcmQoeXMsIGNoaWxkLm5vZGUpDQogICAgICAgICAgICAgICAgaWYgJyJUZXhDb29yZDYiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgbWVzaC5UZXhDb29yZDZBcnJheSA9IFRleENvb3JkKHlzLCBjaGlsZC5ub2RlKQ0KICAgICAgICAgICAgICAgIGlmICciQ29sb3IiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgbWVzaC5jb2xvckFycmF5ID0gQ29sb3IoeXMsIGNoaWxkLm5vZGUpDQogICAgICAgIGlmICciUHJpbWl0aXZlU2V0TGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgbWVzaC5pbmRpY2VBcnJheSA9IFByaW1pdGl2ZVNldExpc3QoeXMsIGNoaWxkKQ0KICAgICAgICBpZiAnIlVzZXJEYXRhQ29udGFpbmVyIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICBtZXNoLmF0cmlidXRlcyA9IFVzZXJEYXRhQ29udGFpbmVyKHlzLCBjaGlsZCkNCiAgICByZXR1cm4gbWVzaA0KZGVmIG9zZ0FuaW1hdGlvbk1vcnBoR2VvbWV0cnkoeXMsIHBhcmVudE5ld05vZGUpOg0KICAgIG1lc2ggPSBNZXNoKCkNCiAgICBtZXNoLnZlcnRleEFycmF5ID0gW10NCiAgICBtZXNoLmluZGljZUFycmF5ID0gW10NCiAgICBtZXNoLlRleENvb3JkMEFycmF5ID0gW10NCiAgICBtZXNoLlRleENvb3JkMUFycmF5ID0gW10NCiAgICBtZXNoLlRleENvb3JkM0FycmF5ID0gW10NCiAgICBtZXNoLlRleENvb3JkNUFycmF5ID0gW10NCiAgICBtZXNoLlRleENvb3JkNkFycmF5ID0gW10NCiAgICBtZXNoLmNvbG9yQXJyYXkgPSBbXQ0KICAgIG1lc2gubm9ybWFsQXJyYXkgPSBbXQ0KICAgIG1lc2gubW9ycGhBcnJheSA9IHt9DQogICAgbWVzaC5Cb25lcyA9IFtdDQogICAgbWVzaC5XZWlnaHRzID0gW10NCiAgICBtZXNoLkJvbmVNYXAgPSB7fQ0KICAgIG1lc2guYXRyaWJ1dGVzID0ge30NCiAgICBtZXNoLnBhcmVudE5vZGUgPSBwYXJlbnROZXdOb2RlLm5vZGUNCiAgICBmb3IgY2hpbGQgaW4gcGFyZW50TmV3Tm9kZS5jaGlsZHJlbjoNCiAgICAgICAgaWYgJyJNb3JwaFRhcmdldHMiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgIGZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCiAgICAgICAgICAgICAgICBpZiAnIm9zZy5HZW9tZXRyeSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICBOYW1lID0gTm9uZQ0KICAgICAgICAgICAgICAgICAgICBmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAnIlZlcnRleEF0dHJpYnV0ZUxpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICciVmVydGV4IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBOYW1lOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc2gubW9ycGhBcnJheVtOYW1lXSA9IFZlcnRleCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICciVW5pcXVlSUQiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoY2hpbGQubm9kZS5oZWFkZXIsICc6JykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBVbmlxdWVJRCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJVbmlxdWVJRCInLCAnaScpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgTmFtZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJOYW1lIicsICciIicpDQogICAgICAgIGlmICciVmVydGV4QXR0cmlidXRlTGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KICAgICAgICAgICAgICAgIGlmICciVmVydGV4IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICAgICAgICAgIG1lc2gudmVydGV4QXJyYXkgPSBWZXJ0ZXgoeXMsIGNoaWxkLm5vZGUpDQogICAgICAgICAgICAgICAgaWYgJyJOb3JtYWwiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgbWVzaC5ub3JtYWxBcnJheSA9IFZlcnRleE5vcm1hbCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICBpZiAnIlRleENvb3JkMCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICBtZXNoLlRleENvb3JkMEFycmF5ID0gVGV4Q29vcmQoeXMsIGNoaWxkLm5vZGUpDQogICAgICAgICAgICAgICAgaWYgJyJUZXhDb29yZDEiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgbWVzaC5UZXhDb29yZDFBcnJheSA9IFRleENvb3JkKHlzLCBjaGlsZC5ub2RlKQ0KICAgICAgICAgICAgICAgIGlmICciVGV4Q29vcmQzIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICAgICAgICAgIG1lc2guVGV4Q29vcmQzQXJyYXkgPSBUZXhDb29yZCh5cywgY2hpbGQubm9kZSkNCiAgICAgICAgICAgICAgICBpZiAnIlRleENvb3JkNSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICBtZXNoLlRleENvb3JkNUFycmF5ID0gVGV4Q29vcmQoeXMsIGNoaWxkLm5vZGUpDQogICAgICAgICAgICAgICAgaWYgJyJUZXhDb29yZDYiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgbWVzaC5UZXhDb29yZDZBcnJheSA9IFRleENvb3JkKHlzLCBjaGlsZC5ub2RlKQ0KICAgICAgICAgICAgICAgIGlmICciQ29sb3IiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgbWVzaC5jb2xvckFycmF5ID0gQ29sb3IoeXMsIGNoaWxkLm5vZGUpDQogICAgICAgIGlmICciUHJpbWl0aXZlU2V0TGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgbWVzaC5pbmRpY2VBcnJheSA9IFByaW1pdGl2ZVNldExpc3QoeXMsIGNoaWxkKQ0KICAgICAgICBpZiAnIlVzZXJEYXRhQ29udGFpbmVyIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICBtZXNoLmF0cmlidXRlcyA9IFVzZXJEYXRhQ29udGFpbmVyKHlzLCBjaGlsZCkNCiAgICByZXR1cm4gbWVzaA0KZGVmIGRyYXdNZXNoKHlzLCBtZXNoKToNCiAgICBkaWZmdXNlID0gTm9uZQ0KICAgIG5vcm1hbCA9IE5vbmUNCiAgICBzcGVjdWxhciA9IE5vbmUNCiAgICB0cmFucyA9IE5vbmUNCiAgICBhbyA9IE5vbmUNCiAgICByZ2JDb2wgPSBOb25lDQogICAgcmdiU3BlYyA9IE5vbmUNCiAgICByZ2JhID0gTm9uZQ0KICAgIG1vZGUgPSBOb25lDQogICAgKG1hdE5hbWUsIGRpZmZ1c2UsIHNwZWN1bGFyLCBub3JtYWwsIGFvLCB0cmFucywgcmdiQ29sLCByZ2JTcGVjLCByZ2JhKSA9IGdldE1hdE5hbWUoeXMsIG1lc2gucGFyZW50Tm9kZSkNCiAgICB0cnk6DQogICAgICAgIGlmIGxlbihtZXNoLm5vcm1hbEFycmF5KSA9PSAxOg0KICAgICAgICAgICAgaWYgbWVzaC5ub3JtYWxBcnJheVswXVsxXSA9PSAnInZhcmludCInOg0KICAgICAgICAgICAgICAgIGJ5dGVzID0gbWVzaC5ub3JtYWxBcnJheVswXVswXQ0KICAgICAgICAgICAgICAgIEl0ZW1TaXplID0gbWVzaC5ub3JtYWxBcnJheVswXVsyXQ0KICAgICAgICAgICAgICAgIGVwcyA9IGZsb2F0KG1lc2guYXRyaWJ1dGVzWydlcHNpbG9uJ10pDQogICAgICAgICAgICAgICAgbnBoaSA9IGZsb2F0KG1lc2guYXRyaWJ1dGVzWyducGhpJ10pDQogICAgICAgICAgICAgICAgc2l6ZSA9IGxlbihieXRlcykgLyBJdGVtU2l6ZQ0KICAgICAgICAgICAgICAgIGludHMgPSBieXRlcw0KICAgICAgICAgICAgICAgIGdsb2JhbCBtb2RlbElEDQogICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoJ21vZGVsRGF0YS5qcycpOg0KICAgICAgICAgICAgICAgICAgICBvcy5yZW1vdmUoJ21vZGVsRGF0YS5qcycpDQogICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoJ25vcm1hbHMuZGF0Jyk6DQogICAgICAgICAgICAgICAgICAgIG9zLnJlbW92ZSgnbm9ybWFscy5kYXQnKQ0KICAgICAgICAgICAgICAgIHdpdGggb3BlbignbW9kZWxEYXRhLmpzJywgJ2EnKSBhcyBtb2RlbERhdGE6DQogICAgICAgICAgICAgICAgICAgIG1vZGVsSUQgKz0gMQ0KICAgICAgICAgICAgICAgICAgICBtb2RlbERhdGEud3JpdGUoJ21vZHVsZS5leHBvcnRzLmVwcyA9ICcgKyBzdHIoZXBzKSArICc7XG4nKQ0KICAgICAgICAgICAgICAgICAgICBtb2RlbERhdGEud3JpdGUoJ21vZHVsZS5leHBvcnRzLm5waGkgPSAnICsgc3RyKG5waGkpICsgJztcbicpDQogICAgICAgICAgICAgICAgICAgIG1vZGVsRGF0YS53cml0ZSgnbW9kdWxlLmV4cG9ydHMuc2l6ZSA9ICcgKyBzdHIoc2l6ZSkgKyAnO1xuJykNCiAgICAgICAgICAgICAgICAgICAgbW9kZWxEYXRhLndyaXRlKCdtb2R1bGUuZXhwb3J0cy5pZCA9ICcgKyBzdHIobW9kZWxJRCkgKyAnO1xuJykNCiAgICAgICAgICAgICAgICAgICAgbW9kZWxEYXRhLndyaXRlKCdtb2R1bGUuZXhwb3J0cy5pbnRzID0gJyArIHN0cihieXRlcykgKyAnO1xuJykNCiAgICAgICAgICAgICAgICBzdWJwcm9jZXNzLmNhbGwoJ25vZGUuZXhlIC4ve3RlbXBQYXRofS9jYWxjVmVydGV4Tm9ybWFscy5qcycpDQogICAgZXhjZXB0Og0KICAgICAgICBwYXNzDQogICAgaWYgbGVuKG1lc2guaW5kaWNlQXJyYXkpID4gMDoNCiAgICAgICAgZm9yIFtpbmRpY2VzLCBtb2RlXSBpbiBtZXNoLmluZGljZUFycmF5Og0KICAgICAgICAgICAgbWF0ID0gTWF0KCkNCiAgICAgICAgICAgIG1hdC5tYXROYW1lID0gbWF0TmFtZQ0KICAgICAgICAgICAgbWF0LnJnYkNvbCA9IHJnYkNvbA0KICAgICAgICAgICAgbWF0LmRpZmZ1c2UgPSBkaWZmdXNlDQogICAgICAgICAgICBtYXQubm9ybWFsID0gbm9ybWFsDQogICAgICAgICAgICBtYXQuc3BlY3VsYXIgPSBzcGVjdWxhcg0KICAgICAgICAgICAgbWF0LnRyYW5zID0gdHJhbnMNCiAgICAgICAgICAgIGlmIHRyYW5zOg0KICAgICAgICAgICAgICAgIG1hdC5aVFJBTlMgPSBUcnVlDQogICAgICAgICAgICBpZiByZ2JhOg0KICAgICAgICAgICAgICAgIG1hdC5yZ2JhID0gcmdiYQ0KICAgICAgICAgICAgbWVzaC5tYXRMaXN0LmFwcGVuZChtYXQpDQogICAgICAgICAgICBtYXQuSURTdGFydCA9IGxlbihtZXNoLmluZGljZUxpc3QpDQogICAgICAgICAgICBtYXQuSURDb3VudCA9IGxlbihpbmRpY2VzKQ0KICAgICAgICAgICAgbWVzaC5pbmRpY2VMaXN0LmV4dGVuZChpbmRpY2VzKQ0KICAgICAgICAgICAgaWYgbW9kZSA9PSAnIlRSSUFOR0xFX1NUUklQIic6DQogICAgICAgICAgICAgICAgbWF0LlRSSVNUUklQID0gVHJ1ZQ0KICAgICAgICAgICAgaWYgbW9kZSA9PSAnIlRSSUFOR0xFUyInOg0KICAgICAgICAgICAgICAgIG1hdC5UUklBTkdMRSA9IFRydWUNCiAgICAgICAgaW5kaWNlcyA9IG1lc2guaW5kaWNlQXJyYXlbMF1bMF0NCiAgICAgICAgbW9kZSA9IG1lc2guaW5kaWNlQXJyYXlbMF1bMV0NCiAgICBpZiBsZW4obWVzaC52ZXJ0ZXhBcnJheSkgPT0gMToNCiAgICAgICAgaWYgbWVzaC52ZXJ0ZXhBcnJheVswXVsxXSA9PSAnInZhcmludCInOg0KICAgICAgICAgICAgaWYgbW9kZToNCiAgICAgICAgICAgICAgICBieXRlcyA9IG1lc2gudmVydGV4QXJyYXlbMF1bMF0NCiAgICAgICAgICAgICAgICBJdGVtU2l6ZSA9IG1lc2gudmVydGV4QXJyYXlbMF1bMl0NCiAgICAgICAgICAgICAgICBpZiBtb2RlID09ICciVFJJQU5HTEVfU1RSSVAiJzoNCiAgICAgICAgICAgICAgICAgICAgYnl0ZXMgPSBkZWNvZGVQcmVkaWN0KGluZGljZXMsIGJ5dGVzLCBJdGVtU2l6ZSkNCiAgICAgICAgICAgICAgICBzMSA9IGZsb2F0KG1lc2guYXRyaWJ1dGVzWyd2dHhfYmJsX3gnXSkNCiAgICAgICAgICAgICAgICBzMiA9IGZsb2F0KG1lc2guYXRyaWJ1dGVzWyd2dHhfYmJsX3knXSkNCiAgICAgICAgICAgICAgICBzMyA9IGZsb2F0KG1lc2guYXRyaWJ1dGVzWyd2dHhfYmJsX3onXSkNCiAgICAgICAgICAgICAgICBzID0gW3MxLCBzMiwgczNdDQogICAgICAgICAgICAgICAgYTEgPSBmbG9hdChtZXNoLmF0cmlidXRlc1sndnR4X2hfeCddKQ0KICAgICAgICAgICAgICAgIGEyID0gZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3Z0eF9oX3knXSkNCiAgICAgICAgICAgICAgICBhMyA9IGZsb2F0KG1lc2guYXRyaWJ1dGVzWyd2dHhfaF96J10pDQogICAgICAgICAgICAgICAgYSA9IFthMSwgYTIsIGEzXQ0KICAgICAgICAgICAgICAgIGZsb2F0cyA9IGRlY29kZVF1YW50aXplKGJ5dGVzLCBzLCBhLCBJdGVtU2l6ZSkNCiAgICAgICAgICAgICAgICBtZXNoLnZlcnRQb3NMaXN0ID0gW2Zsb2F0c1ttOm0gKyBJdGVtU2l6ZV0gZm9yIG0gaW4gcmFuZ2UoMCwgbGVuKGZsb2F0cyksIDMpXQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgbGlzdCA9IG1lc2gudmVydGV4QXJyYXlbMF1bMF0NCiAgICAgICAgICAgIG1lc2gudmVydFBvc0xpc3QgPSBsaXN0DQogICAgaWYgbGVuKG1lc2guVGV4Q29vcmQwQXJyYXkpID09IDE6DQogICAgICAgIGlmIG1lc2guVGV4Q29vcmQwQXJyYXlbMF1bMV0gPT0gJyJ2YXJpbnQiJzoNCiAgICAgICAgICAgIGlmIG1vZGU6DQogICAgICAgICAgICAgICAgYnl0ZXMgPSBtZXNoLlRleENvb3JkMEFycmF5WzBdWzBdDQogICAgICAgICAgICAgICAgSXRlbVNpemUgPSBtZXNoLlRleENvb3JkMEFycmF5WzBdWzJdDQogICAgICAgICAgICAgICAgaWYgbW9kZSA9PSAnIlRSSUFOR0xFX1NUUklQIic6DQogICAgICAgICAgICAgICAgICAgIGJ5dGVzID0gZGVjb2RlUHJlZGljdChpbmRpY2VzLCBieXRlcywgSXRlbVNpemUpDQogICAgICAgICAgICAgICAgczEgPSBmbG9hdChtZXNoLmF0cmlidXRlc1sndXZfMF9iYmxfeCddKQ0KICAgICAgICAgICAgICAgIHMyID0gZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzBfYmJsX3knXSkNCiAgICAgICAgICAgICAgICBzID0gW3MxLCBzMl0NCiAgICAgICAgICAgICAgICBhMSA9IGZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8wX2hfeCddKQ0KICAgICAgICAgICAgICAgIGEyID0gZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzBfaF95J10pDQogICAgICAgICAgICAgICAgYSA9IFthMSwgYTJdDQogICAgICAgICAgICAgICAgZmxvYXRzID0gZGVjb2RlUXVhbnRpemUoYnl0ZXMsIHMsIGEsIEl0ZW1TaXplKQ0KICAgICAgICAgICAgICAgIGZvciBtIGluIHJhbmdlKDAsIGxlbihmbG9hdHMpLCBJdGVtU2l6ZSk6DQogICAgICAgICAgICAgICAgICAgICh1LCB2KSA9IGZsb2F0c1ttOm0gKyBJdGVtU2l6ZV0NCiAgICAgICAgICAgICAgICAgICAgbWVzaC52ZXJ0VVZMaXN0LmFwcGVuZChbdSwgMSAtIHZdKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgbGlzdCA9IG1lc2guVGV4Q29vcmQwQXJyYXlbMF1bMF0NCiAgICAgICAgICAgIG1lc2gudmVydFVWTGlzdCA9IGxpc3QNCiAgICBlbGlmIGxlbihtZXNoLlRleENvb3JkMUFycmF5KSA9PSAxOg0KICAgICAgICBpZiBtZXNoLlRleENvb3JkMUFycmF5WzBdWzFdID09ICcidmFyaW50Iic6DQogICAgICAgICAgICBpZiBtb2RlOg0KICAgICAgICAgICAgICAgIGJ5dGVzID0gbWVzaC5UZXhDb29yZDFBcnJheVswXVswXQ0KICAgICAgICAgICAgICAgIEl0ZW1TaXplID0gbWVzaC5UZXhDb29yZDFBcnJheVswXVsyXQ0KICAgICAgICAgICAgICAgIGlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KICAgICAgICAgICAgICAgICAgICBieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KICAgICAgICAgICAgICAgIHMxID0gZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzFfYmJsX3gnXSkNCiAgICAgICAgICAgICAgICBzMiA9IGZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8xX2JibF95J10pDQogICAgICAgICAgICAgICAgcyA9IFtzMSwgczJdDQogICAgICAgICAgICAgICAgYTEgPSBmbG9hdChtZXNoLmF0cmlidXRlc1sndXZfMV9oX3gnXSkNCiAgICAgICAgICAgICAgICBhMiA9IGZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8xX2hfeSddKQ0KICAgICAgICAgICAgICAgIGEgPSBbYTEsIGEyXQ0KICAgICAgICAgICAgICAgIGZsb2F0cyA9IGRlY29kZVF1YW50aXplKGJ5dGVzLCBzLCBhLCBJdGVtU2l6ZSkNCiAgICAgICAgICAgICAgICBmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KICAgICAgICAgICAgICAgICAgICAodSwgdikgPSBmbG9hdHNbbTptICsgSXRlbVNpemVdDQogICAgICAgICAgICAgICAgICAgIG1lc2gudmVydFVWTGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIGxpc3QgPSBtZXNoLlRleENvb3JkMUFycmF5WzBdWzBdDQogICAgICAgICAgICBtZXNoLnZlcnRVVkxpc3QgPSBsaXN0DQogICAgZWxpZiBsZW4obWVzaC5UZXhDb29yZDNBcnJheSkgPT0gMToNCiAgICAgICAgaWYgbWVzaC5UZXhDb29yZDNBcnJheVswXVsxXSA9PSAnInZhcmludCInOg0KICAgICAgICAgICAgaWYgbW9kZToNCiAgICAgICAgICAgICAgICBieXRlcyA9IG1lc2guVGV4Q29vcmQzQXJyYXlbMF1bMF0NCiAgICAgICAgICAgICAgICBJdGVtU2l6ZSA9IG1lc2guVGV4Q29vcmQzQXJyYXlbMF1bMl0NCiAgICAgICAgICAgICAgICBpZiBtb2RlID09ICciVFJJQU5HTEVfU1RSSVAiJzoNCiAgICAgICAgICAgICAgICAgICAgYnl0ZXMgPSBkZWNvZGVQcmVkaWN0KGluZGljZXMsIGJ5dGVzLCBJdGVtU2l6ZSkNCiAgICAgICAgICAgICAgICBzMSA9IGZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8zX2JibF94J10pDQogICAgICAgICAgICAgICAgczIgPSBmbG9hdChtZXNoLmF0cmlidXRlc1sndXZfM19iYmxfeSddKQ0KICAgICAgICAgICAgICAgIHMgPSBbczEsIHMyXQ0KICAgICAgICAgICAgICAgIGExID0gZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzNfaF94J10pDQogICAgICAgICAgICAgICAgYTIgPSBmbG9hdChtZXNoLmF0cmlidXRlc1sndXZfM19oX3knXSkNCiAgICAgICAgICAgICAgICBhID0gW2ExLCBhMl0NCiAgICAgICAgICAgICAgICBmbG9hdHMgPSBkZWNvZGVRdWFudGl6ZShieXRlcywgcywgYSwgSXRlbVNpemUpDQogICAgICAgICAgICAgICAgZm9yIG0gaW4gcmFuZ2UoMCwgbGVuKGZsb2F0cyksIEl0ZW1TaXplKToNCiAgICAgICAgICAgICAgICAgICAgKHUsIHYpID0gZmxvYXRzW206bSArIEl0ZW1TaXplXQ0KICAgICAgICAgICAgICAgICAgICBtZXNoLnZlcnRVVkxpc3QuYXBwZW5kKFt1LCAxIC0gdl0pDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBsaXN0ID0gbWVzaC5UZXhDb29yZDNBcnJheVswXVswXQ0KICAgICAgICAgICAgbWVzaC52ZXJ0VVZMaXN0ID0gbGlzdA0KICAgIGVsaWYgbGVuKG1lc2guVGV4Q29vcmQ1QXJyYXkpID09IDE6DQogICAgICAgIGlmIG1lc2guVGV4Q29vcmQ1QXJyYXlbMF1bMV0gPT0gJyJ2YXJpbnQiJzoNCiAgICAgICAgICAgIGlmIG1vZGU6DQogICAgICAgICAgICAgICAgYnl0ZXMgPSBtZXNoLlRleENvb3JkNUFycmF5WzBdWzBdDQogICAgICAgICAgICAgICAgSXRlbVNpemUgPSBtZXNoLlRleENvb3JkNUFycmF5WzBdWzJdDQogICAgICAgICAgICAgICAgaWYgbW9kZSA9PSAnIlRSSUFOR0xFX1NUUklQIic6DQogICAgICAgICAgICAgICAgICAgIGJ5dGVzID0gZGVjb2RlUHJlZGljdChpbmRpY2VzLCBieXRlcywgSXRlbVNpemUpDQogICAgICAgICAgICAgICAgczEgPSBmbG9hdChtZXNoLmF0cmlidXRlc1sndXZfNV9iYmxfeCddKQ0KICAgICAgICAgICAgICAgIHMyID0gZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzVfYmJsX3knXSkNCiAgICAgICAgICAgICAgICBzID0gW3MxLCBzMl0NCiAgICAgICAgICAgICAgICBhMSA9IGZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl81X2hfeCddKQ0KICAgICAgICAgICAgICAgIGEyID0gZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzVfaF95J10pDQogICAgICAgICAgICAgICAgYSA9IFthMSwgYTJdDQogICAgICAgICAgICAgICAgZmxvYXRzID0gZGVjb2RlUXVhbnRpemUoYnl0ZXMsIHMsIGEsIEl0ZW1TaXplKQ0KICAgICAgICAgICAgICAgIGZvciBtIGluIHJhbmdlKDAsIGxlbihmbG9hdHMpLCBJdGVtU2l6ZSk6DQogICAgICAgICAgICAgICAgICAgICh1LCB2KSA9IGZsb2F0c1ttOm0gKyBJdGVtU2l6ZV0NCiAgICAgICAgICAgICAgICAgICAgbWVzaC52ZXJ0VVZMaXN0LmFwcGVuZChbdSwgMSAtIHZdKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgbGlzdCA9IG1lc2guVGV4Q29vcmQ1QXJyYXlbMF1bMF0NCiAgICAgICAgICAgIG1lc2gudmVydFVWTGlzdCA9IGxpc3QNCiAgICBlbGlmIGxlbihtZXNoLlRleENvb3JkNkFycmF5KSA9PSAxOg0KICAgICAgICBpZiBtZXNoLlRleENvb3JkNkFycmF5WzBdWzFdID09ICcidmFyaW50Iic6DQogICAgICAgICAgICBpZiBtb2RlOg0KICAgICAgICAgICAgICAgIGJ5dGVzID0gbWVzaC5UZXhDb29yZDZBcnJheVswXVswXQ0KICAgICAgICAgICAgICAgIEl0ZW1TaXplID0gbWVzaC5UZXhDb29yZDZBcnJheVswXVsyXQ0KICAgICAgICAgICAgICAgIGlmIG1vZGUgPT0gJyJUUklBTkdMRV9TVFJJUCInOg0KICAgICAgICAgICAgICAgICAgICBieXRlcyA9IGRlY29kZVByZWRpY3QoaW5kaWNlcywgYnl0ZXMsIEl0ZW1TaXplKQ0KICAgICAgICAgICAgICAgIHMxID0gZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzZfYmJsX3gnXSkNCiAgICAgICAgICAgICAgICBzMiA9IGZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl82X2JibF95J10pDQogICAgICAgICAgICAgICAgcyA9IFtzMSwgczJdDQogICAgICAgICAgICAgICAgYTEgPSBmbG9hdChtZXNoLmF0cmlidXRlc1sndXZfNl9oX3gnXSkNCiAgICAgICAgICAgICAgICBhMiA9IGZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl82X2hfeSddKQ0KICAgICAgICAgICAgICAgIGEgPSBbYTEsIGEyXQ0KICAgICAgICAgICAgICAgIGZsb2F0cyA9IGRlY29kZVF1YW50aXplKGJ5dGVzLCBzLCBhLCBJdGVtU2l6ZSkNCiAgICAgICAgICAgICAgICBmb3IgbSBpbiByYW5nZSgwLCBsZW4oZmxvYXRzKSwgSXRlbVNpemUpOg0KICAgICAgICAgICAgICAgICAgICAodSwgdikgPSBmbG9hdHNbbTptICsgSXRlbVNpemVdDQogICAgICAgICAgICAgICAgICAgIG1lc2gudmVydFVWTGlzdC5hcHBlbmQoW3UsIDEgLSB2XSkNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIGxpc3QgPSBtZXNoLlRleENvb3JkNkFycmF5WzBdWzBdDQogICAgICAgICAgICBtZXNoLnZlcnRVVkxpc3QgPSBsaXN0DQogICAgaWYgbGVuKG1lc2guY29sb3JBcnJheSkgPiAwOg0KICAgICAgICBtZXNoLnZlcnRDb2xMaXN0ID0gbWVzaC5jb2xvckFycmF5DQpkZWYgVXNlckRhdGFDb250YWluZXIoeXMsIGIpOg0KICAgIGF0cmlidXRlcyA9IHt9DQogICAgVmFsdWVzID0geXMuZ2V0KGIubm9kZSwgJyJWYWx1ZXMiJykNCiAgICBpZiBWYWx1ZXM6DQogICAgICAgIGZvciBhIGluIFZhbHVlc1swXS5jaGlsZHJlbjoNCiAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhhLmRhdGEsICc6JykNCiAgICAgICAgICAgIE5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciTmFtZSInLCAnIiInKQ0KICAgICAgICAgICAgVmFsdWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciVmFsdWUiJywgJyIiJykNCiAgICAgICAgICAgIGlmIE5hbWU6DQogICAgICAgICAgICAgICAgYXRyaWJ1dGVzW05hbWVdID0gVmFsdWUNCiAgICByZXR1cm4gYXRyaWJ1dGVzDQpkZWYgb3NnTm9kZSh5cywgcGFyZW50TmV3Tm9kZSwgcGFyZW50Qm9uZSk6DQogICAgZm9yIGNoaWxkIGluIHBhcmVudE5ld05vZGUuY2hpbGRyZW46DQogICAgICAgIGZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCiAgICAgICAgICAgIGlmICcib3NnLkdlb21ldHJ5IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICAgICAgbWVzaCA9IG9zZ0dlb21ldHJ5KHlzLCBjaGlsZCkNCiAgICAgICAgICAgICAgICBtZXNoLnBhcmVudEJvbmUgPSBwYXJlbnRCb25lDQogICAgICAgICAgICAgICAgbW9kZWwubWVzaExpc3QuYXBwZW5kKG1lc2gpDQogICAgICAgICAgICBpZiAnIm9zZ0FuaW1hdGlvbi5SaWdHZW9tZXRyeSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgIG1lc2ggPSBvc2dBbmltYXRpb25SaWdHZW9tZXRyeSh5cywgY2hpbGQpDQogICAgICAgICAgICAgICAgbWVzaC5wYXJlbnRCb25lID0gcGFyZW50Qm9uZQ0KICAgICAgICAgICAgICAgIG1vZGVsLm1lc2hMaXN0LmFwcGVuZChtZXNoKQ0KICAgICAgICAgICAgaWYgJyJvc2dBbmltYXRpb24uTW9ycGhHZW9tZXRyeSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgIG1lc2ggPSBvc2dBbmltYXRpb25Nb3JwaEdlb21ldHJ5KHlzLCBjaGlsZCkNCiAgICAgICAgICAgICAgICBtZXNoLnBhcmVudEJvbmUgPSBwYXJlbnRCb25lDQogICAgICAgICAgICAgICAgbW9kZWwubWVzaExpc3QuYXBwZW5kKG1lc2gpDQpkZWYgb3NnTWF0cml4VHJhbnNmb3JtKHlzLCBwYXJlbnROZXdOb2RlLCBwYXJlbnRCb25lKToNCiAgICBib25lID0gQm9uZSgpDQogICAgYm9uZS5OYW1lID0gTm9uZQ0KICAgIGJvbmUuVXBkYXRlTmFtZSA9IE5vbmUNCiAgICBib25lLm1hdHJpeCA9IE1hdHJpeCgpLnJlc2l6ZTR4NCgpDQogICAgaWYgcGFyZW50Qm9uZToNCiAgICAgICAgYm9uZS5wYXJlbnROYW1lID0gcGFyZW50Qm9uZS5uYW1lDQogICAgc2tlbGV0b24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpDQogICAgZm9yIGNoaWxkIGluIHBhcmVudE5ld05vZGUuY2hpbGRyZW46DQogICAgICAgIGlmICciTWF0cml4IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoY2hpbGQubm9kZS5kYXRhLCAnZicpDQogICAgICAgICAgICBib25lLm1hdHJpeCA9IE1hdHJpeDR4NCh2YWx1ZXMpDQogICAgICAgICAgICBpZiBwYXJlbnRCb25lOg0KICAgICAgICAgICAgICAgIGJvbmUubWF0cml4ICo9IHBhcmVudEJvbmUubWF0cml4DQogICAgICAgIGlmICciVW5pcXVlSUQiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhjaGlsZC5ub2RlLmhlYWRlciwgJzonKQ0KICAgICAgICAgICAgVW5pcXVlSUQgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciVW5pcXVlSUQiJywgJ2knKQ0KICAgICAgICAgICAgYm9uZS5uYW1lID0gJ1VuaXF1ZUlEXycgKyBzdHIoVW5pcXVlSUQpDQogICAgICAgIGlmICciTmFtZSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKGNoaWxkLm5vZGUuaGVhZGVyLCAnOicpDQogICAgICAgICAgICBOYW1lID0geXMuZ2V0VmFsdWUodmFsdWVzLCAnIk5hbWUiJywgJyIiJykNCiAgICAgICAgICAgIGJvbmUuTmFtZSA9IE5hbWUNCiAgICAgICAgaWYgJyJVcGRhdGVDYWxsYmFja3MiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgIGZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCiAgICAgICAgICAgICAgICBpZiAnIm9zZ0FuaW1hdGlvbi5VcGRhdGVNYXRyaXhUcmFuc2Zvcm0iJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgICAgICAgICAgZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgJyJOYW1lIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKGNoaWxkLm5vZGUuaGVhZGVyLCAnOicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgTmFtZSA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJOYW1lIicsICciIicpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9uZS5VcGRhdGVOYW1lID0gTmFtZQ0KICAgIHJldHVybiBib25lDQpkZWYgb3NnQW5pbWF0aW9uQm9uZSh5cywgcGFyZW50TmV3Tm9kZSwgcGFyZW50Qm9uZSk6DQogICAgYm9uZSA9IEJvbmUoKQ0KICAgIHNrZWxldG9uLmJvbmVMaXN0LmFwcGVuZChib25lKQ0KICAgIGJvbmUubWF0cml4ID0gTWF0cml4KCkucmVzaXplNHg0KCkNCiAgICBiaW5kQm9uZSA9IEJvbmUoKQ0KICAgIGJpbmRCb25lLm1hdHJpeCA9IE1hdHJpeCgpLnJlc2l6ZTR4NCgpDQogICAgYmluZEJvbmUuTmFtZSA9IE5vbmUNCiAgICBib25lLk5hbWUgPSBOb25lDQogICAgYm9uZS5VcGRhdGVOYW1lID0gTm9uZQ0KICAgIGJpbmRCb25lLlVwZGF0ZU5hbWUgPSBOb25lDQogICAgZm9yIGNoaWxkIGluIHBhcmVudE5ld05vZGUuY2hpbGRyZW46DQogICAgICAgIGlmICciSW52QmluZE1hdHJpeEluU2tlbGV0b25TcGFjZSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKGNoaWxkLm5vZGUuZGF0YSwgJ2YnKQ0KICAgICAgICAgICAgbWF0cml4ID0gTWF0cml4NHg0KHZhbHVlcykNCiAgICAgICAgICAgIGJpbmRCb25lLm1hdHJpeCA9IG1hdHJpeC5pbnZlcnQoKQ0KICAgICAgICAgICAgYmluZHNrZWxldG9uLmJvbmVMaXN0LmFwcGVuZChiaW5kQm9uZSkNCiAgICAgICAgaWYgJyJVbmlxdWVJRCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgdmFsdWVzID0geXMudmFsdWVzKGNoaWxkLm5vZGUuaGVhZGVyLCAnOicpDQogICAgICAgICAgICBVbmlxdWVJRCA9IHlzLmdldFZhbHVlKHZhbHVlcywgJyJVbmlxdWVJRCInLCAnaScpDQogICAgICAgICAgICBiaW5kQm9uZS5uYW1lID0gJ1VuaXF1ZUlEXycgKyBzdHIoVW5pcXVlSUQpDQogICAgICAgICAgICBib25lLm5hbWUgPSAnVW5pcXVlSURfJyArIHN0cihVbmlxdWVJRCkNCiAgICAgICAgaWYgJyJOYW1lIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICB2YWx1ZXMgPSB5cy52YWx1ZXMoY2hpbGQubm9kZS5oZWFkZXIsICc6JykNCiAgICAgICAgICAgIE5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciTmFtZSInLCAnIiInKQ0KICAgICAgICAgICAgYmluZEJvbmUuTmFtZSA9IE5hbWUNCiAgICAgICAgICAgIGJvbmUuTmFtZSA9IE5hbWUNCiAgICAgICAgaWYgJyJNYXRyaXgiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhjaGlsZC5ub2RlLmRhdGEsICdmJykNCiAgICAgICAgICAgIGJvbmUubWF0cml4ID0gTWF0cml4NHg0KHZhbHVlcykNCiAgICAgICAgICAgIGlmIHBhcmVudEJvbmU6DQogICAgICAgICAgICAgICAgaWYgJ01hdHJpeFRyYW5zZm9ybScgbm90IGluIHBhcmVudEJvbmUubmFtZToNCiAgICAgICAgICAgICAgICAgICAgYm9uZS5wYXJlbnROYW1lID0gcGFyZW50Qm9uZS5uYW1lDQogICAgICAgICAgICAgICAgYm9uZS5tYXRyaXggKj0gcGFyZW50Qm9uZS5tYXRyaXgNCiAgICAgICAgaWYgJyJVcGRhdGVDYWxsYmFja3MiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCiAgICAgICAgICAgIGZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCiAgICAgICAgICAgICAgICBpZiAnIm9zZ0FuaW1hdGlvbi5VcGRhdGVCb25lIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQogICAgICAgICAgICAgICAgICAgIGZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICciTmFtZSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHlzLnZhbHVlcyhjaGlsZC5ub2RlLmhlYWRlciwgJzonKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5hbWUgPSB5cy5nZXRWYWx1ZSh2YWx1ZXMsICciTmFtZSInLCAnIiInKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpbmRCb25lLlVwZGF0ZU5hbWUgPSBOYW1lDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9uZS5VcGRhdGVOYW1lID0gTmFtZQ0KICAgIHJldHVybiBib25lDQpkZWYgZ2V0TmV3Tm9kZVRyZWUoeXMsIHBhcmVudE5ld05vZGUsIG4sIHBhcmVudEJvbmUsIGRhdGEpOg0KICAgIGlmICcib3NnQW5pbWF0aW9uLlNrZWxldG9uIicgaW4gcGFyZW50TmV3Tm9kZS5ub2RlLmhlYWRlcjoNCiAgICAgICAgcGFyZW50Qm9uZSA9IG9zZ0FuaW1hdGlvbkJvbmUoeXMsIHBhcmVudE5ld05vZGUsIHBhcmVudEJvbmUpDQogICAgICAgIGJpbmRza2VsZXRvbi5wYXJlbnRCb25lID0gcGFyZW50Qm9uZQ0KICAgIGlmICcib3NnLk5vZGUiJyBpbiBwYXJlbnROZXdOb2RlLm5vZGUuaGVhZGVyOg0KICAgICAgICBvc2dOb2RlKHlzLCBwYXJlbnROZXdOb2RlLCBwYXJlbnRCb25lKQ0KICAgIGlmICcib3NnLk1hdHJpeFRyYW5zZm9ybSInIGluIHBhcmVudE5ld05vZGUubm9kZS5oZWFkZXI6DQogICAgICAgIHBhcmVudEJvbmUgPSBvc2dNYXRyaXhUcmFuc2Zvcm0oeXMsIHBhcmVudE5ld05vZGUsIHBhcmVudEJvbmUpDQogICAgaWYgJyJvc2dBbmltYXRpb24uQm9uZSInIGluIHBhcmVudE5ld05vZGUubm9kZS5oZWFkZXI6DQogICAgICAgIHBhcmVudEJvbmUgPSBvc2dBbmltYXRpb25Cb25lKHlzLCBwYXJlbnROZXdOb2RlLCBwYXJlbnRCb25lKQ0KICAgIG4gKz0gNA0KICAgIGZvciBjaGlsZCBpbiBwYXJlbnROZXdOb2RlLmNoaWxkcmVuOg0KICAgICAgICBnZXROZXdOb2RlVHJlZSh5cywgY2hpbGQsIG4sIHBhcmVudEJvbmUsIGRhdGEpDQpkZWYgb3NnUGFyc2VyKGZpbGVuYW1lKToNCiAgICBnbG9iYWwgc2tlbGV0b24sIGJpbmRza2VsZXRvbiwgbW9kZWwsIGJvbmVJbmRla3NMaXN0LCBmaXJzdG1hdHJpeCwgbmV3Tm9kZUxpc3QNCiAgICBib25lSW5kZWtzTGlzdCA9IHt9DQogICAgbW9kZWwgPSBNb2RlbChmaWxlbmFtZSkNCiAgICBtb2RlbC5tYXRMaXN0ID0ge30NCiAgICBza2VsZXRvbiA9IFNrZWxldG9uKCkNCiAgICBza2VsZXRvbi5BUk1BVFVSRVNQQUNFID0gVHJ1ZQ0KICAgIGJpbmRza2VsZXRvbiA9IFNrZWxldG9uKCkNCiAgICBiaW5kc2tlbGV0b24ucGFyZW50Qm9uZSA9IE5vbmUNCiAgICBiaW5kc2tlbGV0b24uQVJNQVRVUkVTUEFDRSA9IFRydWUNCiAgICBVbmlxdWVJRExpc3QgPSB7fQ0KICAgIHlzID0gWXNvbigpDQogICAgeXMuZmlsZW5hbWUgPSBmaWxlbmFtZQ0KICAgIHlzLnBhcnNlKCkNCiAgICByb290ID0geXMucm9vdA0KICAgIG4gPSAwDQogICAgbmV3Tm9kZUxpc3QgPSBbXQ0KICAgIG5ld1Jvb3QgPSBOZXdOb2RlKCkNCiAgICBuZXdSb290Lm5vZGUgPSB5cy5yb290DQogICAgbmV3Tm9kZUxpc3QuYXBwZW5kKG5ld1Jvb3QpDQogICAgZ2V0SURUcmVlKHlzLCB5cy5yb290LCBuLCBuZXdSb290KQ0KICAgIHJvb3QgPSBuZXdSb290DQogICAgZ2V0TmV3Tm9kZVRyZWUoeXMsIHJvb3QsIG4sIE5vbmUsIE5vbmUpDQogICAgc2tlbGV0b24uZHJhdygpDQogICAgaWYgbGVuKGJpbmRza2VsZXRvbi5ib25lTGlzdCkgPiAwOg0KICAgICAgICBiaW5kc2tlbGV0b24uZHJhdygpDQogICAgaWYgYmluZHNrZWxldG9uLnBhcmVudEJvbmUgYW5kIGJpbmRza2VsZXRvbi5vYmplY3Q6DQogICAgICAgIGJpbmRza2VsZXRvbi5vYmplY3Quc2V0TWF0cml4KGJpbmRza2VsZXRvbi5wYXJlbnRCb25lLm1hdHJpeCkNCiAgICBmb3IgYm9uZSBpbiBza2VsZXRvbi5ib25lTGlzdDoNCiAgICAgICAgaWYgYm9uZS5VcGRhdGVOYW1lOg0KICAgICAgICAgICAgYm9uZUluZGVrc0xpc3RbYm9uZS5VcGRhdGVOYW1lXSA9IGJvbmUubmFtZQ0KICAgIGZvciBtZXNoIGluIG1vZGVsLm1lc2hMaXN0Og0KICAgICAgICBtZXNoLkJJTkRTS0VMRVRPTiA9IHNrZWxldG9uLm5hbWUNCiAgICAgICAgZHJhd01lc2goeXMsIG1lc2gpDQogICAgZm9yIChpMSwgbWVzaCkgaW4gZW51bWVyYXRlKG1vZGVsLm1lc2hMaXN0KToNCiAgICAgICAgbWVzaC5CSU5EU0tFTEVUT04gPSBza2VsZXRvbi5uYW1lDQogICAgICAgIGlmIGxlbihtZXNoLnZlcnRQb3NMaXN0KSA+IDA6DQogICAgICAgICAgICBpZiBsZW4obWVzaC5Cb25lcykgPiAwIGFuZCBsZW4obWVzaC5XZWlnaHRzKSA+IDA6DQogICAgICAgICAgICAgICAgc2tpbiA9IFNraW4oKQ0KICAgICAgICAgICAgICAgIHNraW4uYm9uZU1hcCA9IFswXSAqIGxlbihtZXNoLkJvbmVNYXApDQogICAgICAgICAgICAgICAgbWVzaC5ib25lTmFtZUxpc3QgPSBbJyddICogbGVuKG1lc2guQm9uZU1hcCkNCiAgICAgICAgICAgICAgICBmb3IgYm9uZU5hbWUgaW4gbWVzaC5Cb25lTWFwOg0KICAgICAgICAgICAgICAgICAgICBmb3IgYm9uZSBpbiBza2VsZXRvbi5ib25lTGlzdDoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGJvbmUuTmFtZSA9PSBib25lTmFtZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IG1lc2guQm9uZU1hcFtib25lTmFtZV0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2luLmJvbmVNYXBbaWRdID0gaWQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNoLmJvbmVOYW1lTGlzdFtpZF0gPSBib25lLm5hbWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgICAgIG1lc2guc2tpbkxpc3QuYXBwZW5kKHNraW4pDQogICAgICAgICAgICAgICAgbWVzaC5za2luSW5kaWNlTGlzdCA9IG1lc2guQm9uZXMNCiAgICAgICAgICAgICAgICBtZXNoLnNraW5XZWlnaHRMaXN0ID0gbWVzaC5XZWlnaHRzDQogICAgICAgICAgICBpZiBiaW5kc2tlbGV0b24ub2JqZWN0IGFuZCBza2VsZXRvbi5vYmplY3Q6DQogICAgICAgICAgICAgICAgaWYgbWVzaC5wYXJlbnRCb25lIGFuZCBsZW4obWVzaC5za2luTGlzdCkgPiAwOg0KICAgICAgICAgICAgICAgICAgICBtZXNoLmRyYXcoKQ0KICAgICAgICAgICAgICAgICAgICBtZXNoLm9iamVjdC5nZXREYXRhKG1lc2g9MSkudHJhbnNmb3JtKG1lc2gucGFyZW50Qm9uZS5tYXRyaXgpDQogICAgICAgICAgICAgICAgICAgIG1lc2gub2JqZWN0LmdldERhdGEobWVzaD0xKS51cGRhdGUoKQ0KICAgICAgICAgICAgICAgICAgICBpZiBCaW5kcG9zZSA9PSAxOg0KICAgICAgICAgICAgICAgICAgICAgICAgYmluZFBvc2UoYmluZHNrZWxldG9uLm9iamVjdCwgc2tlbGV0b24ub2JqZWN0LCBtZXNoLm9iamVjdCkNCiAgICAgICAgICAgICAgICAgICAgc2tlbGV0b24ub2JqZWN0Lm1ha2VQYXJlbnREZWZvcm0oW21lc2gub2JqZWN0XSwgMSwgMCkNCiAgICAgICAgICAgICAgICBlbGlmIG1lc2gucGFyZW50Qm9uZSBhbmQgbGVuKG1lc2guc2tpbkxpc3QpID09IDA6DQogICAgICAgICAgICAgICAgICAgIG1lc2guc2V0U2tpbihtZXNoLnBhcmVudEJvbmUubmFtZSkNCiAgICAgICAgICAgICAgICAgICAgbWVzaC5kcmF3KCkNCiAgICAgICAgICAgICAgICAgICAgbWVzaC5vYmplY3QuZ2V0RGF0YShtZXNoPTEpLnRyYW5zZm9ybShtZXNoLnBhcmVudEJvbmUubWF0cml4KQ0KICAgICAgICAgICAgICAgICAgICBtZXNoLm9iamVjdC5nZXREYXRhKG1lc2g9MSkudXBkYXRlKCkNCiAgICAgICAgICAgICAgICAgICAgc2tlbGV0b24ub2JqZWN0Lm1ha2VQYXJlbnREZWZvcm0oW21lc2gub2JqZWN0XSwgMSwgMCkNCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgaWYgbWVzaC5wYXJlbnRCb25lOg0KICAgICAgICAgICAgICAgICAgICBpZiBsZW4obWVzaC5za2luTGlzdCkgPT0gMDoNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lc2guc2V0U2tpbihtZXNoLnBhcmVudEJvbmUubmFtZSkNCiAgICAgICAgICAgICAgICAgICAgbWVzaC5kcmF3KCkNCiAgICAgICAgICAgICAgICAgICAgbWVzaC5vYmplY3QuZ2V0RGF0YShtZXNoPTEpLnRyYW5zZm9ybShtZXNoLnBhcmVudEJvbmUubWF0cml4KQ0KICAgICAgICAgICAgICAgICAgICBtZXNoLm9iamVjdC5nZXREYXRhKG1lc2g9MSkudXBkYXRlKCkNCiAgICAgICAgICAgICAgICAgICAgaWYgc2tlbGV0b24ub2JqZWN0IGFuZCBza2VsZXRvbi5vYmplY3Q6DQogICAgICAgICAgICAgICAgICAgICAgICBza2VsZXRvbi5vYmplY3QubWFrZVBhcmVudERlZm9ybShbbWVzaC5vYmplY3RdLCAxLCAwKQ0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIG1lc2guZHJhdygpDQogICAgaWYgQmluZHBvc2UgIT0gMjoNCiAgICAgICAgaWYgYmluZHNrZWxldG9uLm9iamVjdDoNCiAgICAgICAgICAgIHNjZW5lID0gYnB5LmRhdGEuc2NlbmVzLmFjdGl2ZQ0KICAgICAgICAgICAgc2NlbmUub2JqZWN0cy51bmxpbmsoYmluZHNrZWxldG9uLm9iamVjdCkNCiAgICBtb2RlbC5zZXQoKQ0KICAgIEFuaW1hdGlvbnMgPSB5cy5nZXQoeXMucm9vdCwgJyJvc2dBbmltYXRpb24uQW5pbWF0aW9uIicpDQogICAgaWYgQW5pbWF0aW9uOg0KICAgICAgICBmb3IgYW5pbWF0aW9uIGluIEFuaW1hdGlvbnM6DQogICAgICAgICAgICBnZXRBbmltYXRpb24oeXMsIGFuaW1hdGlvbiwgbikNCmRlZiBhY3Rpb25QYXJzZXIoZmlsZW5hbWUsIGcpOg0KICAgIGFjdGlvbiA9IEFjdGlvbigpDQogICAgYWN0aW9uLkJPTkVTUEFDRSA9IFRydWUNCiAgICBhY3Rpb24uQk9ORVNPUlQgPSBUcnVlDQogICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgaWYgZy50ZWxsKCkgPj0gZy5maWxlU2l6ZSgpOg0KICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgYm9uZSA9IEFjdGlvbkJvbmUoKQ0KICAgICAgICBhY3Rpb24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpDQogICAgICAgIGJvbmUubmFtZSA9IGcuZmluZCgnXHgwMCcpDQogICAgICAgIHR5cGUgPSBnLmZpbmQoJ1x4MDAnKQ0KICAgICAgICBpZiB0eXBlID09ICdzaXplJzoNCiAgICAgICAgICAgIGNvdW50ID0gZy5pKDEpWzBdDQogICAgICAgICAgICBmb3IgbSBpbiBzYWZlKGNvdW50KToNCiAgICAgICAgICAgICAgICBtYXRyaXggPSBWZWN0b3JTY2FsZU1hdHJpeChnLmYoMykpDQogICAgICAgICAgICAgICAgYm9uZS5zaXplS2V5TGlzdC5hcHBlbmQobWF0cml4KQ0KICAgICAgICAgICAgY291bnQgPSBnLmkoMSlbMF0NCiAgICAgICAgICAgIGZvciBtIGluIHNhZmUoY291bnQpOg0KICAgICAgICAgICAgICAgIGZyYW1lID0gaW50KGcuZigxKVswXSAqIDMzKQ0KICAgICAgICAgICAgICAgIGJvbmUuc2l6ZUZyYW1lTGlzdC5hcHBlbmQoZnJhbWUpDQogICAgICAgIGlmIHR5cGUgPT0gJ3RyYW5zbGF0ZSc6DQogICAgICAgICAgICBjb3VudCA9IGcuaSgxKVswXQ0KICAgICAgICAgICAgZm9yIG0gaW4gc2FmZShjb3VudCk6DQogICAgICAgICAgICAgICAgbWF0cml4ID0gVmVjdG9yTWF0cml4KGcuZigzKSkNCiAgICAgICAgICAgICAgICBib25lLnBvc0tleUxpc3QuYXBwZW5kKG1hdHJpeCkNCiAgICAgICAgICAgIGNvdW50ID0gZy5pKDEpWzBdDQogICAgICAgICAgICBmb3IgbSBpbiBzYWZlKGNvdW50KToNCiAgICAgICAgICAgICAgICBmcmFtZSA9IGludChnLmYoMSlbMF0gKiAzMykNCiAgICAgICAgICAgICAgICBib25lLnBvc0ZyYW1lTGlzdC5hcHBlbmQoZnJhbWUpDQogICAgICAgIGlmIHR5cGUgPT0gJ3F1YXRlcm5pb24nOg0KICAgICAgICAgICAgY291bnQgPSBnLmkoMSlbMF0NCiAgICAgICAgICAgIGZvciBtIGluIHNhZmUoY291bnQpOg0KICAgICAgICAgICAgICAgIHF1YXQgPSBRdWF0ZXJuaW9uKGcuZig0KSkNCiAgICAgICAgICAgICAgICBtYXRyaXggPSBRdWF0TWF0cml4KHF1YXQpLnJlc2l6ZTR4NCgpDQogICAgICAgICAgICAgICAgYm9uZS5yb3RLZXlMaXN0LmFwcGVuZChtYXRyaXgpDQogICAgICAgICAgICBjb3VudCA9IGcuaSgxKVswXQ0KICAgICAgICAgICAgZm9yIG0gaW4gc2FmZShjb3VudCk6DQogICAgICAgICAgICAgICAgZnJhbWUgPSBpbnQoZy5mKDEpWzBdICogMzMpDQogICAgICAgICAgICAgICAgYm9uZS5yb3RGcmFtZUxpc3QuYXBwZW5kKGZyYW1lKQ0KICAgIGFjdGlvbi5kcmF3KCkNCiAgICBhY3Rpb24uc2V0Q29udGV4dCgpDQoNCiMjIEluZGV4IHByb2JsZW1zDQojIyBDb2RlIGxpbmU6IDEzNDcNCmluZGV4Rml4ID0gRmFsc2UNCg0KIyMgVGhpcyB2YXJpYWJsZSBoYW5kbGVzIHRoZSBleHRyYWN0aW9uIG9mIC5hY3Rpb24gZmlsZXMgZnJvbSAuYmluDQojIyBDb2RlIGxpbmU6IDIxMTgNCkFuaW1hdGlvbiA9IEZhbHNlDQoNCiMjIEVudmlhciBwb3NlIGFsIGVsIGVzcXVlbGV0byANCiMjIENvZGUgbGluZTogMjA5Mg0KQmluZHBvc2UgPSAwDQoNCmRlZiBQYXJzZXIoZmlsZSk6DQogICAgZ2xvYmFsIHN5cywgTUFURVJJQUxTLCBJTUFHRVMsIGluZGV4Rml4LCBmaWxlbmFtZSwgQW5pbWF0aW9uLCBCaW5kcG9zZQ0KICAgIE1BVEVSSUFMUyA9IHt9DQogICAgSU1BR0VTID0ge30NCiAgICAjZmlsZW5hbWUgPSBpbnB1dC5maWxlbmFtZQ0KICAgIGZpbGVuYW1lID0gZmlsZQ0KICAgIHN5cyA9IFN5cyhmaWxlbmFtZSkNCiAgICBleHQgPSBmaWxlbmFtZS5zcGxpdCgiLiIpWy0xXS5sb3dlcigpDQoNCiMjIFRoaXMgc2NyaXB0IGNhbiBoYW5kbGUgb3NnanMgZmlsZXMsIG5vIC5odG1sIGlzIG5lZWRlZCBhbnltb3JlDQogICAgaWYgZXh0ID09ICdvc2dqcyc6DQogICAgICAgIG9zZ1BhcnNlcihmaWxlbmFtZSkNCg0KIyMgSGVyZSB0byBzZWxlY3QgdGhlIGFuaW1hdGlvbnMsIHRoZSBza2VsZXRvbiBpcyBhdXRvbWF0aWNhbGx5IHNlbGVjdGVkDQojIyBZb3UgZG9uJ3QgbmVlZCBhZGRpdGlvbmFsIHNjcmlwdHMNCiAgICBpZiBleHQgPT0gJ2FjdGlvbic6DQogICAgICAgIHNjZSA9IGJweS5kYXRhLnNjZW5lcy5hY3RpdmUNCiAgICAgICAgZm9yIG9iamVjdCBpbiBzY2Uub2JqZWN0czoNCiAgICAgICAgICAgIGlmIG9iamVjdC50eXBlID09ICdBcm1hdHVyZSc6DQogICAgICAgICAgICAgICAgb2JqZWN0LnNlbCA9IDENCiAgICAgICAgICAgICAgICBmaWxlID0gb3BlbihmaWxlbmFtZSwgJ3JiJykNCiAgICAgICAgICAgICAgICBnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQogICAgICAgICAgICAgICAgYWN0aW9uUGFyc2VyKGZpbGVuYW1lLCBnKQ0KICAgICAgICAgICAgICAgIGZpbGUuY2xvc2UoKQ0KIyMgVXNlIHRvIGRlYnVnIGFuZCBvcGVuIGZpbGVzIGluIEJsZW5kZXINCmRlZiBvcGVuRmlsZShmbGFnTGlzdCk6DQogICAgZ2xvYmFsIGlucHV0LCBvdXRwdXQNCiAgICBpbnB1dCA9IElucHV0KGZsYWdMaXN0KQ0KICAgIG91dHB1dCA9IE91dHB1dChmbGFnTGlzdCkNCiAgICBwYXJzZXIgPSBQYXJzZXIoKQ0KbW9kZWxJRCA9IDANCiNCbGVuZGVyLldpbmRvdy5GaWxlU2VsZWN0b3Iob3BlbkZpbGUsJ2ltcG9ydCcsJ2ZpbGUub3NnanMnKQ0KDQojbW9kZWxJRCA9IDANClBhcnNlcignJUZJTEVOQU1FJScpDQo="));
			if (bindPose == 1)
			{
				blenderScript = blenderScript.Replace("Bindpose = 0", "Bindpose = 1");
			}
			if (indexFix)
			{
				blenderScript = blenderScript.Replace("indexFix = False", "indexFix = True");
			}
			if (animated)
			{
				blenderScript = blenderScript.Replace("Animation = False", "Animation = True");
			}
			blenderScript = blenderScript.Replace("%FILENAME%", fileName);
			return blenderScript;
		}

		public static string Rig(int bindPose = 1, bool indexFix = false, string tempDir = "_sfTemp")
		{
			string blenderScript = Encoding.UTF8.GetString(Convert.FromBase64String("aW1wb3J0IG5ld0dhbWVMaWINCmZyb20gbmV3R2FtZUxpYiBpbXBvcnQgKg0KaW1wb3J0IEJsZW5kZXINCg0KaW1wb3J0IGFycmF5DQppbXBvcnQgc3VicHJvY2Vzcw0KaW1wb3J0IHN5cyBhcyBzeXMyDQoNCg0KaHRtMT0iIiINCjxoZWFkPg0KICAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iaHR0cHM6Ly9zdGF0aWMuc2tldGNoZmFiLmNvbS9hcGkvc2tldGNoZmFiLXZpZXdlci0xLjMuMC5qcyI+PC9zY3JpcHQ+DQogIA0KICAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL3NoYWRlcmJ5dGVzL1NrZXRjaGZhYi1WaWV3ZXItQVBJLVV0aWxpdHlAdjIuMC4wLjcvU2tldGNoZmFiQVBJVXRpbGl0eS5qcyI+PC9zY3JpcHQ+DQogICANCjwvaGVhZD4NCg0KPGJvZHk+DQogIDxkaXYgY2xhc3M9ImNlbnRlci1kaXYiPg0KCTxpZnJhbWUgaWQ9ImFwaS1mcmFtZSIgd2lkdGg9IjEwMDAiIGhlaWdodD0iNTUwIgkgYWxsb3dmdWxsc2NyZWVuIG1vemFsbG93ZnVsbHNjcmVlbj0idHJ1ZSIgd2Via2l0YWxsb3dmdWxsc2NyZWVuPSJ0cnVlIj48L2lmcmFtZT4NCiAgPC9kaXY+DQogIA0KICA8c2NyaXB0Pg0KCSAgZnVuY3Rpb24gb25Ta2V0Y2hmYWJVdGlsaXR5UmVhZHkoKXsNCgkJIHNrZXRjaGZhYkFQSVV0aWxpdHlJbnN0YW5jZS5yZW1vdmVFdmVudExpc3RlbmVyKHNrZXRjaGZhYkFQSVV0aWxpdHlJbnN0YW5jZS5FVkVOVF9JTklUSUFMSVpFRCwgb25Ta2V0Y2hmYWJVdGlsaXR5UmVhZHkpOw0KCQkgLy9zb21lIGNvZGUgaGVyZS4uDQoJICB9Ow0KCSAgdmFyIHNrZXRjaGZhYkFQSVV0aWxpdHlJbnN0YW5jZSA9IG5ldyBTa2V0Y2hmYWJBUElVdGlsaXR5KCIjIyMiIiINCmh0bTI9IiIiYWY1MjhlM2RmNWY3NjZjYTAxMmY1ZTA2NWM3Y2I4MTIiIiINCmh0bTM9IiIiIiwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFwaS1mcmFtZSIpLCB7ImF1dG9zdGFydCI6IDEgfSk7DQoJICBza2V0Y2hmYWJBUElVdGlsaXR5SW5zdGFuY2UuYWRkRXZlbnRMaXN0ZW5lcihza2V0Y2hmYWJBUElVdGlsaXR5SW5zdGFuY2UuRVZFTlRfSU5JVElBTElaRUQsIG9uU2tldGNoZmFiVXRpbGl0eVJlYWR5KTsNCgkgIHNrZXRjaGZhYkFQSVV0aWxpdHlJbnN0YW5jZS5jcmVhdGUoKTsNCiAgIDwvc2NyaXB0Pg0KICANCjwvYm9keT4NCiIiIg0KDQoNCgkNCmNsYXNzIEJpbmFyeVJlYWRlcihmaWxlKToNCgkiIiJnZW5lcmFsIEJpbmFyeVJlYWRlcg0KCSIiIg0KCWRlZiBfX2luaXRfXyhzZWxmLCBpbnB1dEZpbGUpOg0KCQlzZWxmLmlucHV0RmlsZT1pbnB1dEZpbGUNCgkJc2VsZi5lbmRpYW49JzwnDQoJCXNlbGYuZGVidWc9RmFsc2UNCgkJc2VsZi5zdHJlYW09e30NCgkJc2VsZi5sb2dmaWxlPU5vbmUNCgkJc2VsZi5sb2c9RmFsc2UNCgkJc2VsZi5kaXJuYW1lPUJsZW5kZXIuc3lzLmRpcm5hbWUoc2VsZi5pbnB1dEZpbGUubmFtZSkNCgkJc2VsZi5iYXNlbmFtZT1CbGVuZGVyLnN5cy5iYXNlbmFtZShzZWxmLmlucHV0RmlsZS5uYW1lKS5zcGxpdCgnLicpWzBdDQoJCXNlbGYuZXh0PUJsZW5kZXIuc3lzLmJhc2VuYW1lKHNlbGYuaW5wdXRGaWxlLm5hbWUpLnNwbGl0KCcuJylbLTFdDQoJCXNlbGYueG9yS2V5PU5vbmUNCgkJc2VsZi54b3JPZmZzZXQ9MA0KCQlzZWxmLnhvckRhdGE9JycNCgkJc2VsZi5sb2dza2lwPUZhbHNlDQoJCQ0KCWRlZiBjbG9zZShzZWxmKToNCgkJc2VsZi5pbnB1dEZpbGUuY2xvc2UoKQ0KCQkNCglkZWYgWE9SKHNlbGYsZGF0YSk6DQoJCQlzZWxmLnhvckRhdGE9JycNCgkJCWZvciBtIGluIHJhbmdlKGxlbihkYXRhKSk6DQoJCQkJY2g9b3JkKAljaHIoZGF0YVttXSBeIHNlbGYueG9yS2V5W3NlbGYueG9yT2Zmc2V0XSkJKQ0KCQkJCXNlbGYueG9yRGF0YSs9c3RydWN0LnBhY2soJ0InLGNoKQ0KCQkJCWlmIHNlbGYueG9yT2Zmc2V0PT1sZW4oc2VsZi54b3JLZXkpLTE6DQoJCQkJCXNlbGYueG9yT2Zmc2V0PTANCgkJCQllbHNlOg0KCQkJCQlzZWxmLnhvck9mZnNldCs9MQkNCgkJDQoJCQ0KCWRlZiBsb2dPcGVuKHNlbGYpOgkNCgkJbG9nRGlyPSdsb2cnDQoJCWlmIG9zLnBhdGguZXhpc3RzKGxvZ0Rpcik9PUZhbHNlOm9zLm1ha2VkaXJzKGxvZ0RpcikNCgkJc2VsZi5sb2c9VHJ1ZQ0KCQlzZWxmLmxvZ2ZpbGU9b3Blbihsb2dEaXIrb3Muc2VwK29zLnBhdGguYmFzZW5hbWUoc2VsZi5pbnB1dEZpbGUubmFtZSkrJy5sb2cnLCd3JykNCglkZWYgbG9nQ2xvc2Uoc2VsZik6DQoJCXNlbGYubG9nPUZhbHNlDQoJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZToNCgkJCXNlbGYubG9nZmlsZS5jbG9zZSgpDQoJZGVmIGxvZ1dyaXRlKHNlbGYsZGF0YSk6DQoJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZToNCgkJCXNlbGYubG9nZmlsZS53cml0ZShzdHIoZGF0YSkrJ1xuJykNCgkJZWxzZToNCgkJCXByaW50ICdXQVJOSU5HOiBubyBsb2cnDQoJCQkNCglkZWYgZGlybmFtZShzZWxmKToNCgkJcmV0dXJuIEJsZW5kZXIuc3lzLmRpcm5hbWUoc2VsZi5pbnB1dEZpbGUubmFtZSkNCglkZWYgYmFzZW5hbWUoc2VsZik6DQoJCXJldHVybiBCbGVuZGVyLnN5cy5iYXNlbmFtZShzZWxmLmlucHV0RmlsZS5uYW1lKS5zcGxpdCgnLicpWzBdDQoJZGVmIGV4dChzZWxmKToNCgkJcmV0dXJuIEJsZW5kZXIuc3lzLmJhc2VuYW1lKHNlbGYuaW5wdXRGaWxlLm5hbWUpLnNwbGl0KCcuJylbLTFdDQoJCQ0KCQkNCglkZWYgcShzZWxmLG4pOg0KCQlvZmZzZXQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidxJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qOCkpDQoJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQlwcmludCAncScsZGF0YQ0KCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3N0cihkYXRhKSsnXG4nKQ0KCQlyZXR1cm4gZGF0YQ0KCQkNCglkZWYgaShzZWxmLG4pOg0KCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0ncmInOg0KCQkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkJaWYgc2VsZi54b3JLZXkgaXMgTm9uZToNCgkJCQkjZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2knLHNlbGYuaW5wdXRGaWxlLnJlYWQobio0KSkNCgkJCQkJCQ0KCQkJCWRhdGEgPSBhcnJheS5hcnJheSgnaScpDQoJCQkJZGF0YS5mcm9tZmlsZShzZWxmLmlucHV0RmlsZSwgbikNCgkJCQlpZiBzZWxmLmVuZGlhbiA9PSAiPiI6IGRhdGEuYnl0ZXN3YXAoKQ0KCQkJCQ0KCQkJCQ0KCQkJZWxzZToNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbio0KidCJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qNCkpDQoJCQkJc2VsZi5YT1IoZGF0YSkNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionaScsc2VsZi54b3JEYXRhKQkNCgkJCQkJDQoJCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJCXByaW50ICdpJyxkYXRhDQoJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIob2Zmc2V0KSsnCScrc3RyKGRhdGEpKydcbicpDQoJCQlyZXR1cm4gZGF0YQ0KCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0nd2InOg0KCQkJZm9yIG0gaW4gcmFuZ2UobGVuKG4pKToNCgkJCQlkYXRhPXN0cnVjdC5wYWNrKHNlbGYuZW5kaWFuKydpJyxuW21dKQ0KCQkJCXNlbGYuaW5wdXRGaWxlLndyaXRlKGRhdGEpDQoJDQoJZGVmIEkoc2VsZixuKToNCgkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQlpZiBzZWxmLnhvcktleSBpcyBOb25lOg0KCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ0knLHNlbGYuaW5wdXRGaWxlLnJlYWQobio0KSkNCgkJZWxzZToNCgkJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKjQqJ0InLHNlbGYuaW5wdXRGaWxlLnJlYWQobio0KSkNCgkJCXNlbGYuWE9SKGRhdGEpDQoJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionSScsc2VsZi54b3JEYXRhKQkNCgkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCXByaW50ICdJJyxkYXRhDQoJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIob2Zmc2V0KSsnCScrc3RyKGRhdGEpKydcbicpDQoJCXJldHVybiBkYXRhDQoJDQoJZGVmIEIoc2VsZixuKToNCgkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3JiJzoNCgkJCW9mZnNldD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJCWlmIHNlbGYueG9yS2V5IGlzIE5vbmU6DQoJCQkJI2RhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidCJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4pKQ0KCQkJCQ0KCQkJCWRhdGEgPSBhcnJheS5hcnJheSgnQicpDQoJCQkJZGF0YS5mcm9tZmlsZShzZWxmLmlucHV0RmlsZSwgbikNCgkJCQlpZiBzZWxmLmVuZGlhbiA9PSAiPiI6IGRhdGEuYnl0ZXN3YXAoKQ0KCQkJCQ0KCQkJCQ0KCQkJZWxzZToNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionQicsc2VsZi5pbnB1dEZpbGUucmVhZChuKSkNCgkJCQlzZWxmLlhPUihkYXRhKQ0KCQkJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidCJyxzZWxmLnhvckRhdGEpCQ0KCQkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCQlwcmludCAnQicsZGF0YQ0KCQkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3N0cihkYXRhKSsnXG4nKQ0KCQkJcmV0dXJuIGRhdGENCgkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3diJzoNCgkJCWZvciBtIGluIHJhbmdlKGxlbihuKSk6DQoJCQkJZGF0YT1zdHJ1Y3QucGFjayhzZWxmLmVuZGlhbisnQicsblttXSkNCgkJCQlzZWxmLmlucHV0RmlsZS53cml0ZShkYXRhKQ0KCWRlZiBiKHNlbGYsbik6DQoJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSdyYic6DQoJCQlvZmZzZXQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCQlpZiBzZWxmLnhvcktleSBpcyBOb25lOg0KCQkJCSNkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionYicsc2VsZi5pbnB1dEZpbGUucmVhZChuKSkNCgkJCQlkYXRhID0gYXJyYXkuYXJyYXkoJ2InKQ0KCQkJCWRhdGEuZnJvbWZpbGUoc2VsZi5pbnB1dEZpbGUsIG4pDQoJCQkJaWYgc2VsZi5lbmRpYW4gPT0gIj4iOiBkYXRhLmJ5dGVzd2FwKCkNCgkJCWVsc2U6DQoJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2InLHNlbGYuaW5wdXRGaWxlLnJlYWQobikpDQoJCQkJc2VsZi5YT1IoZGF0YSkNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionYicsc2VsZi54b3JEYXRhKQkNCgkJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQkJcHJpbnQgJ2InLGRhdGENCgkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihvZmZzZXQpKycJJytzdHIoZGF0YSkrJ1xuJykNCgkJCXJldHVybiBkYXRhDQoJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSd3Yic6DQoJCQlmb3IgbSBpbiByYW5nZShsZW4obikpOg0KCQkJCWRhdGE9c3RydWN0LnBhY2soc2VsZi5lbmRpYW4rJ2InLG5bbV0pDQoJCQkJc2VsZi5pbnB1dEZpbGUud3JpdGUoZGF0YSkNCglkZWYgaChzZWxmLG4pOg0KCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0ncmInOg0KCQkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkJaWYgc2VsZi54b3JLZXkgaXMgTm9uZToNCgkJCQkjZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2gnLHNlbGYuaW5wdXRGaWxlLnJlYWQobioyKSkNCgkJCQkNCgkJCQlkYXRhID0gYXJyYXkuYXJyYXkoJ2gnKQ0KCQkJCWRhdGEuZnJvbWZpbGUoc2VsZi5pbnB1dEZpbGUsIG4pDQoJCQkJaWYgc2VsZi5lbmRpYW4gPT0gIj4iOiBkYXRhLmJ5dGVzd2FwKCkNCgkJCQkNCgkJCQkNCgkJCWVsc2U6DQoJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qMionQicsc2VsZi5pbnB1dEZpbGUucmVhZChuKjIpKQ0KCQkJCXNlbGYuWE9SKGRhdGEpDQoJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2gnLHNlbGYueG9yRGF0YSkJDQoJCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJCXByaW50ICdoJyxkYXRhDQoJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIob2Zmc2V0KSsnCScrc3RyKGRhdGEpKydcbicpDQoJCQlyZXR1cm4gZGF0YQ0KCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0nd2InOg0KCQkJZm9yIG0gaW4gcmFuZ2UobGVuKG4pKToNCgkJCQlkYXRhPXN0cnVjdC5wYWNrKHNlbGYuZW5kaWFuKydoJyxuW21dKQ0KCQkJCXNlbGYuaW5wdXRGaWxlLndyaXRlKGRhdGEpDQoJZGVmIEgoc2VsZixuKToNCgkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3JiJzoNCgkJCW9mZnNldD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJCWlmIHNlbGYueG9yS2V5IGlzIE5vbmU6DQoJCQkJI2RhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidIJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qMikpDQoJCQkJDQoJCQkJZGF0YSA9IGFycmF5LmFycmF5KCdIJykNCgkJCQlkYXRhLmZyb21maWxlKHNlbGYuaW5wdXRGaWxlLCBuKQ0KCQkJCWlmIHNlbGYuZW5kaWFuID09ICI+IjogZGF0YS5ieXRlc3dhcCgpDQoJCQkJDQoJCQkJDQoJCQllbHNlOg0KCQkJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKjIqJ0InLHNlbGYuaW5wdXRGaWxlLnJlYWQobioyKSkNCgkJCQlzZWxmLlhPUihkYXRhKQ0KCQkJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidIJyxzZWxmLnhvckRhdGEpCQ0KCQkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCQlwcmludCAnSCcsZGF0YQ0KCQkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3N0cihkYXRhKSsnXG4nKQ0KCQkJcmV0dXJuIGRhdGENCgkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3diJzoNCgkJCWZvciBtIGluIHJhbmdlKGxlbihuKSk6DQoJCQkJZGF0YT1zdHJ1Y3QucGFjayhzZWxmLmVuZGlhbisnSCcsblttXSkNCgkJCQlzZWxmLmlucHV0RmlsZS53cml0ZShkYXRhKQ0KCWRlZiBmKHNlbGYsbik6DQoJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSdyYic6DQoJCQlvZmZzZXQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCQlpZiBzZWxmLnhvcktleSBpcyBOb25lOg0KCQkJCSNkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionZicsc2VsZi5pbnB1dEZpbGUucmVhZChuKjQpKQ0KCQkJCQ0KCQkJCWRhdGEgPSBhcnJheS5hcnJheSgnZicpDQoJCQkJZGF0YS5mcm9tZmlsZShzZWxmLmlucHV0RmlsZSwgbikNCgkJCQlpZiBzZWxmLmVuZGlhbiA9PSAiPiI6IGRhdGEuYnl0ZXN3YXAoKQ0KCQkJCQ0KCQkJZWxzZToNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbio0KidCJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qNCkpDQoJCQkJc2VsZi5YT1IoZGF0YSkNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionZicsc2VsZi54b3JEYXRhKQkNCgkJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQkJcHJpbnQgJ2YnLGRhdGENCgkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihvZmZzZXQpKycJJytzdHIoZGF0YSkrJ1xuJykNCgkJCXJldHVybiBkYXRhDQoJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSd3Yic6DQoJCQlmb3IgbSBpbiByYW5nZShsZW4obikpOg0KCQkJCWRhdGE9c3RydWN0LnBhY2soc2VsZi5lbmRpYW4rJ2YnLG5bbV0pDQoJCQkJc2VsZi5pbnB1dEZpbGUud3JpdGUoZGF0YSkNCglkZWYgZChzZWxmLG4pOg0KCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0ncmInOg0KCQkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkJaWYgc2VsZi54b3JLZXkgaXMgTm9uZToNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionZCcsc2VsZi5pbnB1dEZpbGUucmVhZChuKjgpKQ0KCQkJZWxzZToNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbio0KidCJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qOCkpDQoJCQkJc2VsZi5YT1IoZGF0YSkNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionZCcsc2VsZi54b3JEYXRhKQkNCgkJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQkJcHJpbnQgJ2QnLGRhdGENCgkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihvZmZzZXQpKycJJytzdHIoZGF0YSkrJ1xuJykNCgkJCXJldHVybiBkYXRhDQoJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSd3Yic6DQoJCQlmb3IgbSBpbiByYW5nZShsZW4obikpOg0KCQkJCWRhdGE9c3RydWN0LnBhY2soc2VsZi5lbmRpYW4rJ2QnLG5bbV0pDQoJCQkJc2VsZi5pbnB1dEZpbGUud3JpdGUoZGF0YSkNCglkZWYgaGFsZihzZWxmLG4saD0naCcpOg0KCQlhcnJheSA9IFtdIA0KCQlvZmZzZXQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCWZvciBpZCBpbiByYW5nZShuKTogDQoJCQkjYXJyYXkuYXBwZW5kKGNvbnZlcnRoYWxmMmZsb2F0KHN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rJ0gnLHNlbGYuaW5wdXRGaWxlLnJlYWQoMikpWzBdKSkNCgkJCWFycmF5LmFwcGVuZChjb252ZXJ0aGFsZjJmbG9hdChzdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK2gsc2VsZi5pbnB1dEZpbGUucmVhZCgyKSlbMF0pKQ0KCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJcHJpbnQgJ2hhbGYnLGFycmF5DQoJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIob2Zmc2V0KSsnCScrc3RyKGFycmF5KSsnXG4nKQ0KCQlyZXR1cm4gYXJyYXkNCgkJDQoJZGVmIHNob3J0KHNlbGYsbixoPSdoJyxleHA9MTIpOg0KCQlhcnJheSA9IFtdIA0KCQlvZmZzZXQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCWZvciBpZCBpbiByYW5nZShuKTogDQoJCQlhcnJheS5hcHBlbmQoc3RydWN0LnVucGFjayhzZWxmLmVuZGlhbitoLHNlbGYuaW5wdXRGaWxlLnJlYWQoMikpWzBdKjIqKi1leHApDQoJCQkjYXJyYXkuYXBwZW5kKHNlbGYuSCgxKVswXSoyKiotZXhwKQ0KCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJcHJpbnQgJ3Nob3J0JyxhcnJheQ0KCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3N0cihhcnJheSkrJ1xuJykNCgkJcmV0dXJuIGFycmF5DQoJCQ0KCWRlZiBpMTIoc2VsZixuKToNCgkJYXJyYXkgPSBbXSANCgkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQlmb3IgaWQgaW4gcmFuZ2Uobik6IA0KCQkJaWYgc2VsZi5lbmRpYW49PSc+JzoNCgkJCQl2YXI9J1x4MDAnK3NlbGYuaW5wdXRGaWxlLnJlYWQoMykNCgkJCWlmIHNlbGYuZW5kaWFuPT0nPCc6DQoJCQkJdmFyPXNlbGYuaW5wdXRGaWxlLnJlYWQoMykrJ1x4MDAnDQoJCQlhcnJheS5hcHBlbmQoc3RydWN0LnVucGFjayhzZWxmLmVuZGlhbisnaScsdmFyKVswXSkNCgkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCXByaW50IGFycmF5DQoJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIob2Zmc2V0KSsnCScrc3RyKGFycmF5KSsnXG4nKQ0KCQlyZXR1cm4gYXJyYXkNCgkJDQoJCQ0KCQkNCglkZWYgZmluZChzZWxmLHZhcik6IA0KCQlzdGFydD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJcz0nJw0KCQl3aGlsZShUcnVlKToNCgkJCWM9c2VsZi5pbnB1dEZpbGUucmVhZCgxKQ0KCQkJI3ByaW50IGMNCgkJCWlmIGM9PXZhclswXToNCgkJCQlpZiBsZW4odmFyKT4xOg0KCQkJCQlmb3IgbSBpbiByYW5nZSgxLGxlbih2YXIpKToNCgkJCQkJCWM9c2VsZi5pbnB1dEZpbGUucmVhZCgxKQ0KCQkJCQkJaWYgYyE9dmFyW21dOg0KCQkJCQkJCWJyZWFrDQoJCQkJCWlmIG09PWxlbih2YXIpLTE6DQoJCQkJCQlicmVhaw0KCQkJCWVsc2U6DQoJCQkJCWJyZWFrDQoJCQllbHNlOgkNCgkJCQlzKz1jCQ0KCQkJCQkJDQoJCQ0KCQkNCgkJDQoJCQ0KCQkjaWYgc2VsZi5sb2c9PVRydWU6DQoJCSMJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCSMJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKHN0YXJ0KSsnCScrcysnXG4nKQ0KCQlyZXR1cm4gcwkNCgkNCglkZWYgZmluZDEoc2VsZix2YXIsc2l6ZT05OTkpOiANCgkJDQoJCXN0YXJ0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQlzPScnDQoJCXdoaWxlKFRydWUpOg0KCQkJZGF0YT1zZWxmLmlucHV0RmlsZS5yZWFkKHNpemUpDQoJCQlvZmY9ZGF0YS5maW5kKHZhcikNCgkJCSNwcmludCBvZmYNCgkJCWlmIG9mZj49MDoNCgkJCQlzKz1kYXRhWzpvZmZdDQoJCQkJc2VsZi5pbnB1dEZpbGUuc2VlayhzdGFydCtvZmYrbGVuKHZhcikpDQoJCQkJI3ByaW50ICd6bmFsZXppb25vJyx2YXIsJ29mZnNldD0nLHNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkJCWJyZWFrDQoJCQllbHNlOg0KCQkJCXMrPWRhdGENCgkJCQlzdGFydCs9c2l6ZQ0KCQkJI3ByaW50IHNlbGYuaW5wdXRGaWxlLnRlbGwoKQksc2VsZi5maWxlU2l6ZSgpDQoJCQlpZiBzZWxmLmlucHV0RmlsZS50ZWxsKCk+PXNlbGYuZmlsZVNpemUoKTpicmVhawkNCgkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCXByaW50IHMNCgkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihzdGFydCkrJwknK3MrJ1xuJykNCgkJcmV0dXJuIHMJDQoJCQ0KCWRlZiBmaW5kMTAoc2VsZix2YXIpOiANCgkJDQoJCXN0YXJ0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQlzPScnDQoJCWRhdGE9c2VsZi5pbnB1dEZpbGUucmVhZCgpDQoJCW9mZj1kYXRhLmZpbmQodmFyKQ0KCQlpZiBvZmY+PTA6DQoJCQlzKz1kYXRhWzpvZmZdDQoJCQlzZWxmLmlucHV0RmlsZS5zZWVrKHN0YXJ0K29mZitsZW4odmFyKSkNCgkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihzdGFydCkrJwknK3MrJ1xuJykNCgkJcmV0dXJuIHMJDQoJDQoJZGVmIGZpbmRBbGwoc2VsZix2YXIsc2l6ZT0xMDApOiANCgkJbGlzdD1bXQ0KCQl3aGlsZShUcnVlKToNCgkJCXN0YXJ0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkJZGF0YT1zZWxmLmlucHV0RmlsZS5yZWFkKHNpemUpDQoJCQlvZmY9ZGF0YS5maW5kKHZhcikNCgkJCSNwcmludCBvZmYsc2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCQlpZiBvZmY+PTA6DQoJCQkJbGlzdC5hcHBlbmQoc3RhcnQrb2ZmKQ0KCQkJCSNwcmludCBzdGFydCtvZmYNCgkJCQlzZWxmLmlucHV0RmlsZS5zZWVrKHN0YXJ0K29mZitsZW4odmFyKSkNCgkJCQkjaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCQkjCXByaW50IHN0YXJ0K29mZg0KCQkJZWxzZToNCgkJCQlzdGFydCs9c2l6ZQ0KCQkJCXNlbGYuaW5wdXRGaWxlLnNlZWsoc3RhcnQpDQoJCQlpZglzZWxmLmlucHV0RmlsZS50ZWxsKCk+c2VsZi5maWxlU2l6ZSgpOg0KCQkJCWJyZWFrDQoJCXJldHVybiBsaXN0CQ0KCQkNCgkJDQoJZGVmIGZpbmRjaGFyKHNlbGYsdmFyKToNCgkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLmZpbmQodmFyKQ0KCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJcHJpbnQgdmFyLCd6bmFsZXppb25vJyxvZmZzZXQNCgkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUodmFyKycgem5hbGV6aW9ubyAnK3N0cihvZmZzZXQpKydcbicpDQoJCXJldHVybiBvZmZzZXQJDQoJCQ0KCQkNCglkZWYgZmlsZVNpemUoc2VsZik6DQoJCWJhY2s9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCXNlbGYuaW5wdXRGaWxlLnNlZWsoMCwyKQ0KCQl0ZWxsPXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkjc2VsZi5pbnB1dEZpbGUuc2VlaygwKQ0KCQlzZWxmLmlucHV0RmlsZS5zZWVrKGJhY2spDQoJCXJldHVybiB0ZWxsDQoJCQ0KCWRlZiBzZWVrKHNlbGYsb2ZmLGE9MCk6DQoJCXNlbGYuaW5wdXRGaWxlLnNlZWsob2ZmLGEpDQoJDQoJZGVmIHNlZWtwYWQoc2VsZixwYWQsdHlwZT0wKToNCgkJJycnIDE2LWJ5dGUgY2h1bmsgYWxpZ25tZW50JycnDQoJCXNpemU9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCXNlZWsgPSAocGFkIC0gKHNpemUgJSBwYWQpKSAlIHBhZA0KCQlpZiB0eXBlPT0xOg0KCQkJaWYgc2Vlaz09MDoNCgkJCQlzZWVrKz1wYWQNCgkJc2VsZi5pbnB1dEZpbGUuc2VlayhzZWVrLCAxKQ0KCQkNCglkZWYgcmVhZChzZWxmLGNvdW50KToNCgkJYmFjaz1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJaWYgc2VsZi54b3JLZXkgaXMgTm9uZToNCgkJCXJldHVybiBzZWxmLmlucHV0RmlsZS5yZWFkKGNvdW50KQ0KCQllbHNlOg0KCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK2NvdW50KidCJyxzZWxmLmlucHV0RmlsZS5yZWFkKGNvdW50KSkNCgkJCXNlbGYuWE9SKGRhdGEpDQoJCQlyZXR1cm4gc2VsZi54b3JEYXRhDQoJCQkNCgkNCgkJDQoJZGVmIHdyaXRlKHNlbGYsc3RyaW5nKToNCgkJc2VsZi5pbnB1dEZpbGUud3JpdGUoc3RyaW5nKQ0KCQkNCglkZWYgdGVsbChzZWxmKToNCgkJdmFsPXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJcHJpbnQgJ2N1cnJlbnQgb2Zmc2V0IGlzJyx2YWwNCgkJcmV0dXJuIHZhbAkNCgkJDQoJZGVmIHdvcmQoc2VsZixsb25nKToNCgkJaWYgbG9uZzwxMDAwMDoNCgkJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSdyYic6IA0KCQkJCW9mZnNldD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJCQlzPScnDQoJCQkJZm9yIGogaW4gcmFuZ2UoMCxsb25nKTogDQoJCQkJCQ0KCQkJCQkNCgkJCQkJaWYgc2VsZi54b3JLZXkgaXMgTm9uZToNCgkJCQkJCWxpdCA9ICBzdHJ1Y3QudW5wYWNrKCdjJyxzZWxmLmlucHV0RmlsZS5yZWFkKDEpKVswXQ0KCQkJCQkJI2RhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidpJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qNCkpDQoJCQkJCWVsc2U6DQoJCQkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rJ0InLHNlbGYuaW5wdXRGaWxlLnJlYWQoMSkpDQoJCQkJCQlzZWxmLlhPUihkYXRhKQ0KCQkJCQkJbGl0PXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rJ2MnLHNlbGYueG9yRGF0YSlbMF0NCgkJCQkJDQoJCQkJCQkjbGl0ID0Jc3RydWN0LnVucGFjaygnYycsc2VsZi5pbnB1dEZpbGUucmVhZCgxKSlbMF0NCgkJCQkJDQoJCQkJCQ0KCQkJCQkNCgkJCQkJaWYgb3JkKGxpdCkhPTA6DQoJCQkJCQlzKz1saXQNCgkJCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJCQlwcmludCBzDQoJCQkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIob2Zmc2V0KSsnCScrcysnXG4nKQ0KCQkJCXJldHVybiBzDQoJCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0nd2InOg0KCQkJCSNkYXRhPXNlbGYuaW5wdXRGaWxlLnJlYWQobG9uZykNCgkJCQlzZWxmLmlucHV0RmlsZS53cml0ZShsb25nKQ0KCQkJI3JldHVybiAwCQ0KCQllbHNlOg0KCQkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCQlwcmludCAnV0FSTklORzp0b28gbG9uZycNCgkJCSNyZXR1cm4gMQ0KCQkNCgkJDQoJCQ0KCWRlZiBzKHNlbGYsbG9uZyk6DQoJCWlmIGxvbmc8MTAwMDA6DQoJCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0ncmInOiANCgkJCQlvZmZzZXQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCQkJcz0nJw0KCQkJCWZvciBqIGluIHJhbmdlKDAsbG9uZyk6IA0KCQkJCQkNCgkJCQkJDQoJCQkJCWlmIHNlbGYueG9yS2V5IGlzIE5vbmU6DQoJCQkJCQlsaXQgPSAgc3RydWN0LnVucGFjaygnYycsc2VsZi5pbnB1dEZpbGUucmVhZCgxKSlbMF0NCgkJCQkJCSNkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionaScsc2VsZi5pbnB1dEZpbGUucmVhZChuKjQpKQ0KCQkJCQllbHNlOg0KCQkJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuKydCJyxzZWxmLmlucHV0RmlsZS5yZWFkKDEpKQ0KCQkJCQkJc2VsZi5YT1IoZGF0YSkNCgkJCQkJCWxpdD1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuKydjJyxzZWxmLnhvckRhdGEpWzBdDQoJCQkJCQ0KCQkJCQkJI2xpdCA9CXN0cnVjdC51bnBhY2soJ2MnLHNlbGYuaW5wdXRGaWxlLnJlYWQoMSkpWzBdDQoJCQkJCQ0KCQkJCQkNCgkJCQkJDQoJCQkJCWlmIG9yZChsaXQpIT0wOg0KCQkJCQkJcys9bGl0DQoJCQkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCQkJcHJpbnQgcw0KCQkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3MrJ1xuJykNCgkJCQlyZXR1cm4gcw0KCQkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3diJzoNCgkJCQkjZGF0YT1zZWxmLmlucHV0RmlsZS5yZWFkKGxvbmcpDQoJCQkJc2VsZi5pbnB1dEZpbGUud3JpdGUobG9uZykNCgkJCSNyZXR1cm4gMAkNCgkJZWxzZToNCgkJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQkJcHJpbnQgJ1dBUk5JTkc6dG9vIGxvbmcnDQoJCQkjcmV0dXJuIDENCgkJDQoJCQ0KCWRlZiBTdHJlYW0oc2VsZixzdHJlYW1fbmFtZSxlbGVtZW50X2NvdW50LGVsZW1lbnRfc2l6ZSk6DQoJCXNlbGYuaW5wdXRGaWxlLnNlZWsoZWxlbWVudF9jb3VudCplbGVtZW50X3NpemUsMSkNCgkJc2VsZi5zdHJlYW1bc3RyZWFtX25hbWVdWydvZmZzZXQnXT1vZmZzZXQNCgkJc2VsZi5zdHJlYW1bc3RyZWFtX25hbWVdWydlbGVtZW50X2NvdW50J109ZWxlbWVudF9jb3VudAkNCgkJc2VsZi5zdHJlYW1bc3RyZWFtX25hbWVdWydlbGVtZW50X3NpemUnXT1lbGVtZW50X3NpemUJDQoJCQ0KDQoNCg0KZGVmIGdldE1hdE5hbWUoeXMscGFyZW50KToNCgkjcHJpbnQgJ2dldE1hdE5hbWUnDQoJbWF0TmFtZT1Ob25lDQoJaWYJbWF0TmFtZSBub3QgaW4gTUFURVJJQUxTLmtleXMoKToNCgkJVW5pcXVlSUQ9eXMuZ2V0KHBhcmVudCwnIlVuaXF1ZUlEIicpDQoJCWlmIFVuaXF1ZUlEOg0KCQkJdmFsdWVzPXlzLnZhbHVlcyhVbmlxdWVJRFswXS5oZWFkZXIsJ3MnKQ0KCQkJaWYgbGVuKHZhbHVlcyk+MToNCgkJCQlpZiAnIicgaW4gdmFsdWVzWzFdIGFuZCAnXycgaW4gdmFsdWVzWzFdOg0KCQkJCQltYXROYW1lPXZhbHVlc1sxXS5zcGxpdCgnIicpWzNdLnNwbGl0KCdfJylbLTJdDQoJDQoJcmdiYT1Ob25lCQ0KCUF0dHJpYnV0ZUxpc3Q9eXMuZ2V0KHBhcmVudCwnIkF0dHJpYnV0ZUxpc3QiJykJDQoJaWYgQXR0cmlidXRlTGlzdDoJCQkNCgkJdmFsdWVzPXlzLnZhbHVlcyhBdHRyaWJ1dGVMaXN0WzBdLmhlYWRlciwnOicpDQoJCVVuaXF1ZUlEPXlzLmdldFZhbHVlKHZhbHVlcywnIlVuaXF1ZUlEIicsJ2knKQ0KCQlEaWZmdXNlPXlzLmdldChwYXJlbnQsJyJEaWZmdXNlIicpDQoJCWlmIERpZmZ1c2U6DQoJCQlyZ2JhPXlzLnZhbHVlcyhEaWZmdXNlWzBdLmRhdGEsJ2YnKQkJCQkNCgkJaWYJbWF0TmFtZSBub3QgaW4gTUFURVJJQUxTLmtleXMoKToNCgkJCU1hdGVyaWFsPXlzLmdldChBdHRyaWJ1dGVMaXN0WzBdLCcib3NnLk1hdGVyaWFsIicpDQoJCQlpZiBNYXRlcmlhbDoJDQoJCQkJZm9yIGEgaW4gTWF0ZXJpYWxbMF0uY2hpbGRyZW46DQoJCQkJCWlmICciTmFtZSInIGluIGEuaGVhZGVyOgkJCQkJCQkJDQoJCQkJCQlzcGxpdHM9YS5oZWFkZXIuc3BsaXQoJyInKQ0KCQkJCQkJaWYgbGVuKHNwbGl0cyk+NDoNCgkJCQkJCQltYXROYW1lPXNwbGl0c1s1XQ0KCQkJCQkJCWlmICc6JyBpbiBtYXROYW1lOg0KCQkJCQkJCQltYXROYW1lPW1hdE5hbWUucmVwbGFjZSgnOicsJycpDQoJCQkJCQkJbW9kZWwubWF0TGlzdFtVbmlxdWVJRF09bWF0TmFtZQkNCgkJCQkNCglpZgltYXROYW1lIG5vdCBpbiBNQVRFUklBTFMua2V5cygpOgkNCgkJU3RhdGVTZXQ9eXMuZ2V0KHBhcmVudCwnIlN0YXRlU2V0IicpDQoJCWlmIFN0YXRlU2V0Og0KCQkJb3NnU3RhdGVTZXQ9eXMuZ2V0KFN0YXRlU2V0WzBdLCcib3NnLlN0YXRlU2V0IicpDQoJCQlpZiBvc2dTdGF0ZVNldDoJDQoJCQkJaWYgbGVuKG9zZ1N0YXRlU2V0WzBdLmNoaWxkcmVuKT4wOg0KCQkJCQlmb3IgY2hpbGQgaW4gb3NnU3RhdGVTZXRbMF0uY2hpbGRyZW46CQkJCQ0KCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5oZWFkZXIsJzonKQ0KCQkJCQkJaWYgJyJVbmlxdWVJRCInIGluIHZhbHVlcyBhbmQgJyJOYW1lIicgaW4gdmFsdWVzOg0KCQkJCQkJCVVuaXF1ZUlEPXlzLmdldFZhbHVlKHZhbHVlcywnIlVuaXF1ZUlEIicsJ2knKQ0KCQkJCQkJCW1hdE5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciTmFtZSInLCciIicpDQoJCQkJCQkJbW9kZWwubWF0TGlzdFtVbmlxdWVJRF09bWF0TmFtZQ0KCQkJCWVsc2U6CQkJCQ0KCQkJCQl2YWx1ZXM9eXMudmFsdWVzKG9zZ1N0YXRlU2V0WzBdLmRhdGEsJzonKQ0KCQkJCQlpZiAnIkF0dHJpYnV0ZUxpc3QiJyBub3QgaW4gdmFsdWVzOg0KCQkJCQkJVW5pcXVlSUQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciVW5pcXVlSUQiJywnaScpDQoJCQkJCQlpZiBVbmlxdWVJRCBpbiBtb2RlbC5tYXRMaXN0Og0KCQkJCQkJCW1hdE5hbWU9bW9kZWwubWF0TGlzdFtVbmlxdWVJRF0NCgkJCQ0KCWlmCW1hdE5hbWU6CQ0KCQlpZglsZW4obWF0TmFtZSk9PTA6DQoJCQltYXROYW1lPSdSb290Tm9kZScNCgkJaWYgJ1x4ZWYnIGluIG1hdE5hbWU6DQoJCQltYXROYW1lPW1hdE5hbWUuc3BsaXQoJ1x4ZWYnKVswXQ0KCWRpZmZ1c2U9Tm9uZQkJDQoJbm9ybWFsPU5vbmUJDQoJc3BlY3VsYXI9Tm9uZQ0KCXRyYW5zPU5vbmUJDQoJYW89Tm9uZQ0KCXJnYkNvbD1Ob25lDQoJcmdiU3BlYz1Ob25lDQoJDQoJDQoJDQoJDQoJDQoJaWYgbGVuKE1BVEVSSUFMUy5rZXlzKCkpPT0xOg0KCQkJa2V5PU1BVEVSSUFMUy5rZXlzKClbMF0NCgkJCWZvciBpbWFnZVR5cGUgaW4gTUFURVJJQUxTW2tleV06DQoJCQkJaWYgTUFURVJJQUxTW2tleV1baW1hZ2VUeXBlXVswXT09J3RleHR1cmUnOg0KCQkJCQloYXNoPU1BVEVSSUFMU1trZXldW2ltYWdlVHlwZV1bMV0JCQkJCQ0KCQkJCQlpZiBoYXNoIGluIElNQUdFUy5rZXlzKCk6DQoJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ1JHQiddOg0KCQkJCQkJCXBhdGgsZXhpc3RzLHF1YWxpdHk9SU1BR0VTW2hhc2hdWydSR0InXQ0KCQkJCQkJCWlmIGV4aXN0cz09MToNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nT3BhY2l0eSc6dHJhbnM9cGF0aA0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdBbGJlZG9QQlInOmRpZmZ1c2U9cGF0aA0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdEaWZmdXNlQ29sb3InOmRpZmZ1c2U9cGF0aA0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdOb3JtYWxNYXAnOm5vcm1hbD1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J1NwZWN1bGFyQ29sb3InOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nRGlmZnVzZVBCUic6ZGlmZnVzZT1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J1NwZWN1bGFyRjAnOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nU3BlY3VsYXJDb2xvcic6c3BlY3VsYXI9cGF0aA0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdEaWZmdXNlSW50ZW5zaXR5Jzphbz1wYXRoDQoJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ0EnXToNCgkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnQSddDQoJCQkJCQkJaWYgZXhpc3RzPT0xOg0KCQkJCQkJCQl0cmFucz1wYXRoDQoJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ04nXToNCgkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnTiddDQoJCQkJCQkJaWYgZXhpc3RzPT0xOg0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdOb3JtYWxNYXAnOm5vcm1hbD1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J0J1bXBNYXAnOm5vcm1hbD1wYXRoDQoJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ1InXToNCgkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnUiddDQoJCQkJCQkJaWYgZXhpc3RzPT0xOg0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdPcGFjaXR5Jzp0cmFucz1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J1NwZWN1bGFyRjAnOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nQU9QQlInOmFvPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nUm91Z2huZXNzUEJSJzpzcGVjdWxhcj1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J0dsb3NzaW5lc3NQQlInOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nQnVtcE1hcCc6bm9ybWFsPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nU3BlY3VsYXJDb2xvcic6c3BlY3VsYXI9cGF0aA0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdEaWZmdXNlSW50ZW5zaXR5Jzphbz1wYXRoDQoJCQkJaWYgTUFURVJJQUxTW2tleV1baW1hZ2VUeXBlXVswXT09J2NvbG9yJzoNCgkJCQkJaWYgaW1hZ2VUeXBlPT0nRGlmZnVzZUNvbG9yJzoNCgkJCQkJCXJnYkNvbD1NQVRFUklBTFNba2V5XVtpbWFnZVR5cGVdWzFdDQoJCQkJCQkJCQ0KCWVsc2U6CQkJCQkJCQ0KCQlmb3Iga2V5IGluIE1BVEVSSUFMUy5rZXlzKCk6DQoJCQlpZiBrZXk9PW1hdE5hbWU6DQoJCQkJZm9yIGltYWdlVHlwZSBpbiBNQVRFUklBTFNba2V5XToNCgkJCQkJaWYgTUFURVJJQUxTW2tleV1baW1hZ2VUeXBlXVswXT09J3RleHR1cmUnOg0KCQkJCQkJaGFzaD1NQVRFUklBTFNba2V5XVtpbWFnZVR5cGVdWzFdCQkJCQkNCgkJCQkJCWlmIGhhc2ggaW4gSU1BR0VTLmtleXMoKToNCgkJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ1JHQiddOg0KCQkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnUkdCJ10NCgkJCQkJCQkJaWYgZXhpc3RzPT0xOg0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nQWxiZWRvUEJSJzpkaWZmdXNlPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J0RpZmZ1c2VDb2xvcic6ZGlmZnVzZT1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdEaWZmdXNlUEJSJzpkaWZmdXNlPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J05vcm1hbE1hcCc6bm9ybWFsPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J0VtaXRDb2xvcic6ZGlmZnVzZT1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdTcGVjdWxhclBCUic6c3BlY3VsYXI9cGF0aA0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nT3BhY2l0eSc6dHJhbnM9cGF0aA0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nU3BlY3VsYXJGMCc6c3BlY3VsYXI9cGF0aA0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nU3BlY3VsYXJDb2xvcic6c3BlY3VsYXI9cGF0aA0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nRGlmZnVzZUludGVuc2l0eSc6YW89cGF0aA0KCQkJCQkJCWlmIElNQUdFU1toYXNoXVsnQSddOg0KCQkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnQSddDQoJCQkJCQkJCWlmIGV4aXN0cz09MToNCgkJCQkJCQkJCXRyYW5zPXBhdGgNCgkJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ04nXToNCgkJCQkJCQkJcGF0aCxleGlzdHMscXVhbGl0eT1JTUFHRVNbaGFzaF1bJ04nXQ0KCQkJCQkJCQlpZiBleGlzdHM9PTE6DQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdOb3JtYWxNYXAnOm5vcm1hbD1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdCdW1wTWFwJzpub3JtYWw9cGF0aA0KCQkJCQkJCWlmIElNQUdFU1toYXNoXVsnUiddOg0KCQkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnUiddDQoJCQkJCQkJCWlmIGV4aXN0cz09MToNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J09wYWNpdHknOnRyYW5zPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J1NwZWN1bGFyRjAnOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J0FPUEJSJzphbz1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdSb3VnaG5lc3NQQlInOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J0dsb3NzaW5lc3NQQlInOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J0J1bXBNYXAnOm5vcm1hbD1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdTcGVjdWxhckNvbG9yJzpzcGVjdWxhcj1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdEaWZmdXNlSW50ZW5zaXR5Jzphbz1wYXRoDQoJCQkJCWlmIE1BVEVSSUFMU1trZXldW2ltYWdlVHlwZV1bMF09PSdjb2xvcic6DQoJCQkJCQlpZiBpbWFnZVR5cGU9PSdEaWZmdXNlQ29sb3InOg0KCQkJCQkJCXJnYkNvbD1NQVRFUklBTFNba2V5XVtpbWFnZVR5cGVdWzFdDQoJCQkJDQoJVGV4dHVyZUF0dHJpYnV0ZUxpc3Q9eXMuZ2V0KHBhcmVudCwnIlRleHR1cmVBdHRyaWJ1dGVMaXN0IicpDQoJaWYgVGV4dHVyZUF0dHJpYnV0ZUxpc3Q6DQoJCQkjcHJpbnQgJ2hlcmUnDQoJCQlvc2dfVGV4dHVyZT15cy5nZXQocGFyZW50LCcib3NnLlRleHR1cmUiJykNCgkJCWlmIG9zZ19UZXh0dXJlOg0KCQkJCXZhbHVlcz15cy52YWx1ZXMob3NnX1RleHR1cmVbMF0uZGF0YSwnOicpCQkJCQ0KCQkJCWhhc2g9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInLCciIicpDQoJCQkJaWYgaGFzaDoNCgkJCQkJaWYgJy8nIGluIGhhc2g6DQoJCQkJCQloYXNoPWhhc2guc3BsaXQoJy8nKVsxXQ0KCQkJCQkJI3ByaW50IGhhc2gNCgkJCQkJCWlmIGhhc2ggaW4gSU1BR0VTLmtleXMoKToNCgkJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ1JHQiddOg0KCQkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnUkdCJ10NCgkJCQkJCQkJaWYgZXhpc3RzPT0xOg0KCQkJCQkJCQkJZGlmZnVzZT1wYXRoDQoJCQkJCQkJaWYgSU1BR0VTW2hhc2hdWydBJ106DQoJCQkJCQkJCXBhdGgsZXhpc3RzLHF1YWxpdHk9SU1BR0VTW2hhc2hdWydBJ10NCgkJCQkJCQkJaWYgZXhpc3RzPT0xOg0KCQkJCQkJCQkJdHJhbnM9cGF0aA0KCQkJCQkJCWlmIElNQUdFU1toYXNoXVsnTiddOg0KCQkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnTiddDQoJCQkJCQkJCWlmIGV4aXN0cz09MToNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J05vcm1hbE1hcCc6bm9ybWFsPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J0J1bXBNYXAnOm5vcm1hbD1wYXRoDQoJCQ0KCXJldHVybiBtYXROYW1lLGRpZmZ1c2Usc3BlY3VsYXIsbm9ybWFsLGFvLHRyYW5zLHJnYkNvbCxyZ2JTcGVjLHJnYmENCgkNCg0KZGVmIGdldFNwbGl0TmFtZShuYW1lLHdoYXQsd2hpY2gpOg0KCWE9Tm9uZQ0KCWlmIHdoYXQgaW4gbmFtZToNCgkJYT0nJw0KCQlzcGxpdHM9bmFtZS5zcGxpdCh3aGF0KQ0KCQlpZiB3aGljaDwwOg0KCQkJbnVtPWxlbihzcGxpdHMpK3doaWNoLTENCgkJZWxzZToNCgkJCW51bT13aGljaA0KCQlpZiBudW08MDoNCgkJCWE9bmFtZQ0KCQllbHNlOgkJDQoJCQlpZiB3aGljaDxsZW4oc3BsaXRzKToJCQkNCgkJCQlmb3IgbSBpbiByYW5nZShudW0pOg0KCQkJCQlhKz1zcGxpdHNbbV0rd2hhdA0KCQkJCWErPXNwbGl0c1tudW1dDQoJCQllbHNlOg0KCQkJCWE9bmFtZQkJDQoJcmV0dXJuIGEJDQoJCQ0KDQpkZWYgZXRhcDEoaW5wdXQsSXRlbVNpemUpOg0KCW49bGVuKGlucHV0KS9JdGVtU2l6ZQ0KCXI9MA0KCW91dHB1dD1bMF0qbGVuKGlucHV0KQ0KCXdoaWxlKHI8bik6DQoJCWE9cipJdGVtU2l6ZQ0KCQlzPTANCgkJd2hpbGUoczxJdGVtU2l6ZSk6DQoJCQlvdXRwdXRbYStzXT1pbnB1dFtyK24qc10NCgkJCXMrPTEJDQoJCXIrPTENCglyZXR1cm4gb3V0cHV0CQ0KCQ0KZGVmIGV0YXAyKGlucHV0LEl0ZW1TaXplLGF0cmlidXRlcyk6DQoJaT1bYXRyaWJ1dGVzWyciYngiJ10sYXRyaWJ1dGVzWyciYnkiJ10sYXRyaWJ1dGVzWyciYnoiJ11dDQoJbj1bYXRyaWJ1dGVzWyciaHgiJ10sYXRyaWJ1dGVzWyciaHkiJ10sYXRyaWJ1dGVzWyciaHoiJ11dDQoJYT1sZW4oaW5wdXQpL0l0ZW1TaXplDQoJcz0wDQoJb3V0cHV0PVswXSpsZW4oaW5wdXQpDQoJd2hpbGUoczxhKToNCgkJbz1zKkl0ZW1TaXplDQoJCXU9MA0KCQl3aGlsZSh1PEl0ZW1TaXplKToNCgkJCW91dHB1dFtvK3VdPWlbdV0raW5wdXRbbyt1XSpuW3VdOw0KCQkJdSs9MQkNCgkJcys9MQ0KCXJldHVybiBvdXRwdXQJDQoJDQoJDQoJDQoJDQpkZWYgZXRhcDMoaW5wdXQsSXRlbVNpemUpOg0KCWk9SXRlbVNpemV8MQ0KCW49MQ0KCXI9bGVuKGlucHV0KS9pDQoJd2hpbGUobjxyKToNCgkJYT0obi0xKSppDQoJCXM9bippDQoJCW89MA0KCQl3aGlsZShvPGkpOgkJCQ0KCQkJaW5wdXRbcytvXSs9aW5wdXRbYStvXQ0KCQkJbys9MQkNCgkJbis9MQ0KCXJldHVybiBpbnB1dA0KCQ0KZGVmIGV0YXA0KGlucHV0KToNCgllPTENCglpPWxlbihpbnB1dCkvNA0KCXdoaWxlKGU8aSk6DQoJCW49NCooZS0xKQ0KCQlyPTQqZQ0KCQlhPWlucHV0W25dDQoJCXM9aW5wdXRbbisxXQ0KCQlvPWlucHV0W24rMl0NCgkJdT1pbnB1dFtuKzNdDQoJCWw9aW5wdXRbcl0NCgkJaD1pbnB1dFtyKzFdDQoJCWM9aW5wdXRbcisyXQ0KCQlkPWlucHV0W3IrM10NCgkJaW5wdXRbcl09YSpkK3MqYy1vKmgrdSpsDQoJCWlucHV0W3IrMV09LWEqYytzKmQrbypsK3UqaA0KCQlpbnB1dFtyKzJdPWEqaC1zKmwrbypkK3UqYw0KCQlpbnB1dFtyKzNdPS1hKmwtcypoLW8qYyt1KmQNCgkJZSs9MQ0KCXJldHVybglpbnB1dA0KCQ0KDQoNCmRlZiBpbnQzZmxvYXQ0KGlucHV0LGF0cmlidXRlcyxJdGVtU2l6ZSk6DQoJYz00DQoJZD1hdHJpYnV0ZXNbJyJlcHNpbG9uIiddDQoJcD1pbnQoYXRyaWJ1dGVzWycibnBoaSInXSkNCgllPVswXSpsZW4oaW5wdXQpKjQNCglpPTEuNTcwNzk2MzI2NzkNCgluPTYuMjgzMTg1MzA3MTgNCglyPTMuMTQxNTkyNjUzNTkNCglhPTAuMDE3NDUzMjkyNTENCglzPTAuMjUNCglvPTcyMA0KCXU9ODMyDQoJbD00NzkzODM2MjU4NDE1MTYzNWUtMjENCgloPXt9DQoJZj1UcnVlDQoJDQoJZD1kIG9yIHMNCglwPXAgb3Igbw0KCWc9bWF0aC5jb3MoZCphKQ0KCW09MA0KCXY9MA0KCV89W10NCgkNCgl2PShwKzEpKih1KzEpKjMNCglfPVtOb25lXSp2DQoJDQoJYj1yL2Zsb2F0KHAtMSkNCgl4PWkvZmxvYXQocC0xKQ0KCQ0KCWlmIGY6eT0zDQoJZWxzZTp5PTINCgkJDQoJCQ0KCW09MA0KCXY9bGVuKGlucHV0KS95DQoJd2hpbGUobTx2KToNCgkJQT1tKmMNCgkJUz1tKnkNCgkJQz1pbnB1dFtTXQ0KCQl3PWlucHV0W1MrMV0NCgkJaWYgYz09MDoNCgkJCWlmIGY9PTA6DQoJCQkJaWYgKEMmLTEwMjUpIT00OgkJDQoJCQkJCWVbQSszXT0tMQ0KCQkJCWVsc2U6DQoJCQkJCWVbQSszXT0xDQoJCU09Tm9uZQ0KCQlUPU5vbmUNCgkJRT1Ob25lDQoJCUk9MyooQytwKncpCQkNCgkJTT1fW0ldDQoJCWlmCU09PU5vbmU6CQkJCQ0KCQkJTj1DKmINCgkJCWs9Y29zKE4pDQoJCQlGPXNpbihOKQ0KCQkJTis9eA0KCQkJRD0oZy1rKmNvcyhOKSkvZmxvYXQobWF4KDFlLTUsRipzaW4oTikpKQ0KCQkJaWYgRD4xOkQ9MQ0KCQkJZWxzZToNCgkJCQlpZiBEPC0xOkQ9LTENCgkJCVA9dypuL2Zsb2F0KG1hdGguY2VpbChyL2Zsb2F0KG1heCgxZS01LG1hdGguYWNvcyhEKSkpKSkNCgkJCU09X1tJXT1GKm1hdGguY29zKFApDQoJCQlUPV9bSSsxXT1GKm1hdGguc2luKFApDQoJCQlFPV9bSSsyXT1rDQoJCWVsc2U6IA0KCQkJVD1fW0krMV0NCgkJCUU9X1tJKzJdDQoJCWlmIGY6DQoJCQlSPWlucHV0W1MrMl0qbA0KCQkJTz1tYXRoLnNpbihSKQ0KCQkJZVtBXT1PKk0NCgkJCWVbQSsxXT1PKlQNCgkJCWVbQSsyXT1PKkUNCgkJCWVbQSszXT1tYXRoLmNvcyhSKQ0KCQkJI3dyaXRlKGxvZyxbQSxlW0FdLGVbQSsxXSxlW0ErMl0sZVtBKzNdXSwwKQ0KCQllbHNlOiANCgkJCWVbQV09TQ0KCQkJZVtBKzFdPVQNCgkJCWVbQSsyXT1FDQoJCW0rPTENCgkNCglyZXR1cm4gZQkNCgkNCg0KZGVmIGdldEFuaW1hdGlvbih5cyxBLG4pOg0KCWFjdGlvbj1BY3Rpb24oKQ0KCWFjdGlvbi5CT05FU1BBQ0U9VHJ1ZQ0KCSNhY3Rpb24uQVJNQVRVUkVTUEFDRT1UcnVlDQoJYWN0aW9uLkZSQU1FU09SVD1UcnVlDQoJYWN0aW9uLnNrZWxldG9uPXNrZWxldG9uLm5hbWUNCgluKz00DQoJQ2hhbm5lbHM9eXMuZ2V0KEEsJyJDaGFubmVscyInKQ0KCWJvbmVMaXN0PXt9DQoJaWYgQ2hhbm5lbHM6DQoJCXZhbHVlcz15cy52YWx1ZXMoQ2hhbm5lbHNbMF0uaGVhZGVyLCc6JykNCgkJTmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJOYW1lIicpDQoJCWFjdGlvbi5uYW1lPU5hbWUNCgkJbmV3PU5ldyhOYW1lLnJlcGxhY2UoJyInLCcnKS5yZXBsYWNlKCd8JywnJykrJy5hY3Rpb24nLCd3Yicsc3lzKS5vcGVuKCkNCgkJZm9yIGEgaW4gIENoYW5uZWxzWzBdLmNoaWxkcmVuOg0KCQkJVmVjM0xlcnBDaGFubmVsPXlzLmdldChhLCcib3NnQW5pbWF0aW9uLlZlYzNMZXJwQ2hhbm5lbCInKQ0KCQkJaWYgVmVjM0xlcnBDaGFubmVsOg0KCQkJCUtleUZyYW1lcz15cy5nZXQoYSwnIktleUZyYW1lcyInKQ0KCQkJCWlmIEtleUZyYW1lczoNCgkJCQkJdmFsdWVzPXlzLnZhbHVlcyhLZXlGcmFtZXNbMF0uaGVhZGVyLCc6JykNCgkJCQkJTmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJOYW1lIicpDQoJCQkJCVRhcmdldE5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciVGFyZ2V0TmFtZSInLCciIicpDQoJCQkJCW5hbWU9Z2V0U3BsaXROYW1lKFRhcmdldE5hbWUsJ18nLC0xKQ0KCQkJCQlpZiBOYW1lPT0nInRyYW5zbGF0ZSInOg0KCQkJCQkJYm9uZT1Ob25lDQoJCQkJCQlpZiBUYXJnZXROYW1lIGluIGJvbmVJbmRla3NMaXN0Og0KCQkJCQkJCW5hbWU9Ym9uZUluZGVrc0xpc3RbVGFyZ2V0TmFtZV0NCgkJCQkJCQlpZiBuYW1lIG5vdCBpbiBib25lTGlzdC5rZXlzKCk6DQoJCQkJCQkJCWJvbmU9QWN0aW9uQm9uZSgpDQoJCQkJCQkJCWFjdGlvbi5ib25lTGlzdC5hcHBlbmQoYm9uZSkNCgkJCQkJCQkJYm9uZS5uYW1lPW5hbWUNCgkJCQkJCQkJYm9uZUxpc3RbbmFtZV09Ym9uZQ0KCQkJCQkJCWJvbmU9Ym9uZUxpc3RbbmFtZV0NCgkJCQkJCWVsc2U6DQoJCQkJCQkJcHJpbnQgJ3NraXBlZCB0cmFuc2xhdGUgYm9uZTonLFRhcmdldE5hbWUNCgkJCQkJCQ0KCQkJCQkJDQoJCQkJCQlLZXk9eXMuZ2V0KGEsJyJLZXkiJykNCgkJCQkJCWlmIEtleToNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEtleVswXS5kYXRhLCc6JykNCgkJCQkJCQlJdGVtU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJJdGVtU2l6ZSInLCdpJykJCQkJCQkNCgkJCQkJCQlGbG9hdDMyQXJyYXk9eXMuZ2V0KEtleVswXSwnIkZsb2F0MzJBcnJheSInKQ0KCQkJCQkJCWlmIEZsb2F0MzJBcnJheToNCgkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwnOicpDQoJCQkJCQkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInKQ0KCQkJCQkJCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJykNCgkJCQkJCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInKQ0KCQkJCQkJCQkjd3JpdGUobG9nLFtGaWxlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdJdGVtU2l6ZTonLEl0ZW1TaXplXSxuKzQpDQoJCQkJCQkJCQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXQkJCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWUgYW5kIG9zLnBhdGguZXhpc3RzKHBhdGguc3BsaXQoJy5neicpWzBdKT09RmFsc2U6DQoJCQkJCQkJCQljbWQ9Q21kKCkNCgkJCQkJCQkJCWNtZC5pbnB1dD1wYXRoDQoJCQkJCQkJCQljbWQuWklQPVRydWUNCgkJCQkJCQkJCWNtZC5ydW4oKQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOg0KCQkJCQkJCQkJcGF0aCs9JycNCgkJCQkJCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZToNCgkJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQkJZy5zZWVrKGludChPZmZzZXQpKQkJCQkJCQkJCQ0KCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQluZXcud3JpdGUoYm9uZS5uYW1lKydceDAwJykNCgkJCQkJCQkJCQluZXcud3JpdGUoJ3RyYW5zbGF0ZScrJ1x4MDAnKQ0KCQkJCQkJCQkJCW5ldy5pKFtpbnQoU2l6ZSldKQ0KCQkJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoaW50KFNpemUpKToNCgkJCQkJCQkJCQl2YWx1ZT1nLmYoSXRlbVNpemUpDQoJCQkJCQkJCQkJI3dyaXRlKGxvZyx2YWx1ZSxuKzgpDQoJCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQkJbmV3LmYodmFsdWUpDQoJCQkJCQkJCQkJCWJvbmVNYXRyaXg9c2tlbGV0b24ub2JqZWN0LmdldERhdGEoKS5ib25lc1tib25lLm5hbWVdLm1hdHJpeFsnQVJNQVRVUkVTUEFDRSddDQoJCQkJCQkJCQkJCW1hdHJpeD1WZWN0b3JNYXRyaXgodmFsdWUpIypib25lTWF0cml4DQoJCQkJCQkJCQkJCWJvbmUucG9zS2V5TGlzdC5hcHBlbmQobWF0cml4KQ0KCQkJCQkJCQkJZmlsZS5jbG9zZSgpDQoJCQkJCQkJZWxzZTpwcmludCAndW5rbm93IGFycmF5IHR5cGUnDQoJCQkJCQllbHNlOnByaW50ICdubyBrZXknCQkJCQ0KCQkJCQkJDQoJCQkJCQlUaW1lPXlzLmdldChhLCciVGltZSInKQ0KCQkJCQkJaWYgVGltZToNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKFRpbWVbMF0uZGF0YSwnOicpDQoJCQkJCQkJSXRlbVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJywnaScpCQkJCQkJDQoJCQkJCQkJRmxvYXQzMkFycmF5PXlzLmdldChUaW1lWzBdLCciRmxvYXQzMkFycmF5IicpDQoJCQkJCQkJaWYgRmxvYXQzMkFycmF5Og0KCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCQkJCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicpDQoJCQkJCQkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInKQ0KCQkJCQkJCQlPZmZzZXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicpDQoJCQkJCQkJCSN3cml0ZShsb2csW0ZpbGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0l0ZW1TaXplOicsSXRlbVNpemVdLG4rNCkNCgkJCQkJCQkJDQoJCQkJCQkJCQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXQkJCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWUgYW5kIG9zLnBhdGguZXhpc3RzKHBhdGguc3BsaXQoJy5neicpWzBdKT09RmFsc2U6DQoJCQkJCQkJCQljbWQ9Q21kKCkNCgkJCQkJCQkJCWNtZC5pbnB1dD1wYXRoDQoJCQkJCQkJCQljbWQuWklQPVRydWUNCgkJCQkJCQkJCWNtZC5ydW4oKQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOg0KCQkJCQkJCQkJcGF0aCs9JycNCgkJCQkJCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKToNCgkJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQkJZy5zZWVrKGludChPZmZzZXQpKQkJCQkJCQkNCgkJCQkJCQkJCWlmIGJvbmU6bmV3LmkoW2ludChTaXplKV0pDQoJCQkJCQkJCQlmb3IgbSBpbiByYW5nZShpbnQoU2l6ZSkpOg0KCQkJCQkJCQkJCXZhbHVlPWcuZihJdGVtU2l6ZSkNCgkJCQkJCQkJCQlpZiBJdGVtU2l6ZT09MTp2YWx1ZT12YWx1ZVswXQ0KCQkJCQkJCQkJCSN3cml0ZShsb2csW3ZhbHVlXSxuKzgpDQoJCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQkJbmV3LmYoW3ZhbHVlXSkNCgkJCQkJCQkJCQkJYm9uZS5wb3NGcmFtZUxpc3QuYXBwZW5kKGludCh2YWx1ZSozMykpDQoJCQkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQkJCQllbHNlOnByaW50ICd1bmtub3cgYXJyYXkgdHlwZScNCgkJCQkJCWVsc2U6cHJpbnQgJ25vIHRpbWUnCQkNCgkJCQkJDQoJCQkJCQ0KCQkJCQkNCgkJCQkJDQoJCQkJCWlmIE5hbWU9PScic2NhbGUiJzoNCgkJCQkJCWJvbmU9Tm9uZQ0KCQkJCQkJaWYgVGFyZ2V0TmFtZSBpbiBib25lSW5kZWtzTGlzdDoNCgkJCQkJCQluYW1lPWJvbmVJbmRla3NMaXN0W1RhcmdldE5hbWVdDQoJCQkJCQkJaWYgbmFtZSBub3QgaW4gYm9uZUxpc3Qua2V5cygpOg0KCQkJCQkJCQlib25lPUFjdGlvbkJvbmUoKQ0KCQkJCQkJCQlhY3Rpb24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpDQoJCQkJCQkJCWJvbmUubmFtZT1uYW1lDQoJCQkJCQkJCWJvbmVMaXN0W25hbWVdPWJvbmUNCgkJCQkJCQlib25lPWJvbmVMaXN0W25hbWVdDQoJCQkJCQllbHNlOg0KCQkJCQkJCXByaW50ICdza2lwZWQgc2NhbGUgYm9uZTonLFRhcmdldE5hbWUNCgkJCQkJCQ0KCQkJCQkJDQoJCQkJCQlLZXk9eXMuZ2V0KGEsJyJLZXkiJykNCgkJCQkJCWlmIEtleToNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEtleVswXS5kYXRhLCc6JykNCgkJCQkJCQlJdGVtU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJJdGVtU2l6ZSInLCdpJykJCQkJCQkNCgkJCQkJCQlGbG9hdDMyQXJyYXk9eXMuZ2V0KEtleVswXSwnIkZsb2F0MzJBcnJheSInKQ0KCQkJCQkJCWlmIEZsb2F0MzJBcnJheToNCgkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwnOicpDQoJCQkJCQkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInKQ0KCQkJCQkJCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJykNCgkJCQkJCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInKQ0KCQkJCQkJCQkjd3JpdGUobG9nLFtGaWxlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdJdGVtU2l6ZTonLEl0ZW1TaXplXSxuKzQpDQoJCQkJCQkJCQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXQkJCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWUgYW5kIG9zLnBhdGguZXhpc3RzKHBhdGguc3BsaXQoJy5neicpWzBdKT09RmFsc2U6DQoJCQkJCQkJCQljbWQ9Q21kKCkNCgkJCQkJCQkJCWNtZC5pbnB1dD1wYXRoDQoJCQkJCQkJCQljbWQuWklQPVRydWUNCgkJCQkJCQkJCWNtZC5ydW4oKQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOg0KCQkJCQkJCQkJcGF0aCs9JycNCgkJCQkJCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZToNCgkJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQkJZy5zZWVrKGludChPZmZzZXQpKQkJCQkJCQkJCQ0KCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQluZXcud3JpdGUoYm9uZS5uYW1lKydceDAwJykNCgkJCQkJCQkJCQluZXcud3JpdGUoJ3NpemUnKydceDAwJykNCgkJCQkJCQkJCQluZXcuaShbaW50KFNpemUpXSkNCgkJCQkJCQkJCWZvciBtIGluIHJhbmdlKGludChTaXplKSk6DQoJCQkJCQkJCQkJdmFsdWU9Zy5mKEl0ZW1TaXplKQ0KCQkJCQkJCQkJCSN3cml0ZShsb2csdmFsdWUsbis4KQ0KCQkJCQkJCQkJCWlmIGJvbmU6DQoJCQkJCQkJCQkJCW5ldy5mKHZhbHVlKQ0KCQkJCQkJCQkJCQlib25lTWF0cml4PXNrZWxldG9uLm9iamVjdC5nZXREYXRhKCkuYm9uZXNbYm9uZS5uYW1lXS5tYXRyaXhbJ0FSTUFUVVJFU1BBQ0UnXQ0KCQkJCQkJCQkJCQltYXRyaXg9VmVjdG9yTWF0cml4KHZhbHVlKSMqYm9uZU1hdHJpeA0KCQkJCQkJCQkJCQlib25lLnNpemVLZXlMaXN0LmFwcGVuZChtYXRyaXgpDQoJCQkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQkJCQllbHNlOnByaW50ICd1bmtub3cgYXJyYXkgdHlwZScNCgkJCQkJCWVsc2U6cHJpbnQgJ25vIGtleScJCQkJDQoJCQkJCQkNCgkJCQkJCVRpbWU9eXMuZ2V0KGEsJyJUaW1lIicpDQoJCQkJCQlpZiBUaW1lOg0KCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoVGltZVswXS5kYXRhLCc6JykNCgkJCQkJCQlJdGVtU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJJdGVtU2l6ZSInLCdpJykJCQkJCQkNCgkJCQkJCQlGbG9hdDMyQXJyYXk9eXMuZ2V0KFRpbWVbMF0sJyJGbG9hdDMyQXJyYXkiJykNCgkJCQkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQkJCQkJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJykNCgkJCQkJCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicpDQoJCQkJCQkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJykNCgkJCQkJCQkJI3dyaXRlKGxvZyxbRmlsZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnSXRlbVNpemU6JyxJdGVtU2l6ZV0sbis0KQ0KCQkJCQkJCQkNCgkJCQkJCQkJDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZSBhbmQgb3MucGF0aC5leGlzdHMocGF0aC5zcGxpdCgnLmd6JylbMF0pPT1GYWxzZToNCgkJCQkJCQkJCWNtZD1DbWQoKQ0KCQkJCQkJCQkJY21kLmlucHV0PXBhdGgNCgkJCQkJCQkJCWNtZC5aSVA9VHJ1ZQ0KCQkJCQkJCQkJY21kLnJ1bigpDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdLnNwbGl0KCcuZ3onKVswXQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6DQoJCQkJCQkJCQlwYXRoKz0nJw0KCQkJCQkJCQkJDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KCQkJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCQlnLnNlZWsoaW50KE9mZnNldCkpCQkJCQkJCQ0KCQkJCQkJCQkJaWYgYm9uZTpuZXcuaShbaW50KFNpemUpXSkNCgkJCQkJCQkJCWZvciBtIGluIHJhbmdlKGludChTaXplKSk6DQoJCQkJCQkJCQkJdmFsdWU9Zy5mKEl0ZW1TaXplKQ0KCQkJCQkJCQkJCWlmIEl0ZW1TaXplPT0xOnZhbHVlPXZhbHVlWzBdDQoJCQkJCQkJCQkJI3dyaXRlKGxvZyxbdmFsdWVdLG4rOCkNCgkJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCQluZXcuZihbdmFsdWVdKQ0KCQkJCQkJCQkJCQlib25lLnNpemVGcmFtZUxpc3QuYXBwZW5kKGludCh2YWx1ZSozMykpDQoJCQkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQkJCQllbHNlOnByaW50ICd1bmtub3cgYXJyYXkgdHlwZScNCgkJCQkJCWVsc2U6cHJpbnQgJ25vIHRpbWUnCQkNCgkJCQkJCQkJCQ0KCQkJVmVjM0xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZD15cy5nZXQoYSwnIm9zZ0FuaW1hdGlvbi5WZWMzTGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkIicpDQoJCQlpZiBWZWMzTGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkOg0KCQkJDQoJCQkJYXRyaWJ1dGVzPXt9DQoJCQkJVXNlckRhdGFDb250YWluZXI9eXMuZ2V0KFZlYzNMZXJwQ2hhbm5lbENvbXByZXNzZWRQYWNrZWRbMF0sJyJVc2VyRGF0YUNvbnRhaW5lciInKQ0KCQkJCWlmIFVzZXJEYXRhQ29udGFpbmVyOg0KCQkJCQlWYWx1ZXM9eXMuZ2V0KFVzZXJEYXRhQ29udGFpbmVyWzBdLCciVmFsdWVzIicpDQoJCQkJCWlmIFZhbHVlczoNCgkJCQkJCWZvciBjaGlsZCBpbiBWYWx1ZXNbMF0uY2hpbGRyZW46DQoJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5kYXRhLCc6JykNCgkJCQkJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJykNCgkJCQkJCQlWYWx1ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJWYWx1ZSInLCciZiInKQ0KCQkJCQkJCSN3cml0ZShsb2csW05hbWUsVmFsdWVdLG4rNCkNCgkJCQkJCQlhdHJpYnV0ZXNbTmFtZV09VmFsdWUNCgkJCQkNCgkJCQlLZXlGcmFtZXM9eXMuZ2V0KGEsJyJLZXlGcmFtZXMiJykNCgkJCQlpZiBLZXlGcmFtZXM6DQoJCQkJCXZhbHVlcz15cy52YWx1ZXMoS2V5RnJhbWVzWzBdLmhlYWRlciwnOicpDQoJCQkJCU5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciTmFtZSInKQ0KCQkJCQlUYXJnZXROYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIlRhcmdldE5hbWUiJywnIiInKQ0KCQkJCQkjd3JpdGUobG9nLFsnVmVjM0xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZDonLE5hbWUsJ1RhcmdldE5hbWU6JyxUYXJnZXROYW1lXSxuKzQpDQoJCQkJCW5hbWU9Z2V0U3BsaXROYW1lKFRhcmdldE5hbWUsJ18nLC0xKQ0KCQkJCQlpZiBOYW1lPT0nInRyYW5zbGF0ZSInOg0KCQkJCQkJYm9uZT1Ob25lDQoJCQkJCQlpZiBUYXJnZXROYW1lIGluIGJvbmVJbmRla3NMaXN0Og0KCQkJCQkJCSNuZXcud3JpdGUoVGFyZ2V0TmFtZSsnXHgwMCcpDQoJCQkJCQkJI25ldy53cml0ZSgndHJhbnNsYXRlJysnXHgwMCcpDQoJCQkJCQkJbmFtZT1ib25lSW5kZWtzTGlzdFtUYXJnZXROYW1lXQ0KCQkJCQkJCWlmIG5hbWUgbm90IGluIGJvbmVMaXN0LmtleXMoKToNCgkJCQkJCQkJYm9uZT1BY3Rpb25Cb25lKCkNCgkJCQkJCQkJYWN0aW9uLmJvbmVMaXN0LmFwcGVuZChib25lKQ0KCQkJCQkJCQlib25lLm5hbWU9bmFtZQ0KCQkJCQkJCQlib25lTGlzdFtuYW1lXT1ib25lDQoJCQkJCQkJYm9uZT1ib25lTGlzdFtuYW1lXQ0KCQkJCQkJZWxzZToNCgkJCQkJCQlwcmludCAnc2tpcGVkIHRyYW5zbGF0ZSBib25lOicsVGFyZ2V0TmFtZQ0KCQkJCQkJDQoJCQkJCQlLZXk9eXMuZ2V0KGEsJyJLZXkiJykNCgkJCQkJCWlmIEtleToNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEtleVswXS5kYXRhLCc6JykNCgkJCQkJCQlJdGVtU2l6ZT1pbnQoeXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJykpCQkJCQkJDQoJCQkJCQkJVWludDE2QXJyYXk9eXMuZ2V0KEtleVswXSwnIlVpbnQxNkFycmF5IicpDQoJCQkJCQkJdHlwZT0iVWludDE2QXJyYXkiDQoJCQkJCQkJaWYgVWludDE2QXJyYXk6DQoJCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoVWludDE2QXJyYXlbMF0uZGF0YSwnOicpDQoJCQkJCQkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInKQ0KCQkJCQkJCQlTaXplPWludCh5cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicpKQ0KCQkJCQkJCQlPZmZzZXQ9aW50KHlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInKSkNCgkJCQkJCQkJRW5jb2Rpbmc9eXMuZ2V0VmFsdWUodmFsdWVzLCciRW5jb2RpbmciJykNCgkJCQkJCQkJI3dyaXRlKGxvZyxbRmlsZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZywnSXRlbVNpemU6JyxJdGVtU2l6ZV0sbis0KQ0KCQkJCQkJCQkNCgkJCQkJCQkJDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdCQkJDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1UcnVlIGFuZCBvcy5wYXRoLmV4aXN0cyhwYXRoLnNwbGl0KCcuZ3onKVswXSk9PUZhbHNlOg0KCQkJCQkJCQkJY21kPUNtZCgpDQoJCQkJCQkJCQljbWQuaW5wdXQ9cGF0aA0KCQkJCQkJCQkJY21kLlpJUD1UcnVlDQoJCQkJCQkJCQljbWQucnVuKCkNCgkJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCciJylbMV0uc3BsaXQoJy5neicpWzBdDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1GYWxzZToNCgkJCQkJCQkJCXBhdGgrPScnDQoJCQkJCQkJCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk6DQoJCQkJCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJCQ0KCQkJCQkJCQkJbGlzdD1kZWNvZGVWYXJpbnQoZyxPZmZzZXQsU2l6ZSpJdGVtU2l6ZSx0eXBlKQ0KCQkJCQkJCQkJbGlzdDE9ZXRhcDEobGlzdCxJdGVtU2l6ZSkNCgkJCQkJCQkJCW91dD1ldGFwMihsaXN0MSxJdGVtU2l6ZSxhdHJpYnV0ZXMpDQoJCQkJCQkJCQlsaXN0Mj1bYXRyaWJ1dGVzWycib3giJ10sYXRyaWJ1dGVzWycib3kiJ10sYXRyaWJ1dGVzWycib3oiJ11dDQoJCQkJCQkJCQlsaXN0Mi5leHRlbmQob3V0KQ0KCQkJCQkJCQkJbGlzdDM9ZXRhcDMobGlzdDIsSXRlbVNpemUpCQkJCQkJCQ0KCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQluZXcud3JpdGUoYm9uZS5uYW1lKydceDAwJykNCgkJCQkJCQkJCQluZXcud3JpdGUoJ3RyYW5zbGF0ZScrJ1x4MDAnKQ0KCQkJCQkJCQkJCW5ldy5pKFtTaXplXSkNCgkJCQkJCQkJCWZvciBtIGluIHJhbmdlKFNpemUpOg0KCQkJCQkJCQkJCXZhbHVlPWxpc3QzW20qMzptKjMrM10NCgkJCQkJCQkJCQkjd3JpdGUobG9nLHZhbHVlLG4rOCkNCgkJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCQluZXcuZih2YWx1ZSkNCgkJCQkJCQkJCQkJaWYgYm9uZS5uYW1lIGluIHNrZWxldG9uLm9iamVjdC5nZXREYXRhKCkuYm9uZXMua2V5cygpOg0KCQkJCQkJCQkJCQkJYm9uZU1hdHJpeD1za2VsZXRvbi5vYmplY3QuZ2V0RGF0YSgpLmJvbmVzW2JvbmUubmFtZV0ubWF0cml4WydBUk1BVFVSRVNQQUNFJ10NCgkJCQkJCQkJCQkJCSNib25lTWF0cml4Kj1WZWN0b3JNYXRyaXgodmFsdWUpDQoJCQkJCQkJCQkJCQltYXRyaXg9VmVjdG9yTWF0cml4KHZhbHVlKSMqYm9uZU1hdHJpeA0KCQkJCQkJCQkJCQkJYm9uZS5wb3NLZXlMaXN0LmFwcGVuZChtYXRyaXgpDQoJCQkJCQkJCQkJCQkNCgkJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCQkJCWVsc2U6cHJpbnQgJ3Vua25vdyBhcnJheSB0eXBlJw0KCQkJCQkJZWxzZTpwcmludCAnbm8ga2V5JwkNCgkJCQkJCQ0KCQkJCQkJVGltZT15cy5nZXQoYSwnIlRpbWUiJykNCgkJCQkJCWlmIFRpbWU6DQoJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhUaW1lWzBdLmRhdGEsJzonKQ0KCQkJCQkJCUl0ZW1TaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIkl0ZW1TaXplIicsJ2knKQkJCQkJCQ0KCQkJCQkJCUZsb2F0MzJBcnJheT15cy5nZXQoVGltZVswXSwnIkZsb2F0MzJBcnJheSInKQ0KCQkJCQkJCWlmIEZsb2F0MzJBcnJheToNCgkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwnOicpDQoJCQkJCQkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInKQ0KCQkJCQkJCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJywnaScpDQoJCQkJCQkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQkJCQkJCSN3cml0ZShsb2csW0ZpbGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0l0ZW1TaXplOicsSXRlbVNpemVdLG4rNCkNCgkJCQkJCQkJDQoJCQkJCQkJCQ0KCQkJCQkJCQkNCgkJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCciJylbMV0JCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWUgYW5kIG9zLnBhdGguZXhpc3RzKHBhdGguc3BsaXQoJy5neicpWzBdKT09RmFsc2U6DQoJCQkJCQkJCQljbWQ9Q21kKCkNCgkJCQkJCQkJCWNtZC5pbnB1dD1wYXRoDQoJCQkJCQkJCQljbWQuWklQPVRydWUNCgkJCQkJCQkJCWNtZC5ydW4oKQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOg0KCQkJCQkJCQkJcGF0aCs9JycNCgkJCQkJCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKToNCgkJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQkJZy5zZWVrKGludChPZmZzZXQpKQ0KCQkJCQkJCQkJbGlzdD1nLmYoU2l6ZSpJdGVtU2l6ZSkNCgkJCQkJCQkJCWxpc3QxPWV0YXAxKGxpc3QsSXRlbVNpemUpDQoJCQkJCQkJCQkjb3V0PWV0YXAyKGxpc3QxLEl0ZW1TaXplLGF0cmlidXRlcykNCgkJCQkJCQkJCWxpc3QyPVthdHJpYnV0ZXNbJyJvdCInXV0NCgkJCQkJCQkJCWxpc3QyLmV4dGVuZChsaXN0MSkNCgkJCQkJCQkJCWxpc3QzPWV0YXAzKGxpc3QyLEl0ZW1TaXplKQ0KCQkJCQkJCQkJI3dyaXRlKGxvZyxsaXN0MywwKQkJCQkJCQkNCgkJCQkJCQkJCWlmIGJvbmU6bmV3LmkoW1NpemVdKQ0KCQkJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQoJCQkJCQkJCQkJdmFsdWU9bGlzdDNbbV0NCgkJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCQluZXcuZihbdmFsdWVdKQ0KCQkJCQkJCQkJCQlib25lLnBvc0ZyYW1lTGlzdC5hcHBlbmQoaW50KHZhbHVlKjMzKSkNCgkJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCQkJCWVsc2U6cHJpbnQgJ3Vua25vdyBhcnJheSB0eXBlJwkNCgkJCQkJCWVsc2U6cHJpbnQgJ25vIHRpbWUnCQ0KCQkJCQkNCgkJCQkJDQoJCQkJCQ0KCQkJUXVhdFNsZXJwQ2hhbm5lbD15cy5nZXQoYSwnIm9zZ0FuaW1hdGlvbi5RdWF0U2xlcnBDaGFubmVsIicpDQoJCQlpZiBRdWF0U2xlcnBDaGFubmVsOg0KCQkJCUtleUZyYW1lcz15cy5nZXQoYSwnIktleUZyYW1lcyInKQ0KCQkJCWlmIEtleUZyYW1lczoNCgkJCQkJdmFsdWVzPXlzLnZhbHVlcyhLZXlGcmFtZXNbMF0uaGVhZGVyLCc6JykNCgkJCQkJTmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJOYW1lIicpDQoJCQkJCVRhcmdldE5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciVGFyZ2V0TmFtZSInLCciIicpDQoJCQkJCSN3cml0ZShsb2csWydRdWF0U2xlcnBDaGFubmVsOicsTmFtZSwnVGFyZ2V0TmFtZTonLFRhcmdldE5hbWVdLG4rNCkNCgkJCQkJbmFtZT1nZXRTcGxpdE5hbWUoVGFyZ2V0TmFtZSwnXycsLTEpDQoJCQkJCWJvbmU9Tm9uZQ0KCQkJCQlpZiBUYXJnZXROYW1lIGluIGJvbmVJbmRla3NMaXN0Og0KCQkJCQkJbmFtZT1ib25lSW5kZWtzTGlzdFtUYXJnZXROYW1lXQ0KCQkJCQkJaWYgbmFtZSBub3QgaW4gYm9uZUxpc3Qua2V5cygpOg0KCQkJCQkJCWJvbmU9QWN0aW9uQm9uZSgpDQoJCQkJCQkJYWN0aW9uLmJvbmVMaXN0LmFwcGVuZChib25lKQ0KCQkJCQkJCWJvbmUubmFtZT1uYW1lDQoJCQkJCQkJYm9uZUxpc3RbbmFtZV09Ym9uZQ0KCQkJCQkJYm9uZT1ib25lTGlzdFtuYW1lXQ0KCQkJCQllbHNlOg0KCQkJCQkJcHJpbnQgJ3NraXBlZCBxdWF0ZXJuaW9uIGJvbmU6JyxUYXJnZXROYW1lDQoJCQkJCQ0KCQkJCQkNCgkJCQkJDQoJCQkJCUtleT15cy5nZXQoYSwnIktleSInKQ0KCQkJCQlpZiBLZXk6DQoJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEtleVswXS5kYXRhLCc6JykNCgkJCQkJCUl0ZW1TaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIkl0ZW1TaXplIicpCQkJCQkJDQoJCQkJCQlGbG9hdDMyQXJyYXk9eXMuZ2V0KEtleVswXSwnIkZsb2F0MzJBcnJheSInKQ0KCQkJCQkJaWYgRmxvYXQzMkFycmF5Og0KCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQkJCQkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInKQ0KCQkJCQkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInKQ0KCQkJCQkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJykNCgkJCQkJCQkjd3JpdGUobG9nLFtGaWxlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdJdGVtU2l6ZTonLEl0ZW1TaXplXSxuKzQpDQoJCQkJCQkJDQoJCQkJCQkJCQ0KCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdCQkJDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWUgYW5kIG9zLnBhdGguZXhpc3RzKHBhdGguc3BsaXQoJy5neicpWzBdKT09RmFsc2U6DQoJCQkJCQkJCWNtZD1DbWQoKQ0KCQkJCQkJCQljbWQuaW5wdXQ9cGF0aA0KCQkJCQkJCQljbWQuWklQPVRydWUNCgkJCQkJCQkJY21kLnJ1bigpDQoJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCciJylbMV0uc3BsaXQoJy5neicpWzBdDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOg0KCQkJCQkJCQlwYXRoKz0nJw0KCQkJCQkJCQkNCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKToNCgkJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJZy5zZWVrKGludChPZmZzZXQpKQkJCQkJCQkNCgkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCW5ldy53cml0ZShib25lLm5hbWUrJ1x4MDAnKQ0KCQkJCQkJCQkJbmV3LndyaXRlKCdxdWF0ZXJuaW9uJysnXHgwMCcpDQoJCQkJCQkJCQluZXcuaShbaW50KFNpemUpXSkNCgkJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoaW50KFNpemUpKToNCgkJCQkJCQkJCXZhbHVlPWcuZig0KQ0KCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQluZXcuZih2YWx1ZSkNCgkJCQkJCQkJCXZhbHVlPVF1YXRlcm5pb24odmFsdWUpDQoJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCSNuZXcuZih2YWx1ZSkNCgkJCQkJCQkJCQlib25lTWF0cml4PXNrZWxldG9uLm9iamVjdC5nZXREYXRhKCkuYm9uZXNbYm9uZS5uYW1lXS5tYXRyaXhbJ0FSTUFUVVJFU1BBQ0UnXQ0KCQkJCQkJCQkJCSNib25lLnJvdEtleUxpc3QuYXBwZW5kKGJvbmVNYXRyaXgqUXVhdE1hdHJpeCh2YWx1ZSkucmVzaXplNHg0KCkpDQoJCQkJCQkJCQkJbWF0cml4PVF1YXRNYXRyaXgodmFsdWUpLnJlc2l6ZTR4NCgpIypib25lTWF0cml4DQoJCQkJCQkJCQkJYm9uZS5yb3RLZXlMaXN0LmFwcGVuZChtYXRyaXgpDQoJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCQkNCgkJCQkJVGltZT15cy5nZXQoYSwnIlRpbWUiJykNCgkJCQkJaWYgVGltZToNCgkJCQkJCXZhbHVlcz15cy52YWx1ZXMoVGltZVswXS5kYXRhLCc6JykNCgkJCQkJCUl0ZW1TaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIkl0ZW1TaXplIicsJ2knKQkJCQkJCQ0KCQkJCQkJRmxvYXQzMkFycmF5PXlzLmdldChUaW1lWzBdLCciRmxvYXQzMkFycmF5IicpDQoJCQkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwnOicpDQoJCQkJCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicpDQoJCQkJCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicpDQoJCQkJCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInKQ0KCQkJCQkJCSN3cml0ZShsb2csW0ZpbGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0l0ZW1TaXplOicsSXRlbVNpemVdLG4rNCkNCgkJCQkJCQkNCgkJCQkJCQkJDQoJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCciJylbMV0JCQkNCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZSBhbmQgb3MucGF0aC5leGlzdHMocGF0aC5zcGxpdCgnLmd6JylbMF0pPT1GYWxzZToNCgkJCQkJCQkJY21kPUNtZCgpDQoJCQkJCQkJCWNtZC5pbnB1dD1wYXRoDQoJCQkJCQkJCWNtZC5aSVA9VHJ1ZQ0KCQkJCQkJCQljbWQucnVuKCkNCgkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6DQoJCQkJCQkJCXBhdGgrPScnDQoJCQkJCQkJCQ0KCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KCQkJCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQlnLnNlZWsoaW50KE9mZnNldCkpCQkJCQkJCQ0KCQkJCQkJCQlpZiBib25lOm5ldy5pKFtpbnQoU2l6ZSldKQ0KCQkJCQkJCQlmb3IgbSBpbiByYW5nZShpbnQoU2l6ZSkpOg0KCQkJCQkJCQkJdmFsdWU9Zy5mKEl0ZW1TaXplKQ0KCQkJCQkJCQkJaWYgSXRlbVNpemU9PTE6dmFsdWU9dmFsdWVbMF0NCgkJCQkJCQkJCWlmIGJvbmU6DQoJCQkJCQkJCQkJbmV3LmYoW3ZhbHVlXSkNCgkJCQkJCQkJCQlib25lLnJvdEZyYW1lTGlzdC5hcHBlbmQoaW50KHZhbHVlKjMzKSkNCgkJCQkJCQkJZmlsZS5jbG9zZSgpDQoJCQkJCQ0KCQkJCQkJCQkJDQoJCQlRdWF0U2xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZD15cy5nZXQoYSwnIm9zZ0FuaW1hdGlvbi5RdWF0U2xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZCInKQ0KCQkJaWYgUXVhdFNsZXJwQ2hhbm5lbENvbXByZXNzZWRQYWNrZWQ6DQoJCQkJVGFyZ2V0TmFtZT1Ob25lDQoJCQkJdHJ5Og0KCQkJDQoJCQkJCWF0cmlidXRlcz17fQ0KCQkJCQlVc2VyRGF0YUNvbnRhaW5lcj15cy5nZXQoUXVhdFNsZXJwQ2hhbm5lbENvbXByZXNzZWRQYWNrZWRbMF0sJyJVc2VyRGF0YUNvbnRhaW5lciInKQ0KCQkJCQlpZiBVc2VyRGF0YUNvbnRhaW5lcjoNCgkJCQkJCVZhbHVlcz15cy5nZXQoVXNlckRhdGFDb250YWluZXJbMF0sJyJWYWx1ZXMiJykNCgkJCQkJCWlmIFZhbHVlczoNCgkJCQkJCQlmb3IgY2hpbGQgaW4gVmFsdWVzWzBdLmNoaWxkcmVuOg0KCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGNoaWxkLmRhdGEsJzonKQ0KCQkJCQkJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJykNCgkJCQkJCQkJVmFsdWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciVmFsdWUiJywnImYiJykNCgkJCQkJCQkJI3dyaXRlKGxvZyxbTmFtZSxWYWx1ZV0sbis0KQ0KCQkJCQkJCQlhdHJpYnV0ZXNbTmFtZV09VmFsdWUNCgkJCQkNCgkJCQkJS2V5RnJhbWVzPXlzLmdldChhLCciS2V5RnJhbWVzIicpDQoJCQkJCWlmIEtleUZyYW1lczoJCQkJDQoJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEtleUZyYW1lc1swXS5oZWFkZXIsJzonKQ0KCQkJCQkJTmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJOYW1lIicpDQoJCQkJCQlUYXJnZXROYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIlRhcmdldE5hbWUiJywnIiInKQ0KCQkJCQkJI3dyaXRlKGxvZyxbJ1F1YXRTbGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkOicsTmFtZSwnVGFyZ2V0TmFtZTonLFRhcmdldE5hbWVdLG4rNCkNCgkJCQkJCW5hbWU9Z2V0U3BsaXROYW1lKFRhcmdldE5hbWUsJ18nLC0xKQ0KCQkJCQkJI3ByaW50IFRhcmdldE5hbWUNCgkJCQkJCWJvbmU9Tm9uZQ0KCQkJCQkJI3ByaW50IFRhcmdldE5hbWUNCgkJCQkJCSNwcmludCBhdHJpYnV0ZXMNCgkJCQkJCWlmIFRhcmdldE5hbWUgaW4gYm9uZUluZGVrc0xpc3Q6DQoJCQkJCQkJbmFtZT1ib25lSW5kZWtzTGlzdFtUYXJnZXROYW1lXQ0KCQkJCQkJCWlmIG5hbWUgbm90IGluIGJvbmVMaXN0LmtleXMoKToNCgkJCQkJCQkJYm9uZT1BY3Rpb25Cb25lKCkNCgkJCQkJCQkJYWN0aW9uLmJvbmVMaXN0LmFwcGVuZChib25lKQ0KCQkJCQkJCQlib25lLm5hbWU9bmFtZQ0KCQkJCQkJCQlib25lTGlzdFtuYW1lXT1ib25lDQoJCQkJCQkJYm9uZT1ib25lTGlzdFtuYW1lXQ0KCQkJCQkJZWxzZToNCgkJCQkJCQlwcmludCAnc2tpcGVkIHF1YXRlcm5pb24gYm9uZTonLFRhcmdldE5hbWUNCgkJCQkJCQkNCgkJCQkJCUtleT15cy5nZXQoYSwnIktleSInKQ0KCQkJCQkJaWYgS2V5Og0KCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoS2V5WzBdLmRhdGEsJzonKQ0KCQkJCQkJCUl0ZW1TaXplPWludCh5cy5nZXRWYWx1ZSh2YWx1ZXMsJyJJdGVtU2l6ZSInKSkJCQkJCQkNCgkJCQkJCQlVaW50MTZBcnJheT15cy5nZXQoS2V5WzBdLCciVWludDE2QXJyYXkiJykNCgkJCQkJCQl0eXBlPSJVaW50MTZBcnJheSINCgkJCQkJCQlpZiBVaW50MTZBcnJheToNCgkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhVaW50MTZBcnJheVswXS5kYXRhLCc6JykNCgkJCQkJCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicpDQoJCQkJCQkJCVNpemU9aW50KHlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJykpDQoJCQkJCQkJCU9mZnNldD1pbnQoeXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicpKQ0KCQkJCQkJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInKQ0KCQkJCQkJCQkjd3JpdGUobG9nLFtGaWxlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nLCdJdGVtU2l6ZTonLEl0ZW1TaXplXSxuKzQpDQoJCQkJCQkJCQ0KCQkJCQkJCQkJDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdCQkJDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1UcnVlIGFuZCBvcy5wYXRoLmV4aXN0cyhwYXRoLnNwbGl0KCcuZ3onKVswXSk9PUZhbHNlOg0KCQkJCQkJCQkJY21kPUNtZCgpDQoJCQkJCQkJCQljbWQuaW5wdXQ9cGF0aA0KCQkJCQkJCQkJY21kLlpJUD1UcnVlDQoJCQkJCQkJCQljbWQucnVuKCkNCgkJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCciJylbMV0uc3BsaXQoJy5neicpWzBdDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1GYWxzZToNCgkJCQkJCQkJCXBhdGgrPScnDQoJCQkJCQkJCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk6DQoJCQkJCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJCQ0KCQkJCQkJCQkJbGlzdD1kZWNvZGVWYXJpbnQoZyxPZmZzZXQsU2l6ZSpJdGVtU2l6ZSx0eXBlKQ0KCQkJCQkJCQkJI3dyaXRlKGxvZyxsaXN0LDApDQoJCQkJCQkJCQlsaXN0MT1ldGFwMShsaXN0LEl0ZW1TaXplKQ0KCQkJCQkJCQkJI3dyaXRlKGxvZyxsaXN0MSwwKQ0KCQkJCQkJCQkJaWYgJyJveCInIGluIGF0cmlidXRlczoNCgkJCQkJCQkJCQlsaXN0Mj1pbnQzZmxvYXQ0KGxpc3QxLGF0cmlidXRlcyxJdGVtU2l6ZSkJCQkJCQkJCQ0KCQkJCQkJCQkJCSN3cml0ZShsb2csbGlzdDIsMCkNCgkJCQkJCQkJCQlsaXN0Mz1bYXRyaWJ1dGVzWycib3giJ10sYXRyaWJ1dGVzWycib3kiJ10sYXRyaWJ1dGVzWycib3oiJ10sYXRyaWJ1dGVzWycib3ciJ11dDQoJCQkJCQkJCQkJbGlzdDMuZXh0ZW5kKGxpc3QyKQ0KCQkJCQkJCQkJCWxpc3Q0PWV0YXA0KGxpc3QzKQ0KCQkJCQkJCQkJCSN3cml0ZShsb2csbGlzdDQsMCkNCgkJCQkJCQkJCQkJCQkJCQkJDQoJCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQkJbmV3LndyaXRlKGJvbmUubmFtZSsnXHgwMCcpDQoJCQkJCQkJCQkJCW5ldy53cml0ZSgncXVhdGVybmlvbicrJ1x4MDAnKQ0KCQkJCQkJCQkJCQluZXcuaShbU2l6ZV0pDQoJCQkJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQoJCQkJCQkJCQkJCXZhbHVlPWxpc3Q0W20qNDptKjQrNF0NCgkJCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQkJCW5ldy5mKHZhbHVlKQkJCQkJCQkJCQ0KCQkJCQkJCQkJCQl2YWx1ZT1RdWF0ZXJuaW9uKHZhbHVlKQ0KCQkJCQkJCQkJCQkjd3JpdGUobG9nLHZhbHVlLG4rOCkNCgkJCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQkJCSNuZXcuZih2YWx1ZSkNCgkJCQkJCQkJCQkJCWJvbmVNYXRyaXg9c2tlbGV0b24ub2JqZWN0LmdldERhdGEoKS5ib25lc1tib25lLm5hbWVdLm1hdHJpeFsnQVJNQVRVUkVTUEFDRSddDQoJCQkJCQkJCQkJCQkjI2JvbmUucm90S2V5TGlzdC5hcHBlbmQoKGJvbmVNYXRyaXgucm90YXRpb25QYXJ0KCkqUXVhdE1hdHJpeCh2YWx1ZSkpLnJlc2l6ZTR4NCgpKQ0KCQkJCQkJCQkJCQkJbWF0cml4PVF1YXRNYXRyaXgodmFsdWUpLnJlc2l6ZTR4NCgpIypib25lTWF0cml4DQoJCQkJCQkJCQkJCQlib25lLnJvdEtleUxpc3QuYXBwZW5kKG1hdHJpeCkNCgkJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCQkJDQoJCQkJCQlUaW1lPXlzLmdldChhLCciVGltZSInKQ0KCQkJCQkJaWYgVGltZToNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKFRpbWVbMF0uZGF0YSwnOicpDQoJCQkJCQkJSXRlbVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJywnaScpCQkJCQkJDQoJCQkJCQkJRmxvYXQzMkFycmF5PXlzLmdldChUaW1lWzBdLCciRmxvYXQzMkFycmF5IicpDQoJCQkJCQkJaWYgRmxvYXQzMkFycmF5Og0KCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCQkJCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicpDQoJCQkJCQkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCQkJCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInLCdpJykNCgkJCQkJCQkJI3dyaXRlKGxvZyxbRmlsZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnSXRlbVNpemU6JyxJdGVtU2l6ZV0sbis0KQ0KCQkJCQkJCQkNCgkJCQkJCQkJCQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXQkJCQkJCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWUgYW5kIG9zLnBhdGguZXhpc3RzKHBhdGguc3BsaXQoJy5neicpWzBdKT09RmFsc2U6DQoJCQkJCQkJCQljbWQ9Q21kKCkNCgkJCQkJCQkJCWNtZC5pbnB1dD1wYXRoDQoJCQkJCQkJCQljbWQuWklQPVRydWUNCgkJCQkJCQkJCWNtZC5ydW4oKQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOg0KCQkJCQkJCQkJcGF0aCs9JycNCgkJCQkJCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKToNCgkJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQkJZy5zZWVrKGludChPZmZzZXQpKQ0KCQkJCQkJCQkJbGlzdD1nLmYoU2l6ZSpJdGVtU2l6ZSkNCgkJCQkJCQkJCWxpc3QxPWV0YXAxKGxpc3QsSXRlbVNpemUpDQoJCQkJCQkJCQkjb3V0PWV0YXAyKGxpc3QxLEl0ZW1TaXplLGF0cmlidXRlcykNCgkJCQkJCQkJCWlmICcib3QiJyBpbiBhdHJpYnV0ZXM6DQoJCQkJCQkJCQkJbGlzdDI9W2F0cmlidXRlc1snIm90IiddXQ0KCQkJCQkJCQkJCWxpc3QyLmV4dGVuZChsaXN0MSkNCgkJCQkJCQkJCQlsaXN0Mz1ldGFwMyhsaXN0MixJdGVtU2l6ZSkNCgkJCQkJCQkJCQkjd3JpdGUobG9nLGxpc3QzLDApCQkNCgkJCQkJCQkJCQlpZiBib25lOm5ldy5pKFtTaXplXSkNCgkJCQkJCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCQkJCQkJdmFsdWU9bGlzdDJbbV0NCgkJCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQkJCW5ldy5mKFt2YWx1ZV0pDQoJCQkJCQkJCQkJCQlib25lLnJvdEZyYW1lTGlzdC5hcHBlbmQoaW50KHZhbHVlKjMzKSkNCgkJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCWV4Y2VwdDoNCgkJCQkJcHJpbnQgJ25pZXBvd29kemVuaWU6UXVhdFNsZXJwQ2hhbm5lbENvbXByZXNzZWRQYWNrZWQ6JyxUYXJnZXROYW1lDQoJCQkJCQ0KCQkJI2lmIGJvbmU6CQ0KCQkJIwlwcmludCBuYW1lLGJvbmUubmFtZQ0KCQluZXcuY2xvc2UoKQkJDQoJI2FjdGlvbi5kcmF3KCkNCgkjYWN0aW9uLnNldENvbnRleHQoKQkNCgkJDQoNCmRlZiBkZWNvZGVWYXJpbnQoZyxvZmZzZXQsc2l6ZSx0eXBlKToNCglnLnNlZWsob2Zmc2V0KQ0KCW49WzBdKnNpemUNCglhPTANCglzPTAJDQoJd2hpbGUoYSE9c2l6ZSk6DQoJCXNoaWZ0ID0gMA0KCQlyZXN1bHQgPSAwDQoJCXdoaWxlIFRydWU6DQoJCQlieXRlID0gZy5CKDEpWzBdDQoJCQlyZXN1bHQgfD0gKGJ5dGUgJiAxMjcpIDw8IHNoaWZ0DQoJCQlzaGlmdCArPSA3DQoJCQlpZiBub3QgKGJ5dGUgJiAweDgwKTpicmVhawkJCQ0KCQluW2FdPXJlc3VsdAkJDQoJCWErPTENCglpZiB0eXBlWzBdIT0nVSc6DQoJCWw9MA0KCQl3aGlsZShsPHNpemUpOg0KCQkJaD1uW2xdDQoJCQluW2xdPWg+PjFeLSgxJmgpDQoJCQlsKz0xDQoJcmV0dXJuIG4NCgkJDQoJDQoJCQ0KZGVmIGRlY29kZURlbHRhKHQsZSk6DQoJaT1lfDANCgluPWxlbih0KQ0KCWlmIGk+PWxlbih0KTpyPU5vbmUNCgllbHNlOnI9dFtpXQ0KCWE9aSsxDQoJd2hpbGUoYTxuKToNCgkJcz10W2FdDQoJCXI9dFthXT1yKyhzPj4xXi0oMSZzKSkNCgkJYSs9MQ0KCXJldHVybiB0CQ0KDQoNCmRlZiBkZWNvZGVJbXBsaWNpdChpbnB1dCxuKToNCglJTVBMSUNJVF9IRUFERVJfTEVOR1RIPTMNCglJTVBMSUNJVF9IRUFERVJfTUFTS19MRU5HVEg9MQ0KCUlNUExJQ0lUX0hFQURFUl9QUklNSVRJVkVfTEVOR1RIPTANCglJTVBMSUNJVF9IRUFERVJfRVhQRUNURURfSU5ERVg9Mg0KCWhpZ2hXYXRlcm1hcms9Mg0KCQ0KCXQ9aW5wdXQNCgllPVswXSp0W0lNUExJQ0lUX0hFQURFUl9QUklNSVRJVkVfTEVOR1RIXQ0KCWE9dFtJTVBMSUNJVF9IRUFERVJfRVhQRUNURURfSU5ERVhdDQoJcz10W0lNUExJQ0lUX0hFQURFUl9NQVNLX0xFTkdUSF0NCglvPXRbSU1QTElDSVRfSEVBREVSX0xFTkdUSDpzK0lNUExJQ0lUX0hFQURFUl9MRU5HVEhdDQoJcj1oaWdoV2F0ZXJtYXJrDQoJdT0zMipzLWxlbihlKQ0KCWw9MTw8MzENCgloPTAJDQoJd2hpbGUoaDxzKToNCgkJYz1vW2hdDQoJCWQ9MzINCgkJcD1oKmQNCgkJaWYgaD09cy0xOmY9dQ0KCQllbHNlOmY9MA0KCQlnMT1mDQoJCXdoaWxlKGcxPGQpOg0KCQkJaWYgYyZsPj5nMToNCgkJCQllW3BdPXRbbl0NCgkJCQluKz0xCQ0KCQkJZWxzZToNCgkJCQlpZiByOg0KCQkJCQllW3BdPWENCgkJCQllbHNlOg0KCQkJCQllW3BdPWENCgkJCQkJYSs9MQkJCQ0KCQkJZzErPTENCgkJCXArPTENCgkJaCs9MQ0KCXJldHVybiBlCQkNCgkNCgkNCmRlZiBkZWNvZGVXYXRlcm1hcmsodCxlLGkpOg0KCW49aVswXQ0KCXI9bGVuKHQpDQoJYT0wDQoJd2hpbGUoYTxyKToNCgkJcz1uLXRbYV0NCgkJZVthXT1zDQoJCWlmIG48PXM6bj1zKzENCgkJYSs9MQ0KCXJldHVybiBlLG4NCg0KDQpkZWYgZGVjb2RlUXVhbnRpemUoaW5wdXQscyxhLGl0ZW1zaXplKToNCgl4PVswXSpsZW4oaW5wdXQpDQoJaWQ9MA0KCWZvciByIGluIHJhbmdlKGxlbihpbnB1dCkvaXRlbXNpemUpOg0KCQlmb3IgbCBpbiByYW5nZShpdGVtc2l6ZSk6DQoJCQl4W2lkXT1zW2xdK2lucHV0W2lkXSphW2xdDQoJCQlpZCs9MQ0KCXJldHVybiB4CQkNCgkJDQoNCmRlZiBkZWNvZGVQcmVkaWN0KGluZGljZXMsaW5wdXQsaXRlbXNpemUpOgkNCgl0PWlucHV0CQ0KCWlmIGxlbihpbmRpY2VzKT4wOg0KCQl0PWlucHV0CQ0KCQllPWl0ZW1zaXplDQoJCWk9aW5kaWNlcwkNCgkJbj1sZW4odCkvZQ0KCQlyPVswXSpuDQoJCWE9bGVuKGkpLTENCgkJcltpWzBdXT0xDQoJCXJbaVsxXV09MQ0KCQlyW2lbMl1dPTEJDQoJCXM9Mg0KCQl3aGlsZShzPGEpOg0KCQkJbz1zLTINCgkJCXU9aVtvXQ0KCQkJbD1pW28rMV0NCgkJCWg9aVtvKzJdDQoJCQljPWlbbyszXQ0KCQkJaWYgMSE9cltjXToNCgkJCQlyW2NdPTENCgkJCQl1Kj1lDQoJCQkJbCo9ZQ0KCQkJCWgqPWUNCgkJCQljKj1lCQkJDQoJCQkJZD0wDQoJCQkJd2hpbGUoZDxlKToNCgkJCQkJdFtjK2RdPXRbYytkXSt0W2wrZF0rdFtoK2RdLXRbdStkXQ0KCQkJCQlkKz0xDQoJCQlzKz0xDQoJcmV0dXJuIHQNCg0KDQoNCmNsYXNzIE5vZGU6DQoJZGVmIF9faW5pdF9fKHNlbGYpOg0KCQlzZWxmLm5hbWU9Tm9uZQ0KCQlzZWxmLmNoaWxkcmVuPVtdDQoJCXNlbGYub3NnQ2hpbGRyZW49W10NCgkJc2VsZi5vZmZzZXQ9Tm9uZQ0KCQlzZWxmLnN0YXJ0PU5vbmUNCgkJc2VsZi5lbmQ9Tm9uZQ0KCQlzZWxmLmhlYWRlcj0nJw0KCQlzZWxmLmRhdGE9JycNCgkJc2VsZi5wYXJlbnQ9Tm9uZQ0KCQ0KY2xhc3MgWXNvbjoNCglkZWYgX19pbml0X18oc2VsZik6DQoJCXNlbGYuaW5wdXQ9Tm9uZQ0KCQlzZWxmLmZpbGVuYW1lPU5vbmUNCgkJc2VsZi5yb290PU5vZGUoKQ0KCQlzZWxmLmxvZz1GYWxzZQ0KCWRlZiBwYXJzZShzZWxmKToNCgkJZ2xvYmFsIG9mZnNldCxzdHJpbmcsdHh0DQoJCWlmIHNlbGYuZmlsZW5hbWUgaXMgbm90IE5vbmU6DQoJCQlmaWxlPW9wZW4oc2VsZi5maWxlbmFtZSwncmInKQ0KCQkJc2VsZi5pbnB1dD1maWxlLnJlYWQoKS5yZXBsYWNlKCdceDIwJywnJykucmVwbGFjZSgnXHgwQScsJycpLnJlcGxhY2UoJyYjMzQ7JywnIicpCQkNCgkJDQoJCQlsaW5lPXNlbGYuaW5wdXQNCgkJCWlmIHNlbGYubG9nPT1UcnVlOnR4dD1vcGVuKHNlbGYuZmlsZW5hbWUrJy55cycsJ3cnKQ0KCQkJDQoJCQlpZiBsaW5lIGlzIG5vdCBOb25lIGFuZCBsZW4obGluZSk+MDoNCgkJCQlvZmZzZXQ9MA0KCQkJCW49MA0KCQkJCXN0cmluZz1bXQ0KCQkJCWlmIHNlbGYuaW5wdXRbb2Zmc2V0XT09J3snOg0KCQkJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQkJCXR4dC53cml0ZSgnXG4nKQ0KCQkJCQkJdHh0LndyaXRlKCcgJypuKydoZWFkZXI6JytzdHIoTm9uZSkpDQoJCQkJCQl0eHQud3JpdGUoJyB7ICcrc3RyKG9mZnNldCkpDQoJCQkJCQl0eHQud3JpdGUoJyAnKihuKzQpKQ0KCQkJCWlmIHNlbGYuaW5wdXRbb2Zmc2V0XT09J1snOg0KCQkJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQkJCXR4dC53cml0ZSgnXG4nKQ0KCQkJCQkJdHh0LndyaXRlKCcgJypuKydoZWFkZXI6JytzdHIoTm9uZSkpDQoJCQkJCQl0eHQud3JpdGUoJyBbICcrc3RyKG9mZnNldCkpDQoJCQkJCQl0eHQud3JpdGUoJyAnKihuKzQpKQ0KCQkJCXNlbGYudHJlZShzZWxmLnJvb3QsbikNCgkJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQkJdHh0LndyaXRlKCcgJypuKQ0KCQkJCQ0KCQkJZmlsZS5jbG9zZSgpCQ0KCQkJDQoJCWlmIHNlbGYubG9nPT1UcnVlOnR4dC5jbG9zZSgpDQoNCglkZWYgZ2V0VHJlZTEoc2VsZixwYXJlbnQsbGlzdCxrZXkpOg0KCQlmb3IgY2hpbGQgaW4gcGFyZW50LmNoaWxkcmVuOg0KCQkJaWYga2V5IGluIGNoaWxkLmhlYWRlcjoNCgkJCQlsaXN0LmFwcGVuZChjaGlsZCkNCgkJCXNlbGYuZ2V0VHJlZShjaGlsZCxsaXN0LGtleSkNCgkJCQ0KCQkNCglkZWYgZ2V0VHJlZShzZWxmLHBhcmVudCxsaXN0LGtleSk6DQoJCWlmIGtleSBpbiBwYXJlbnQuaGVhZGVyIG9yIGtleSBpbiBwYXJlbnQuZGF0YToNCgkJCWxpc3QuYXBwZW5kKHBhcmVudCkNCgkJZm9yIGNoaWxkIGluIHBhcmVudC5jaGlsZHJlbjoNCgkJCXNlbGYuZ2V0VHJlZShjaGlsZCxsaXN0LGtleSkJDQoNCglkZWYgdmFsdWVzKHNlbGYsZGF0YSx0eXBlKToNCgkJbGlzdD17fQ0KCQlBPWRhdGEuc3BsaXQoJywnKQ0KCQlpZiB0eXBlPT0nOic6DQoJCQlmb3IgYSBpbiBBOg0KCQkJCWlmICc6JyBpbiBhOg0KCQkJCQljPTANCgkJCQkJYWxpc3Q9W10NCgkJCQkJc3RyaW5nPScnDQoJCQkJCWZvciBiIGluIGE6DQoJCQkJCQlpZiBiPT0nIicgYW5kIGM9PTA6DQoJCQkJCQkJaWYgbGVuKHN0cmluZyk+MDphbGlzdC5hcHBlbmQoc3RyaW5nKQ0KCQkJCQkJCXN0cmluZz0nJw0KCQkJCQkJCXN0cmluZys9Yg0KCQkJCQkJCWM9MQ0KCQkJCQkJZWxpZiBiPT0nIicgYW5kIGM9PTE6DQoJCQkJCQkJc3RyaW5nKz1iDQoJCQkJCQkJaWYgbGVuKHN0cmluZyk+MDphbGlzdC5hcHBlbmQoc3RyaW5nKQ0KCQkJCQkJCXN0cmluZz0nJw0KCQkJCQkJCWM9MA0KCQkJCQkJZWxpZiBiPT0nOic6DQoJCQkJCQkJcGFzcw0KCQkJCQkJZWxzZTpzdHJpbmcrPWINCgkJCQkJaWYgbGVuKHN0cmluZyk+MDphbGlzdC5hcHBlbmQoc3RyaW5nKQ0KCQkJCQlpZiBsZW4oYWxpc3QpPT0yOgkNCgkJCQkJCWxpc3RbYWxpc3RbMF1dPWFsaXN0WzFdCQkNCgkJCQkJaWYgbGVuKGFsaXN0KT09MToJDQoJCQkJCQlsaXN0W2FsaXN0WzBdXT0nTm9uZScJCQkJCQkNCgkJCQkJCQkJCQ0KCQkJCQkJDQoJCQkJCQkJDQoJCQkJCSNpZiBhLmNvdW50KCc6Jyk+MToNCgkJaWYgdHlwZT09J2YnOg0KCQkJbGlzdD1tYXAoZmxvYXQsQSkNCgkJaWYgdHlwZT09J2knOg0KCQkJbGlzdD1tYXAoaW50LEEpDQoJCWlmIHR5cGU9PSdzJzoNCgkJCWxpc3Q9QQ0KCQlyZXR1cm4gbGlzdAkNCg0KCWRlZiBnZXRWYWx1ZShzZWxmLHZhbHVlcyxuYW1lLHR5cGU9Tm9uZSk6DQoJCWlmIG5hbWUgaW4gdmFsdWVzOg0KCQkJaWYgdHlwZT09JyJmIic6DQoJCQkJcmV0dXJuIGZsb2F0KHZhbHVlc1tuYW1lXS5zcGxpdCgnIicpWzFdKQ0KCQkJZWxpZiB0eXBlPT0nImkiJzoNCgkJCQlyZXR1cm4gaW50KHZhbHVlc1tuYW1lXS5zcGxpdCgnIicpWzFdKQ0KCQkJZWxpZiB0eXBlPT0naSc6DQoJCQkJI3ByaW50IG5hbWUsdmFsdWVzW25hbWVdDQoJCQkJaWYgdmFsdWVzW25hbWVdIT0nTm9uZSc6DQoJCQkJCXJldHVybiBpbnQodmFsdWVzW25hbWVdLnJlcGxhY2UoJ1wiJywgJycpKQ0KCQkJCWVsc2U6DQoJCQkJCXJldHVybiBOb25lDQoJCQllbGlmIHR5cGU9PSciIic6DQoJCQkJcmV0dXJuIHZhbHVlc1tuYW1lXS5zcGxpdCgnIicpWzFdDQoJCQllbHNlOg0KCQkJCXJldHVybiB2YWx1ZXNbbmFtZV0NCgkJZWxzZToNCgkJCXJldHVybiBOb25lDQoJCQ0KCWRlZiBnZXQoc2VsZixub2RlLGtleSk6CQkNCgkJbGlzdD1bXQ0KCQlzZWxmLmdldFRyZWUobm9kZSxsaXN0LGtleSkNCgkJaWYgbGVuKGxpc3QpPjA6DQoJCQlyZXR1cm4gbGlzdAkNCgkJZWxzZToNCgkJCXJldHVybiBOb25lDQoJCQkNCglkZWYgdHJlZShzZWxmLHBhcmVudE5vZGUsbik6DQoJCWdsb2JhbCBvZmZzZXQsc3RyaW5nDQoJCW4rPTQNCgkJb2Zmc2V0Kz0xDQoJCXdoaWxlKFRydWUpOgkNCgkJCWlmCW9mZnNldD49bGVuKHNlbGYuaW5wdXQpOmJyZWFrDQoJCQl2YWx1ZT1zZWxmLmlucHV0W29mZnNldF0NCgkJCWlmIHZhbHVlPT0nfSc6DQoJCQkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQkJCXR4dC53cml0ZSgnXG4nKQ0KCQkJCQlpZiBsZW4oc3RyaW5nKT4wOg0KCQkJCQkJdHh0LndyaXRlKCcgJypuKydkYXRhOicrc2VsZi5pbnB1dFtzdHJpbmdbMF06b2Zmc2V0XSkJDQoJCQkJCWVsc2U6CQ0KCQkJCQkJdHh0LndyaXRlKCcgJypuKydkYXRhOk5vbmUnKQkJCQkNCgkJCQkJdHh0LndyaXRlKCdcbicrJyAnKm4rJyB9ICcrc3RyKG9mZnNldCkpDQoJCQkJaWYgbGVuKHN0cmluZyk+MDoJDQoJCQkJCXBhcmVudE5vZGUuZGF0YT1zZWxmLmlucHV0W3N0cmluZ1swXTpvZmZzZXRdDQoJCQkJc3RyaW5nPVtdDQoJCQkJb2Zmc2V0Kz0xCQkJDQoJCQkJYnJlYWsNCgkJCQ0KCQkJZWxpZiB2YWx1ZT09J3snOg0KCQkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCQl0eHQud3JpdGUoJ1xuJykNCgkJCQkJaWYgbGVuKHN0cmluZyk+MDoNCgkJCQkJCXR4dC53cml0ZSgnICcqbisnaGVhZGVyOicrc2VsZi5pbnB1dFtzdHJpbmdbMF06b2Zmc2V0XSkJDQoJCQkJCWVsc2U6CQ0KCQkJCQkJdHh0LndyaXRlKCcgJypuKydoZWFkZXI6Tm9uZScpCQkJCQ0KCQkJCQl0eHQud3JpdGUoJyB7ICcrc3RyKG9mZnNldCkpDQoJCQkJCXR4dC53cml0ZSgnICcqKG4rNCkpDQoJCQkJI3ByaW50IHJvdW5kKDEwMCpvZmZzZXQvZmxvYXQobGVuKHNlbGYuaW5wdXQpKSwzKSwncHJvY2VudCcNCgkJCQlub2RlPU5vZGUoKQ0KCQkJCW5vZGUucGFyZW50PXBhcmVudE5vZGUNCgkJCQlwYXJlbnROb2RlLmNoaWxkcmVuLmFwcGVuZChub2RlKQ0KCQkJCW5vZGUub2Zmc2V0PW9mZnNldA0KCQkJCWlmIGxlbihzdHJpbmcpPjA6DQoJCQkJCW5vZGUuaGVhZGVyPXNlbGYuaW5wdXRbc3RyaW5nWzBdOm9mZnNldF0NCgkJCQlzdHJpbmc9W10NCgkJCQlzZWxmLnRyZWUobm9kZSxuKQ0KCQkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCQl0eHQud3JpdGUoJyAnKm4pDQoJCQkJDQoJCQllbGlmIHZhbHVlPT0nXSc6DQoJCQkJaWYgbGVuKHN0cmluZyk+MDoNCgkJCQkJcGFyZW50Tm9kZS5kYXRhPXNlbGYuaW5wdXRbc3RyaW5nWzBdOm9mZnNldF0NCgkJCQkNCgkJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQkJdHh0LndyaXRlKCdcbicpDQoJCQkJCWlmIGxlbihzdHJpbmcpPjA6DQoJCQkJCQl0eHQud3JpdGUoJyAnKm4rJ2RhdGE6JytzZWxmLmlucHV0W3N0cmluZ1swXTpvZmZzZXRdKydcbicpCQ0KCQkJCQllbHNlOgkNCgkJCQkJCXR4dC53cml0ZSgnICcqbisnZGF0YTpOb25lJykJCQkJCQkJDQoJCQkJCXR4dC53cml0ZSgnICcqbisnIF0gJytzdHIob2Zmc2V0KSkNCgkJCQkJDQoJCQkJb2Zmc2V0Kz0xDQoJCQkJc3RyaW5nPVtdDQoJCQkJYnJlYWsNCgkJCQ0KCQkJZWxpZiB2YWx1ZT09J1snOg0KCQkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCQl0eHQud3JpdGUoJ1xuJykNCgkJCQkJaWYgbGVuKHN0cmluZyk+MDoNCgkJCQkJCXR4dC53cml0ZSgnICcqbisnaGVhZGVyOicrc2VsZi5pbnB1dFtzdHJpbmdbMF06b2Zmc2V0XSkNCgkJCQkJZWxzZToJDQoJCQkJCQl0eHQud3JpdGUoJyAnKm4rJ2hlYWRlcjpOb25lJykNCgkJCQkJdHh0LndyaXRlKCcgWyAnK3N0cihvZmZzZXQpKQ0KCQkJCQl0eHQud3JpdGUoJyAnKihuKzQpKQ0KCQkJCSNwcmludCByb3VuZCgxMDAqb2Zmc2V0L2Zsb2F0KGxlbihzZWxmLmlucHV0KSksMyksJ3Byb2NlbnQnDQoJCQkJbm9kZT1Ob2RlKCkNCgkJCQlub2RlLnBhcmVudD1wYXJlbnROb2RlDQoJCQkJcGFyZW50Tm9kZS5jaGlsZHJlbi5hcHBlbmQobm9kZSkNCgkJCQlub2RlLm9mZnNldD1vZmZzZXQNCgkJCQlub2RlLm5hbWU9c3RyaW5nDQoJCQkJaWYgbGVuKHN0cmluZyk+MDoNCgkJCQkJbm9kZS5oZWFkZXI9c2VsZi5pbnB1dFtzdHJpbmdbMF06b2Zmc2V0XQ0KCQkJCWVsc2U6DQoJCQkJCW5vZGUuaGVhZGVyPScnDQoJCQkJc3RyaW5nPVtdDQoJCQkJc2VsZi50cmVlKG5vZGUsbikNCgkJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQkJdHh0LndyaXRlKCcgJypuKQ0KCQkJZWxzZToJCQkNCgkJCQkjc3RyaW5nKz12YWx1ZQ0KCQkJCWlmIGxlbihzdHJpbmcpPT0wOg0KCQkJCQlzdHJpbmcuYXBwZW5kKG9mZnNldCkNCgkJCQlvZmZzZXQrPTENCgkJDQpkZWYgZ2V0VW5pcXVlSUQoeXMsZGF0YSk6DQoJVW5pcXVlSUQ9Tm9uZQ0KCXZhbHVlcz15cy52YWx1ZXMoZGF0YSwnOicpDQoJaWYgJyJVbmlxdWVJRCInIGluIHZhbHVlczoNCgkJVW5pcXVlSUQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciVW5pcXVlSUQiJywnaScpDQoJcmV0dXJuIFVuaXF1ZUlECQ0KCQ0KDQpjbGFzcyBOZXdOb2RlOg0KCWRlZiBfX2luaXRfXyhzZWxmKToNCgkJc2VsZi5ub2RlPU5vbmUNCgkJc2VsZi5wYXJlbnQ9Tm9uZQ0KCQlzZWxmLmNoaWxkcmVuPVtdDQoJCXNlbGYuVW5pcXVlSUQ9Tm9uZQ0KCQ0KZGVmIGdldElEVHJlZSh5cyxwYXJlbnROb2RlLG4scGFyZW50TmV3Tm9kZSk6DQoJaWYgbGVuKHBhcmVudE5vZGUuaGVhZGVyKSE9MCBhbmQgcGFyZW50Tm9kZS5oZWFkZXIhPScsJzoNCgkJbis9NA0KCVVuaXF1ZUlEPWdldFVuaXF1ZUlEKHlzLHBhcmVudE5vZGUuZGF0YSkNCglpZiBVbmlxdWVJRDoNCgkJcGFyZW50TmV3Tm9kZS5VbmlxdWVJRD1VbmlxdWVJRA0KCWZvciBjaGlsZCBpbiBwYXJlbnROb2RlLmNoaWxkcmVuOg0KCQlpZiBsZW4oY2hpbGQuaGVhZGVyKSE9MCBhbmQgY2hpbGQuaGVhZGVyIT0nLCc6DQoJCQluZXdOb2RlPU5ld05vZGUoKQ0KCQkJVW5pcXVlSUQ9Z2V0VW5pcXVlSUQoeXMsY2hpbGQuaGVhZGVyKQ0KCQkJaWYgVW5pcXVlSUQ6DQoJCQkJcGFyZW50TmV3Tm9kZS5VbmlxdWVJRD1VbmlxdWVJRA0KCQkJbmV3Tm9kZS5ub2RlPWNoaWxkDQoJCQlwYXJlbnROZXdOb2RlLmNoaWxkcmVuLmFwcGVuZChuZXdOb2RlKQ0KCQkJbmV3Tm9kZUxpc3QuYXBwZW5kKG5ld05vZGUpDQoJCQluZXdOb2RlLnBhcmVudD1wYXJlbnROb2RlDQoJCQlwYXJlbnROZXdOb2RlMT1uZXdOb2RlDQoJCQlnZXRJRFRyZWUoeXMsY2hpbGQsbixwYXJlbnROZXdOb2RlMSkNCgkJZWxzZToJDQoJCQlnZXRJRFRyZWUoeXMsY2hpbGQsbixwYXJlbnROZXdOb2RlKQ0KCQkJDQoJCQkJCQkJCQ0KZGVmIGdldFBhdGgoRmlsZSk6DQoJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCcuZ3onKVswXQ0KCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1GYWxzZTpwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUrJy50eHQnDQoJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOnBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZQ0KCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1UcnVlOnJldHVybiBwYXRoDQoJZWxzZTpyZXR1cm4gTm9uZQ0KDQpkZWYgcmVhZEZsb2F0cyhicixvZmZzZXQsc2l6ZSxpdGVtU2l6ZSk6DQoJaWYgYnIuaW5wdXRGaWxlLm1vZGU9PSdyYic6DQoJCWJyLnNlZWsob2Zmc2V0KQ0KCQlpID0gMA0KCQludW1iZXJzID0gW10NCgkJd2hpbGUgaSA8IHNpemUgKiBpdGVtU2l6ZToNCgkJCW51bWJlcnMuYXBwZW5kKGZsb2F0KHN0cnVjdC51bnBhY2soJzxmJyxici5pbnB1dEZpbGUucmVhZCg0KSlbMF0pKQ0KCQkJaSArPSAxDQoJCXJldHVybiBudW1iZXJzCQkJDQoNCmRlZiBWZXJ0ZXhOb3JtYWwoeXMsYik6DQoJbj0yMA0KCVNpemU9Tm9uZQ0KCU9mZnNldD1Ob25lDQoJRW5jb2Rpbmc9Tm9uZQ0KCUl0ZW1TaXplPU5vbmUNCgl0eXBlPU5vbmUNCglub3JtYWxBcnJheT1bXQkNCgl2YWx1ZXM9eXMudmFsdWVzKGIuZGF0YSwnOicpDQoJaWYgJyJJdGVtU2l6ZSInIGluIHZhbHVlczoNCgkJSXRlbVNpemU9aW50KHZhbHVlc1snIkl0ZW1TaXplIiddKQkJCQkJDQoJCVVpbnQzMkFycmF5PXlzLmdldChiLCciVWludDMyQXJyYXkiJykNCgkJaWYgVWludDMyQXJyYXk6DQoJCQl0eXBlPSdVaW50MzJBcnJheScNCgkJCXZhbHVlcz15cy52YWx1ZXMoVWludDMyQXJyYXlbMF0uZGF0YSwnOicpDQoJCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJywnaScpDQoJCQlPZmZzZXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicsJ2knKQ0KCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicsJyIiJykNCgkJCUVuY29kaW5nPXlzLmdldFZhbHVlKHZhbHVlcywnIkVuY29kaW5nIicpDQoJCQlpZiBFbmNvZGluZz09JyJ2YXJpbnQiJzoJCQkJCQkNCgkJCQlwYXRoPWdldFBhdGgoRmlsZSkNCgkJCQlpZiBwYXRoOg0KCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQlieXRlcz1kZWNvZGVWYXJpbnQoZyxPZmZzZXQsU2l6ZSpJdGVtU2l6ZSx0eXBlKQ0KCQkJCQlub3JtYWxBcnJheS5hcHBlbmQoW2J5dGVzLEVuY29kaW5nLEl0ZW1TaXplXSkNCgkJCQkJZmlsZS5jbG9zZSgpDQoJCUZsb2F0MzJBcnJheSA9IHlzLmdldChiLCAnIkZsb2F0MzJBcnJheSInKQ0KCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQl0eXBlPSdGbG9hdDMyQXJyYXknDQoJCQl2YWx1ZXM9eXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJywnIiInKQ0KCQkJRW5jb2Rpbmc9eXMuZ2V0VmFsdWUodmFsdWVzLCciRW5jb2RpbmciJykNCgkJCWlmIEVuY29kaW5nICE9ICcidmFyaW50Iic6DQoJCQkJcGF0aCA9IGdldFBhdGgoRmlsZSkNCgkJCQlpZiBwYXRoOg0KCQkJCQlnbG9iYWwgbW9kZWxJRA0KCQkJCQlmaWxlID0gb3BlbihwYXRoLCAicmIiKQ0KCQkJCQlnID0gQmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCWJ5dGVzID0gcmVhZEZsb2F0cyhnLCBPZmZzZXQsIFNpemUsIEl0ZW1TaXplKQ0KCQkJCQl3aXRoIG9wZW4oIi4ve3RlbXBQYXRofS92ZXJ0ZXhOb3JtYWxEYXRhLyIgKyBzdHIobW9kZWxJRCkgKyAiLmRhdCIsICJhIikgYXMgbW9kZWxEYXRhOg0KCQkJCQkJbW9kZWxJRCArPSAxDQoJCQkJCQlmb3IgbGluZSBpbiBieXRlczoNCgkJCQkJCQltb2RlbERhdGEud3JpdGUoc3RyKGxpbmUpICsgIlxuIikNCgkJCQkJbm9ybWFsQXJyYXkuYXBwZW5kKFtieXRlcywgRW5jb2RpbmcsIEl0ZW1TaXplXSkNCgkJCQkJZmlsZS5jbG9zZSgpDQoJcmV0dXJuIG5vcm1hbEFycmF5DQoNCmRlZiBWZXJ0ZXgoeXMsYik6DQoJbj0yMA0KCVNpemU9Tm9uZQ0KCU9mZnNldD1Ob25lDQoJRW5jb2Rpbmc9Tm9uZQ0KCUl0ZW1TaXplPU5vbmUNCgl0eXBlPU5vbmUNCgl2ZXJ0ZXhBcnJheT1bXQkNCgl2YWx1ZXM9eXMudmFsdWVzKGIuZGF0YSwnOicpDQoJaWYgJyJJdGVtU2l6ZSInIGluIHZhbHVlczoNCgkJSXRlbVNpemU9aW50KHZhbHVlc1snIkl0ZW1TaXplIiddKQkJCQkJDQoJCUludDMyQXJyYXk9eXMuZ2V0KGIsJyJJbnQzMkFycmF5IicpDQoJCWlmIEludDMyQXJyYXk6DQoJCQl0eXBlPSdJbnQzMkFycmF5Jw0KCQkJdmFsdWVzPXlzLnZhbHVlcyhJbnQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicsJ2knKQ0KCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInLCdpJykNCgkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInLCciIicpDQoJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInKQ0KCQkJI3dyaXRlKGxvZyxbdHlwZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZ10sbikNCgkJCWlmIEVuY29kaW5nPT0nInZhcmludCInOgkJCQkJCQ0KCQkJCXBhdGg9Z2V0UGF0aChGaWxlKQ0KCQkJCWlmIHBhdGg6DQoJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCWJ5dGVzPWRlY29kZVZhcmludChnLE9mZnNldCxTaXplKkl0ZW1TaXplLHR5cGUpDQoJCQkJCXZlcnRleEFycmF5LmFwcGVuZChbYnl0ZXMsRW5jb2RpbmcsSXRlbVNpemVdKQ0KCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQkJDQoJCUZsb2F0MzJBcnJheT15cy5nZXQoYiwnIkZsb2F0MzJBcnJheSInKQ0KCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQl0eXBlPSdGbG9hdDMyQXJyYXknDQoJCQkjcHJpbnQgbW9kZSx0eXBlDQoJCQl2YWx1ZXM9eXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJywnIiInKQ0KCQkJRW5jb2Rpbmc9eXMuZ2V0VmFsdWUodmFsdWVzLCciRW5jb2RpbmciJykNCgkJCSN3cml0ZShsb2csW3R5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmddLG4pDQoJCQlpZiBFbmNvZGluZyE9JyJ2YXJpbnQiJzoJCQkJCQkNCgkJCQlwYXRoPWdldFBhdGgoRmlsZSkNCgkJCQlpZiBwYXRoOg0KCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQlnLnNlZWsoT2Zmc2V0KQ0KCQkJCQlieXRlcz1nLmYoU2l6ZSpJdGVtU2l6ZSkNCgkJCQkJbGlzdD1bXQ0KCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCWxpc3QuYXBwZW5kKGJ5dGVzW20qSXRlbVNpemU6bSpJdGVtU2l6ZStJdGVtU2l6ZV0pDQoJCQkJCXZlcnRleEFycmF5LmFwcGVuZChbbGlzdCxFbmNvZGluZ10pDQoJCQkJCWZpbGUuY2xvc2UoKQ0KCXJldHVybiB2ZXJ0ZXhBcnJheQkJCQkNCgkNCmRlZiBUZXhDb29yZCh5cyxiKToNCgluPTIwDQoJU2l6ZT1Ob25lDQoJT2Zmc2V0PU5vbmUNCglFbmNvZGluZz1Ob25lDQoJSXRlbVNpemU9Tm9uZQ0KCXR5cGU9Tm9uZQkNCglUZXhDb29yZEFycmF5PVtdDQoJdmFsdWVzPXlzLnZhbHVlcyhiLmRhdGEsJzonKQ0KCWlmICciSXRlbVNpemUiJyBpbiB2YWx1ZXM6DQoJCUl0ZW1TaXplPWludCh2YWx1ZXNbJyJJdGVtU2l6ZSInXSkJCQkJCQ0KCQlJbnQzMkFycmF5PXlzLmdldChiLCciSW50MzJBcnJheSInKQ0KCQlpZiBJbnQzMkFycmF5Og0KCQkJdHlwZT0nSW50MzJBcnJheScNCgkJCXZhbHVlcz15cy52YWx1ZXMoSW50MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJywnIiInKQ0KCQkJRW5jb2Rpbmc9eXMuZ2V0VmFsdWUodmFsdWVzLCciRW5jb2RpbmciJykNCgkJCWlmIEVuY29kaW5nPT0nInZhcmludCInOgkJCQkJCQ0KCQkJCXBhdGg9Z2V0UGF0aChGaWxlKQ0KCQkJCWlmIHBhdGg6DQoJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCWJ5dGVzPWRlY29kZVZhcmludChnLE9mZnNldCxTaXplKkl0ZW1TaXplLHR5cGUpDQoJCQkJCVRleENvb3JkQXJyYXkuYXBwZW5kKFtieXRlcyxFbmNvZGluZyxJdGVtU2l6ZV0pDQoJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCQkNCgkJRmxvYXQzMkFycmF5PXlzLmdldChiLCciRmxvYXQzMkFycmF5IicpDQoJCWlmIEZsb2F0MzJBcnJheToNCgkJCXR5cGU9J0Zsb2F0MzJBcnJheScNCgkJCXZhbHVlcz15cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicsJ2knKQ0KCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInLCdpJykNCgkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInLCciIicpDQoJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInKQ0KCQkJaWYgRW5jb2RpbmchPScidmFyaW50Iic6CQkJCQkJDQoJCQkJcGF0aD1nZXRQYXRoKEZpbGUpDQoJCQkJaWYgcGF0aDoNCgkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJZy5zZWVrKE9mZnNldCkNCgkJCQkJYnl0ZXM9Zy5mKFNpemUqSXRlbVNpemUpDQoJCQkJCWxpc3Q9W10NCgkJCQkJZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQoJCQkJCQl1LHY9Ynl0ZXNbbSpJdGVtU2l6ZTptKkl0ZW1TaXplK0l0ZW1TaXplXQ0KCQkJCQkJbGlzdC5hcHBlbmQoW3UsMS12XSkNCgkJCQkJVGV4Q29vcmRBcnJheS5hcHBlbmQoW2xpc3QsRW5jb2RpbmddKQ0KCQkJCQlmaWxlLmNsb3NlKCkNCglyZXR1cm4gVGV4Q29vcmRBcnJheQ0KCQ0KZGVmIENvbG9yKHlzLGIpOg0KCW49MjANCglTaXplPU5vbmUNCglPZmZzZXQ9Tm9uZQ0KCUVuY29kaW5nPU5vbmUNCglJdGVtU2l6ZT1Ob25lDQoJdHlwZT1Ob25lCQkJCQ0KCXZhbHVlcz15cy52YWx1ZXMoYi5kYXRhLCc6JykNCgljb2xvckFycmF5PVtdDQoJaWYgJyJJdGVtU2l6ZSInIGluIHZhbHVlczoNCgkJSXRlbVNpemU9aW50KHZhbHVlc1snIkl0ZW1TaXplIiddKQkJCQkJDQoJCVVpbnQ4QXJyYXk9eXMuZ2V0KGIsJyJVaW50OEFycmF5IicpDQoJCWlmIFVpbnQ4QXJyYXk6DQoJCQl0eXBlPSJVaW50OEFycmF5Ig0KCQkJdmFsdWVzPXlzLnZhbHVlcyhVaW50OEFycmF5WzBdLmRhdGEsJzonKQ0KCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicsJ2knKQ0KCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInLCdpJykNCgkJCUVuY29kaW5nPXlzLmdldFZhbHVlKHZhbHVlcywnIkVuY29kaW5nIicsJyIiJykJDQoJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJywnIiInKQkJCQkJDQoJCQlwYXRoPWdldFBhdGgoRmlsZSkNCgkJCWlmIHBhdGg6DQoJCQkJaWYgRW5jb2RpbmchPScidmFyaW50Iic6DQoJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCWcuc2VlayhPZmZzZXQpDQoJCQkJCWJ5dGVzPWcuQihTaXplKkl0ZW1TaXplKQ0KCQkJCQlsaXN0PVtdDQoJCQkJCWZvciBtIGluIHJhbmdlKFNpemUpOg0KCQkJCQkJbGlzdC5hcHBlbmQoYnl0ZXNbbSpJdGVtU2l6ZTptKkl0ZW1TaXplK0l0ZW1TaXplXSkNCgkJCQkJY29sb3JBcnJheT1saXN0DQoJCQkJCWZpbGUuY2xvc2UoKQkJCQkJDQoJCUZsb2F0MzJBcnJheT15cy5nZXQoYiwnIkZsb2F0MzJBcnJheSInKQ0KCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQl0eXBlPSJGbG9hdDMyQXJyYXkiDQoJCQl2YWx1ZXM9eXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInLCciIicpCQ0KCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicsJyIiJykJCQkJCQ0KCQkJcGF0aD1nZXRQYXRoKEZpbGUpDQoJCQlpZiBwYXRoOg0KCQkJCWlmIEVuY29kaW5nIT0nInZhcmludCInOg0KCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQlnLnNlZWsoT2Zmc2V0KQ0KCQkJCQlieXRlcz1nLmYoU2l6ZSpJdGVtU2l6ZSkNCgkJCQkJbGlzdD1bXQ0KCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCWl0ZW1zPWJ5dGVzW20qSXRlbVNpemU6bSpJdGVtU2l6ZStJdGVtU2l6ZV0NCgkJCQkJCUE9W10NCgkJCQkJCWZvciBpdGVtIGluIGl0ZW1zOg0KCQkJCQkJCUEuYXBwZW5kKGludChpdGVtKjI1NikpDQoJCQkJCQlsaXN0LmFwcGVuZChBKQ0KCQkJCQljb2xvckFycmF5PWxpc3QNCgkJCQkJZmlsZS5jbG9zZSgpDQoJcmV0dXJuIGNvbG9yQXJyYXkJCQkJCQkJDQoJDQoJDQoJDQpkZWYgZ2V0SW5kaWNlcyhpdGVtc2l6ZSxzaXplLG9mZnNldCx0eXBlLGcsbW9kZSxtYWdpYyk6DQoJaWYgdHlwZSE9IlVpbnQ4QXJyYXkiOmJ5dGVzPWRlY29kZVZhcmludChnLG9mZnNldCxzaXplKml0ZW1zaXplLHR5cGUpDQoJZWxzZToNCgkJZy5zZWVrKG9mZnNldCkNCgkJYnl0ZXM9bGlzdChnLkIoc2l6ZSppdGVtc2l6ZSkpCQkNCgl3cml0ZShsb2csW21hZ2ljLG1vZGUsdHlwZV0sMCkNCgl3cml0ZShsb2csYnl0ZXMsMCkJCQ0KCQ0KCUlNUExJQ0lUX0hFQURFUl9MRU5HVEg9Mw0KCUlNUExJQ0lUX0hFQURFUl9NQVNLX0xFTkdUSD0xDQoJSU1QTElDSVRfSEVBREVSX1BSSU1JVElWRV9MRU5HVEg9MA0KCUlNUExJQ0lUX0hFQURFUl9FWFBFQ1RFRF9JTkRFWD0yDQoJaGlnaFdhdGVybWFyaz0yDQoJDQoJTWlzc2luZ0NvbmRpdGlvbj1za2lwZGVjb2RlDQoJaWYgTWlzc2luZ0NvbmRpdGlvbiE9MToNCgkJDQoJCWlmIG1vZGU9PSciVFJJQU5HTEVfU1RSSVAiJzoNCgkJCQkJaz1JTVBMSUNJVF9IRUFERVJfTEVOR1RIK2J5dGVzW0lNUExJQ0lUX0hFQURFUl9NQVNLX0xFTkdUSF0NCgkJCQkJYnl0ZXM9ZGVjb2RlRGVsdGEoYnl0ZXMsaykJDQoJCQkJCSN3cml0ZShsb2csW21hZ2ljLGtdLDApCQ0KCQkJCQkjd3JpdGUobG9nLGJ5dGVzLDApCQkNCgkJCQkJYnl0ZXM9ZGVjb2RlSW1wbGljaXQoYnl0ZXMsaykNCgkJCQkJI3dyaXRlKGxvZyxbbWFnaWMsa10sMCkJDQoJCQkJCSN3cml0ZShsb2csYnl0ZXMsMCkJCQkNCgkJCQkJaT1bbWFnaWNdCQ0KCQkJCQlieXRlcyxtYWdpYz1kZWNvZGVXYXRlcm1hcmsoYnl0ZXMsYnl0ZXMsaSkNCgkJCQkJI3dyaXRlKGxvZyxbbWFnaWNdLDApCQ0KCQkJCQkjd3JpdGUobG9nLGJ5dGVzLDApCQ0KCQkJCQ0KCQllbGlmIG1vZGU9PSciVFJJQU5HTEVTIic6DQoJCQkJCWs9MA0KCQkJCQlieXRlcz1kZWNvZGVEZWx0YShieXRlcyxrKQ0KCQkJCQkjd3JpdGUobG9nLFttYWdpY10sMCkJDQoJCQkJCSN3cml0ZShsb2csYnl0ZXMsMCkJCQkNCgkJCQkJaT1bbWFnaWNdCQ0KCQkJCQlieXRlcyxtYWdpYz1kZWNvZGVXYXRlcm1hcmsoYnl0ZXMsYnl0ZXMsaSkNCgkJCQkJI3dyaXRlKGxvZyxbbWFnaWNdLDApCQ0KCQkJCQkjd3JpdGUobG9nLGJ5dGVzLDApCQ0KCQkNCgkJDQoJCQ0KCQkNCglyZXR1cm4gbWFnaWMsYnl0ZXMNCgkNCgkJCQkNCmRlZiBQcmltaXRpdmVTZXRMaXN0KHlzLGNoaWxkKToNCglnbG9iYWwgbWFnaWMNCgltb2RlPU5vbmUNCgltYWdpYz0wDQoJbj0xNg0KCWluZGljZUFycmF5PVtdDQoJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOgkJCQkJDQoJCWI9Y2hpbGQubm9kZQ0KCQlpZiAnIkRyYXdFbGVtZW50c1VJbnQiJyBpbiBiLmhlYWRlcjoJCQkNCgkJCXZhbHVlcz15cy52YWx1ZXMoYi5kYXRhLCc6JykNCgkJCW1vZGU9dmFsdWVzWyciTW9kZSInXQkJCQ0KCQkJU2l6ZT1Ob25lDQoJCQlPZmZzZXQ9Tm9uZQ0KCQkJRW5jb2Rpbmc9Tm9uZQ0KCQkJSXRlbVNpemU9Tm9uZQ0KCQkJdHlwZT1Ob25lDQoJCQlpZiBtb2RlIT0nIkxJTkVTIic6DQoJCQkJSW5kaWNlcz15cy5nZXQoYiwnIkluZGljZXMiJykNCgkJCQlpZiBJbmRpY2VzOg0KCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEluZGljZXNbMF0uZGF0YSwnOicpDQoJCQkJCUl0ZW1TaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIkl0ZW1TaXplIicsJ2knKQ0KCQkJCQlVaW50MzJBcnJheT15cy5nZXQoSW5kaWNlc1swXSwnIlVpbnQzMkFycmF5IicpDQoJCQkJCXR5cGU9IlVpbnQzMkFycmF5Ig0KCQkJCQkjcHJpbnQgIkRyYXdFbGVtZW50c1VJbnQiLHR5cGUNCgkJCQkJaWYgVWludDMyQXJyYXk6DQoJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKFVpbnQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQkJCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicsJ2knKQ0KCQkJCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInLCdpJykNCgkJCQkJCUVuY29kaW5nPXlzLmdldFZhbHVlKHZhbHVlcywnIkVuY29kaW5nIicsJyIiJykNCgkJCQkJCSN3cml0ZShsb2csWydJbmRpY2U6JywnbW9kZTonLG1vZGUsdHlwZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZywnbWFnaWM6JyxtYWdpY10sbikNCgkJCQkJCWlmIEVuY29kaW5nPT0ndmFyaW50JzoNCgkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkrb3Muc2VwKyJtb2RlbF9maWxlLmJpbiINCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6cGF0aD1vcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpK29zLnNlcCsibW9kZWxfZmlsZS5iaW4iDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOnBhdGg9b3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKStvcy5zZXArdmFsdWVzWyciRmlsZSInXS5zcGxpdCgnIicpWzFdIysnLnR4dCcNCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZToNCgkJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJbWFnaWMsaW5kaWNlTGlzdD1nZXRJbmRpY2VzKEl0ZW1TaXplLFNpemUsT2Zmc2V0LHR5cGUsZyxtb2RlLG1hZ2ljKQ0KCQkJCQkJCQlpbmRpY2VBcnJheS5hcHBlbmQoW2luZGljZUxpc3QsbW9kZV0pDQoJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJI2Vsc2U6DQoJCQkjCXByaW50ICdMSU5FUycNCgkJCQkNCgkJaWYgJyJEcmF3RWxlbWVudHNVU2hvcnQiJyBpbiBiLmhlYWRlcjoJCQ0KCQkJdmFsdWVzPXlzLnZhbHVlcyhiLmRhdGEsJzonKQ0KCQkJbW9kZT12YWx1ZXNbJyJNb2RlIiddCQkJDQoJCQlTaXplPU5vbmUNCgkJCU9mZnNldD1Ob25lDQoJCQlFbmNvZGluZz1Ob25lDQoJCQlJdGVtU2l6ZT1Ob25lDQoJCQl0eXBlPU5vbmUNCgkJCWlmIG1vZGUhPSciTElORVMiJzoNCgkJCQlJbmRpY2VzPXlzLmdldChiLCciSW5kaWNlcyInKQ0KCQkJCWlmIEluZGljZXM6DQoJCQkJCXZhbHVlcz15cy52YWx1ZXMoSW5kaWNlc1swXS5kYXRhLCc6JykNCgkJCQkJSXRlbVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJywnaScpDQoJCQkJCVVpbnQxNkFycmF5PXlzLmdldChJbmRpY2VzWzBdLCciVWludDE2QXJyYXkiJykNCgkJCQkJdHlwZT0iVWludDE2QXJyYXkiDQoJCQkJCSNwcmludCAiRHJhd0VsZW1lbnRzVVNob3J0Iix0eXBlDQoJCQkJCWlmIFVpbnQxNkFycmF5Og0KCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhVaW50MTZBcnJheVswXS5kYXRhLCc6JykNCgkJCQkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCQkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQkJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInLCciIicpDQoJCQkJCQkjd3JpdGUobG9nLFsnSW5kaWNlOicsJ21vZGU6Jyxtb2RlLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmcsJ21hZ2ljOicsbWFnaWNdLG4pDQoJCQkJCQkjcHJpbnQgRW5jb2RpbmcNCgkJCQkJCWlmIEVuY29kaW5nPT0ndmFyaW50JzoNCgkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkrb3Muc2VwKyJtb2RlbF9maWxlLmJpbiINCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6cGF0aD1vcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpK29zLnNlcCsibW9kZWxfZmlsZS5iaW4iDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOnBhdGg9b3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKStvcy5zZXArdmFsdWVzWyciRmlsZSInXS5zcGxpdCgnIicpWzFdIysnLnR4dCcNCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZToNCgkJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJbWFnaWMsaW5kaWNlTGlzdD1nZXRJbmRpY2VzKEl0ZW1TaXplLFNpemUsT2Zmc2V0LHR5cGUsZyxtb2RlLG1hZ2ljKQ0KCQkJCQkJCQlpbmRpY2VBcnJheS5hcHBlbmQoW2luZGljZUxpc3QsbW9kZV0pDQoJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCQkJZWxzZToNCgkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkrb3Muc2VwKyJtb2RlbF9maWxlLmJpbiINCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6cGF0aD1vcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpK29zLnNlcCsibW9kZWxfZmlsZS5iaW4iDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOnBhdGg9b3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKStvcy5zZXArdmFsdWVzWyciRmlsZSInXS5zcGxpdCgnIicpWzFdIysnLnR4dCcNCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZToNCgkJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJZy5zZWVrKE9mZnNldCkNCgkJCQkJCQkJaW5kaWNlTGlzdD1nLkgoSXRlbVNpemUqU2l6ZSkNCgkJCQkJCQkJaW5kaWNlQXJyYXkuYXBwZW5kKFtpbmRpY2VMaXN0LG1vZGVdKQ0KCQkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCSNlbHNlOg0KCQkJIwlwcmludCAnTElORVMnDQoJCQkNCgkJaWYgJyJEcmF3RWxlbWVudHNVQnl0ZSInIGluIGIuaGVhZGVyOgkJCQ0KCQkJdmFsdWVzPXlzLnZhbHVlcyhiLmRhdGEsJzonKQ0KCQkJbW9kZT12YWx1ZXNbJyJNb2RlIiddCQkJDQoJCQlTaXplPU5vbmUNCgkJCU9mZnNldD1Ob25lDQoJCQlFbmNvZGluZz1Ob25lDQoJCQlJdGVtU2l6ZT1Ob25lDQoJCQl0eXBlPU5vbmUNCgkJCWlmIG1vZGUhPSciTElORVMiJzoNCgkJCQlJbmRpY2VzPXlzLmdldChiLCciSW5kaWNlcyInKQ0KCQkJCWlmIEluZGljZXM6DQoJCQkJCXZhbHVlcz15cy52YWx1ZXMoSW5kaWNlc1swXS5kYXRhLCc6JykNCgkJCQkJSXRlbVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJywnaScpDQoJCQkJCVVpbnQ4QXJyYXk9eXMuZ2V0KEluZGljZXNbMF0sJyJVaW50OEFycmF5IicpDQoJCQkJCXR5cGU9IlVpbnQ4QXJyYXkiDQoJCQkJCSNwcmludCAiRHJhd0VsZW1lbnRzVUJ5dGUiLHR5cGUNCgkJCQkJaWYgVWludDhBcnJheToNCgkJCQkJCXZhbHVlcz15cy52YWx1ZXMoVWludDhBcnJheVswXS5kYXRhLCc6JykNCgkJCQkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCQkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQkJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInLCciIicpDQoJCQkJCQkjd3JpdGUobG9nLFsnSW5kaWNlOicsJ21vZGU6Jyxtb2RlLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmcsJ21hZ2ljOicsbWFnaWNdLG4pDQoJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkrb3Muc2VwKyJtb2RlbF9maWxlLmJpbiINCgkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1GYWxzZTpwYXRoPW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkrb3Muc2VwKyJtb2RlbF9maWxlLmJpbiINCgkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1GYWxzZTpwYXRoPW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkrb3Muc2VwK3ZhbHVlc1snIkZpbGUiJ10uc3BsaXQoJyInKVsxXSMrJy50eHQnDQoJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZToNCgkJCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJbWFnaWMsaW5kaWNlTGlzdD1nZXRJbmRpY2VzKEl0ZW1TaXplLFNpemUsT2Zmc2V0LHR5cGUsZyxtb2RlLG1hZ2ljKQ0KCQkJCQkJCWluZGljZUFycmF5LmFwcGVuZChbaW5kaWNlTGlzdCxtb2RlXSkNCgkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCSNlbHNlOg0KCQkJIwlwcmludCAnTElORVMnDQoJCQkJDQoJcmV0dXJuIGluZGljZUFycmF5DQoJDQoJDQoJCQkNCmRlZiBCb25lcyh5cyxiKToNCgluPTIwDQoJYm9uZXM9W10NCgl2YWx1ZXM9eXMudmFsdWVzKGIuZGF0YSwnOicpDQoJSXRlbVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJywnaScpDQoJVWludDE2QXJyYXk9eXMuZ2V0KGIsJyJVaW50MTZBcnJheSInKQ0KCWlmIFVpbnQxNkFycmF5Og0KCQl0eXBlPSJVaW50MTZBcnJheSINCgkJdmFsdWVzPXlzLnZhbHVlcyhVaW50MTZBcnJheVswXS5kYXRhLCc6JykNCgkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicsJyIiJykNCgkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicsJ2knKQ0KCQlPZmZzZXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicsJ2knKQ0KCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInLCciIicpDQoJCQ0KCQlpZiBFbmNvZGluZz09J3ZhcmludCc6CQkJCQkJDQoJCQlwYXRoPWdldFBhdGgoRmlsZSkNCgkJCWlmIHBhdGg6DQoJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCWxpc3Q9ZGVjb2RlVmFyaW50KGcsT2Zmc2V0LFNpemUqSXRlbVNpemUsdHlwZSkNCgkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJYm9uZXMuYXBwZW5kKGxpc3RbbSpJdGVtU2l6ZTptKkl0ZW1TaXplK0l0ZW1TaXplXSkNCgkJCQlmaWxlLmNsb3NlKCkNCglyZXR1cm4gYm9uZXMJCQ0KCQkJDQpkZWYgV2VpZ2h0cyh5cyxiKToNCgluPTIwDQoJd2VpZ2h0cz1bXQ0KCXZhbHVlcz15cy52YWx1ZXMoYi5kYXRhLCc6JykNCglJdGVtU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJJdGVtU2l6ZSInLCdpJykNCglGbG9hdDMyQXJyYXk9eXMuZ2V0KGIsJyJGbG9hdDMyQXJyYXkiJykNCglpZiBGbG9hdDMyQXJyYXk6DQoJCXZhbHVlcz15cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJywnIiInKQ0KCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJywnaScpDQoJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCUVuY29kaW5nPXlzLmdldFZhbHVlKHZhbHVlcywnIkVuY29kaW5nIicsJyIiJykNCgkJDQoJCWlmIEVuY29kaW5nPT0ndmFyaW50JzoJCQkJCQ0KCQkJcGF0aD1nZXRQYXRoKEZpbGUpDQoJCQlpZiBwYXRoOg0KCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQlsaXN0PWRlY29kZVZhcmludChnLE9mZnNldCxTaXplKkl0ZW1TaXplLHR5cGUpDQoJCQkJZmlsZS5jbG9zZSgpDQoJCWVsc2U6CQkJCQkNCgkJCXBhdGg9Z2V0UGF0aChGaWxlKQ0KCQkJaWYgcGF0aDoNCgkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJZy5zZWVrKE9mZnNldCkNCgkJCQlsaXN0PWcuZihTaXplKkl0ZW1TaXplKQ0KCQkJCWZvciBtIGluIHJhbmdlKFNpemUpOg0KCQkJCQl3ZWlnaHRzLmFwcGVuZChsaXN0W20qSXRlbVNpemU6bSpJdGVtU2l6ZStJdGVtU2l6ZV0pDQoJCQkJZmlsZS5jbG9zZSgpDQoJcmV0dXJuIHdlaWdodHMJDQoJDQpkZWYgQm9uZU1hcCh5cyxiKToJDQoJQm9uZU1hcD17fQ0KCXZhbHVlcz15cy52YWx1ZXMoYi5kYXRhLCc6JykNCglmb3IgdmFsdWUgaW4gdmFsdWVzOg0KCQlpZD15cy5nZXRWYWx1ZSh2YWx1ZXMsdmFsdWUsJ2knKQ0KCQluYW1lPXZhbHVlLnJlcGxhY2UoJyInLCAnJykNCgkJQm9uZU1hcFtuYW1lXT1pZA0KCXJldHVybiBCb25lTWFwCQ0KCQkNCgkJDQpkZWYgb3NnQW5pbWF0aW9uUmlnR2VvbWV0cnkoeXMscGFyZW50TmV3Tm9kZSk6DQoNCgltZXNoPU1lc2goKQ0KCW1lc2gudmVydGV4QXJyYXk9W10NCgltZXNoLmluZGljZUFycmF5PVtdDQoJbWVzaC5UZXhDb29yZDBBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQxQXJyYXk9W10NCgltZXNoLlRleENvb3JkM0FycmF5PVtdDQoJbWVzaC5UZXhDb29yZDVBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQ2QXJyYXk9W10NCgltZXNoLmNvbG9yQXJyYXk9W10NCgltZXNoLm5vcm1hbEFycmF5PVtdDQoJbWVzaC5tb3JwaEFycmF5PXt9DQoJbWVzaC5Cb25lcz1bXQ0KCW1lc2guV2VpZ2h0cz1bXQ0KCW1lc2guQm9uZU1hcD17fQ0KCW1lc2guYXRyaWJ1dGVzPXt9DQoJbWVzaC5wYXJlbnROb2RlPXBhcmVudE5ld05vZGUubm9kZQ0KCWZvciBjaGlsZCBpbiBwYXJlbnROZXdOb2RlLmNoaWxkcmVuOg0KCQkjd3JpdGUobG9nLFtjaGlsZC5ub2RlLmhlYWRlcl0sNCkNCgkJaWYgJyJTb3VyY2VHZW9tZXRyeSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCSN3cml0ZShsb2csW2NoaWxkLm5vZGUuaGVhZGVyXSw4KQ0KCQkJCWlmICcib3NnQW5pbWF0aW9uLk1vcnBoR2VvbWV0cnkiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCQkJI3dyaXRlKGxvZyxbY2hpbGQubm9kZS5oZWFkZXJdLDEyKQ0KCQkJCQkJaWYgJyJWZXJ0ZXhBdHRyaWJ1dGVMaXN0IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCQkJCQlpZiAnIlZlcnRleCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJbWVzaC52ZXJ0ZXhBcnJheT1WZXJ0ZXgoeXMsY2hpbGQubm9kZSkNCgkJCQkJCQkJCXByaW50ICJUcmlhbmdsZXM6ICIgKyBzdHIobGVuKG1lc2gudmVydGV4QXJyYXkpKQ0KCQkJCQkJCQkJc3lzMi5zdGRvdXQuZmx1c2goKQ0KCQkJCQkJCQlpZiAnIk5vcm1hbCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJbWVzaC5ub3JtYWxBcnJheT1WZXJ0ZXhOb3JtYWwoeXMsY2hpbGQubm9kZSkNCgkJCQkJCQkJaWYgJyJUZXhDb29yZDAiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2guVGV4Q29vcmQwQXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQkJCQkJaWYgJyJUZXhDb29yZDEiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2guVGV4Q29vcmQxQXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQkJCQkJaWYgJyJUZXhDb29yZDMiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2guVGV4Q29vcmQzQXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQkJCQkJaWYgJyJUZXhDb29yZDUiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2guVGV4Q29vcmQ1QXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQkJCQkJaWYgJyJUZXhDb29yZDYiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2guVGV4Q29vcmQ2QXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQkJCQkJaWYgJyJDb2xvciInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJbWVzaC5jb2xvckFycmF5PUNvbG9yKHlzLGNoaWxkLm5vZGUpDQoJCQkJCQlpZiAnIlByaW1pdGl2ZVNldExpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQltZXNoLmluZGljZUFycmF5PVByaW1pdGl2ZVNldExpc3QoeXMsY2hpbGQpDQoJCQkJCQlpZiAnIlVzZXJEYXRhQ29udGFpbmVyIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJbWVzaC5hdHJpYnV0ZXM9VXNlckRhdGFDb250YWluZXIoeXMsY2hpbGQpDQoJCQkJCQlpZiAnIk1vcnBoVGFyZ2V0cyInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCXByaW50ICJNb3JwaFRhcmdldHMiDQoJCQkJCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCQkJCQkjd3JpdGUobG9nLFtjaGlsZC5ub2RlLmhlYWRlcl0sMTYpDQoJCQkJCQkJCWlmICcib3NnLkdlb21ldHJ5IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQlOYW1lPU5vbmUNCgkJCQkJCQkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQkJCQkJCQkjd3JpdGUobG9nLFtjaGlsZC5ub2RlLmhlYWRlcl0sMjApCQkJCQkJCQkJCQ0KCQkJCQkJCQkJCWlmICciVmVydGV4QXR0cmlidXRlTGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJCQkJCQkJCQlpZiAnIlZlcnRleCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJCQkJCWlmIE5hbWU6DQoJCQkJCQkJCQkJCQkJCW1lc2gubW9ycGhBcnJheVtOYW1lXT1WZXJ0ZXgoeXMsY2hpbGQubm9kZSkJCQkJCQkJCQkJDQoJCQkJCQkJCQkJaWYgJyJVbmlxdWVJRCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGNoaWxkLm5vZGUuaGVhZGVyLCc6JykNCgkJCQkJCQkJCQkJVW5pcXVlSUQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciVW5pcXVlSUQiJywnaScpDQoJCQkJCQkJCQkJCU5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciTmFtZSInLCciIicpDQoJCQkJCQkJCQkJCSN3cml0ZShsb2csW1VuaXF1ZUlELE5hbWVdLDI0KQ0KCQkJCWlmICcib3NnLkdlb21ldHJ5IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQkJCWlmICciVmVydGV4QXR0cmlidXRlTGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQkJCQkJaWYgJyJWZXJ0ZXgiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2gudmVydGV4QXJyYXk9VmVydGV4KHlzLGNoaWxkLm5vZGUpDQoJCQkJCQkJCQlwcmludCAiVHJpYW5nbGVzOiAiICsgc3RyKGxlbihtZXNoLnZlcnRleEFycmF5KSkNCgkJCQkJCQkJCXN5czIuc3Rkb3V0LmZsdXNoKCkNCgkJCQkJCQkJaWYgJyJOb3JtYWwiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2gubm9ybWFsQXJyYXk9VmVydGV4Tm9ybWFsKHlzLGNoaWxkLm5vZGUpDQoJCQkJCQkJCWlmICciVGV4Q29vcmQwIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQltZXNoLlRleENvb3JkMEFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJCQkJCWlmICciVGV4Q29vcmQxIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQltZXNoLlRleENvb3JkMUFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJCQkJCWlmICciVGV4Q29vcmQzIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQltZXNoLlRleENvb3JkM0FycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJCQkJCWlmICciVGV4Q29vcmQ1IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQltZXNoLlRleENvb3JkNUFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJCQkJCWlmICciVGV4Q29vcmQ2IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQltZXNoLlRleENvb3JkNkFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJCQkJCWlmICciQ29sb3IiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2guY29sb3JBcnJheT1Db2xvcih5cyxjaGlsZC5ub2RlKQ0KCQkJCQkJaWYgJyJQcmltaXRpdmVTZXRMaXN0IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJbWVzaC5pbmRpY2VBcnJheT1QcmltaXRpdmVTZXRMaXN0KHlzLGNoaWxkKQ0KCQkJCQkJaWYgJyJVc2VyRGF0YUNvbnRhaW5lciInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCW1lc2guYXRyaWJ1dGVzPVVzZXJEYXRhQ29udGFpbmVyKHlzLGNoaWxkKQ0KCQkJCQkJCQkNCgkJCQkJCQkJDQoJCWlmICciVmVydGV4QXR0cmlidXRlTGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCWlmICciQm9uZXMiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5Cb25lcz1Cb25lcyh5cyxjaGlsZC5ub2RlKQ0KCQkJCWlmICciV2VpZ2h0cyInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLldlaWdodHM9V2VpZ2h0cyh5cyxjaGlsZC5ub2RlKQ0KCQlpZiAnIkJvbmVNYXAiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCW1lc2guQm9uZU1hcD1Cb25lTWFwKHlzLGNoaWxkLm5vZGUpDQoJCQkJDQoJcmV0dXJuIG1lc2gJDQoJDQpkZWYgb3NnR2VvbWV0cnkoeXMscGFyZW50TmV3Tm9kZSk6DQoNCgltZXNoPU1lc2goKQ0KCW1lc2gudmVydGV4QXJyYXk9W10NCgltZXNoLmluZGljZUFycmF5PVtdDQoJbWVzaC5UZXhDb29yZDBBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQxQXJyYXk9W10NCgltZXNoLlRleENvb3JkM0FycmF5PVtdDQoJbWVzaC5UZXhDb29yZDVBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQ2QXJyYXk9W10NCgltZXNoLmNvbG9yQXJyYXk9W10NCgltZXNoLm5vcm1hbEFycmF5PVtdDQoJbWVzaC5tb3JwaEFycmF5PXt9DQoJbWVzaC5Cb25lcz1bXQ0KCW1lc2guV2VpZ2h0cz1bXQ0KCW1lc2guQm9uZU1hcD17fQ0KCW1lc2guYXRyaWJ1dGVzPXt9DQoJbWVzaC5wYXJlbnROb2RlPXBhcmVudE5ld05vZGUubm9kZQ0KCWZvciBjaGlsZCBpbiBwYXJlbnROZXdOb2RlLmNoaWxkcmVuOg0KCQkjd3JpdGUobG9nLFtjaGlsZC5ub2RlLmhlYWRlcl0sNCkNCgkJaWYgJyJWZXJ0ZXhBdHRyaWJ1dGVMaXN0IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJI3dyaXRlKGxvZyxbY2hpbGQubm9kZS5oZWFkZXJdLDgpDQoJCQkJaWYgJyJWZXJ0ZXgiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC52ZXJ0ZXhBcnJheT1WZXJ0ZXgoeXMsY2hpbGQubm9kZSkNCgkJCQkJcHJpbnQgIlRyaWFuZ2xlczogIiArIHN0cihsZW4obWVzaC52ZXJ0ZXhBcnJheSkpDQoJCQkJCXN5czIuc3Rkb3V0LmZsdXNoKCkNCgkJCQlpZiAnIk5vcm1hbCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLm5vcm1hbEFycmF5PVZlcnRleE5vcm1hbCh5cyxjaGlsZC5ub2RlKQ0KCQkJCWlmICciVGV4Q29vcmQwIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2guVGV4Q29vcmQwQXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQlpZiAnIlRleENvb3JkMSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLlRleENvb3JkMUFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJaWYgJyJUZXhDb29yZDMiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5UZXhDb29yZDNBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCWlmICciVGV4Q29vcmQ1IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2guVGV4Q29vcmQ1QXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQlpZiAnIlRleENvb3JkNiInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLlRleENvb3JkNkFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJaWYgJyJDb2xvciInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLmNvbG9yQXJyYXk9Q29sb3IoeXMsY2hpbGQubm9kZSkNCgkJaWYgJyJQcmltaXRpdmVTZXRMaXN0IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQltZXNoLmluZGljZUFycmF5PVByaW1pdGl2ZVNldExpc3QoeXMsY2hpbGQpDQoJCWlmICciVXNlckRhdGFDb250YWluZXIiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCW1lc2guYXRyaWJ1dGVzPVVzZXJEYXRhQ29udGFpbmVyKHlzLGNoaWxkKQ0KCXJldHVybiBtZXNoCQkNCgkNCgkNCmRlZiBvc2dBbmltYXRpb25Nb3JwaEdlb21ldHJ5KHlzLHBhcmVudE5ld05vZGUpOg0KDQoJbWVzaD1NZXNoKCkNCgltZXNoLnZlcnRleEFycmF5PVtdDQoJbWVzaC5pbmRpY2VBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQwQXJyYXk9W10NCgltZXNoLlRleENvb3JkMUFycmF5PVtdDQoJbWVzaC5UZXhDb29yZDNBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQ1QXJyYXk9W10NCgltZXNoLlRleENvb3JkNkFycmF5PVtdDQoJbWVzaC5jb2xvckFycmF5PVtdDQoJbWVzaC5ub3JtYWxBcnJheT1bXQ0KCW1lc2gubW9ycGhBcnJheT17fQ0KCW1lc2guQm9uZXM9W10NCgltZXNoLldlaWdodHM9W10NCgltZXNoLkJvbmVNYXA9e30NCgltZXNoLmF0cmlidXRlcz17fQ0KCW1lc2gucGFyZW50Tm9kZT1wYXJlbnROZXdOb2RlLm5vZGUNCglmb3IgY2hpbGQgaW4gcGFyZW50TmV3Tm9kZS5jaGlsZHJlbjoNCgkJaWYgJyJNb3JwaFRhcmdldHMiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCXByaW50ICJNb3JwaFRhcmdldHMiDQoJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJI3dyaXRlKGxvZyxbY2hpbGQubm9kZS5oZWFkZXJdLDE2KQ0KCQkJCWlmICcib3NnLkdlb21ldHJ5IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCU5hbWU9Tm9uZQ0KCQkJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJCQkjd3JpdGUobG9nLFtjaGlsZC5ub2RlLmhlYWRlcl0sMjApCQkJCQkJCQkJCQ0KCQkJCQkJaWYgJyJWZXJ0ZXhBdHRyaWJ1dGVMaXN0IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCQkJCQlpZiAnIlZlcnRleCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJaWYgTmFtZToNCgkJCQkJCQkJCQltZXNoLm1vcnBoQXJyYXlbTmFtZV09VmVydGV4KHlzLGNoaWxkLm5vZGUpCQkJCQkJCQkJCQ0KCQkJCQkJaWYgJyJVbmlxdWVJRCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoY2hpbGQubm9kZS5oZWFkZXIsJzonKQ0KCQkJCQkJCVVuaXF1ZUlEPXlzLmdldFZhbHVlKHZhbHVlcywnIlVuaXF1ZUlEIicsJ2knKQ0KCQkJCQkJCU5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciTmFtZSInLCciIicpDQoJCQkJCQkJI3dyaXRlKGxvZyxbVW5pcXVlSUQsTmFtZV0sMjQpDQoJCWlmICciVmVydGV4QXR0cmlidXRlTGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCSNwcmludCBjaGlsZC5ub2RlLmhlYWRlcg0KCQkJCWlmICciVmVydGV4IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2gudmVydGV4QXJyYXk9VmVydGV4KHlzLGNoaWxkLm5vZGUpDQoJCQkJCXByaW50ICJUcmlhbmdsZXM6ICIgKyBzdHIobGVuKG1lc2gudmVydGV4QXJyYXkpKQ0KCQkJCQlzeXMyLnN0ZG91dC5mbHVzaCgpDQoJCQkJaWYgJyJOb3JtYWwiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5ub3JtYWxBcnJheT1WZXJ0ZXhOb3JtYWwoeXMsY2hpbGQubm9kZSkNCgkJCQlpZiAnIlRleENvb3JkMCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLlRleENvb3JkMEFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJaWYgJyJUZXhDb29yZDEiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5UZXhDb29yZDFBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCWlmICciVGV4Q29vcmQzIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2guVGV4Q29vcmQzQXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQlpZiAnIlRleENvb3JkNSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLlRleENvb3JkNUFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJaWYgJyJUZXhDb29yZDYiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5UZXhDb29yZDZBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCWlmICciQ29sb3IiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5jb2xvckFycmF5PUNvbG9yKHlzLGNoaWxkLm5vZGUpDQoJCWlmICciUHJpbWl0aXZlU2V0TGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJbWVzaC5pbmRpY2VBcnJheT1QcmltaXRpdmVTZXRMaXN0KHlzLGNoaWxkKQ0KCQlpZiAnIlVzZXJEYXRhQ29udGFpbmVyIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQltZXNoLmF0cmlidXRlcz1Vc2VyRGF0YUNvbnRhaW5lcih5cyxjaGlsZCkNCgkJCQkJCQkJDQoJCQkJCQkNCgkJCQkNCglyZXR1cm4gbWVzaAkNCgkJDQoJCQ0KZGVmIGRyYXdNZXNoKHlzLG1lc2gpOgkNCglkaWZmdXNlPU5vbmUJCQ0KCW5vcm1hbD1Ob25lCQ0KCXNwZWN1bGFyPU5vbmUNCgl0cmFucz1Ob25lCQ0KCWFvPU5vbmUNCglyZ2JDb2w9Tm9uZQ0KCXJnYlNwZWM9Tm9uZQ0KCXJnYmE9Tm9uZQkNCgltb2RlPU5vbmUJDQoNCg0KDQoJbWF0TmFtZSxkaWZmdXNlLHNwZWN1bGFyLG5vcm1hbCxhbyx0cmFucyxyZ2JDb2wscmdiU3BlYyxyZ2JhPWdldE1hdE5hbWUoeXMsbWVzaC5wYXJlbnROb2RlKQ0KCSNwcmludCAnbWF0TmFtZTonLG1hdE5hbWUsZGlmZnVzZQ0KCXRyeToNCgkJaWYgbGVuKG1lc2gubm9ybWFsQXJyYXkpID09IDE6DQoJCQlpZiBtZXNoLm5vcm1hbEFycmF5WzBdWzFdID09ICcidmFyaW50Iic6DQoJCQkJYnl0ZXMgPSBtZXNoLm5vcm1hbEFycmF5WzBdWzBdDQoJCQkJSXRlbVNpemUgPSBtZXNoLm5vcm1hbEFycmF5WzBdWzJdDQoJCQkJZXBzID0gZmxvYXQobWVzaC5hdHJpYnV0ZXNbImVwc2lsb24iXSkNCgkJCQlucGhpID0gZmxvYXQobWVzaC5hdHJpYnV0ZXNbIm5waGkiXSkNCgkJCQlzaXplID0gbGVuKGJ5dGVzKSAvIEl0ZW1TaXplDQoJCQkJaW50cyA9IGJ5dGVzDQoJCQkJZ2xvYmFsIG1vZGVsSUQNCgkJCQkNCgkJCQlpZiBvcy5wYXRoLmV4aXN0cygibW9kZWxEYXRhLmpzIik6DQoJCQkJCW9zLnJlbW92ZSgibW9kZWxEYXRhLmpzIikNCgkJCQlpZiBvcy5wYXRoLmV4aXN0cygibm9ybWFscy5kYXQiKToNCgkJCQkJb3MucmVtb3ZlKCJub3JtYWxzLmRhdCIpDQoJCQkJd2l0aCBvcGVuKCJtb2RlbERhdGEuanMiLCAiYSIpIGFzIG1vZGVsRGF0YToNCgkJCQkJbW9kZWxJRCArPSAxDQoJCQkJCW1vZGVsRGF0YS53cml0ZSgibW9kdWxlLmV4cG9ydHMuZXBzID0gIiArIHN0cihlcHMpICsgIjtcbiIpDQoJCQkJCW1vZGVsRGF0YS53cml0ZSgibW9kdWxlLmV4cG9ydHMubnBoaSA9ICIgKyBzdHIobnBoaSkgKyAiO1xuIikNCgkJCQkJbW9kZWxEYXRhLndyaXRlKCJtb2R1bGUuZXhwb3J0cy5zaXplID0gIiArIHN0cihzaXplKSArICI7XG4iKQ0KCQkJCQltb2RlbERhdGEud3JpdGUoIm1vZHVsZS5leHBvcnRzLmlkID0gIiArIHN0cihtb2RlbElEKSArICI7XG4iKQ0KCQkJCQltb2RlbERhdGEud3JpdGUoIm1vZHVsZS5leHBvcnRzLmludHMgPSAiICsgc3RyKGJ5dGVzKSArICI7XG4iKQ0KCQkJCQ0KCQkJCXN1YnByb2Nlc3MuY2FsbCgoJ25vZGUuZXhlIC4ve3RlbXBQYXRofS9jYWxjVmVydGV4Tm9ybWFscy5qcycpKQ0KCWV4Y2VwdDoNCgkJcGFzcw0KCQ0KCWlmIGxlbihtZXNoLmluZGljZUFycmF5KT4wOg0KCQlmb3IgW2luZGljZXMsbW9kZV0gaW4gbWVzaC5pbmRpY2VBcnJheToNCgkJCW1hdD1NYXQoKQ0KCQkJbWF0Lm1hdE5hbWU9bWF0TmFtZQ0KCQkJbWF0LnJnYkNvbD1yZ2JDb2wNCgkJCW1hdC5kaWZmdXNlPWRpZmZ1c2UNCgkJCW1hdC5ub3JtYWw9bm9ybWFsDQoJCQltYXQuc3BlY3VsYXI9c3BlY3VsYXINCgkJCW1hdC50cmFucz10cmFucw0KCQkJaWYgdHJhbnM6DQoJCQkJbWF0LlpUUkFOUz1UcnVlDQoJCQkjbWF0LmFvPWFvDQoJCQlpZiByZ2JhOm1hdC5yZ2JhPXJnYmENCgkJCW1lc2gubWF0TGlzdC5hcHBlbmQobWF0KQ0KCQkJbWF0LklEU3RhcnQ9bGVuKG1lc2guaW5kaWNlTGlzdCkNCgkJCW1hdC5JRENvdW50PWxlbihpbmRpY2VzKQ0KCQkJbWVzaC5pbmRpY2VMaXN0LmV4dGVuZChpbmRpY2VzKQ0KCQkJaWYgbW9kZT09JyJUUklBTkdMRV9TVFJJUCInOm1hdC5UUklTVFJJUD1UcnVlDQoJCQlpZiBtb2RlPT0nIlRSSUFOR0xFUyInOm1hdC5UUklBTkdMRT1UcnVlDQoJCQkNCgkJaW5kaWNlcz1tZXNoLmluZGljZUFycmF5WzBdWzBdDQoJCW1vZGU9bWVzaC5pbmRpY2VBcnJheVswXVsxXQkJDQoJaWYgbGVuKG1lc2gudmVydGV4QXJyYXkpPT0xOg0KCQlpZiBtZXNoLnZlcnRleEFycmF5WzBdWzFdPT0nInZhcmludCInOg0KCQkJaWYgbW9kZToNCgkJCQlieXRlcz1tZXNoLnZlcnRleEFycmF5WzBdWzBdCQkJCQ0KCQkJCUl0ZW1TaXplPW1lc2gudmVydGV4QXJyYXlbMF1bMl0NCgkJCQlpZiBtb2RlPT0nIlRSSUFOR0xFX1NUUklQIic6DQoJCQkJCWJ5dGVzPWRlY29kZVByZWRpY3QoaW5kaWNlcyxieXRlcyxJdGVtU2l6ZSkNCgkJCQlzMT1mbG9hdChtZXNoLmF0cmlidXRlc1sndnR4X2JibF94J10pDQoJCQkJczI9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3Z0eF9iYmxfeSddKQ0KCQkJCXMzPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd2dHhfYmJsX3onXSkNCgkJCQlzPVtzMSxzMixzM10JCQkNCgkJCQlhMT1mbG9hdChtZXNoLmF0cmlidXRlc1sndnR4X2hfeCddKQ0KCQkJCWEyPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd2dHhfaF95J10pDQoJCQkJYTM9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3Z0eF9oX3onXSkNCgkJCQlhPVthMSxhMixhM10NCgkJCQlmbG9hdHM9ZGVjb2RlUXVhbnRpemUoYnl0ZXMscyxhLEl0ZW1TaXplKQ0KCQkJCW1lc2gudmVydFBvc0xpc3Q9W2Zsb2F0c1ttOm0rSXRlbVNpemVdZm9yIG0gaW4gcmFuZ2UoMCxsZW4oZmxvYXRzKSwzKV0NCgkJCQkjcHJpbnQgbWVzaC52ZXJ0UG9zTGlzdA0KCQkJCSNtZXNoLmluZGkNCgkJCQkjbWVzaC5kcmF3KCkNCgkJZWxzZToNCgkJCWxpc3Q9bWVzaC52ZXJ0ZXhBcnJheVswXVswXQ0KCQkJbWVzaC52ZXJ0UG9zTGlzdD1saXN0DQoJCQkNCglpZiBsZW4obWVzaC5UZXhDb29yZDBBcnJheSk9PTE6DQoJCWlmIG1lc2guVGV4Q29vcmQwQXJyYXlbMF1bMV09PScidmFyaW50Iic6DQoJCQlpZiBtb2RlOg0KCQkJCWJ5dGVzPW1lc2guVGV4Q29vcmQwQXJyYXlbMF1bMF0JCQkJDQoJCQkJSXRlbVNpemU9bWVzaC5UZXhDb29yZDBBcnJheVswXVsyXQ0KCQkJCWlmIG1vZGU9PSciVFJJQU5HTEVfU1RSSVAiJzoNCgkJCQkJYnl0ZXM9ZGVjb2RlUHJlZGljdChpbmRpY2VzLGJ5dGVzLEl0ZW1TaXplKQ0KCQkJCXMxPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8wX2JibF94J10pDQoJCQkJczI9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzBfYmJsX3knXSkNCgkJCQlzPVtzMSxzMl0JCQkNCgkJCQlhMT1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfMF9oX3gnXSkNCgkJCQlhMj1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfMF9oX3knXSkNCgkJCQlhPVthMSxhMl0NCgkJCQlmbG9hdHM9ZGVjb2RlUXVhbnRpemUoYnl0ZXMscyxhLEl0ZW1TaXplKQ0KCQkJCWZvciBtIGluIHJhbmdlKDAsbGVuKGZsb2F0cyksSXRlbVNpemUpOg0KCQkJCQl1LHY9ZmxvYXRzW206bStJdGVtU2l6ZV0NCgkJCQkJbWVzaC52ZXJ0VVZMaXN0LmFwcGVuZChbdSwxLXZdKQ0KCQllbHNlOg0KCQkJbGlzdD1tZXNoLlRleENvb3JkMEFycmF5WzBdWzBdDQoJCQltZXNoLnZlcnRVVkxpc3Q9bGlzdA0KCWVsaWYgbGVuKG1lc2guVGV4Q29vcmQxQXJyYXkpPT0xOg0KCQlpZiBtZXNoLlRleENvb3JkMUFycmF5WzBdWzFdPT0nInZhcmludCInOg0KCQkJaWYgbW9kZToNCgkJCQlieXRlcz1tZXNoLlRleENvb3JkMUFycmF5WzBdWzBdCQkJCQ0KCQkJCUl0ZW1TaXplPW1lc2guVGV4Q29vcmQxQXJyYXlbMF1bMl0NCgkJCQlpZiBtb2RlPT0nIlRSSUFOR0xFX1NUUklQIic6DQoJCQkJCWJ5dGVzPWRlY29kZVByZWRpY3QoaW5kaWNlcyxieXRlcyxJdGVtU2l6ZSkNCgkJCQlzMT1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfMV9iYmxfeCddKQ0KCQkJCXMyPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8xX2JibF95J10pDQoJCQkJcz1bczEsczJdCQkJDQoJCQkJYTE9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzFfaF94J10pDQoJCQkJYTI9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzFfaF95J10pDQoJCQkJYT1bYTEsYTJdDQoJCQkJZmxvYXRzPWRlY29kZVF1YW50aXplKGJ5dGVzLHMsYSxJdGVtU2l6ZSkNCgkJCQlmb3IgbSBpbiByYW5nZSgwLGxlbihmbG9hdHMpLEl0ZW1TaXplKToNCgkJCQkJdSx2PWZsb2F0c1ttOm0rSXRlbVNpemVdDQoJCQkJCW1lc2gudmVydFVWTGlzdC5hcHBlbmQoW3UsMS12XSkNCgkJZWxzZToNCgkJCWxpc3Q9bWVzaC5UZXhDb29yZDFBcnJheVswXVswXQ0KCQkJbWVzaC52ZXJ0VVZMaXN0PWxpc3QNCgllbGlmIGxlbihtZXNoLlRleENvb3JkM0FycmF5KT09MToNCgkJaWYgbWVzaC5UZXhDb29yZDNBcnJheVswXVsxXT09JyJ2YXJpbnQiJzoNCgkJCWlmIG1vZGU6DQoJCQkJYnl0ZXM9bWVzaC5UZXhDb29yZDNBcnJheVswXVswXQkJCQkNCgkJCQlJdGVtU2l6ZT1tZXNoLlRleENvb3JkM0FycmF5WzBdWzJdDQoJCQkJaWYgbW9kZT09JyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcz1kZWNvZGVQcmVkaWN0KGluZGljZXMsYnl0ZXMsSXRlbVNpemUpDQoJCQkJczE9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzNfYmJsX3gnXSkNCgkJCQlzMj1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfM19iYmxfeSddKQ0KCQkJCXM9W3MxLHMyXQkJCQ0KCQkJCWExPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8zX2hfeCddKQ0KCQkJCWEyPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8zX2hfeSddKQ0KCQkJCWE9W2ExLGEyXQ0KCQkJCWZsb2F0cz1kZWNvZGVRdWFudGl6ZShieXRlcyxzLGEsSXRlbVNpemUpDQoJCQkJZm9yIG0gaW4gcmFuZ2UoMCxsZW4oZmxvYXRzKSxJdGVtU2l6ZSk6DQoJCQkJCXUsdj1mbG9hdHNbbTptK0l0ZW1TaXplXQ0KCQkJCQltZXNoLnZlcnRVVkxpc3QuYXBwZW5kKFt1LDEtdl0pDQoJCWVsc2U6DQoJCQlsaXN0PW1lc2guVGV4Q29vcmQzQXJyYXlbMF1bMF0NCgkJCW1lc2gudmVydFVWTGlzdD1saXN0DQoJZWxpZiBsZW4obWVzaC5UZXhDb29yZDVBcnJheSk9PTE6DQoJCWlmIG1lc2guVGV4Q29vcmQ1QXJyYXlbMF1bMV09PScidmFyaW50Iic6DQoJCQlpZiBtb2RlOg0KCQkJCWJ5dGVzPW1lc2guVGV4Q29vcmQ1QXJyYXlbMF1bMF0JCQkJDQoJCQkJSXRlbVNpemU9bWVzaC5UZXhDb29yZDVBcnJheVswXVsyXQ0KCQkJCWlmIG1vZGU9PSciVFJJQU5HTEVfU1RSSVAiJzoNCgkJCQkJYnl0ZXM9ZGVjb2RlUHJlZGljdChpbmRpY2VzLGJ5dGVzLEl0ZW1TaXplKQ0KCQkJCXMxPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl81X2JibF94J10pDQoJCQkJczI9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzVfYmJsX3knXSkNCgkJCQlzPVtzMSxzMl0JCQkNCgkJCQlhMT1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfNV9oX3gnXSkNCgkJCQlhMj1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfNV9oX3knXSkNCgkJCQlhPVthMSxhMl0NCgkJCQlmbG9hdHM9ZGVjb2RlUXVhbnRpemUoYnl0ZXMscyxhLEl0ZW1TaXplKQ0KCQkJCWZvciBtIGluIHJhbmdlKDAsbGVuKGZsb2F0cyksSXRlbVNpemUpOg0KCQkJCQl1LHY9ZmxvYXRzW206bStJdGVtU2l6ZV0NCgkJCQkJbWVzaC52ZXJ0VVZMaXN0LmFwcGVuZChbdSwxLXZdKQ0KCQllbHNlOg0KCQkJbGlzdD1tZXNoLlRleENvb3JkNUFycmF5WzBdWzBdDQoJCQltZXNoLnZlcnRVVkxpc3Q9bGlzdA0KCWVsaWYgbGVuKG1lc2guVGV4Q29vcmQ2QXJyYXkpPT0xOg0KCQlpZiBtZXNoLlRleENvb3JkNkFycmF5WzBdWzFdPT0nInZhcmludCInOg0KCQkJaWYgbW9kZToNCgkJCQlieXRlcz1tZXNoLlRleENvb3JkNkFycmF5WzBdWzBdCQkJCQ0KCQkJCUl0ZW1TaXplPW1lc2guVGV4Q29vcmQ2QXJyYXlbMF1bMl0NCgkJCQlpZiBtb2RlPT0nIlRSSUFOR0xFX1NUUklQIic6DQoJCQkJCWJ5dGVzPWRlY29kZVByZWRpY3QoaW5kaWNlcyxieXRlcyxJdGVtU2l6ZSkNCgkJCQlzMT1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfNl9iYmxfeCddKQ0KCQkJCXMyPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl82X2JibF95J10pDQoJCQkJcz1bczEsczJdCQkJDQoJCQkJYTE9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzZfaF94J10pDQoJCQkJYTI9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzZfaF95J10pDQoJCQkJYT1bYTEsYTJdDQoJCQkJZmxvYXRzPWRlY29kZVF1YW50aXplKGJ5dGVzLHMsYSxJdGVtU2l6ZSkNCgkJCQlmb3IgbSBpbiByYW5nZSgwLGxlbihmbG9hdHMpLEl0ZW1TaXplKToNCgkJCQkJdSx2PWZsb2F0c1ttOm0rSXRlbVNpemVdDQoJCQkJCW1lc2gudmVydFVWTGlzdC5hcHBlbmQoW3UsMS12XSkNCgkJZWxzZToNCgkJCWxpc3Q9bWVzaC5UZXhDb29yZDZBcnJheVswXVswXQ0KCQkJbWVzaC52ZXJ0VVZMaXN0PWxpc3QNCglpZiBsZW4obWVzaC5jb2xvckFycmF5KT4wOg0KCQltZXNoLnZlcnRDb2xMaXN0PW1lc2guY29sb3JBcnJheQ0KCQkNCgkJDQoJCQ0KDQpkZWYgVXNlckRhdGFDb250YWluZXIoeXMsYik6DQoJYXRyaWJ1dGVzPXt9DQoJVmFsdWVzPXlzLmdldChiLm5vZGUsJyJWYWx1ZXMiJykNCglpZiBWYWx1ZXM6DQoJCWZvciBhIGluIFZhbHVlc1swXS5jaGlsZHJlbjoNCgkJCXZhbHVlcz15cy52YWx1ZXMoYS5kYXRhLCc6JykNCgkJCU5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciTmFtZSInLCciIicpDQoJCQlWYWx1ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJWYWx1ZSInLCciIicpDQoJCQkjaWYgTmFtZTp3cml0ZShsb2csW05hbWUsVmFsdWVdLG4rNCkNCgkJCWlmIE5hbWU6YXRyaWJ1dGVzW05hbWVdPVZhbHVlCQ0KCXJldHVybiBhdHJpYnV0ZXMJCQkNCgkJDQpkZWYgb3NnTm9kZSh5cyxwYXJlbnROZXdOb2RlLHBhcmVudEJvbmUpOg0KCWZvciBjaGlsZCBpbiBwYXJlbnROZXdOb2RlLmNoaWxkcmVuOg0KCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQlpZiAnIm9zZy5HZW9tZXRyeSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCW1lc2g9b3NnR2VvbWV0cnkoeXMsY2hpbGQpDQoJCQkJbWVzaC5wYXJlbnRCb25lPXBhcmVudEJvbmUNCgkJCQltb2RlbC5tZXNoTGlzdC5hcHBlbmQobWVzaCkNCgkJCWlmICcib3NnQW5pbWF0aW9uLlJpZ0dlb21ldHJ5IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJbWVzaD1vc2dBbmltYXRpb25SaWdHZW9tZXRyeSh5cyxjaGlsZCkNCgkJCQltZXNoLnBhcmVudEJvbmU9cGFyZW50Qm9uZQ0KCQkJCW1vZGVsLm1lc2hMaXN0LmFwcGVuZChtZXNoKQ0KCQkJaWYgJyJvc2dBbmltYXRpb24uTW9ycGhHZW9tZXRyeSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCW1lc2g9b3NnQW5pbWF0aW9uTW9ycGhHZW9tZXRyeSh5cyxjaGlsZCkNCgkJCQltZXNoLnBhcmVudEJvbmU9cGFyZW50Qm9uZQ0KCQkJCW1vZGVsLm1lc2hMaXN0LmFwcGVuZChtZXNoKQ0KCQkJCXByaW50ICJUcmlhbmdsZXM6IDEiDQoJCQkJDQoJCQkJDQpkZWYgb3NnTWF0cml4VHJhbnNmb3JtKHlzLHBhcmVudE5ld05vZGUscGFyZW50Qm9uZSk6DQoJYm9uZT1Cb25lKCkJDQoJYm9uZS5OYW1lPU5vbmUNCglib25lLlVwZGF0ZU5hbWU9Tm9uZQ0KCWJvbmUubWF0cml4PU1hdHJpeCgpLnJlc2l6ZTR4NCgpIy5pbnZlcnQoKQ0KCWlmIHBhcmVudEJvbmU6Ym9uZS5wYXJlbnROYW1lPXBhcmVudEJvbmUubmFtZQ0KCXNrZWxldG9uLmJvbmVMaXN0LmFwcGVuZChib25lKQ0KCWZvciBjaGlsZCBpbiBwYXJlbnROZXdOb2RlLmNoaWxkcmVuOg0KCQlpZiAnIk1hdHJpeCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5ub2RlLmRhdGEsJ2YnKQkNCgkJCWJvbmUubWF0cml4PU1hdHJpeDR4NCh2YWx1ZXMpDQoJCQlpZiBwYXJlbnRCb25lOmJvbmUubWF0cml4Kj1wYXJlbnRCb25lLm1hdHJpeAkNCgkJaWYgJyJVbmlxdWVJRCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5ub2RlLmhlYWRlciwnOicpDQoJCQlVbmlxdWVJRD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJVbmlxdWVJRCInLCdpJykNCgkJCWJvbmUubmFtZT0nVW5pcXVlSURfJytzdHIoVW5pcXVlSUQpDQoJCWlmICciTmFtZSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5ub2RlLmhlYWRlciwnOicpDQoJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJywnIiInKQ0KCQkJI2JpbmRCb25lLk5hbWU9TmFtZQ0KCQkJYm9uZS5OYW1lPU5hbWUNCgkJaWYgJyJVcGRhdGVDYWxsYmFja3MiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQlpZiAnIm9zZ0FuaW1hdGlvbi5VcGRhdGVNYXRyaXhUcmFuc2Zvcm0iJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCQkJaWYgJyJOYW1lIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5ub2RlLmhlYWRlciwnOicpDQoJCQkJCQkJTmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJOYW1lIicsJyIiJykNCgkJCQkJCQkjYmluZEJvbmUuVXBkYXRlTmFtZT1OYW1lDQoJCQkJCQkJYm9uZS5VcGRhdGVOYW1lPU5hbWUNCglyZXR1cm4gYm9uZQkJDQoJCQkNCgkJDQpkZWYgb3NnQW5pbWF0aW9uQm9uZSh5cyxwYXJlbnROZXdOb2RlLHBhcmVudEJvbmUpOg0KCWJvbmU9Qm9uZSgpDQoJc2tlbGV0b24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpCQkNCglib25lLm1hdHJpeD1NYXRyaXgoKS5yZXNpemU0eDQoKSMuaW52ZXJ0KCkNCgliaW5kQm9uZT1Cb25lKCkNCgliaW5kQm9uZS5tYXRyaXg9TWF0cml4KCkucmVzaXplNHg0KCkjLmludmVydCgpDQoJYmluZEJvbmUuTmFtZT1Ob25lDQoJYm9uZS5OYW1lPU5vbmUNCglib25lLlVwZGF0ZU5hbWU9Tm9uZQ0KCWJpbmRCb25lLlVwZGF0ZU5hbWU9Tm9uZQ0KCWZvciBjaGlsZCBpbiBwYXJlbnROZXdOb2RlLmNoaWxkcmVuOg0KCQlpZiAnIkludkJpbmRNYXRyaXhJblNrZWxldG9uU3BhY2UiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCXZhbHVlcz15cy52YWx1ZXMoY2hpbGQubm9kZS5kYXRhLCdmJykJDQoJCQltYXRyaXg9TWF0cml4NHg0KHZhbHVlcykNCgkJCWJpbmRCb25lLm1hdHJpeD1tYXRyaXguaW52ZXJ0KCkJDQoJCQliaW5kc2tlbGV0b24uYm9uZUxpc3QuYXBwZW5kKGJpbmRCb25lKQ0KCQlpZiAnIlVuaXF1ZUlEIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQl2YWx1ZXM9eXMudmFsdWVzKGNoaWxkLm5vZGUuaGVhZGVyLCc6JykNCgkJCVVuaXF1ZUlEPXlzLmdldFZhbHVlKHZhbHVlcywnIlVuaXF1ZUlEIicsJ2knKQ0KCQkJYmluZEJvbmUubmFtZT0nVW5pcXVlSURfJytzdHIoVW5pcXVlSUQpDQoJCQlib25lLm5hbWU9J1VuaXF1ZUlEXycrc3RyKFVuaXF1ZUlEKQ0KCQlpZiAnIk5hbWUiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCXZhbHVlcz15cy52YWx1ZXMoY2hpbGQubm9kZS5oZWFkZXIsJzonKQ0KCQkJTmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJOYW1lIicsJyIiJykNCgkJCWJpbmRCb25lLk5hbWU9TmFtZQ0KCQkJYm9uZS5OYW1lPU5hbWUNCgkJCSNib25lSW5kZWtzTGlzdFtOYW1lXT1ib25lLm5hbWUNCgkJaWYgJyJNYXRyaXgiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCXZhbHVlcz15cy52YWx1ZXMoY2hpbGQubm9kZS5kYXRhLCdmJykJDQoJCQlib25lLm1hdHJpeD1NYXRyaXg0eDQodmFsdWVzKQ0KCQkJaWYgcGFyZW50Qm9uZToNCgkJCQlpZiAnTWF0cml4VHJhbnNmb3JtJyBub3QgaW4gcGFyZW50Qm9uZS5uYW1lOg0KCQkJCQlib25lLnBhcmVudE5hbWU9cGFyZW50Qm9uZS5uYW1lDQoJCQkJYm9uZS5tYXRyaXgqPXBhcmVudEJvbmUubWF0cml4DQoJCWlmICciVXBkYXRlQ2FsbGJhY2tzIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJaWYgJyJvc2dBbmltYXRpb24uVXBkYXRlQm9uZSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJCQlpZiAnIk5hbWUiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGNoaWxkLm5vZGUuaGVhZGVyLCc6JykNCgkJCQkJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJywnIiInKQ0KCQkJCQkJCWJpbmRCb25lLlVwZGF0ZU5hbWU9TmFtZQ0KCQkJCQkJCWJvbmUuVXBkYXRlTmFtZT1OYW1lDQoJcmV0dXJuIGJvbmUJCQkNCgkJDQpkZWYgZ2V0TmV3Tm9kZVRyZWUoeXMscGFyZW50TmV3Tm9kZSxuLHBhcmVudEJvbmUsZGF0YSk6DQoJDQoJaWYgJyJvc2dBbmltYXRpb24uU2tlbGV0b24iJyBpbiBwYXJlbnROZXdOb2RlLm5vZGUuaGVhZGVyOg0KCQlwYXJlbnRCb25lPW9zZ0FuaW1hdGlvbkJvbmUoeXMscGFyZW50TmV3Tm9kZSxwYXJlbnRCb25lKQ0KCQliaW5kc2tlbGV0b24ucGFyZW50Qm9uZT1wYXJlbnRCb25lDQoJaWYgJyJvc2cuTm9kZSInIGluIHBhcmVudE5ld05vZGUubm9kZS5oZWFkZXI6DQoJCW9zZ05vZGUoeXMscGFyZW50TmV3Tm9kZSxwYXJlbnRCb25lKQ0KCWlmICcib3NnLk1hdHJpeFRyYW5zZm9ybSInIGluIHBhcmVudE5ld05vZGUubm9kZS5oZWFkZXI6DQoJCXBhcmVudEJvbmU9b3NnTWF0cml4VHJhbnNmb3JtKHlzLHBhcmVudE5ld05vZGUscGFyZW50Qm9uZSkNCglpZiAnIm9zZ0FuaW1hdGlvbi5Cb25lIicgaW4gcGFyZW50TmV3Tm9kZS5ub2RlLmhlYWRlcjoNCgkJcGFyZW50Qm9uZT1vc2dBbmltYXRpb25Cb25lKHlzLHBhcmVudE5ld05vZGUscGFyZW50Qm9uZSkNCgluKz00DQoJZm9yIGNoaWxkIGluIHBhcmVudE5ld05vZGUuY2hpbGRyZW46DQoJCSN3cml0ZShsb2csW2NoaWxkLm5vZGUuaGVhZGVyLGNoaWxkLlVuaXF1ZUlEXSxuKQ0KCQlnZXROZXdOb2RlVHJlZSh5cyxjaGlsZCxuLHBhcmVudEJvbmUsZGF0YSkJCQ0KCQ0KZGVmIG9zZ1BhcnNlcihmaWxlbmFtZSk6DQoJZ2xvYmFsIHNrZWxldG9uLGJpbmRza2VsZXRvbixtb2RlbCxib25lSW5kZWtzTGlzdCxmaXJzdG1hdHJpeCxuZXdOb2RlTGlzdA0KCSNSaWdHZW9tZXRyeT1GYWxzZQ0KCWJvbmVJbmRla3NMaXN0PXt9DQoJbW9kZWw9TW9kZWwoZmlsZW5hbWUpDQoJbW9kZWwubWF0TGlzdD17fQ0KCXNrZWxldG9uPVNrZWxldG9uKCkNCglza2VsZXRvbi5BUk1BVFVSRVNQQUNFPVRydWUNCgliaW5kc2tlbGV0b249U2tlbGV0b24oKQ0KCWJpbmRza2VsZXRvbi5wYXJlbnRCb25lPU5vbmUNCgliaW5kc2tlbGV0b24uQVJNQVRVUkVTUEFDRT1UcnVlDQoJVW5pcXVlSURMaXN0PXt9DQoJeXM9WXNvbigpDQoJeXMubG9nPVRydWUNCgl5cy5maWxlbmFtZT1maWxlbmFtZQ0KCXlzLnBhcnNlKCkNCgkNCglyb290PXlzLnJvb3QNCgluPTANCgluZXdOb2RlTGlzdD1bXQ0KCW5ld1Jvb3Q9TmV3Tm9kZSgpDQoJbmV3Um9vdC5ub2RlPXlzLnJvb3QNCgluZXdOb2RlTGlzdC5hcHBlbmQobmV3Um9vdCkNCglnZXRJRFRyZWUoeXMseXMucm9vdCxuLG5ld1Jvb3QpDQoJDQoJcm9vdD1uZXdSb290DQoJZ2V0TmV3Tm9kZVRyZWUoeXMscm9vdCxuLE5vbmUsTm9uZSkNCgkNCiNkZWYgc3NzKCk6CQ0KCQ0KCXNrZWxldG9uLmRyYXcoKQ0KCQkjZm9yIGJvbmUgaW4gYmluZHNrZWxldG9uLmJvbmVMaXN0Og0KCQkjCWJvbmUubWF0cml4Kj1iaW5kc2tlbGV0b24ucGFyZW50Qm9uZS5tYXRyaXgNCglpZiBsZW4oYmluZHNrZWxldG9uLmJvbmVMaXN0KT4wOgkJDQoJCWJpbmRza2VsZXRvbi5kcmF3KCkNCglpZiBiaW5kc2tlbGV0b24ucGFyZW50Qm9uZSBhbmQgYmluZHNrZWxldG9uLm9iamVjdDoNCgkJYmluZHNrZWxldG9uLm9iamVjdC5zZXRNYXRyaXgoYmluZHNrZWxldG9uLnBhcmVudEJvbmUubWF0cml4KQ0KCSNib25lTmFtZUxpc3Q9W10NCgkNCglmb3IgYm9uZSBpbiBza2VsZXRvbi5ib25lTGlzdDoNCgkJaWYgYm9uZS5VcGRhdGVOYW1lOg0KCQkJI05hbWU9Z2V0U3BsaXROYW1lKGJvbmUuTmFtZSwnXycsLTEpDQoJCQlib25lSW5kZWtzTGlzdFtib25lLlVwZGF0ZU5hbWVdPWJvbmUubmFtZQ0KCQkJI3ByaW50IE5hbWUsYm9uZS5uYW1lDQoJCQkNCgluPTAJDQoJcmVzdWx0PTANCglBbmltYXRpb25zPXlzLmdldCh5cy5yb290LCcib3NnQW5pbWF0aW9uLkFuaW1hdGlvbiInKQkJDQoJaWYgQW5pbWF0aW9uczoNCgkJI3Jlc3VsdD1CbGVuZGVyLkRyYXcuUHVwTWVudSgiZXhwb3J0IGFuaW1hdGlvbnMgYXMgKi5hY3Rpb24/JXR8WWVzfE5vIikNCgkJaWYgcmVzdWx0PT0xOg0KCQkJZm9yIGFuaW1hdGlvbiBpbiBBbmltYXRpb25zOgkNCgkJCQlnZXRBbmltYXRpb24oeXMsYW5pbWF0aW9uLG4pDQoJCQkJDQoJCQkJDQoJCQ0KCQkNCgkJDQoJZm9yIG1lc2ggaW4gbW9kZWwubWVzaExpc3Q6DQoJCW1lc2guQklORFNLRUxFVE9OPXNrZWxldG9uLm5hbWUNCgkJZHJhd01lc2goeXMsbWVzaCkNCgkJCQkNCgkjbW9kZWwuZ2V0TWF0KCkJDQoJcmVzdWx0PTENCgkjcmVzdWx0PUJsZW5kZXIuRHJhdy5QdXBNZW51KCJTZW5kIG1lc2hlcyB0byBzdGFydHBvc2U/JXR8WWVzfE5vIikNCgkNCglyZXN1bHQxMD0xIA0KCQkNCglpZiByZXN1bHQxMD09MToNCgkJZm9yIGkxLG1lc2ggaW4gZW51bWVyYXRlKG1vZGVsLm1lc2hMaXN0KToNCgkJCXByaW50IGkxLCd2ZXJ0OicsbGVuKG1lc2gudmVydFBvc0xpc3QpLCdjb2w6JyxsZW4obWVzaC52ZXJ0Q29sTGlzdCksJ3V2OicsbGVuKG1lc2gudmVydFVWTGlzdCksJ2luZGljZTonLGxlbihtZXNoLmluZGljZUxpc3QpLCdtYXQ6JyxsZW4obWVzaC5tYXRMaXN0KSwnc2tpbjonLGxlbihtZXNoLnNraW5MaXN0KSMsbWF0TmFtZQ0KCQkJc3lzMi5zdGRvdXQuZmx1c2goKQ0KCQkJI0JsZW5kZXIuV2luZG93LkRyYXdQcm9ncmVzc0JhcihmbG9hdCgoaTEpL2Zsb2F0KGxlbihtb2RlbC5tZXNoTGlzdCkpKSxzdHIobGVuKG1vZGVsLm1lc2hMaXN0KS0xLWkxKSkNCgkJCQ0KCQkJbWVzaC5CSU5EU0tFTEVUT049c2tlbGV0b24ubmFtZQ0KCQkJaWYgbGVuKG1lc2gudmVydFBvc0xpc3QpPjA6CQ0KCQkJCWlmIGxlbihtZXNoLkJvbmVzKT4wIGFuZCBsZW4obWVzaC5XZWlnaHRzKT4wOg0KCQkJCQlza2luPVNraW4oKQ0KCQkJCQlza2luLmJvbmVNYXA9WzBdKmxlbihtZXNoLkJvbmVNYXApDQoJCQkJCW1lc2guYm9uZU5hbWVMaXN0PVsnJ10qbGVuKG1lc2guQm9uZU1hcCkNCgkJCQkJZm9yIGJvbmVOYW1lIGluIG1lc2guQm9uZU1hcDoNCgkJCQkJCWZvciBib25lIGluIHNrZWxldG9uLmJvbmVMaXN0Og0KCQkJCQkJCWlmIGJvbmUuTmFtZT09Ym9uZU5hbWU6DQoJCQkJCQkJCWlkPW1lc2guQm9uZU1hcFtib25lTmFtZV0NCgkJCQkJCQkJc2tpbi5ib25lTWFwW2lkXT1pZA0KCQkJCQkJCQltZXNoLmJvbmVOYW1lTGlzdFtpZF09Ym9uZS5uYW1lCQ0KCQkJCQkJCQlicmVhawkJCQkNCgkJCQkJbWVzaC5za2luTGlzdC5hcHBlbmQoc2tpbikNCgkJCQkJbWVzaC5za2luSW5kaWNlTGlzdD1tZXNoLkJvbmVzDQoJCQkJCW1lc2guc2tpbldlaWdodExpc3Q9bWVzaC5XZWlnaHRzDQoJCQkJDQoJCQkJaWYgYmluZHNrZWxldG9uLm9iamVjdCBhbmQgc2tlbGV0b24ub2JqZWN0Og0KCQkJCQlpZiBtZXNoLnBhcmVudEJvbmUgYW5kIGxlbihtZXNoLnNraW5MaXN0KT4wOg0KCQkJCQkJbWVzaC5kcmF3KCkJDQoJCQkJCQltZXNoLm9iamVjdC5nZXREYXRhKG1lc2g9MSkudHJhbnNmb3JtKG1lc2gucGFyZW50Qm9uZS5tYXRyaXgpDQoJCQkJCQltZXNoLm9iamVjdC5nZXREYXRhKG1lc2g9MSkudXBkYXRlKCkNCgkJCQkJCSNtZXNoLm9iamVjdC5zZXRNYXRyaXgobWVzaC5wYXJlbnRCb25lLm1hdHJpeCkNCgkJCQkJCWlmIHJlc3VsdD09MToNCgkJCQkJCQliaW5kUG9zZShiaW5kc2tlbGV0b24ub2JqZWN0LHNrZWxldG9uLm9iamVjdCxtZXNoLm9iamVjdCkNCgkJCQkJCXNrZWxldG9uLm9iamVjdC5tYWtlUGFyZW50RGVmb3JtKFttZXNoLm9iamVjdF0sMSwwKQ0KCQkJCQllbGlmIG1lc2gucGFyZW50Qm9uZSBhbmQgbGVuKG1lc2guc2tpbkxpc3QpPT0wOg0KCQkJCQkJbWVzaC5zZXRTa2luKG1lc2gucGFyZW50Qm9uZS5uYW1lKQkNCgkJCQkJCW1lc2guZHJhdygpCQ0KCQkJCQkJbWVzaC5vYmplY3QuZ2V0RGF0YShtZXNoPTEpLnRyYW5zZm9ybShtZXNoLnBhcmVudEJvbmUubWF0cml4KQ0KCQkJCQkJbWVzaC5vYmplY3QuZ2V0RGF0YShtZXNoPTEpLnVwZGF0ZSgpDQoJCQkJCQlza2VsZXRvbi5vYmplY3QubWFrZVBhcmVudERlZm9ybShbbWVzaC5vYmplY3RdLDEsMCkNCgkJCQllbHNlOgkNCgkJCQkJaWYgbWVzaC5wYXJlbnRCb25lOg0KCQkJCQkJaWYgbGVuKG1lc2guc2tpbkxpc3QpPT0wOg0KCQkJCQkJCW1lc2guc2V0U2tpbihtZXNoLnBhcmVudEJvbmUubmFtZSkJDQoJCQkJCQltZXNoLmRyYXcoKQkNCgkJCQkJCW1lc2gub2JqZWN0LmdldERhdGEobWVzaD0xKS50cmFuc2Zvcm0obWVzaC5wYXJlbnRCb25lLm1hdHJpeCkNCgkJCQkJCW1lc2gub2JqZWN0LmdldERhdGEobWVzaD0xKS51cGRhdGUoKQ0KCQkJCQkJI21lc2gub2JqZWN0LnNldE1hdHJpeChtZXNoLnBhcmVudEJvbmUubWF0cml4KQ0KCQkJCQkJI3NrZWxldG9uLm9iamVjdC5tYWtlUGFyZW50Qm9uZShbbWVzaC5vYmplY3RdLG1lc2gucGFyZW50Qm9uZS5uYW1lLDAsMCkNCgkJCQkJCWlmIHNrZWxldG9uLm9iamVjdCBhbmQgc2tlbGV0b24ub2JqZWN0Og0KCQkJCQkJCXNrZWxldG9uLm9iamVjdC5tYWtlUGFyZW50RGVmb3JtKFttZXNoLm9iamVjdF0sMSwwKQ0KCQkJCQllbHNlOg0KCQkJCQkJI3ByaW50IGxlbihtZXNoLnZlcnRQb3NMaXN0KQ0KCQkJCQkJI3ByaW50IG1lc2guaW5kaWNlTGlzdA0KCQkJCQkJI21lc2guaW5kaWNlTGlzdD1bXQ0KCQkJCQkJbWVzaC5kcmF3KCkJDQoJCQkJCQkjbWVzaC5vYmplY3QuZ2V0RGF0YShtZXNoPTEpLnRyYW5zZm9ybShtZXNoLnBhcmVudEJvbmUubWF0cml4KQ0KCQkJCQkJI21lc2gub2JqZWN0LmdldERhdGEobWVzaD0xKS51cGRhdGUoKQ0KCQkJCQkJI21lc2gub2JqZWN0LnNldE1hdHJpeChtZXNoLnBhcmVudEJvbmUubWF0cml4KQ0KCQkJCQ0KCQkJCSIiIg0KCQkJCWlmIGxlbihtZXNoLm1vcnBoQXJyYXkpPjA6CQkNCgkJCQkJbmFtZT1tZXNoLm9iamVjdC5uYW1lDQoJCQkJCWFjdGlvbj1BY3Rpb24oKQkJDQoJCQkJCWFjdGlvbi5NRVNIU1BBQ0U9VHJ1ZQ0KCQkJCQlhY3Rpb24ubmFtZT1uYW1lDQoJCQkJCWZvciBpLG1vcnBoIGluIGVudW1lcmF0ZShtZXNoLm1vcnBoQXJyYXkpOg0KCQkJCQkJI21vcnBoTWVzaD1NZXNoKCkNCgkJCQkJCSNtb3JwaE1lc2gudmVydFBvc0xpc3Q9bWVzaC5tb3JwaEFycmF5W21vcnBoXVswXVswXQ0KCQkJCQkJI3ByaW50IG1vcnBoDQoJCQkJCQkjbW9ycGhNZXNoLmRyYXcoKQ0KCQkJCQkJdmVydExpc3Q9bWVzaC5tb3JwaEFycmF5W21vcnBoXVswXVswXQ0KCQkJCQkJZnJhbWU9aSo1DQoJCQkJCQlhY3Rpb24uc2hhcGVGcmFtZUxpc3QuYXBwZW5kKGZyYW1lKQ0KCQkJCQkJYWN0aW9uLnNoYXBlS2V5TGlzdC5hcHBlbmQodmVydExpc3QpDQoJCQkJCWFjdGlvbi5kcmF3KCkNCgkJCQkJYWN0aW9uLnNldENvbnRleHQoKQ0KCQkJCQkiIiINCgkJCQkJCQ0KCQkJCQkJDQoJCQkJCQkNCg0KDQoJCW1vZGVsLnNldCgpCQ0KCQkJCQkJDQoNCg0KDQoNCg0KDQoNCg0KDQoJCQ0KCQkjZm9yIGksbWVzaCBpbiBlbnVtZXJhdGUobW9kZWwubWVzaExpc3QpOg0KCQkjCUJsZW5kZXIuV2luZG93LkRyYXdQcm9ncmVzc0JhcihmbG9hdChpL2Zsb2F0KGxlbihtb2RlbC5tZXNoTGlzdCkrMSkpLHN0cigtMStsZW4obW9kZWwubWVzaExpc3QpLWkpKQ0KCQkjcHJpbnQgJ3Jlc3VsdDonLHJlc3VsdA0KCQlpZiByZXN1bHQhPTI6DQoJCQlpZgliaW5kc2tlbGV0b24ub2JqZWN0Og0KCQkJCXNjZW5lID0gYnB5LmRhdGEuc2NlbmVzLmFjdGl2ZQ0KCQkJCXNjZW5lLm9iamVjdHMudW5saW5rKGJpbmRza2VsZXRvbi5vYmplY3QpDQoJCQ0KZGVmIGh0bVBhcnNlcihmaWxlbmFtZSk6DQoJeXM9WXNvbigpDQoJeXMubG9nPVRydWUNCgl5cy5maWxlbmFtZT1maWxlbmFtZQ0KCXlzLnBhcnNlKCkJCQ0KCSMjb3Muc3lzdGVtKCdjbHMnKQ0KCQ0KCQkJDQoJI3N6dWthbSBpa29ueQ0KCXByaW50ICdzenVrYW0gaWtvbnknDQoJI3ByaW50IHlzLnJvb3QNCglUSFVNQk5BSUxTPXlzLmdldCh5cy5yb290LCcidGh1bWJuYWlscyInKQ0KCXByaW50IFRIVU1CTkFJTFMNCglpa29uYT1Ob25lDQoJU0laRT0wDQoJaWYgVEhVTUJOQUlMUzoNCgkJZm9yIHRodW1ibmFpbHMgaW4gVEhVTUJOQUlMUzoNCgkJCSNwcmludCB0aHVtYm5haWxzLmhlYWRlcg0KCQkJVVJMPXlzLmdldCh0aHVtYm5haWxzLCcidXJsIicpDQoJCQlmb3IgYSBpbiBVUkw6DQoJCQkJdmFsdWVzPXlzLnZhbHVlcyhhLmRhdGEsJzonKQ0KCQkJCXVybD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJ1cmwiJywnIiInKQ0KCQkJCXNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCcic2l6ZSInLCdpJykNCgkJCQlpZiB1cmw6DQoJCQkJCWJhc2VuYW1lPW9zLnBhdGguYmFzZW5hbWUodXJsKQkJCQ0KCQkJCQlpZiAnLmpwZWcnIGluIGJhc2VuYW1lOnBhdGg9c3lzLmRpcitvcy5zZXArb3MucGF0aC5iYXNlbmFtZSh1cmwpKycuanBnJw0KCQkJCQllbHNlOnBhdGg9c3lzLmRpcitvcy5zZXArb3MucGF0aC5iYXNlbmFtZSh1cmwpDQoJCQkJCWV4aXN0cz1vcy5wYXRoLmV4aXN0cyhwYXRoKQ0KCQkJCQkjcHJpbnQgJ2lrb25hJyxleGlzdHMsb3MucGF0aC5iYXNlbmFtZSh1cmwpKycuanBnJwkJCQkJCQkNCgkJCQkJaWYgZXhpc3RzPT1UcnVlOg0KCQkJCQkJaWYgc2l6ZT5TSVpFOg0KCQkJCQkJCVNJWkU9c2l6ZQ0KCQkJCQkJCWlrb25hPXBhdGgNCgkJCQkJCQkNCglpZiBpa29uYToNCgkJI3ByaW50IGlrb25hDQoJCWZvciBmaWxlIGluIG9zLmxpc3RkaXIoc3lzLmRpcik6DQoJCQlpZiAnLmh0bScgaW4gZmlsZToNCgkJCQlpZiBvcy5wYXRoLmV4aXN0cyhzeXMuZGlyK29zLnNlcCtmaWxlKyIudGh1bWIuMTAucG5nIik9PUZhbHNlOg0KCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhpa29uYSk6DQoJCQkJCQlvcy5yZW5hbWUoaWtvbmEsc3lzLmRpcitvcy5zZXArZmlsZSsiLnRodW1iLjEwLnBuZyIpDQoJCQkJZWxzZToNCgkJCQkJaWYgb3MucGF0aC5leGlzdHMoc3lzLmRpcitvcy5zZXArZmlsZSsiLnRodW1iLjExLnBuZyIpPT1GYWxzZToNCgkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKGlrb25hKToJCQkJCQkNCgkJCQkJCQlvcy5yZW5hbWUoaWtvbmEsc3lzLmRpcitvcy5zZXArZmlsZSsiLnRodW1iLjExLnBuZyIpDQoJCQkJCQ0KCQkJDQoJCQ0KCQ0KCVJFU1VMVFM9eXMuZ2V0KHlzLnJvb3QsJyJyZXN1bHRzIicpCQ0KCWlmIFJFU1VMVFM6DQoJCWZvciByZXN1bHRzIGluIFJFU1VMVFM6DQoJCQl3cml0ZShsb2csWyJyZXN1bHRzIl0sMCkNCgkJCVVJRFM9eXMuZ2V0KHJlc3VsdHMsJyJ1aWQiJykJDQoJCQlpZiBVSURTOg0KCQkJCWZvciBVSUQgaW4gVUlEUzoNCgkJCQkJI3dyaXRlKGxvZyxbVUlELmhlYWRlcl0sNCkNCgkJCQkJdWlkPU5vbmUNCgkJCQkJdmFsdWVzPU5vbmUNCgkJCQkJaWYgJyJ1aWQiJyBpbiBVSUQuaGVhZGVyOnZhbHVlcz15cy52YWx1ZXMoVUlELmhlYWRlciwnOicpDQoJCQkJCWlmICcidWlkIicgaW4gVUlELmRhdGE6dmFsdWVzPXlzLnZhbHVlcyhVSUQuZGF0YSwnOicpDQoJCQkJCWlmIHZhbHVlczp1aWQ9eXMuZ2V0VmFsdWUodmFsdWVzLCcidWlkIicsJyIiJykNCgkJCQkJd3JpdGUobG9nLFsndWlkOicsdWlkXSw0KQ0KCQkJCQlpZiB1aWQ6DQoJCQkJCQlmb3JtYXRzPXlzLmdldChVSUQsJyJmb3JtYXQiJykNCgkJCQkJCWlmIGZvcm1hdHM6CQkJCQkJCQ0KCQkJCQkJCUlNQUdFU1t1aWRdPXt9DQoJCQkJCQkJSU1BR0VTW3VpZF1bJ0EnXT1bTm9uZSxOb25lLDEwMF0NCgkJCQkJCQlJTUFHRVNbdWlkXVsnUkdCJ109W05vbmUsTm9uZSwxMDBdDQoJCQkJCQkJSU1BR0VTW3VpZF1bJ04nXT1bTm9uZSxOb25lLDEwMF0NCgkJCQkJCQlJTUFHRVNbdWlkXVsnUiddPVtOb25lLE5vbmUsMTAwXQ0KCQkJCQkJCWZvciBmb3JtYXROb2RlIGluIGZvcm1hdHM6DQoJCQkJCQkJCXdyaXRlKGxvZyxbJ2ltYWdlJ10sOCkJCQkJCQkJCQ0KCQkJCQkJCQl2YWx1ZXM9Tm9uZQ0KCQkJCQkJCQlmb3JtYXQ9Tm9uZQ0KCQkJCQkJCQlpZiAnImZvcm1hdCInIGluIGZvcm1hdE5vZGUuaGVhZGVyOnZhbHVlcz15cy52YWx1ZXMoZm9ybWF0Tm9kZS5oZWFkZXIsJzonKQ0KCQkJCQkJCQlpZiAnImZvcm1hdCInIGluIGZvcm1hdE5vZGUuZGF0YTp2YWx1ZXM9eXMudmFsdWVzKGZvcm1hdE5vZGUuZGF0YSwnOicpDQoJCQkJCQkJCWlmIHZhbHVlczpmb3JtYXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciZm9ybWF0IicsJyIiJykNCgkJCQkJCQkJd3JpdGUobG9nLFsnZm9ybWF0OicsZm9ybWF0XSwxMikJCQkJCQkJCQ0KCQkJCQkJCQl2YWx1ZXM9Tm9uZQ0KCQkJCQkJCQlxdWFsaXR5PU5vbmUNCgkJCQkJCQkJaWYgJyJxdWFsaXR5IicgaW4gZm9ybWF0Tm9kZS5oZWFkZXI6dmFsdWVzPXlzLnZhbHVlcyhmb3JtYXROb2RlLmhlYWRlciwnOicpDQoJCQkJCQkJCWlmICcicXVhbGl0eSInIGluIGZvcm1hdE5vZGUuZGF0YTp2YWx1ZXM9eXMudmFsdWVzKGZvcm1hdE5vZGUuZGF0YSwnOicpDQoJCQkJCQkJCWlmIHZhbHVlczpxdWFsaXR5PXlzLmdldFZhbHVlKHZhbHVlcywnInF1YWxpdHkiJywnaScpDQoJCQkJCQkJCXdyaXRlKGxvZyxbJ3F1YWxpdHk6JyxxdWFsaXR5XSwxMikJCQkJCQkJCQ0KCQkJCQkJCQl2YWx1ZXM9Tm9uZQ0KCQkJCQkJCQl1cmw9Tm9uZQ0KCQkJCQkJCQlpZiAnInVybCInIGluIGZvcm1hdE5vZGUuaGVhZGVyOnZhbHVlcz15cy52YWx1ZXMoZm9ybWF0Tm9kZS5oZWFkZXIsJzonKQ0KCQkJCQkJCQlpZiAnInVybCInIGluIGZvcm1hdE5vZGUuZGF0YTp2YWx1ZXM9eXMudmFsdWVzKGZvcm1hdE5vZGUuZGF0YSwnOicpDQoJCQkJCQkJCWlmIHZhbHVlczp1cmw9eXMuZ2V0VmFsdWUodmFsdWVzLCcidXJsIicsJyIiJykJCQkJCQkJCQ0KCQkJCQkJCQkjd3JpdGUobG9nLFsndXJsOicsdXJsXSwxMikNCgkJCQkJCQkJaWYgbm90IHVybDoNCgkJCQkJCQkJCWlmICcidXJsIicgaW4gZm9ybWF0Tm9kZS5wYXJlbnQuaGVhZGVyOnZhbHVlcz15cy52YWx1ZXMoZm9ybWF0Tm9kZS5wYXJlbnQuaGVhZGVyLCc6JykNCgkJCQkJCQkJCWlmICcidXJsIicgaW4gZm9ybWF0Tm9kZS5wYXJlbnQuZGF0YTp2YWx1ZXM9eXMudmFsdWVzKGZvcm1hdE5vZGUucGFyZW50LmRhdGEsJzonKQ0KCQkJCQkJCQkJaWYgdmFsdWVzOnVybD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJ1cmwiJywnIiInKQkNCgkJCQkJCQkJaWYgdXJsOg0KCQkJCQkJCQkJYmFzZW5hbWU9b3MucGF0aC5iYXNlbmFtZSh1cmwpCQkJDQoJCQkJCQkJCQlpZiAnLmpwZWcnIGluIGJhc2VuYW1lOnBhdGg9c3lzLmRpcitvcy5zZXArb3MucGF0aC5iYXNlbmFtZSh1cmwpKycuanBnJw0KCQkJCQkJCQkJZWxzZTpwYXRoPXN5cy5kaXIrb3Muc2VwK29zLnBhdGguYmFzZW5hbWUodXJsKQ0KCQkJCQkJCQkJZXhpc3RzPW9zLnBhdGguZXhpc3RzKHBhdGgpCQkJCQkJCQkNCgkJCQkJCQkJCXdyaXRlKGxvZyxbJ3BhdGg6JyxwYXRoLGV4aXN0c10sMTIpDQoJCQkJCQkJCQkNCgkJCQkJCQkJCWlmIGZvcm1hdCBub3QgaW4gSU1BR0VTW3VpZF0ua2V5cygpOg0KCQkJCQkJCQkJCXByaW50ICdOT1dZIEZPUk1BVDonLGZvcm1hdA0KCQkJCQkJCQkJCUlNQUdFU1t1aWRdW2Zvcm1hdF09W3BhdGgsZXhpc3RzLHF1YWxpdHldDQoJCQkJCQkJCQllbHNlOg0KCQkJCQkJCQkJCWlmIHF1YWxpdHkgYW5kIGZvcm1hdDoNCgkJCQkJCQkJCQkJaWYgcXVhbGl0eTw9SU1BR0VTW3VpZF1bZm9ybWF0XVsyXSBhbmQgZXhpc3RzPT1UcnVlOg0KCQkJCQkJCQkJCQkJSU1BR0VTW3VpZF1bZm9ybWF0XT1bcGF0aCxleGlzdHMscXVhbGl0eV0NCgkJCQkJCQkJCQ0KCQkJCQkJCQkJDQoJCQkJCQkJCQ0KCQkJCQkJCQ0KCQkNCgkJCQkJCQ0KCQkJCQ0KCQkJDQoJYWxsSW1hZ2VQYXRocz1bXQkJCQ0KCQkJCQkJDQoJDQoJdXNlZEltYWdlUGF0aHM9W10NCglmb3Iga2V5IGluIElNQUdFUzoNCgkJI3dyaXRlKGxvZyxba2V5XSwwKQ0KCQlmb3IgaXRlbSBpbiBJTUFHRVNba2V5XToNCgkJCSN3cml0ZShsb2csW2l0ZW0sJzonLElNQUdFU1trZXldW2l0ZW1dXSw0KQ0KCQkJaWYgSU1BR0VTW2tleV1baXRlbV1bMF06DQoJCQkJaWYgSU1BR0VTW2tleV1baXRlbV1bMF0gbm90IGluIHVzZWRJbWFnZVBhdGhzOg0KCQkJCQl1c2VkSW1hZ2VQYXRocy5hcHBlbmQoSU1BR0VTW2tleV1baXRlbV1bMF0pDQoJDQoJZm9yIGltYWdlIGluIGFsbEltYWdlUGF0aHM6DQoJCWlmIGltYWdlIG5vdCBpbiB1c2VkSW1hZ2VQYXRoczoNCgkJCWlmIG9zLnBhdGguZXhpc3RzKGltYWdlKT09VHJ1ZToNCgkJCQlwcmludCAndXN1d2FtOicsaW1hZ2UNCgkJCQkjb3MucmVtb3ZlKGltYWdlKQ0KCQ0KCW1hdGVyaWFscz15cy5nZXQoeXMucm9vdCwnIm1hdGVyaWFscyInKQ0KCWlmIG1hdGVyaWFsczoNCgkJZm9yIGEgaW4gbWF0ZXJpYWxzOg0KCQkJZm9yIGIgaW4gYS5jaGlsZHJlbjoNCgkJCQltYXROYW1lPU5vbmUJDQoJCQkJaWYgJyJuYW1lIicgaW4gYi5kYXRhOg0KCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGIuZGF0YSwnOicpDQoJCQkJCW1hdE5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCcibmFtZSInLCciIicpLnJlcGxhY2UoJzonLCcnKQ0KCQkJCQltYXROYW1lPW1hdE5hbWUucmVwbGFjZSgnOicsJycpDQoJCQkJCWlmICdcXCcgaW4gbWF0TmFtZTptYXROYW1lPW1hdE5hbWUuc3BsaXQoJ1xcJylbMF0NCgkJCQkJTUFURVJJQUxTW21hdE5hbWVdPXt9DQoJCQkJZWxzZToJDQoJCQkJCWZvciBjIGluIGIuY2hpbGRyZW46CQkNCgkJCQkJCWlmICcibmFtZSInIGluIGMuaGVhZGVyOg0KCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoYy5oZWFkZXIsJzonKQ0KCQkJCQkJCW1hdE5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCcibmFtZSInLCciIicpDQoJCQkJCQkJTUFURVJJQUxTW21hdE5hbWVdPXt9DQoJCQkJI3ByaW50IG1hdE5hbWUNCgkJCQl3cml0ZShsb2csW21hdE5hbWVdLDApDQoJCQkJaWYJbWF0TmFtZToNCgkJCQkJI21hdE5hbWU9bWF0TmFtZS5yZXBsYWNlKCc6JywnJykNCgkJCQkJI2lmICdcXCcgaW4gbWF0TmFtZTptYXROYW1lPW1hdE5hbWUuc3BsaXQoJ1xcJylbMF0NCgkJCQkJY2hhbm5lbHM9eXMuZ2V0KGIsJyJjaGFubmVscyInKQ0KCQkJCQlpZiBjaGFubmVsczoNCgkJCQkJCWZvciBjIGluIGNoYW5uZWxzWzBdLmNoaWxkcmVuOgkJCQkJDQoJCQkJCQkJTUFURVJJQUxTW21hdE5hbWVdW2MuaGVhZGVyLnNwbGl0KCciJylbMV1dPVsnJyxbXSxbXV0NCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGMuZGF0YSwnOicpDQoJCQkJCQkJZW5hYmxlPXlzLmdldFZhbHVlKHZhbHVlcywnImVuYWJsZSInLCdzJykNCgkJCQkJCQlpZiBlbmFibGU6DQoJCQkJCQkJCWlmIGVuYWJsZT09J3RydWUnOg0KCQkJCQkJCQkJZm9yIGQgaW4gYy5jaGlsZHJlbjoNCgkJCQkJCQkJCQlkdmFsdWVzPXlzLnZhbHVlcyhkLmhlYWRlciwnOicpDQoJCQkJCQkJCQkJI3ByaW50IGR2YWx1ZXMNCgkJCQkJCQkJCQlpZiAnInRleHR1cmUiJyBpbiBkLmhlYWRlcjoNCgkJCQkJCQkJCQkJaWYgJyJ1aWQiJyBpbiBkLmRhdGE6DQoJCQkJCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGQuZGF0YSwnOicpDQoJCQkJCQkJCQkJCQl1aWQ9eXMuZ2V0VmFsdWUodmFsdWVzLCcidWlkIicsJyIiJykNCgkJCQkJCQkJCQkJCXdyaXRlKGxvZyxbdWlkXSw0KQ0KCQkJCQkJCQkJCQkJaWYgdWlkIGluIElNQUdFUy5rZXlzKCk6DQoJCQkJCQkJCQkJCQkJZm9yIGZvcm1hdCBpbiBJTUFHRVNbdWlkXToNCgkJCQkJCQkJCQkJCQkJd3JpdGUobG9nLFtmb3JtYXQsSU1BR0VTW3VpZF1bZm9ybWF0XV0sOCkNCgkJCQkJCQkJCQkJCQkJcGFzcw0KCQkJCQkJCQkJCQkJZWxzZToNCgkJCQkJCQkJCQkJCQl3cml0ZShsb2csWydNSVNTSU5HOicsdWlkXSw4KQ0KCQkJCQkJCQkJCQkJCXBhc3MNCgkJCQkJCQkJCQkJCQkNCgkJCQkJCQkJCQkJCU1BVEVSSUFMU1ttYXROYW1lXVtjLmhlYWRlci5zcGxpdCgnIicpWzFdXT1bJ3RleHR1cmUnLHVpZF0NCgkJCQkJCQkJCQkJCXVpZD1NQVRFUklBTFNbbWF0TmFtZV1bYy5oZWFkZXIuc3BsaXQoJyInKVsxXV1bMV0NCgkJCQkJCQkJCQkJCSNwcmludCBJTUFHRVNbdWlkXQ0KCQkJCQkJCQkJCWlmICciY29sb3IiJyBpbiBkLmhlYWRlcjoNCgkJCQkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhkLmRhdGEsJ2YnKQ0KCQkJCQkJCQkJCQlNQVRFUklBTFNbbWF0TmFtZV1bYy5oZWFkZXIuc3BsaXQoJyInKVsxXV09Wydjb2xvcicsdmFsdWVzXQ0KCQkJCQkJCWVsc2U6DQoJCQkJCQkJCQlmb3IgZCBpbiBjLmNoaWxkcmVuOg0KCQkJCQkJCQkJDQoJCQkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhkLmhlYWRlciwnOicpDQoJCQkJCQkJCQkJZW5hYmxlPXlzLmdldFZhbHVlKHZhbHVlcywnImVuYWJsZSInLCdzJykNCgkJCQkJCQkJCQlpZiBlbmFibGU6DQoJCQkJCQkJCQkNCgkJCQkJCQkJCQkJaWYgZW5hYmxlPT0ndHJ1ZSc6DQoJCQkJCQkJCQkJCQkNCgkJCQkJCQkJCQkJCQlkdmFsdWVzPXlzLnZhbHVlcyhkLmhlYWRlciwnOicpDQoJCQkJCQkJCQkJCQkJI3ByaW50IGR2YWx1ZXMNCgkJCQkJCQkJCQkJCQlpZiAnInRleHR1cmUiJyBpbiBkLmhlYWRlcjoNCgkJCQkJCQkJCQkJCQkJaWYgJyJ1aWQiJyBpbiBkLmRhdGE6DQoJCQkJCQkJCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGQuZGF0YSwnOicpDQoJCQkJCQkJCQkJCQkJCQl1aWQ9eXMuZ2V0VmFsdWUodmFsdWVzLCcidWlkIicsJyIiJykNCgkJCQkJCQkJCQkJCQkJCXdyaXRlKGxvZyxbdWlkXSw0KQ0KCQkJCQkJCQkJCQkJCQkJaWYgdWlkIGluIElNQUdFUy5rZXlzKCk6DQoJCQkJCQkJCQkJCQkJCQkJZm9yIGZvcm1hdCBpbiBJTUFHRVNbdWlkXToNCgkJCQkJCQkJCQkJCQkJCQkJd3JpdGUobG9nLFtmb3JtYXQsSU1BR0VTW3VpZF1bZm9ybWF0XSxlbmFibGVdLDgpDQoJCQkJCQkJCQkJCQkJCQkJCXBhc3MNCgkJCQkJCQkJCQkJCQkJCWVsc2U6DQoJCQkJCQkJCQkJCQkJCQkJd3JpdGUobG9nLFsnTUlTU0lORzonLHVpZF0sOCkNCgkJCQkJCQkJCQkJCQkJCQlwYXNzDQoJCQkJCQkJCQkJCQkJCQkJDQoJCQkJCQkJCQkJCQkJCQlNQVRFUklBTFNbbWF0TmFtZV1bYy5oZWFkZXIuc3BsaXQoJyInKVsxXV09Wyd0ZXh0dXJlJyx1aWRdDQoJCQkJCQkJCQkJCQkJCQl1aWQ9TUFURVJJQUxTW21hdE5hbWVdW2MuaGVhZGVyLnNwbGl0KCciJylbMV1dWzFdDQoJCQkJCQkJCQkJCQkJCQkjcHJpbnQgSU1BR0VTW3VpZF0NCgkJCQkJCQkJCQkJCQlpZiAnImNvbG9yIicgaW4gZC5oZWFkZXI6DQoJCQkJCQkJCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoZC5kYXRhLCdmJykNCgkJCQkJCQkJCQkJCQkJTUFURVJJQUxTW21hdE5hbWVdW2MuaGVhZGVyLnNwbGl0KCciJylbMV1dPVsnY29sb3InLHZhbHVlc10NCgkJCQkJCQkJDQoNCg0KZGVmIGFjdGlvblBhcnNlcihmaWxlbmFtZSxnKToNCglhY3Rpb249QWN0aW9uKCkNCglhY3Rpb24uQk9ORVNQQUNFPVRydWUNCglhY3Rpb24uQk9ORVNPUlQ9VHJ1ZQ0KCXdoaWxlKFRydWUpOg0KCQlpZiBnLnRlbGwoKT49Zy5maWxlU2l6ZSgpOmJyZWFrDQoJCWJvbmU9QWN0aW9uQm9uZSgpDQoJCWFjdGlvbi5ib25lTGlzdC5hcHBlbmQoYm9uZSkNCgkJYm9uZS5uYW1lPWcuZmluZCgnXHgwMCcpDQoJCXR5cGU9Zy5maW5kKCdceDAwJykNCgkJI3ByaW50IGJvbmUubmFtZSx0eXBlLGcudGVsbCgpDQoJCWlmIHR5cGU9PSdzaXplJzoNCgkJCWNvdW50PWcuaSgxKVswXQ0KCQkJI3ByaW50IGNvdW50DQoJCQlmb3IgbSBpbiBzYWZlKGNvdW50KToNCgkJCQltYXRyaXg9VmVjdG9yU2NhbGVNYXRyaXgoZy5mKDMpKQ0KCQkJCWJvbmUuc2l6ZUtleUxpc3QuYXBwZW5kKG1hdHJpeCkNCgkJCWNvdW50PWcuaSgxKVswXQ0KCQkJI3ByaW50IGNvdW50DQoJCQlmb3IgbSBpbiBzYWZlKGNvdW50KToNCgkJCQlmcmFtZT1pbnQoZy5mKDEpWzBdKjMzKQ0KCQkJCWJvbmUuc2l6ZUZyYW1lTGlzdC5hcHBlbmQoZnJhbWUpDQoJCWlmIHR5cGU9PSd0cmFuc2xhdGUnOg0KCQkJY291bnQ9Zy5pKDEpWzBdDQoJCQkjcHJpbnQgY291bnQNCgkJCWZvciBtIGluIHNhZmUoY291bnQpOg0KCQkJCW1hdHJpeD1WZWN0b3JNYXRyaXgoZy5mKDMpKQ0KCQkJCWJvbmUucG9zS2V5TGlzdC5hcHBlbmQobWF0cml4KQ0KCQkJY291bnQ9Zy5pKDEpWzBdDQoJCQkjcHJpbnQgY291bnQNCgkJCWZvciBtIGluIHNhZmUoY291bnQpOg0KCQkJCWZyYW1lPWludChnLmYoMSlbMF0qMzMpDQoJCQkJYm9uZS5wb3NGcmFtZUxpc3QuYXBwZW5kKGZyYW1lKQ0KCQlpZiB0eXBlPT0ncXVhdGVybmlvbic6DQoJCQljb3VudD1nLmkoMSlbMF0NCgkJCSNwcmludCBjb3VudA0KCQkJZm9yIG0gaW4gc2FmZShjb3VudCk6DQoJCQkJcXVhdD1RdWF0ZXJuaW9uKGcuZig0KSkNCgkJCQltYXRyaXg9UXVhdE1hdHJpeChxdWF0KS5yZXNpemU0eDQoKQ0KCQkJCWJvbmUucm90S2V5TGlzdC5hcHBlbmQobWF0cml4KQ0KCQkJY291bnQ9Zy5pKDEpWzBdDQoJCQkjcHJpbnQgY291bnQNCgkJCWZvciBtIGluIHNhZmUoY291bnQpOg0KCQkJCWZyYW1lPWludChnLmYoMSlbMF0qMzMpDQoJCQkJYm9uZS5yb3RGcmFtZUxpc3QuYXBwZW5kKGZyYW1lKQ0KCWFjdGlvbi5kcmF3KCkNCglhY3Rpb24uc2V0Q29udGV4dCgpCQ0KCQ0KCQ0KCQ0KZGVmIGdldENhbm9uaWNhbChmaWxlbmFtZSk6DQoJZmlsZT1vcGVuKGZpbGVuYW1lLCdyJykNCglkYXRhPWZpbGUucmVhZCgpDQoJI3ByaW50IGRhdGENCgljYW5vbmljYWw9Tm9uZQ0KCWlmICciY2Fub25pY2FsIicgaW4gZGF0YToNCgkJY2Fub25pY2FsPWRhdGEuc3BsaXQoJyJjYW5vbmljYWwiJylbMV0uc3BsaXQoJyInKVsxXS5zcGxpdCgnLycpWzRdDQoJCSMoJzxsaW5rIHJlbD0iY2Fub25pY2FsIiBocmVmPSJodHRwczovL3NrZXRjaGZhYi5jb20vM2QtbW9kZWxzLycpWzFdLnNwbGl0KCciPicpWzBdDQoJCWlmICItIiBpbiBjYW5vbmljYWw6DQoJCQljYW5vbmljYWw9Y2Fub25pY2FsLnNwbGl0KCItIilbLTFdDQoJI2lmIAkJDQoJZmlsZS5jbG9zZSgpCQ0KCXJldHVybiBjYW5vbmljYWwNCgkJCQkJCQkJCQkNCmRlZiBQYXJzZXIocGF0aCk6DQoJZ2xvYmFsIHN5cyxNQVRFUklBTFMsSU1BR0VTLExBU1ROT0RFTkFNRSxsb2csc2tpcGRlY29kZSxmaWxlbmFtZQ0KCWxvZz1vcGVuKCdsb2cudHh0JywndycpDQoJTEFTVE5PREVOQU1FPU5vbmUNCglNQVRFUklBTFM9e30NCglJTUFHRVM9e30NCgkNCgkNCglmaWxlbmFtZT1wYXRoDQoJc3lzPVN5cyhmaWxlbmFtZSkNCglleHQ9ZmlsZW5hbWUuc3BsaXQoJy4nKVstMV0ubG93ZXIoKQ0KCWlmIGV4dD09J2d6JzoNCgkJb3NnPXN5cy5kaXIrb3Muc2VwKydmaWxlLm9zZ2pzJw0KCQlpZiBvcy5wYXRoLmV4aXN0cyhvc2cpPT1GYWxzZToNCgkJCWNtZD1DbWQoKQ0KCQkJY21kLmlucHV0PWZpbGVuYW1lDQoJCQljbWQuWklQPVRydWUNCgkJCWNtZC5ydW4oKQ0KCQkJbW9kZWw9c3lzLmRpcitvcy5zZXArJ21vZGVsX2ZpbGUuYmluLmd6Jw0KCQkJaWYgb3MucGF0aC5leGlzdHMobW9kZWwpPT1UcnVlOg0KCQkJCWNtZD1DbWQoKQ0KCQkJCWNtZC5pbnB1dD1tb2RlbA0KCQkJCWNtZC5aSVA9VHJ1ZQ0KCQkJCWNtZC5ydW4oKQ0KCQkJb3NnUGFyc2VyKGZpbGVuYW1lLnNwbGl0KCcuZ3onKVswXSkNCgkJDQoJaWYgZXh0PT0nb3NnanMnOg0KCQlvc2dQYXJzZXIoZmlsZW5hbWUpDQoJaWYgZXh0PT0ndHh0JzoNCgkJb3NnUGFyc2VyKGZpbGVuYW1lKQ0KCWlmIGV4dCBpbiBbJ2h0bScsJ2h0bWwnXToNCgkJb3NnPXN5cy5kaXIrb3Muc2VwKydmaWxlLm9zZ2pzLmd6Jw0KCQlpZiBvcy5wYXRoLmV4aXN0cyhvc2cpPT1UcnVlOg0KCQkJY21kPUNtZCgpDQoJCQljbWQuaW5wdXQ9b3NnDQoJCQljbWQuWklQPVRydWUNCgkJCWNtZC5ydW4oKQ0KCQkJbW9kZWw9c3lzLmRpcitvcy5zZXArJ21vZGVsX2ZpbGUuYmluLmd6Jw0KCQllbHNlOg0KCQkJb3NnPXN5cy5kaXIrb3Muc2VwKydmaWxlLm9zZ2pzJw0KCQltb2RlbD1zeXMuZGlyK29zLnNlcCsnbW9kZWxfZmlsZS5iaW4uZ3onDQoJCWlmIG9zLnBhdGguZXhpc3RzKG1vZGVsKT09VHJ1ZToNCgkJCWNtZD1DbWQoKQ0KCQkJY21kLmlucHV0PW1vZGVsDQoJCQljbWQuWklQPVRydWUNCgkJCWNtZC5ydW4oKQ0KCQllbHNlOg0KCQkJbW9kZWw9c3lzLmRpcitvcy5zZXArJ21vZGVsX2ZpbGUuYmluJw0KCQlpZiBvcy5wYXRoLmV4aXN0cyhtb2RlbCk6DQoJCQ0KCQkJcmVzdWx0PTANCgkJCSNyZXN1bHQ9QmxlbmRlci5EcmF3LlB1cE1lbnUoIlNrZXRjaGZhYiBWaWV3ZXIgPyV0fFllc3xObyIpCQ0KCQkJaWYgcmVzdWx0PT0xOg0KCQkJCWNhbm9uaWNhbD1nZXRDYW5vbmljYWwoZmlsZW5hbWUpDQoJCQkJY2hyb21lRXhlPSJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXEdvb2dsZVxDaHJvbWVcQXBwbGljYXRpb25cY2hyb21lLmV4ZSINCgkJCQkjb3Muc3lzdGVtKGNocm9tZUV4ZSkNCgkJCQkjc3VicHJvY2Vzcy5Qb3BlbihbY2hyb21lRXhlLGZpbGVuYW1lXSkud2FpdCgpDQoJCQkJI3R4dD1odG0xK2h0bTIraHRtMw0KCQkJCXR4dD1vcGVuKCJza2V0Y2hmYWIuaHRtbCIsInciKQ0KCQkJCXR4dC53cml0ZShodG0xLnJlcGxhY2UoIiMiLCIiKSkNCgkJCQlpZiBjYW5vbmljYWwgaXMgbm90IE5vbmU6DQoJCQkJDQoJCQkJCXR4dC53cml0ZShjYW5vbmljYWwpDQoJCQkJZWxzZToJDQoJCQkJCSN0eHQud3JpdGUoaHRtMikNCgkJCQkJdHh0LndyaXRlKG9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkuc3BsaXQob3Muc2VwKVstMV0pDQoJCQkJdHh0LndyaXRlKGh0bTMpDQoJCQkJdHh0LmNsb3NlKCkNCgkJCQlzdWJwcm9jZXNzLlBvcGVuKFtjaHJvbWVFeGUsYmxlbmREaXIrb3Muc2VwKyJza2V0Y2hmYWIuaHRtbCJdKSMud2FpdCgpDQoJCQllbHNlOgkNCgkJCQ0KCQkJDQoJCQkJcmVzdWx0PTENCgkJCQlmaWxlU2l6ZT1vcy5wYXRoLmdldHNpemUobW9kZWwpDQoJCQkJI3Jlc3VsdD1CbGVuZGVyLkRyYXcuUHVwTWVudSgiaW1wb3J0ICIrc3RyKHJvdW5kKGZpbGVTaXplLzEwMDAwMDAuMCwxKSkrIiBNYiA/JXR8WWVzfE5vIikNCgkJCQkNCgkJCQlodG1QYXJzZXIoZmlsZW5hbWUpDQoJCQkJaWYgcmVzdWx0PT0xOgkNCgkJCQkJc2tpcGRlY29kZT0wDQoJCQkJCQ0KCQkJCQlpbmRleFJlc3VsdD0wDQoJCQkJCSNyZXN1bHQ9QmxlbmRlci5EcmF3LlB1cE1lbnUoImluZGljZSBwcm9ibGVtIisiID8ldHxZZXN8Tm8iKQ0KCQkJCQlpZiBpbmRleFJlc3VsdD09MToNCgkJCQkJCXNraXBkZWNvZGU9MQ0KCQkJCQkJDQoJCQkJCQ0KCQkJCQkNCgkJCQkJb3NnUGF0aD1zeXMuZGlyK29zLnNlcCsnZmlsZS5vc2dqcycNCgkJCQkJaWYgb3MucGF0aC5leGlzdHMob3NnUGF0aCk9PVRydWU6DQoJCQkJCQlvc2dQYXJzZXIob3NnUGF0aCkNCgkJCQkJCXBhc3MNCgkJCQkJZWxzZToNCgkJCQkJCW9zZ1BhdGg9c3lzLmRpcitvcy5zZXArJ2ZpbGUub3NnanMnDQoJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhvc2dQYXRoKT09VHJ1ZToNCgkJCQkJCQlvc2dQYXJzZXIob3NnUGF0aCkNCgkJCQkJCQlwYXNzCQ0KCQkJCQ0KCWlmIGV4dD09J2FjdGlvbic6DQoJCWZpbGU9b3BlbihmaWxlbmFtZSwncmInKQ0KCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQlhY3Rpb25QYXJzZXIoZmlsZW5hbWUsZykNCgkJZmlsZS5jbG9zZSgpDQoJbG9nLmNsb3NlKCkJDQoJCQ0KbW9kZWxJRCA9IDANClBhcnNlcignLi97dGVtcFBhdGh9L2R1bW15Lmh0bWwnKQ=="));
			blenderScript = blenderScript.Replace("{tempPath}", tempDir);
			if (indexFix)
			{
				blenderScript = blenderScript.Replace("indexResult=0", "indexResult=1");
			}
			if (bindPose == 0)
			{
				blenderScript = blenderScript.Replace("bindPose(bindskeleton.object,skeleton.object,mesh.object)", "print ' '");
			}
			return blenderScript;
		}

		public static string Animated(bool indexFix = false, string tempDir = "_sfTemp")
		{
			string blenderScript = Encoding.UTF8.GetString(Convert.FromBase64String("aW1wb3J0IG5ld0dhbWVMaWINCmZyb20gbmV3R2FtZUxpYiBpbXBvcnQgKg0KaW1wb3J0IEJsZW5kZXINCg0KaW1wb3J0IGFycmF5DQppbXBvcnQgc3VicHJvY2Vzcw0KDQppbXBvcnQgc3lzIGFzIHN5czINCg0KaHRtMT0iIiINCjxoZWFkPg0KICAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iaHR0cHM6Ly9zdGF0aWMuc2tldGNoZmFiLmNvbS9hcGkvc2tldGNoZmFiLXZpZXdlci0xLjMuMC5qcyI+PC9zY3JpcHQ+DQogIA0KICAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL3NoYWRlcmJ5dGVzL1NrZXRjaGZhYi1WaWV3ZXItQVBJLVV0aWxpdHlAdjIuMC4wLjcvU2tldGNoZmFiQVBJVXRpbGl0eS5qcyI+PC9zY3JpcHQ+DQogICANCjwvaGVhZD4NCg0KPGJvZHk+DQogIDxkaXYgY2xhc3M9ImNlbnRlci1kaXYiPg0KCTxpZnJhbWUgaWQ9ImFwaS1mcmFtZSIgd2lkdGg9IjEwMDAiIGhlaWdodD0iNTUwIgkgYWxsb3dmdWxsc2NyZWVuIG1vemFsbG93ZnVsbHNjcmVlbj0idHJ1ZSIgd2Via2l0YWxsb3dmdWxsc2NyZWVuPSJ0cnVlIj48L2lmcmFtZT4NCiAgPC9kaXY+DQogIA0KICA8c2NyaXB0Pg0KCSAgZnVuY3Rpb24gb25Ta2V0Y2hmYWJVdGlsaXR5UmVhZHkoKXsNCgkJIHNrZXRjaGZhYkFQSVV0aWxpdHlJbnN0YW5jZS5yZW1vdmVFdmVudExpc3RlbmVyKHNrZXRjaGZhYkFQSVV0aWxpdHlJbnN0YW5jZS5FVkVOVF9JTklUSUFMSVpFRCwgb25Ta2V0Y2hmYWJVdGlsaXR5UmVhZHkpOw0KCQkgLy9zb21lIGNvZGUgaGVyZS4uDQoJICB9Ow0KCSAgdmFyIHNrZXRjaGZhYkFQSVV0aWxpdHlJbnN0YW5jZSA9IG5ldyBTa2V0Y2hmYWJBUElVdGlsaXR5KCIjIyMiIiINCmh0bTI9IiIiYWY1MjhlM2RmNWY3NjZjYTAxMmY1ZTA2NWM3Y2I4MTIiIiINCmh0bTM9IiIiIiwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFwaS1mcmFtZSIpLCB7ImF1dG9zdGFydCI6IDEgfSk7DQoJICBza2V0Y2hmYWJBUElVdGlsaXR5SW5zdGFuY2UuYWRkRXZlbnRMaXN0ZW5lcihza2V0Y2hmYWJBUElVdGlsaXR5SW5zdGFuY2UuRVZFTlRfSU5JVElBTElaRUQsIG9uU2tldGNoZmFiVXRpbGl0eVJlYWR5KTsNCgkgIHNrZXRjaGZhYkFQSVV0aWxpdHlJbnN0YW5jZS5jcmVhdGUoKTsNCiAgIDwvc2NyaXB0Pg0KICANCjwvYm9keT4NCiIiIg0KDQoNCgkNCmNsYXNzIEJpbmFyeVJlYWRlcihmaWxlKToNCgkiIiJnZW5lcmFsIEJpbmFyeVJlYWRlcg0KCSIiIg0KCWRlZiBfX2luaXRfXyhzZWxmLCBpbnB1dEZpbGUpOg0KCQlzZWxmLmlucHV0RmlsZT1pbnB1dEZpbGUNCgkJc2VsZi5lbmRpYW49JzwnDQoJCXNlbGYuZGVidWc9RmFsc2UNCgkJc2VsZi5zdHJlYW09e30NCgkJc2VsZi5sb2dmaWxlPU5vbmUNCgkJc2VsZi5sb2c9RmFsc2UNCgkJc2VsZi5kaXJuYW1lPUJsZW5kZXIuc3lzLmRpcm5hbWUoc2VsZi5pbnB1dEZpbGUubmFtZSkNCgkJc2VsZi5iYXNlbmFtZT1CbGVuZGVyLnN5cy5iYXNlbmFtZShzZWxmLmlucHV0RmlsZS5uYW1lKS5zcGxpdCgnLicpWzBdDQoJCXNlbGYuZXh0PUJsZW5kZXIuc3lzLmJhc2VuYW1lKHNlbGYuaW5wdXRGaWxlLm5hbWUpLnNwbGl0KCcuJylbLTFdDQoJCXNlbGYueG9yS2V5PU5vbmUNCgkJc2VsZi54b3JPZmZzZXQ9MA0KCQlzZWxmLnhvckRhdGE9JycNCgkJc2VsZi5sb2dza2lwPUZhbHNlDQoJCQ0KCWRlZiBjbG9zZShzZWxmKToNCgkJc2VsZi5pbnB1dEZpbGUuY2xvc2UoKQ0KCQkNCglkZWYgWE9SKHNlbGYsZGF0YSk6DQoJCQlzZWxmLnhvckRhdGE9JycNCgkJCWZvciBtIGluIHJhbmdlKGxlbihkYXRhKSk6DQoJCQkJY2g9b3JkKAljaHIoZGF0YVttXSBeIHNlbGYueG9yS2V5W3NlbGYueG9yT2Zmc2V0XSkJKQ0KCQkJCXNlbGYueG9yRGF0YSs9c3RydWN0LnBhY2soJ0InLGNoKQ0KCQkJCWlmIHNlbGYueG9yT2Zmc2V0PT1sZW4oc2VsZi54b3JLZXkpLTE6DQoJCQkJCXNlbGYueG9yT2Zmc2V0PTANCgkJCQllbHNlOg0KCQkJCQlzZWxmLnhvck9mZnNldCs9MQkNCgkJDQoJCQ0KCWRlZiBsb2dPcGVuKHNlbGYpOgkNCgkJbG9nRGlyPSdsb2cnDQoJCWlmIG9zLnBhdGguZXhpc3RzKGxvZ0Rpcik9PUZhbHNlOm9zLm1ha2VkaXJzKGxvZ0RpcikNCgkJc2VsZi5sb2c9VHJ1ZQ0KCQlzZWxmLmxvZ2ZpbGU9b3Blbihsb2dEaXIrb3Muc2VwK29zLnBhdGguYmFzZW5hbWUoc2VsZi5pbnB1dEZpbGUubmFtZSkrJy5sb2cnLCd3JykNCglkZWYgbG9nQ2xvc2Uoc2VsZik6DQoJCXNlbGYubG9nPUZhbHNlDQoJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZToNCgkJCXNlbGYubG9nZmlsZS5jbG9zZSgpDQoJZGVmIGxvZ1dyaXRlKHNlbGYsZGF0YSk6DQoJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZToNCgkJCXNlbGYubG9nZmlsZS53cml0ZShzdHIoZGF0YSkrJ1xuJykNCgkJZWxzZToNCgkJCXByaW50ICdXQVJOSU5HOiBubyBsb2cnDQoJCQkNCglkZWYgZGlybmFtZShzZWxmKToNCgkJcmV0dXJuIEJsZW5kZXIuc3lzLmRpcm5hbWUoc2VsZi5pbnB1dEZpbGUubmFtZSkNCglkZWYgYmFzZW5hbWUoc2VsZik6DQoJCXJldHVybiBCbGVuZGVyLnN5cy5iYXNlbmFtZShzZWxmLmlucHV0RmlsZS5uYW1lKS5zcGxpdCgnLicpWzBdDQoJZGVmIGV4dChzZWxmKToNCgkJcmV0dXJuIEJsZW5kZXIuc3lzLmJhc2VuYW1lKHNlbGYuaW5wdXRGaWxlLm5hbWUpLnNwbGl0KCcuJylbLTFdDQoJCQ0KCQkNCglkZWYgcShzZWxmLG4pOg0KCQlvZmZzZXQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidxJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qOCkpDQoJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQlwcmludCAncScsZGF0YQ0KCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3N0cihkYXRhKSsnXG4nKQ0KCQlyZXR1cm4gZGF0YQ0KCQkNCglkZWYgaShzZWxmLG4pOg0KCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0ncmInOg0KCQkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkJaWYgc2VsZi54b3JLZXkgaXMgTm9uZToNCgkJCQkjZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2knLHNlbGYuaW5wdXRGaWxlLnJlYWQobio0KSkNCgkJCQkJCQ0KCQkJCWRhdGEgPSBhcnJheS5hcnJheSgnaScpDQoJCQkJZGF0YS5mcm9tZmlsZShzZWxmLmlucHV0RmlsZSwgbikNCgkJCQlpZiBzZWxmLmVuZGlhbiA9PSAiPiI6IGRhdGEuYnl0ZXN3YXAoKQ0KCQkJCQ0KCQkJCQ0KCQkJZWxzZToNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbio0KidCJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qNCkpDQoJCQkJc2VsZi5YT1IoZGF0YSkNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionaScsc2VsZi54b3JEYXRhKQkNCgkJCQkJDQoJCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJCXByaW50ICdpJyxkYXRhDQoJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIob2Zmc2V0KSsnCScrc3RyKGRhdGEpKydcbicpDQoJCQlyZXR1cm4gZGF0YQ0KCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0nd2InOg0KCQkJZm9yIG0gaW4gcmFuZ2UobGVuKG4pKToNCgkJCQlkYXRhPXN0cnVjdC5wYWNrKHNlbGYuZW5kaWFuKydpJyxuW21dKQ0KCQkJCXNlbGYuaW5wdXRGaWxlLndyaXRlKGRhdGEpDQoJDQoJZGVmIEkoc2VsZixuKToNCgkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQlpZiBzZWxmLnhvcktleSBpcyBOb25lOg0KCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ0knLHNlbGYuaW5wdXRGaWxlLnJlYWQobio0KSkNCgkJZWxzZToNCgkJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKjQqJ0InLHNlbGYuaW5wdXRGaWxlLnJlYWQobio0KSkNCgkJCXNlbGYuWE9SKGRhdGEpDQoJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionSScsc2VsZi54b3JEYXRhKQkNCgkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCXByaW50ICdJJyxkYXRhDQoJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIob2Zmc2V0KSsnCScrc3RyKGRhdGEpKydcbicpDQoJCXJldHVybiBkYXRhDQoJDQoJZGVmIEIoc2VsZixuKToNCgkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3JiJzoNCgkJCW9mZnNldD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJCWlmIHNlbGYueG9yS2V5IGlzIE5vbmU6DQoJCQkJI2RhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidCJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4pKQ0KCQkJCQ0KCQkJCWRhdGEgPSBhcnJheS5hcnJheSgnQicpDQoJCQkJZGF0YS5mcm9tZmlsZShzZWxmLmlucHV0RmlsZSwgbikNCgkJCQlpZiBzZWxmLmVuZGlhbiA9PSAiPiI6IGRhdGEuYnl0ZXN3YXAoKQ0KCQkJCQ0KCQkJCQ0KCQkJZWxzZToNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionQicsc2VsZi5pbnB1dEZpbGUucmVhZChuKSkNCgkJCQlzZWxmLlhPUihkYXRhKQ0KCQkJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidCJyxzZWxmLnhvckRhdGEpCQ0KCQkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCQlwcmludCAnQicsZGF0YQ0KCQkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3N0cihkYXRhKSsnXG4nKQ0KCQkJcmV0dXJuIGRhdGENCgkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3diJzoNCgkJCWZvciBtIGluIHJhbmdlKGxlbihuKSk6DQoJCQkJZGF0YT1zdHJ1Y3QucGFjayhzZWxmLmVuZGlhbisnQicsblttXSkNCgkJCQlzZWxmLmlucHV0RmlsZS53cml0ZShkYXRhKQ0KCWRlZiBiKHNlbGYsbik6DQoJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSdyYic6DQoJCQlvZmZzZXQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCQlpZiBzZWxmLnhvcktleSBpcyBOb25lOg0KCQkJCSNkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionYicsc2VsZi5pbnB1dEZpbGUucmVhZChuKSkNCgkJCQlkYXRhID0gYXJyYXkuYXJyYXkoJ2InKQ0KCQkJCWRhdGEuZnJvbWZpbGUoc2VsZi5pbnB1dEZpbGUsIG4pDQoJCQkJaWYgc2VsZi5lbmRpYW4gPT0gIj4iOiBkYXRhLmJ5dGVzd2FwKCkNCgkJCWVsc2U6DQoJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2InLHNlbGYuaW5wdXRGaWxlLnJlYWQobikpDQoJCQkJc2VsZi5YT1IoZGF0YSkNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionYicsc2VsZi54b3JEYXRhKQkNCgkJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQkJcHJpbnQgJ2InLGRhdGENCgkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihvZmZzZXQpKycJJytzdHIoZGF0YSkrJ1xuJykNCgkJCXJldHVybiBkYXRhDQoJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSd3Yic6DQoJCQlmb3IgbSBpbiByYW5nZShsZW4obikpOg0KCQkJCWRhdGE9c3RydWN0LnBhY2soc2VsZi5lbmRpYW4rJ2InLG5bbV0pDQoJCQkJc2VsZi5pbnB1dEZpbGUud3JpdGUoZGF0YSkNCglkZWYgaChzZWxmLG4pOg0KCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0ncmInOg0KCQkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkJaWYgc2VsZi54b3JLZXkgaXMgTm9uZToNCgkJCQkjZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2gnLHNlbGYuaW5wdXRGaWxlLnJlYWQobioyKSkNCgkJCQkNCgkJCQlkYXRhID0gYXJyYXkuYXJyYXkoJ2gnKQ0KCQkJCWRhdGEuZnJvbWZpbGUoc2VsZi5pbnB1dEZpbGUsIG4pDQoJCQkJaWYgc2VsZi5lbmRpYW4gPT0gIj4iOiBkYXRhLmJ5dGVzd2FwKCkNCgkJCQkNCgkJCQkNCgkJCWVsc2U6DQoJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qMionQicsc2VsZi5pbnB1dEZpbGUucmVhZChuKjIpKQ0KCQkJCXNlbGYuWE9SKGRhdGEpDQoJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2gnLHNlbGYueG9yRGF0YSkJDQoJCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJCXByaW50ICdoJyxkYXRhDQoJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIob2Zmc2V0KSsnCScrc3RyKGRhdGEpKydcbicpDQoJCQlyZXR1cm4gZGF0YQ0KCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0nd2InOg0KCQkJZm9yIG0gaW4gcmFuZ2UobGVuKG4pKToNCgkJCQlkYXRhPXN0cnVjdC5wYWNrKHNlbGYuZW5kaWFuKydoJyxuW21dKQ0KCQkJCXNlbGYuaW5wdXRGaWxlLndyaXRlKGRhdGEpDQoJZGVmIEgoc2VsZixuKToNCgkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3JiJzoNCgkJCW9mZnNldD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJCWlmIHNlbGYueG9yS2V5IGlzIE5vbmU6DQoJCQkJI2RhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidIJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qMikpDQoJCQkJDQoJCQkJZGF0YSA9IGFycmF5LmFycmF5KCdIJykNCgkJCQlkYXRhLmZyb21maWxlKHNlbGYuaW5wdXRGaWxlLCBuKQ0KCQkJCWlmIHNlbGYuZW5kaWFuID09ICI+IjogZGF0YS5ieXRlc3dhcCgpDQoJCQkJDQoJCQkJDQoJCQllbHNlOg0KCQkJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKjIqJ0InLHNlbGYuaW5wdXRGaWxlLnJlYWQobioyKSkNCgkJCQlzZWxmLlhPUihkYXRhKQ0KCQkJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidIJyxzZWxmLnhvckRhdGEpCQ0KCQkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCQlwcmludCAnSCcsZGF0YQ0KCQkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3N0cihkYXRhKSsnXG4nKQ0KCQkJcmV0dXJuIGRhdGENCgkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3diJzoNCgkJCWZvciBtIGluIHJhbmdlKGxlbihuKSk6DQoJCQkJZGF0YT1zdHJ1Y3QucGFjayhzZWxmLmVuZGlhbisnSCcsblttXSkNCgkJCQlzZWxmLmlucHV0RmlsZS53cml0ZShkYXRhKQ0KCWRlZiBmKHNlbGYsbik6DQoJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSdyYic6DQoJCQlvZmZzZXQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCQlpZiBzZWxmLnhvcktleSBpcyBOb25lOg0KCQkJCSNkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionZicsc2VsZi5pbnB1dEZpbGUucmVhZChuKjQpKQ0KCQkJCQ0KCQkJCWRhdGEgPSBhcnJheS5hcnJheSgnZicpDQoJCQkJZGF0YS5mcm9tZmlsZShzZWxmLmlucHV0RmlsZSwgbikNCgkJCQlpZiBzZWxmLmVuZGlhbiA9PSAiPiI6IGRhdGEuYnl0ZXN3YXAoKQ0KCQkJCQ0KCQkJZWxzZToNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbio0KidCJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qNCkpDQoJCQkJc2VsZi5YT1IoZGF0YSkNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionZicsc2VsZi54b3JEYXRhKQkNCgkJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQkJcHJpbnQgJ2YnLGRhdGENCgkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihvZmZzZXQpKycJJytzdHIoZGF0YSkrJ1xuJykNCgkJCXJldHVybiBkYXRhDQoJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSd3Yic6DQoJCQlmb3IgbSBpbiByYW5nZShsZW4obikpOg0KCQkJCWRhdGE9c3RydWN0LnBhY2soc2VsZi5lbmRpYW4rJ2YnLG5bbV0pDQoJCQkJc2VsZi5pbnB1dEZpbGUud3JpdGUoZGF0YSkNCglkZWYgZChzZWxmLG4pOg0KCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0ncmInOg0KCQkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkJaWYgc2VsZi54b3JLZXkgaXMgTm9uZToNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionZCcsc2VsZi5pbnB1dEZpbGUucmVhZChuKjgpKQ0KCQkJZWxzZToNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbio0KidCJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qOCkpDQoJCQkJc2VsZi5YT1IoZGF0YSkNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionZCcsc2VsZi54b3JEYXRhKQkNCgkJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQkJcHJpbnQgJ2QnLGRhdGENCgkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihvZmZzZXQpKycJJytzdHIoZGF0YSkrJ1xuJykNCgkJCXJldHVybiBkYXRhDQoJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSd3Yic6DQoJCQlmb3IgbSBpbiByYW5nZShsZW4obikpOg0KCQkJCWRhdGE9c3RydWN0LnBhY2soc2VsZi5lbmRpYW4rJ2QnLG5bbV0pDQoJCQkJc2VsZi5pbnB1dEZpbGUud3JpdGUoZGF0YSkNCglkZWYgaGFsZihzZWxmLG4saD0naCcpOg0KCQlhcnJheSA9IFtdIA0KCQlvZmZzZXQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCWZvciBpZCBpbiByYW5nZShuKTogDQoJCQkjYXJyYXkuYXBwZW5kKGNvbnZlcnRoYWxmMmZsb2F0KHN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rJ0gnLHNlbGYuaW5wdXRGaWxlLnJlYWQoMikpWzBdKSkNCgkJCWFycmF5LmFwcGVuZChjb252ZXJ0aGFsZjJmbG9hdChzdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK2gsc2VsZi5pbnB1dEZpbGUucmVhZCgyKSlbMF0pKQ0KCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJcHJpbnQgJ2hhbGYnLGFycmF5DQoJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIob2Zmc2V0KSsnCScrc3RyKGFycmF5KSsnXG4nKQ0KCQlyZXR1cm4gYXJyYXkNCgkJDQoJZGVmIHNob3J0KHNlbGYsbixoPSdoJyxleHA9MTIpOg0KCQlhcnJheSA9IFtdIA0KCQlvZmZzZXQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCWZvciBpZCBpbiByYW5nZShuKTogDQoJCQlhcnJheS5hcHBlbmQoc3RydWN0LnVucGFjayhzZWxmLmVuZGlhbitoLHNlbGYuaW5wdXRGaWxlLnJlYWQoMikpWzBdKjIqKi1leHApDQoJCQkjYXJyYXkuYXBwZW5kKHNlbGYuSCgxKVswXSoyKiotZXhwKQ0KCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJcHJpbnQgJ3Nob3J0JyxhcnJheQ0KCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3N0cihhcnJheSkrJ1xuJykNCgkJcmV0dXJuIGFycmF5DQoJCQ0KCWRlZiBpMTIoc2VsZixuKToNCgkJYXJyYXkgPSBbXSANCgkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQlmb3IgaWQgaW4gcmFuZ2Uobik6IA0KCQkJaWYgc2VsZi5lbmRpYW49PSc+JzoNCgkJCQl2YXI9J1x4MDAnK3NlbGYuaW5wdXRGaWxlLnJlYWQoMykNCgkJCWlmIHNlbGYuZW5kaWFuPT0nPCc6DQoJCQkJdmFyPXNlbGYuaW5wdXRGaWxlLnJlYWQoMykrJ1x4MDAnDQoJCQlhcnJheS5hcHBlbmQoc3RydWN0LnVucGFjayhzZWxmLmVuZGlhbisnaScsdmFyKVswXSkNCgkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCXByaW50IGFycmF5DQoJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIob2Zmc2V0KSsnCScrc3RyKGFycmF5KSsnXG4nKQ0KCQlyZXR1cm4gYXJyYXkNCgkJDQoJCQ0KCQkNCglkZWYgZmluZChzZWxmLHZhcik6IA0KCQlzdGFydD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJcz0nJw0KCQl3aGlsZShUcnVlKToNCgkJCWM9c2VsZi5pbnB1dEZpbGUucmVhZCgxKQ0KCQkJI3ByaW50IGMNCgkJCWlmIGM9PXZhclswXToNCgkJCQlpZiBsZW4odmFyKT4xOg0KCQkJCQlmb3IgbSBpbiByYW5nZSgxLGxlbih2YXIpKToNCgkJCQkJCWM9c2VsZi5pbnB1dEZpbGUucmVhZCgxKQ0KCQkJCQkJaWYgYyE9dmFyW21dOg0KCQkJCQkJCWJyZWFrDQoJCQkJCWlmIG09PWxlbih2YXIpLTE6DQoJCQkJCQlicmVhaw0KCQkJCWVsc2U6DQoJCQkJCWJyZWFrDQoJCQllbHNlOgkNCgkJCQlzKz1jCQ0KCQkJCQkJDQoJCQ0KCQkNCgkJDQoJCQ0KCQkjaWYgc2VsZi5sb2c9PVRydWU6DQoJCSMJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCSMJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKHN0YXJ0KSsnCScrcysnXG4nKQ0KCQlyZXR1cm4gcwkNCgkNCglkZWYgZmluZDEoc2VsZix2YXIsc2l6ZT05OTkpOiANCgkJDQoJCXN0YXJ0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQlzPScnDQoJCXdoaWxlKFRydWUpOg0KCQkJZGF0YT1zZWxmLmlucHV0RmlsZS5yZWFkKHNpemUpDQoJCQlvZmY9ZGF0YS5maW5kKHZhcikNCgkJCSNwcmludCBvZmYNCgkJCWlmIG9mZj49MDoNCgkJCQlzKz1kYXRhWzpvZmZdDQoJCQkJc2VsZi5pbnB1dEZpbGUuc2VlayhzdGFydCtvZmYrbGVuKHZhcikpDQoJCQkJI3ByaW50ICd6bmFsZXppb25vJyx2YXIsJ29mZnNldD0nLHNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkJCWJyZWFrDQoJCQllbHNlOg0KCQkJCXMrPWRhdGENCgkJCQlzdGFydCs9c2l6ZQ0KCQkJI3ByaW50IHNlbGYuaW5wdXRGaWxlLnRlbGwoKQksc2VsZi5maWxlU2l6ZSgpDQoJCQlpZiBzZWxmLmlucHV0RmlsZS50ZWxsKCk+PXNlbGYuZmlsZVNpemUoKTpicmVhawkNCgkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCXByaW50IHMNCgkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihzdGFydCkrJwknK3MrJ1xuJykNCgkJcmV0dXJuIHMJDQoJCQ0KCWRlZiBmaW5kMTAoc2VsZix2YXIpOiANCgkJDQoJCXN0YXJ0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQlzPScnDQoJCWRhdGE9c2VsZi5pbnB1dEZpbGUucmVhZCgpDQoJCW9mZj1kYXRhLmZpbmQodmFyKQ0KCQlpZiBvZmY+PTA6DQoJCQlzKz1kYXRhWzpvZmZdDQoJCQlzZWxmLmlucHV0RmlsZS5zZWVrKHN0YXJ0K29mZitsZW4odmFyKSkNCgkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihzdGFydCkrJwknK3MrJ1xuJykNCgkJcmV0dXJuIHMJDQoJDQoJZGVmIGZpbmRBbGwoc2VsZix2YXIsc2l6ZT0xMDApOiANCgkJbGlzdD1bXQ0KCQl3aGlsZShUcnVlKToNCgkJCXN0YXJ0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkJZGF0YT1zZWxmLmlucHV0RmlsZS5yZWFkKHNpemUpDQoJCQlvZmY9ZGF0YS5maW5kKHZhcikNCgkJCSNwcmludCBvZmYsc2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCQlpZiBvZmY+PTA6DQoJCQkJbGlzdC5hcHBlbmQoc3RhcnQrb2ZmKQ0KCQkJCSNwcmludCBzdGFydCtvZmYNCgkJCQlzZWxmLmlucHV0RmlsZS5zZWVrKHN0YXJ0K29mZitsZW4odmFyKSkNCgkJCQkjaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCQkjCXByaW50IHN0YXJ0K29mZg0KCQkJZWxzZToNCgkJCQlzdGFydCs9c2l6ZQ0KCQkJCXNlbGYuaW5wdXRGaWxlLnNlZWsoc3RhcnQpDQoJCQlpZglzZWxmLmlucHV0RmlsZS50ZWxsKCk+c2VsZi5maWxlU2l6ZSgpOg0KCQkJCWJyZWFrDQoJCXJldHVybiBsaXN0CQ0KCQkNCgkJDQoJZGVmIGZpbmRjaGFyKHNlbGYsdmFyKToNCgkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLmZpbmQodmFyKQ0KCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJcHJpbnQgdmFyLCd6bmFsZXppb25vJyxvZmZzZXQNCgkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUodmFyKycgem5hbGV6aW9ubyAnK3N0cihvZmZzZXQpKydcbicpDQoJCXJldHVybiBvZmZzZXQJDQoJCQ0KCQkNCglkZWYgZmlsZVNpemUoc2VsZik6DQoJCWJhY2s9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCXNlbGYuaW5wdXRGaWxlLnNlZWsoMCwyKQ0KCQl0ZWxsPXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkjc2VsZi5pbnB1dEZpbGUuc2VlaygwKQ0KCQlzZWxmLmlucHV0RmlsZS5zZWVrKGJhY2spDQoJCXJldHVybiB0ZWxsDQoJCQ0KCWRlZiBzZWVrKHNlbGYsb2ZmLGE9MCk6DQoJCXNlbGYuaW5wdXRGaWxlLnNlZWsob2ZmLGEpDQoJDQoJZGVmIHNlZWtwYWQoc2VsZixwYWQsdHlwZT0wKToNCgkJJycnIDE2LWJ5dGUgY2h1bmsgYWxpZ25tZW50JycnDQoJCXNpemU9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCXNlZWsgPSAocGFkIC0gKHNpemUgJSBwYWQpKSAlIHBhZA0KCQlpZiB0eXBlPT0xOg0KCQkJaWYgc2Vlaz09MDoNCgkJCQlzZWVrKz1wYWQNCgkJc2VsZi5pbnB1dEZpbGUuc2VlayhzZWVrLCAxKQ0KCQkNCglkZWYgcmVhZChzZWxmLGNvdW50KToNCgkJYmFjaz1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJaWYgc2VsZi54b3JLZXkgaXMgTm9uZToNCgkJCXJldHVybiBzZWxmLmlucHV0RmlsZS5yZWFkKGNvdW50KQ0KCQllbHNlOg0KCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK2NvdW50KidCJyxzZWxmLmlucHV0RmlsZS5yZWFkKGNvdW50KSkNCgkJCXNlbGYuWE9SKGRhdGEpDQoJCQlyZXR1cm4gc2VsZi54b3JEYXRhDQoJCQkNCgkNCgkJDQoJZGVmIHdyaXRlKHNlbGYsc3RyaW5nKToNCgkJc2VsZi5pbnB1dEZpbGUud3JpdGUoc3RyaW5nKQ0KCQkNCglkZWYgdGVsbChzZWxmKToNCgkJdmFsPXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJcHJpbnQgJ2N1cnJlbnQgb2Zmc2V0IGlzJyx2YWwNCgkJcmV0dXJuIHZhbAkNCgkJDQoJZGVmIHdvcmQoc2VsZixsb25nKToNCgkJaWYgbG9uZzwxMDAwMDoNCgkJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSdyYic6IA0KCQkJCW9mZnNldD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJCQlzPScnDQoJCQkJZm9yIGogaW4gcmFuZ2UoMCxsb25nKTogDQoJCQkJCQ0KCQkJCQkNCgkJCQkJaWYgc2VsZi54b3JLZXkgaXMgTm9uZToNCgkJCQkJCWxpdCA9ICBzdHJ1Y3QudW5wYWNrKCdjJyxzZWxmLmlucHV0RmlsZS5yZWFkKDEpKVswXQ0KCQkJCQkJI2RhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidpJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qNCkpDQoJCQkJCWVsc2U6DQoJCQkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rJ0InLHNlbGYuaW5wdXRGaWxlLnJlYWQoMSkpDQoJCQkJCQlzZWxmLlhPUihkYXRhKQ0KCQkJCQkJbGl0PXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rJ2MnLHNlbGYueG9yRGF0YSlbMF0NCgkJCQkJDQoJCQkJCQkjbGl0ID0Jc3RydWN0LnVucGFjaygnYycsc2VsZi5pbnB1dEZpbGUucmVhZCgxKSlbMF0NCgkJCQkJDQoJCQkJCQ0KCQkJCQkNCgkJCQkJaWYgb3JkKGxpdCkhPTA6DQoJCQkJCQlzKz1saXQNCgkJCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJCQlwcmludCBzDQoJCQkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIob2Zmc2V0KSsnCScrcysnXG4nKQ0KCQkJCXJldHVybiBzDQoJCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0nd2InOg0KCQkJCSNkYXRhPXNlbGYuaW5wdXRGaWxlLnJlYWQobG9uZykNCgkJCQlzZWxmLmlucHV0RmlsZS53cml0ZShsb25nKQ0KCQkJI3JldHVybiAwCQ0KCQllbHNlOg0KCQkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCQlwcmludCAnV0FSTklORzp0b28gbG9uZycNCgkJCSNyZXR1cm4gMQ0KCQkNCgkJDQoJCQ0KCWRlZiBzKHNlbGYsbG9uZyk6DQoJCWlmIGxvbmc8MTAwMDA6DQoJCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0ncmInOiANCgkJCQlvZmZzZXQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCQkJcz0nJw0KCQkJCWZvciBqIGluIHJhbmdlKDAsbG9uZyk6IA0KCQkJCQkNCgkJCQkJDQoJCQkJCWlmIHNlbGYueG9yS2V5IGlzIE5vbmU6DQoJCQkJCQlsaXQgPSAgc3RydWN0LnVucGFjaygnYycsc2VsZi5pbnB1dEZpbGUucmVhZCgxKSlbMF0NCgkJCQkJCSNkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionaScsc2VsZi5pbnB1dEZpbGUucmVhZChuKjQpKQ0KCQkJCQllbHNlOg0KCQkJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuKydCJyxzZWxmLmlucHV0RmlsZS5yZWFkKDEpKQ0KCQkJCQkJc2VsZi5YT1IoZGF0YSkNCgkJCQkJCWxpdD1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuKydjJyxzZWxmLnhvckRhdGEpWzBdDQoJCQkJCQ0KCQkJCQkJI2xpdCA9CXN0cnVjdC51bnBhY2soJ2MnLHNlbGYuaW5wdXRGaWxlLnJlYWQoMSkpWzBdDQoJCQkJCQ0KCQkJCQkNCgkJCQkJDQoJCQkJCWlmIG9yZChsaXQpIT0wOg0KCQkJCQkJcys9bGl0DQoJCQkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCQkJcHJpbnQgcw0KCQkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3MrJ1xuJykNCgkJCQlyZXR1cm4gcw0KCQkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3diJzoNCgkJCQkjZGF0YT1zZWxmLmlucHV0RmlsZS5yZWFkKGxvbmcpDQoJCQkJc2VsZi5pbnB1dEZpbGUud3JpdGUobG9uZykNCgkJCSNyZXR1cm4gMAkNCgkJZWxzZToNCgkJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQkJcHJpbnQgJ1dBUk5JTkc6dG9vIGxvbmcnDQoJCQkjcmV0dXJuIDENCgkJDQoJCQ0KCWRlZiBTdHJlYW0oc2VsZixzdHJlYW1fbmFtZSxlbGVtZW50X2NvdW50LGVsZW1lbnRfc2l6ZSk6DQoJCXNlbGYuaW5wdXRGaWxlLnNlZWsoZWxlbWVudF9jb3VudCplbGVtZW50X3NpemUsMSkNCgkJc2VsZi5zdHJlYW1bc3RyZWFtX25hbWVdWydvZmZzZXQnXT1vZmZzZXQNCgkJc2VsZi5zdHJlYW1bc3RyZWFtX25hbWVdWydlbGVtZW50X2NvdW50J109ZWxlbWVudF9jb3VudAkNCgkJc2VsZi5zdHJlYW1bc3RyZWFtX25hbWVdWydlbGVtZW50X3NpemUnXT1lbGVtZW50X3NpemUJDQoJCQ0KDQoNCg0KZGVmIGdldE1hdE5hbWUoeXMscGFyZW50KToNCgkjcHJpbnQgJ2dldE1hdE5hbWUnDQoJbWF0TmFtZT1Ob25lDQoJaWYJbWF0TmFtZSBub3QgaW4gTUFURVJJQUxTLmtleXMoKToNCgkJVW5pcXVlSUQ9eXMuZ2V0KHBhcmVudCwnIlVuaXF1ZUlEIicpDQoJCWlmIFVuaXF1ZUlEOg0KCQkJdmFsdWVzPXlzLnZhbHVlcyhVbmlxdWVJRFswXS5oZWFkZXIsJ3MnKQ0KCQkJaWYgbGVuKHZhbHVlcyk+MToNCgkJCQlpZiAnIicgaW4gdmFsdWVzWzFdIGFuZCAnXycgaW4gdmFsdWVzWzFdOg0KCQkJCQltYXROYW1lPXZhbHVlc1sxXS5zcGxpdCgnIicpWzNdLnNwbGl0KCdfJylbLTJdDQoJDQoJcmdiYT1Ob25lCQ0KCUF0dHJpYnV0ZUxpc3Q9eXMuZ2V0KHBhcmVudCwnIkF0dHJpYnV0ZUxpc3QiJykJDQoJaWYgQXR0cmlidXRlTGlzdDoJCQkNCgkJdmFsdWVzPXlzLnZhbHVlcyhBdHRyaWJ1dGVMaXN0WzBdLmhlYWRlciwnOicpDQoJCVVuaXF1ZUlEPXlzLmdldFZhbHVlKHZhbHVlcywnIlVuaXF1ZUlEIicsJ2knKQ0KCQlEaWZmdXNlPXlzLmdldChwYXJlbnQsJyJEaWZmdXNlIicpDQoJCWlmIERpZmZ1c2U6DQoJCQlyZ2JhPXlzLnZhbHVlcyhEaWZmdXNlWzBdLmRhdGEsJ2YnKQkJCQkNCgkJaWYJbWF0TmFtZSBub3QgaW4gTUFURVJJQUxTLmtleXMoKToNCgkJCU1hdGVyaWFsPXlzLmdldChBdHRyaWJ1dGVMaXN0WzBdLCcib3NnLk1hdGVyaWFsIicpDQoJCQlpZiBNYXRlcmlhbDoJDQoJCQkJZm9yIGEgaW4gTWF0ZXJpYWxbMF0uY2hpbGRyZW46DQoJCQkJCWlmICciTmFtZSInIGluIGEuaGVhZGVyOgkJCQkJCQkJDQoJCQkJCQlzcGxpdHM9YS5oZWFkZXIuc3BsaXQoJyInKQ0KCQkJCQkJaWYgbGVuKHNwbGl0cyk+NDoNCgkJCQkJCQltYXROYW1lPXNwbGl0c1s1XQ0KCQkJCQkJCWlmICc6JyBpbiBtYXROYW1lOg0KCQkJCQkJCQltYXROYW1lPW1hdE5hbWUucmVwbGFjZSgnOicsJycpDQoJCQkJCQkJbW9kZWwubWF0TGlzdFtVbmlxdWVJRF09bWF0TmFtZQkNCgkJCQkNCglpZgltYXROYW1lIG5vdCBpbiBNQVRFUklBTFMua2V5cygpOgkNCgkJU3RhdGVTZXQ9eXMuZ2V0KHBhcmVudCwnIlN0YXRlU2V0IicpDQoJCWlmIFN0YXRlU2V0Og0KCQkJb3NnU3RhdGVTZXQ9eXMuZ2V0KFN0YXRlU2V0WzBdLCcib3NnLlN0YXRlU2V0IicpDQoJCQlpZiBvc2dTdGF0ZVNldDoJDQoJCQkJaWYgbGVuKG9zZ1N0YXRlU2V0WzBdLmNoaWxkcmVuKT4wOg0KCQkJCQlmb3IgY2hpbGQgaW4gb3NnU3RhdGVTZXRbMF0uY2hpbGRyZW46CQkJCQ0KCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5oZWFkZXIsJzonKQ0KCQkJCQkJaWYgJyJVbmlxdWVJRCInIGluIHZhbHVlcyBhbmQgJyJOYW1lIicgaW4gdmFsdWVzOg0KCQkJCQkJCVVuaXF1ZUlEPXlzLmdldFZhbHVlKHZhbHVlcywnIlVuaXF1ZUlEIicsJ2knKQ0KCQkJCQkJCW1hdE5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciTmFtZSInLCciIicpDQoJCQkJCQkJbW9kZWwubWF0TGlzdFtVbmlxdWVJRF09bWF0TmFtZQ0KCQkJCWVsc2U6CQkJCQ0KCQkJCQl2YWx1ZXM9eXMudmFsdWVzKG9zZ1N0YXRlU2V0WzBdLmRhdGEsJzonKQ0KCQkJCQlpZiAnIkF0dHJpYnV0ZUxpc3QiJyBub3QgaW4gdmFsdWVzOg0KCQkJCQkJVW5pcXVlSUQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciVW5pcXVlSUQiJywnaScpDQoJCQkJCQlpZiBVbmlxdWVJRCBpbiBtb2RlbC5tYXRMaXN0Og0KCQkJCQkJCW1hdE5hbWU9bW9kZWwubWF0TGlzdFtVbmlxdWVJRF0NCgkJCQ0KCWlmCW1hdE5hbWU6CQ0KCQlpZglsZW4obWF0TmFtZSk9PTA6DQoJCQltYXROYW1lPSdSb290Tm9kZScNCgkJaWYgJ1x4ZWYnIGluIG1hdE5hbWU6DQoJCQltYXROYW1lPW1hdE5hbWUuc3BsaXQoJ1x4ZWYnKVswXQ0KCWRpZmZ1c2U9Tm9uZQkJDQoJbm9ybWFsPU5vbmUJDQoJc3BlY3VsYXI9Tm9uZQ0KCXRyYW5zPU5vbmUJDQoJYW89Tm9uZQ0KCXJnYkNvbD1Ob25lDQoJcmdiU3BlYz1Ob25lDQoJDQoJDQoJDQoJDQoJDQoJaWYgbGVuKE1BVEVSSUFMUy5rZXlzKCkpPT0xOg0KCQkJa2V5PU1BVEVSSUFMUy5rZXlzKClbMF0NCgkJCWZvciBpbWFnZVR5cGUgaW4gTUFURVJJQUxTW2tleV06DQoJCQkJaWYgTUFURVJJQUxTW2tleV1baW1hZ2VUeXBlXVswXT09J3RleHR1cmUnOg0KCQkJCQloYXNoPU1BVEVSSUFMU1trZXldW2ltYWdlVHlwZV1bMV0JCQkJCQ0KCQkJCQlpZiBoYXNoIGluIElNQUdFUy5rZXlzKCk6DQoJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ1JHQiddOg0KCQkJCQkJCXBhdGgsZXhpc3RzLHF1YWxpdHk9SU1BR0VTW2hhc2hdWydSR0InXQ0KCQkJCQkJCWlmIGV4aXN0cz09MToNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nT3BhY2l0eSc6dHJhbnM9cGF0aA0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdBbGJlZG9QQlInOmRpZmZ1c2U9cGF0aA0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdEaWZmdXNlQ29sb3InOmRpZmZ1c2U9cGF0aA0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdOb3JtYWxNYXAnOm5vcm1hbD1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J1NwZWN1bGFyQ29sb3InOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nRGlmZnVzZVBCUic6ZGlmZnVzZT1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J1NwZWN1bGFyRjAnOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nU3BlY3VsYXJDb2xvcic6c3BlY3VsYXI9cGF0aA0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdEaWZmdXNlSW50ZW5zaXR5Jzphbz1wYXRoDQoJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ0EnXToNCgkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnQSddDQoJCQkJCQkJaWYgZXhpc3RzPT0xOg0KCQkJCQkJCQl0cmFucz1wYXRoDQoJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ04nXToNCgkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnTiddDQoJCQkJCQkJaWYgZXhpc3RzPT0xOg0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdOb3JtYWxNYXAnOm5vcm1hbD1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J0J1bXBNYXAnOm5vcm1hbD1wYXRoDQoJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ1InXToNCgkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnUiddDQoJCQkJCQkJaWYgZXhpc3RzPT0xOg0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdPcGFjaXR5Jzp0cmFucz1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J1NwZWN1bGFyRjAnOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nQU9QQlInOmFvPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nUm91Z2huZXNzUEJSJzpzcGVjdWxhcj1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J0dsb3NzaW5lc3NQQlInOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nQnVtcE1hcCc6bm9ybWFsPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nU3BlY3VsYXJDb2xvcic6c3BlY3VsYXI9cGF0aA0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdEaWZmdXNlSW50ZW5zaXR5Jzphbz1wYXRoDQoJCQkJaWYgTUFURVJJQUxTW2tleV1baW1hZ2VUeXBlXVswXT09J2NvbG9yJzoNCgkJCQkJaWYgaW1hZ2VUeXBlPT0nRGlmZnVzZUNvbG9yJzoNCgkJCQkJCXJnYkNvbD1NQVRFUklBTFNba2V5XVtpbWFnZVR5cGVdWzFdDQoJCQkJCQkJCQ0KCWVsc2U6CQkJCQkJCQ0KCQlmb3Iga2V5IGluIE1BVEVSSUFMUy5rZXlzKCk6DQoJCQlpZiBrZXk9PW1hdE5hbWU6DQoJCQkJZm9yIGltYWdlVHlwZSBpbiBNQVRFUklBTFNba2V5XToNCgkJCQkJaWYgTUFURVJJQUxTW2tleV1baW1hZ2VUeXBlXVswXT09J3RleHR1cmUnOg0KCQkJCQkJaGFzaD1NQVRFUklBTFNba2V5XVtpbWFnZVR5cGVdWzFdCQkJCQkNCgkJCQkJCWlmIGhhc2ggaW4gSU1BR0VTLmtleXMoKToNCgkJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ1JHQiddOg0KCQkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnUkdCJ10NCgkJCQkJCQkJaWYgZXhpc3RzPT0xOg0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nQWxiZWRvUEJSJzpkaWZmdXNlPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J0RpZmZ1c2VDb2xvcic6ZGlmZnVzZT1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdEaWZmdXNlUEJSJzpkaWZmdXNlPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J05vcm1hbE1hcCc6bm9ybWFsPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J0VtaXRDb2xvcic6ZGlmZnVzZT1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdTcGVjdWxhclBCUic6c3BlY3VsYXI9cGF0aA0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nT3BhY2l0eSc6dHJhbnM9cGF0aA0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nU3BlY3VsYXJGMCc6c3BlY3VsYXI9cGF0aA0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nU3BlY3VsYXJDb2xvcic6c3BlY3VsYXI9cGF0aA0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nRGlmZnVzZUludGVuc2l0eSc6YW89cGF0aA0KCQkJCQkJCWlmIElNQUdFU1toYXNoXVsnQSddOg0KCQkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnQSddDQoJCQkJCQkJCWlmIGV4aXN0cz09MToNCgkJCQkJCQkJCXRyYW5zPXBhdGgNCgkJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ04nXToNCgkJCQkJCQkJcGF0aCxleGlzdHMscXVhbGl0eT1JTUFHRVNbaGFzaF1bJ04nXQ0KCQkJCQkJCQlpZiBleGlzdHM9PTE6DQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdOb3JtYWxNYXAnOm5vcm1hbD1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdCdW1wTWFwJzpub3JtYWw9cGF0aA0KCQkJCQkJCWlmIElNQUdFU1toYXNoXVsnUiddOg0KCQkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnUiddDQoJCQkJCQkJCWlmIGV4aXN0cz09MToNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J09wYWNpdHknOnRyYW5zPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J1NwZWN1bGFyRjAnOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J0FPUEJSJzphbz1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdSb3VnaG5lc3NQQlInOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J0dsb3NzaW5lc3NQQlInOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J0J1bXBNYXAnOm5vcm1hbD1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdTcGVjdWxhckNvbG9yJzpzcGVjdWxhcj1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdEaWZmdXNlSW50ZW5zaXR5Jzphbz1wYXRoDQoJCQkJCWlmIE1BVEVSSUFMU1trZXldW2ltYWdlVHlwZV1bMF09PSdjb2xvcic6DQoJCQkJCQlpZiBpbWFnZVR5cGU9PSdEaWZmdXNlQ29sb3InOg0KCQkJCQkJCXJnYkNvbD1NQVRFUklBTFNba2V5XVtpbWFnZVR5cGVdWzFdDQoJCQkJDQoJVGV4dHVyZUF0dHJpYnV0ZUxpc3Q9eXMuZ2V0KHBhcmVudCwnIlRleHR1cmVBdHRyaWJ1dGVMaXN0IicpDQoJaWYgVGV4dHVyZUF0dHJpYnV0ZUxpc3Q6DQoJCQkjcHJpbnQgJ2hlcmUnDQoJCQlvc2dfVGV4dHVyZT15cy5nZXQocGFyZW50LCcib3NnLlRleHR1cmUiJykNCgkJCWlmIG9zZ19UZXh0dXJlOg0KCQkJCXZhbHVlcz15cy52YWx1ZXMob3NnX1RleHR1cmVbMF0uZGF0YSwnOicpCQkJCQ0KCQkJCWhhc2g9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInLCciIicpDQoJCQkJaWYgaGFzaDoNCgkJCQkJaWYgJy8nIGluIGhhc2g6DQoJCQkJCQloYXNoPWhhc2guc3BsaXQoJy8nKVsxXQ0KCQkJCQkJI3ByaW50IGhhc2gNCgkJCQkJCWlmIGhhc2ggaW4gSU1BR0VTLmtleXMoKToNCgkJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ1JHQiddOg0KCQkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnUkdCJ10NCgkJCQkJCQkJaWYgZXhpc3RzPT0xOg0KCQkJCQkJCQkJZGlmZnVzZT1wYXRoDQoJCQkJCQkJaWYgSU1BR0VTW2hhc2hdWydBJ106DQoJCQkJCQkJCXBhdGgsZXhpc3RzLHF1YWxpdHk9SU1BR0VTW2hhc2hdWydBJ10NCgkJCQkJCQkJaWYgZXhpc3RzPT0xOg0KCQkJCQkJCQkJdHJhbnM9cGF0aA0KCQkJCQkJCWlmIElNQUdFU1toYXNoXVsnTiddOg0KCQkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnTiddDQoJCQkJCQkJCWlmIGV4aXN0cz09MToNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J05vcm1hbE1hcCc6bm9ybWFsPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J0J1bXBNYXAnOm5vcm1hbD1wYXRoDQoJCQ0KCXJldHVybiBtYXROYW1lLGRpZmZ1c2Usc3BlY3VsYXIsbm9ybWFsLGFvLHRyYW5zLHJnYkNvbCxyZ2JTcGVjLHJnYmENCgkNCg0KZGVmIGdldFNwbGl0TmFtZShuYW1lLHdoYXQsd2hpY2gpOg0KCWE9Tm9uZQ0KCWlmIHdoYXQgaW4gbmFtZToNCgkJYT0nJw0KCQlzcGxpdHM9bmFtZS5zcGxpdCh3aGF0KQ0KCQlpZiB3aGljaDwwOg0KCQkJbnVtPWxlbihzcGxpdHMpK3doaWNoLTENCgkJZWxzZToNCgkJCW51bT13aGljaA0KCQlpZiBudW08MDoNCgkJCWE9bmFtZQ0KCQllbHNlOgkJDQoJCQlpZiB3aGljaDxsZW4oc3BsaXRzKToJCQkNCgkJCQlmb3IgbSBpbiByYW5nZShudW0pOg0KCQkJCQlhKz1zcGxpdHNbbV0rd2hhdA0KCQkJCWErPXNwbGl0c1tudW1dDQoJCQllbHNlOg0KCQkJCWE9bmFtZQkJDQoJcmV0dXJuIGEJDQoJCQ0KDQpkZWYgZXRhcDEoaW5wdXQsSXRlbVNpemUpOg0KCW49bGVuKGlucHV0KS9JdGVtU2l6ZQ0KCXI9MA0KCW91dHB1dD1bMF0qbGVuKGlucHV0KQ0KCXdoaWxlKHI8bik6DQoJCWE9cipJdGVtU2l6ZQ0KCQlzPTANCgkJd2hpbGUoczxJdGVtU2l6ZSk6DQoJCQlvdXRwdXRbYStzXT1pbnB1dFtyK24qc10NCgkJCXMrPTEJDQoJCXIrPTENCglyZXR1cm4gb3V0cHV0CQ0KCQ0KZGVmIGV0YXAyKGlucHV0LEl0ZW1TaXplLGF0cmlidXRlcyk6DQoJaT1bYXRyaWJ1dGVzWyciYngiJ10sYXRyaWJ1dGVzWyciYnkiJ10sYXRyaWJ1dGVzWyciYnoiJ11dDQoJbj1bYXRyaWJ1dGVzWyciaHgiJ10sYXRyaWJ1dGVzWyciaHkiJ10sYXRyaWJ1dGVzWyciaHoiJ11dDQoJYT1sZW4oaW5wdXQpL0l0ZW1TaXplDQoJcz0wDQoJb3V0cHV0PVswXSpsZW4oaW5wdXQpDQoJd2hpbGUoczxhKToNCgkJbz1zKkl0ZW1TaXplDQoJCXU9MA0KCQl3aGlsZSh1PEl0ZW1TaXplKToNCgkJCW91dHB1dFtvK3VdPWlbdV0raW5wdXRbbyt1XSpuW3VdOw0KCQkJdSs9MQkNCgkJcys9MQ0KCXJldHVybiBvdXRwdXQJDQoJDQoJDQoJDQoJDQpkZWYgZXRhcDMoaW5wdXQsSXRlbVNpemUpOg0KCWk9SXRlbVNpemV8MQ0KCW49MQ0KCXI9bGVuKGlucHV0KS9pDQoJd2hpbGUobjxyKToNCgkJYT0obi0xKSppDQoJCXM9bippDQoJCW89MA0KCQl3aGlsZShvPGkpOgkJCQ0KCQkJaW5wdXRbcytvXSs9aW5wdXRbYStvXQ0KCQkJbys9MQkNCgkJbis9MQ0KCXJldHVybiBpbnB1dA0KCQ0KZGVmIGV0YXA0KGlucHV0KToNCgllPTENCglpPWxlbihpbnB1dCkvNA0KCXdoaWxlKGU8aSk6DQoJCW49NCooZS0xKQ0KCQlyPTQqZQ0KCQlhPWlucHV0W25dDQoJCXM9aW5wdXRbbisxXQ0KCQlvPWlucHV0W24rMl0NCgkJdT1pbnB1dFtuKzNdDQoJCWw9aW5wdXRbcl0NCgkJaD1pbnB1dFtyKzFdDQoJCWM9aW5wdXRbcisyXQ0KCQlkPWlucHV0W3IrM10NCgkJaW5wdXRbcl09YSpkK3MqYy1vKmgrdSpsDQoJCWlucHV0W3IrMV09LWEqYytzKmQrbypsK3UqaA0KCQlpbnB1dFtyKzJdPWEqaC1zKmwrbypkK3UqYw0KCQlpbnB1dFtyKzNdPS1hKmwtcypoLW8qYyt1KmQNCgkJZSs9MQ0KCXJldHVybglpbnB1dA0KCQ0KDQoNCmRlZiBpbnQzZmxvYXQ0KGlucHV0LGF0cmlidXRlcyxJdGVtU2l6ZSk6DQoJYz00DQoJZD1hdHJpYnV0ZXNbJyJlcHNpbG9uIiddDQoJcD1pbnQoYXRyaWJ1dGVzWycibnBoaSInXSkNCgllPVswXSpsZW4oaW5wdXQpKjQNCglpPTEuNTcwNzk2MzI2NzkNCgluPTYuMjgzMTg1MzA3MTgNCglyPTMuMTQxNTkyNjUzNTkNCglhPTAuMDE3NDUzMjkyNTENCglzPTAuMjUNCglvPTcyMA0KCXU9ODMyDQoJbD00NzkzODM2MjU4NDE1MTYzNWUtMjENCgloPXt9DQoJZj1UcnVlDQoJDQoJZD1kIG9yIHMNCglwPXAgb3Igbw0KCWc9bWF0aC5jb3MoZCphKQ0KCW09MA0KCXY9MA0KCV89W10NCgkNCgl2PShwKzEpKih1KzEpKjMNCglfPVtOb25lXSp2DQoJDQoJYj1yL2Zsb2F0KHAtMSkNCgl4PWkvZmxvYXQocC0xKQ0KCQ0KCWlmIGY6eT0zDQoJZWxzZTp5PTINCgkJDQoJCQ0KCW09MA0KCXY9bGVuKGlucHV0KS95DQoJd2hpbGUobTx2KToNCgkJQT1tKmMNCgkJUz1tKnkNCgkJQz1pbnB1dFtTXQ0KCQl3PWlucHV0W1MrMV0NCgkJaWYgYz09MDoNCgkJCWlmIGY9PTA6DQoJCQkJaWYgKEMmLTEwMjUpIT00OgkJDQoJCQkJCWVbQSszXT0tMQ0KCQkJCWVsc2U6DQoJCQkJCWVbQSszXT0xDQoJCU09Tm9uZQ0KCQlUPU5vbmUNCgkJRT1Ob25lDQoJCUk9MyooQytwKncpCQkNCgkJTT1fW0ldDQoJCWlmCU09PU5vbmU6CQkJCQ0KCQkJTj1DKmINCgkJCWs9Y29zKE4pDQoJCQlGPXNpbihOKQ0KCQkJTis9eA0KCQkJRD0oZy1rKmNvcyhOKSkvZmxvYXQobWF4KDFlLTUsRipzaW4oTikpKQ0KCQkJaWYgRD4xOkQ9MQ0KCQkJZWxzZToNCgkJCQlpZiBEPC0xOkQ9LTENCgkJCVA9dypuL2Zsb2F0KG1hdGguY2VpbChyL2Zsb2F0KG1heCgxZS01LG1hdGguYWNvcyhEKSkpKSkNCgkJCU09X1tJXT1GKm1hdGguY29zKFApDQoJCQlUPV9bSSsxXT1GKm1hdGguc2luKFApDQoJCQlFPV9bSSsyXT1rDQoJCWVsc2U6IA0KCQkJVD1fW0krMV0NCgkJCUU9X1tJKzJdDQoJCWlmIGY6DQoJCQlSPWlucHV0W1MrMl0qbA0KCQkJTz1tYXRoLnNpbihSKQ0KCQkJZVtBXT1PKk0NCgkJCWVbQSsxXT1PKlQNCgkJCWVbQSsyXT1PKkUNCgkJCWVbQSszXT1tYXRoLmNvcyhSKQ0KCQkJI3dyaXRlKGxvZyxbQSxlW0FdLGVbQSsxXSxlW0ErMl0sZVtBKzNdXSwwKQ0KCQllbHNlOiANCgkJCWVbQV09TQ0KCQkJZVtBKzFdPVQNCgkJCWVbQSsyXT1FDQoJCW0rPTENCgkNCglyZXR1cm4gZQkNCgkNCg0KZGVmIGdldEFuaW1hdGlvbih5cyxBLG4pOg0KCWFjdGlvbj1BY3Rpb24oKQ0KCWFjdGlvbi5CT05FU1BBQ0U9VHJ1ZQ0KCSNhY3Rpb24uQVJNQVRVUkVTUEFDRT1UcnVlDQoJYWN0aW9uLkZSQU1FU09SVD1UcnVlDQoJYWN0aW9uLnNrZWxldG9uPXNrZWxldG9uLm5hbWUNCgluKz00DQoJQ2hhbm5lbHM9eXMuZ2V0KEEsJyJDaGFubmVscyInKQ0KCWJvbmVMaXN0PXt9DQoJaWYgQ2hhbm5lbHM6DQoJCXZhbHVlcz15cy52YWx1ZXMoQ2hhbm5lbHNbMF0uaGVhZGVyLCc6JykNCgkJTmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJOYW1lIicpDQoJCWFjdGlvbi5uYW1lPU5hbWUNCgkJbmV3PU5ldyhOYW1lLnJlcGxhY2UoJyInLCcnKS5yZXBsYWNlKCd8JywnJykrJy5hY3Rpb24nLCd3Yicsc3lzKS5vcGVuKCkNCgkJZm9yIGEgaW4gIENoYW5uZWxzWzBdLmNoaWxkcmVuOg0KCQkJVmVjM0xlcnBDaGFubmVsPXlzLmdldChhLCcib3NnQW5pbWF0aW9uLlZlYzNMZXJwQ2hhbm5lbCInKQ0KCQkJaWYgVmVjM0xlcnBDaGFubmVsOg0KCQkJCUtleUZyYW1lcz15cy5nZXQoYSwnIktleUZyYW1lcyInKQ0KCQkJCWlmIEtleUZyYW1lczoNCgkJCQkJdmFsdWVzPXlzLnZhbHVlcyhLZXlGcmFtZXNbMF0uaGVhZGVyLCc6JykNCgkJCQkJTmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJOYW1lIicpDQoJCQkJCVRhcmdldE5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciVGFyZ2V0TmFtZSInLCciIicpDQoJCQkJCW5hbWU9Z2V0U3BsaXROYW1lKFRhcmdldE5hbWUsJ18nLC0xKQ0KCQkJCQlpZiBOYW1lPT0nInRyYW5zbGF0ZSInOg0KCQkJCQkJYm9uZT1Ob25lDQoJCQkJCQlpZiBUYXJnZXROYW1lIGluIGJvbmVJbmRla3NMaXN0Og0KCQkJCQkJCW5hbWU9Ym9uZUluZGVrc0xpc3RbVGFyZ2V0TmFtZV0NCgkJCQkJCQlpZiBuYW1lIG5vdCBpbiBib25lTGlzdC5rZXlzKCk6DQoJCQkJCQkJCWJvbmU9QWN0aW9uQm9uZSgpDQoJCQkJCQkJCWFjdGlvbi5ib25lTGlzdC5hcHBlbmQoYm9uZSkNCgkJCQkJCQkJYm9uZS5uYW1lPW5hbWUNCgkJCQkJCQkJYm9uZUxpc3RbbmFtZV09Ym9uZQ0KCQkJCQkJCWJvbmU9Ym9uZUxpc3RbbmFtZV0NCgkJCQkJCWVsc2U6DQoJCQkJCQkJcHJpbnQgJ3NraXBlZCB0cmFuc2xhdGUgYm9uZTonLFRhcmdldE5hbWUNCgkJCQkJCQ0KCQkJCQkJDQoJCQkJCQlLZXk9eXMuZ2V0KGEsJyJLZXkiJykNCgkJCQkJCWlmIEtleToNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEtleVswXS5kYXRhLCc6JykNCgkJCQkJCQlJdGVtU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJJdGVtU2l6ZSInLCdpJykJCQkJCQkNCgkJCQkJCQlGbG9hdDMyQXJyYXk9eXMuZ2V0KEtleVswXSwnIkZsb2F0MzJBcnJheSInKQ0KCQkJCQkJCWlmIEZsb2F0MzJBcnJheToNCgkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwnOicpDQoJCQkJCQkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInKQ0KCQkJCQkJCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJykNCgkJCQkJCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInKQ0KCQkJCQkJCQl3cml0ZShsb2csW0ZpbGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0l0ZW1TaXplOicsSXRlbVNpemVdLG4rNCkNCgkJCQkJCQkJDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZSBhbmQgb3MucGF0aC5leGlzdHMocGF0aC5zcGxpdCgnLmd6JylbMF0pPT1GYWxzZToNCgkJCQkJCQkJCWNtZD1DbWQoKQ0KCQkJCQkJCQkJY21kLmlucHV0PXBhdGgNCgkJCQkJCQkJCWNtZC5aSVA9VHJ1ZQ0KCQkJCQkJCQkJY21kLnJ1bigpDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdLnNwbGl0KCcuZ3onKVswXQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6DQoJCQkJCQkJCQlwYXRoKz0nJw0KCQkJCQkJCQkJDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1UcnVlOg0KCQkJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCQlnLnNlZWsoaW50KE9mZnNldCkpCQkJCQkJCQkJDQoJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCW5ldy53cml0ZShib25lLm5hbWUrJ1x4MDAnKQ0KCQkJCQkJCQkJCW5ldy53cml0ZSgndHJhbnNsYXRlJysnXHgwMCcpDQoJCQkJCQkJCQkJbmV3LmkoW2ludChTaXplKV0pDQoJCQkJCQkJCQlmb3IgbSBpbiByYW5nZShpbnQoU2l6ZSkpOg0KCQkJCQkJCQkJCXZhbHVlPWcuZihJdGVtU2l6ZSkNCgkJCQkJCQkJCQkjd3JpdGUobG9nLHZhbHVlLG4rOCkNCgkJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCQluZXcuZih2YWx1ZSkNCgkJCQkJCQkJCQkJYm9uZU1hdHJpeD1za2VsZXRvbi5vYmplY3QuZ2V0RGF0YSgpLmJvbmVzW2JvbmUubmFtZV0ubWF0cml4WydBUk1BVFVSRVNQQUNFJ10NCgkJCQkJCQkJCQkJbWF0cml4PVZlY3Rvck1hdHJpeCh2YWx1ZSkjKmJvbmVNYXRyaXgNCgkJCQkJCQkJCQkJYm9uZS5wb3NLZXlMaXN0LmFwcGVuZChtYXRyaXgpDQoJCQkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQkJCQllbHNlOnByaW50ICd1bmtub3cgYXJyYXkgdHlwZScNCgkJCQkJCWVsc2U6cHJpbnQgJ25vIGtleScJCQkJDQoJCQkJCQkNCgkJCQkJCVRpbWU9eXMuZ2V0KGEsJyJUaW1lIicpDQoJCQkJCQlpZiBUaW1lOg0KCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoVGltZVswXS5kYXRhLCc6JykNCgkJCQkJCQlJdGVtU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJJdGVtU2l6ZSInLCdpJykJCQkJCQkNCgkJCQkJCQlGbG9hdDMyQXJyYXk9eXMuZ2V0KFRpbWVbMF0sJyJGbG9hdDMyQXJyYXkiJykNCgkJCQkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQkJCQkJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJykNCgkJCQkJCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicpDQoJCQkJCQkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJykNCgkJCQkJCQkJI3dyaXRlKGxvZyxbRmlsZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnSXRlbVNpemU6JyxJdGVtU2l6ZV0sbis0KQ0KCQkJCQkJCQkNCgkJCQkJCQkJDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZSBhbmQgb3MucGF0aC5leGlzdHMocGF0aC5zcGxpdCgnLmd6JylbMF0pPT1GYWxzZToNCgkJCQkJCQkJCWNtZD1DbWQoKQ0KCQkJCQkJCQkJY21kLmlucHV0PXBhdGgNCgkJCQkJCQkJCWNtZC5aSVA9VHJ1ZQ0KCQkJCQkJCQkJY21kLnJ1bigpDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdLnNwbGl0KCcuZ3onKVswXQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6DQoJCQkJCQkJCQlwYXRoKz0nJw0KCQkJCQkJCQkJDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KCQkJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCQlnLnNlZWsoaW50KE9mZnNldCkpCQkJCQkJCQ0KCQkJCQkJCQkJaWYgYm9uZTpuZXcuaShbaW50KFNpemUpXSkNCgkJCQkJCQkJCWZvciBtIGluIHJhbmdlKGludChTaXplKSk6DQoJCQkJCQkJCQkJdmFsdWU9Zy5mKEl0ZW1TaXplKQ0KCQkJCQkJCQkJCWlmIEl0ZW1TaXplPT0xOnZhbHVlPXZhbHVlWzBdDQoJCQkJCQkJCQkJI3dyaXRlKGxvZyxbdmFsdWVdLG4rOCkNCgkJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCQluZXcuZihbdmFsdWVdKQ0KCQkJCQkJCQkJCQlib25lLnBvc0ZyYW1lTGlzdC5hcHBlbmQoaW50KHZhbHVlKjMzKSkNCgkJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCQkJCWVsc2U6cHJpbnQgJ3Vua25vdyBhcnJheSB0eXBlJw0KCQkJCQkJZWxzZTpwcmludCAnbm8gdGltZScJCQ0KCQkJCQkNCgkJCQkJDQoJCQkJCQ0KCQkJCQkNCgkJCQkJaWYgTmFtZT09JyJzY2FsZSInOg0KCQkJCQkJYm9uZT1Ob25lDQoJCQkJCQlpZiBUYXJnZXROYW1lIGluIGJvbmVJbmRla3NMaXN0Og0KCQkJCQkJCW5hbWU9Ym9uZUluZGVrc0xpc3RbVGFyZ2V0TmFtZV0NCgkJCQkJCQlpZiBuYW1lIG5vdCBpbiBib25lTGlzdC5rZXlzKCk6DQoJCQkJCQkJCWJvbmU9QWN0aW9uQm9uZSgpDQoJCQkJCQkJCWFjdGlvbi5ib25lTGlzdC5hcHBlbmQoYm9uZSkNCgkJCQkJCQkJYm9uZS5uYW1lPW5hbWUNCgkJCQkJCQkJYm9uZUxpc3RbbmFtZV09Ym9uZQ0KCQkJCQkJCWJvbmU9Ym9uZUxpc3RbbmFtZV0NCgkJCQkJCWVsc2U6DQoJCQkJCQkJcHJpbnQgJ3NraXBlZCBzY2FsZSBib25lOicsVGFyZ2V0TmFtZQ0KCQkJCQkJDQoJCQkJCQkNCgkJCQkJCUtleT15cy5nZXQoYSwnIktleSInKQ0KCQkJCQkJaWYgS2V5Og0KCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoS2V5WzBdLmRhdGEsJzonKQ0KCQkJCQkJCUl0ZW1TaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIkl0ZW1TaXplIicsJ2knKQkJCQkJCQ0KCQkJCQkJCUZsb2F0MzJBcnJheT15cy5nZXQoS2V5WzBdLCciRmxvYXQzMkFycmF5IicpDQoJCQkJCQkJaWYgRmxvYXQzMkFycmF5Og0KCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCQkJCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicpDQoJCQkJCQkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInKQ0KCQkJCQkJCQlPZmZzZXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicpDQoJCQkJCQkJCSN3cml0ZShsb2csW0ZpbGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0l0ZW1TaXplOicsSXRlbVNpemVdLG4rNCkNCgkJCQkJCQkJDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZSBhbmQgb3MucGF0aC5leGlzdHMocGF0aC5zcGxpdCgnLmd6JylbMF0pPT1GYWxzZToNCgkJCQkJCQkJCWNtZD1DbWQoKQ0KCQkJCQkJCQkJY21kLmlucHV0PXBhdGgNCgkJCQkJCQkJCWNtZC5aSVA9VHJ1ZQ0KCQkJCQkJCQkJY21kLnJ1bigpDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdLnNwbGl0KCcuZ3onKVswXQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6DQoJCQkJCQkJCQlwYXRoKz0nJw0KCQkJCQkJCQkJDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1UcnVlOg0KCQkJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCQlnLnNlZWsoaW50KE9mZnNldCkpCQkJCQkJCQkJDQoJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCW5ldy53cml0ZShib25lLm5hbWUrJ1x4MDAnKQ0KCQkJCQkJCQkJCW5ldy53cml0ZSgnc2l6ZScrJ1x4MDAnKQ0KCQkJCQkJCQkJCW5ldy5pKFtpbnQoU2l6ZSldKQ0KCQkJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoaW50KFNpemUpKToNCgkJCQkJCQkJCQl2YWx1ZT1nLmYoSXRlbVNpemUpDQoJCQkJCQkJCQkJI3dyaXRlKGxvZyx2YWx1ZSxuKzgpDQoJCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQkJbmV3LmYodmFsdWUpDQoJCQkJCQkJCQkJCWJvbmVNYXRyaXg9c2tlbGV0b24ub2JqZWN0LmdldERhdGEoKS5ib25lc1tib25lLm5hbWVdLm1hdHJpeFsnQVJNQVRVUkVTUEFDRSddDQoJCQkJCQkJCQkJCW1hdHJpeD1WZWN0b3JNYXRyaXgodmFsdWUpIypib25lTWF0cml4DQoJCQkJCQkJCQkJCWJvbmUuc2l6ZUtleUxpc3QuYXBwZW5kKG1hdHJpeCkNCgkJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCQkJCWVsc2U6cHJpbnQgJ3Vua25vdyBhcnJheSB0eXBlJw0KCQkJCQkJZWxzZTpwcmludCAnbm8ga2V5JwkJCQkNCgkJCQkJCQ0KCQkJCQkJVGltZT15cy5nZXQoYSwnIlRpbWUiJykNCgkJCQkJCWlmIFRpbWU6DQoJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhUaW1lWzBdLmRhdGEsJzonKQ0KCQkJCQkJCUl0ZW1TaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIkl0ZW1TaXplIicsJ2knKQkJCQkJCQ0KCQkJCQkJCUZsb2F0MzJBcnJheT15cy5nZXQoVGltZVswXSwnIkZsb2F0MzJBcnJheSInKQ0KCQkJCQkJCWlmIEZsb2F0MzJBcnJheToNCgkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwnOicpDQoJCQkJCQkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInKQ0KCQkJCQkJCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJykNCgkJCQkJCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInKQ0KCQkJCQkJCQkjd3JpdGUobG9nLFtGaWxlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdJdGVtU2l6ZTonLEl0ZW1TaXplXSxuKzQpDQoJCQkJCQkJCQ0KCQkJCQkJCQkNCgkJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCciJylbMV0JCQkJDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1UcnVlIGFuZCBvcy5wYXRoLmV4aXN0cyhwYXRoLnNwbGl0KCcuZ3onKVswXSk9PUZhbHNlOg0KCQkJCQkJCQkJY21kPUNtZCgpDQoJCQkJCQkJCQljbWQuaW5wdXQ9cGF0aA0KCQkJCQkJCQkJY21kLlpJUD1UcnVlDQoJCQkJCQkJCQljbWQucnVuKCkNCgkJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCciJylbMV0uc3BsaXQoJy5neicpWzBdDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1GYWxzZToNCgkJCQkJCQkJCXBhdGgrPScnDQoJCQkJCQkJCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk6DQoJCQkJCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJCWcuc2VlayhpbnQoT2Zmc2V0KSkJCQkJCQkJDQoJCQkJCQkJCQlpZiBib25lOm5ldy5pKFtpbnQoU2l6ZSldKQ0KCQkJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoaW50KFNpemUpKToNCgkJCQkJCQkJCQl2YWx1ZT1nLmYoSXRlbVNpemUpDQoJCQkJCQkJCQkJaWYgSXRlbVNpemU9PTE6dmFsdWU9dmFsdWVbMF0NCgkJCQkJCQkJCQkjd3JpdGUobG9nLFt2YWx1ZV0sbis4KQ0KCQkJCQkJCQkJCWlmIGJvbmU6DQoJCQkJCQkJCQkJCW5ldy5mKFt2YWx1ZV0pDQoJCQkJCQkJCQkJCWJvbmUuc2l6ZUZyYW1lTGlzdC5hcHBlbmQoaW50KHZhbHVlKjMzKSkNCgkJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCQkJCWVsc2U6cHJpbnQgJ3Vua25vdyBhcnJheSB0eXBlJw0KCQkJCQkJZWxzZTpwcmludCAnbm8gdGltZScJCQ0KCQkJCQkJCQkJDQoJCQlWZWMzTGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkPXlzLmdldChhLCcib3NnQW5pbWF0aW9uLlZlYzNMZXJwQ2hhbm5lbENvbXByZXNzZWRQYWNrZWQiJykNCgkJCWlmIFZlYzNMZXJwQ2hhbm5lbENvbXByZXNzZWRQYWNrZWQ6DQoJCQkNCgkJCQlhdHJpYnV0ZXM9e30NCgkJCQlVc2VyRGF0YUNvbnRhaW5lcj15cy5nZXQoVmVjM0xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZFswXSwnIlVzZXJEYXRhQ29udGFpbmVyIicpDQoJCQkJaWYgVXNlckRhdGFDb250YWluZXI6DQoJCQkJCVZhbHVlcz15cy5nZXQoVXNlckRhdGFDb250YWluZXJbMF0sJyJWYWx1ZXMiJykNCgkJCQkJaWYgVmFsdWVzOg0KCQkJCQkJZm9yIGNoaWxkIGluIFZhbHVlc1swXS5jaGlsZHJlbjoNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGNoaWxkLmRhdGEsJzonKQ0KCQkJCQkJCU5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciTmFtZSInKQ0KCQkJCQkJCVZhbHVlPXlzLmdldFZhbHVlKHZhbHVlcywnIlZhbHVlIicsJyJmIicpDQoJCQkJCQkJI3dyaXRlKGxvZyxbTmFtZSxWYWx1ZV0sbis0KQ0KCQkJCQkJCWF0cmlidXRlc1tOYW1lXT1WYWx1ZQ0KCQkJCQ0KCQkJCUtleUZyYW1lcz15cy5nZXQoYSwnIktleUZyYW1lcyInKQ0KCQkJCWlmIEtleUZyYW1lczoNCgkJCQkJdmFsdWVzPXlzLnZhbHVlcyhLZXlGcmFtZXNbMF0uaGVhZGVyLCc6JykNCgkJCQkJTmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJOYW1lIicpDQoJCQkJCVRhcmdldE5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciVGFyZ2V0TmFtZSInLCciIicpDQoJCQkJCSN3cml0ZShsb2csWydWZWMzTGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkOicsTmFtZSwnVGFyZ2V0TmFtZTonLFRhcmdldE5hbWVdLG4rNCkNCgkJCQkJbmFtZT1nZXRTcGxpdE5hbWUoVGFyZ2V0TmFtZSwnXycsLTEpDQoJCQkJCWlmIE5hbWU9PScidHJhbnNsYXRlIic6DQoJCQkJCQlib25lPU5vbmUNCgkJCQkJCWlmIFRhcmdldE5hbWUgaW4gYm9uZUluZGVrc0xpc3Q6DQoJCQkJCQkJI25ldy53cml0ZShUYXJnZXROYW1lKydceDAwJykNCgkJCQkJCQkjbmV3LndyaXRlKCd0cmFuc2xhdGUnKydceDAwJykNCgkJCQkJCQluYW1lPWJvbmVJbmRla3NMaXN0W1RhcmdldE5hbWVdDQoJCQkJCQkJaWYgbmFtZSBub3QgaW4gYm9uZUxpc3Qua2V5cygpOg0KCQkJCQkJCQlib25lPUFjdGlvbkJvbmUoKQ0KCQkJCQkJCQlhY3Rpb24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpDQoJCQkJCQkJCWJvbmUubmFtZT1uYW1lDQoJCQkJCQkJCWJvbmVMaXN0W25hbWVdPWJvbmUNCgkJCQkJCQlib25lPWJvbmVMaXN0W25hbWVdDQoJCQkJCQllbHNlOg0KCQkJCQkJCXByaW50ICdza2lwZWQgdHJhbnNsYXRlIGJvbmU6JyxUYXJnZXROYW1lDQoJCQkJCQkNCgkJCQkJCUtleT15cy5nZXQoYSwnIktleSInKQ0KCQkJCQkJaWYgS2V5Og0KCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoS2V5WzBdLmRhdGEsJzonKQ0KCQkJCQkJCUl0ZW1TaXplPWludCh5cy5nZXRWYWx1ZSh2YWx1ZXMsJyJJdGVtU2l6ZSInKSkJCQkJCQkNCgkJCQkJCQlVaW50MTZBcnJheT15cy5nZXQoS2V5WzBdLCciVWludDE2QXJyYXkiJykNCgkJCQkJCQl0eXBlPSJVaW50MTZBcnJheSINCgkJCQkJCQlpZiBVaW50MTZBcnJheToNCgkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhVaW50MTZBcnJheVswXS5kYXRhLCc6JykNCgkJCQkJCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicpDQoJCQkJCQkJCVNpemU9aW50KHlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJykpDQoJCQkJCQkJCU9mZnNldD1pbnQoeXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicpKQ0KCQkJCQkJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInKQ0KCQkJCQkJCQkjd3JpdGUobG9nLFtGaWxlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nLCdJdGVtU2l6ZTonLEl0ZW1TaXplXSxuKzQpDQoJCQkJCQkJCQ0KCQkJCQkJCQkNCgkJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCciJylbMV0JCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWUgYW5kIG9zLnBhdGguZXhpc3RzKHBhdGguc3BsaXQoJy5neicpWzBdKT09RmFsc2U6DQoJCQkJCQkJCQljbWQ9Q21kKCkNCgkJCQkJCQkJCWNtZC5pbnB1dD1wYXRoDQoJCQkJCQkJCQljbWQuWklQPVRydWUNCgkJCQkJCQkJCWNtZC5ydW4oKQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOg0KCQkJCQkJCQkJcGF0aCs9JycNCgkJCQkJCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKToNCgkJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQkJDQoJCQkJCQkJCQlsaXN0PWRlY29kZVZhcmludChnLE9mZnNldCxTaXplKkl0ZW1TaXplLHR5cGUpDQoJCQkJCQkJCQlsaXN0MT1ldGFwMShsaXN0LEl0ZW1TaXplKQ0KCQkJCQkJCQkJb3V0PWV0YXAyKGxpc3QxLEl0ZW1TaXplLGF0cmlidXRlcykNCgkJCQkJCQkJCWxpc3QyPVthdHJpYnV0ZXNbJyJveCInXSxhdHJpYnV0ZXNbJyJveSInXSxhdHJpYnV0ZXNbJyJveiInXV0NCgkJCQkJCQkJCWxpc3QyLmV4dGVuZChvdXQpDQoJCQkJCQkJCQlsaXN0Mz1ldGFwMyhsaXN0MixJdGVtU2l6ZSkJCQkJCQkJDQoJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCW5ldy53cml0ZShib25lLm5hbWUrJ1x4MDAnKQ0KCQkJCQkJCQkJCW5ldy53cml0ZSgndHJhbnNsYXRlJysnXHgwMCcpDQoJCQkJCQkJCQkJbmV3LmkoW1NpemVdKQ0KCQkJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQoJCQkJCQkJCQkJdmFsdWU9bGlzdDNbbSozOm0qMyszXQ0KCQkJCQkJCQkJCSN3cml0ZShsb2csdmFsdWUsbis4KQ0KCQkJCQkJCQkJCWlmIGJvbmU6DQoJCQkJCQkJCQkJCW5ldy5mKHZhbHVlKQ0KCQkJCQkJCQkJCQlpZiBib25lLm5hbWUgaW4gc2tlbGV0b24ub2JqZWN0LmdldERhdGEoKS5ib25lcy5rZXlzKCk6DQoJCQkJCQkJCQkJCQlib25lTWF0cml4PXNrZWxldG9uLm9iamVjdC5nZXREYXRhKCkuYm9uZXNbYm9uZS5uYW1lXS5tYXRyaXhbJ0FSTUFUVVJFU1BBQ0UnXQ0KCQkJCQkJCQkJCQkJI2JvbmVNYXRyaXgqPVZlY3Rvck1hdHJpeCh2YWx1ZSkNCgkJCQkJCQkJCQkJCW1hdHJpeD1WZWN0b3JNYXRyaXgodmFsdWUpIypib25lTWF0cml4DQoJCQkJCQkJCQkJCQlib25lLnBvc0tleUxpc3QuYXBwZW5kKG1hdHJpeCkNCgkJCQkJCQkJCQkJCQ0KCQkJCQkJCQkJZmlsZS5jbG9zZSgpDQoJCQkJCQkJZWxzZTpwcmludCAndW5rbm93IGFycmF5IHR5cGUnDQoJCQkJCQllbHNlOnByaW50ICdubyBrZXknCQ0KCQkJCQkJDQoJCQkJCQlUaW1lPXlzLmdldChhLCciVGltZSInKQ0KCQkJCQkJaWYgVGltZToNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKFRpbWVbMF0uZGF0YSwnOicpDQoJCQkJCQkJSXRlbVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJywnaScpCQkJCQkJDQoJCQkJCQkJRmxvYXQzMkFycmF5PXlzLmdldChUaW1lWzBdLCciRmxvYXQzMkFycmF5IicpDQoJCQkJCQkJaWYgRmxvYXQzMkFycmF5Og0KCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCQkJCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicpDQoJCQkJCQkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCQkJCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInLCdpJykNCgkJCQkJCQkJI3dyaXRlKGxvZyxbRmlsZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnSXRlbVNpemU6JyxJdGVtU2l6ZV0sbis0KQ0KCQkJCQkJCQkNCgkJCQkJCQkJDQoJCQkJCQkJCQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZSBhbmQgb3MucGF0aC5leGlzdHMocGF0aC5zcGxpdCgnLmd6JylbMF0pPT1GYWxzZToNCgkJCQkJCQkJCWNtZD1DbWQoKQ0KCQkJCQkJCQkJY21kLmlucHV0PXBhdGgNCgkJCQkJCQkJCWNtZC5aSVA9VHJ1ZQ0KCQkJCQkJCQkJY21kLnJ1bigpDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdLnNwbGl0KCcuZ3onKVswXQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6DQoJCQkJCQkJCQlwYXRoKz0nJw0KCQkJCQkJCQkJDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KCQkJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCQlnLnNlZWsoaW50KE9mZnNldCkpDQoJCQkJCQkJCQlsaXN0PWcuZihTaXplKkl0ZW1TaXplKQ0KCQkJCQkJCQkJbGlzdDE9ZXRhcDEobGlzdCxJdGVtU2l6ZSkNCgkJCQkJCQkJCSNvdXQ9ZXRhcDIobGlzdDEsSXRlbVNpemUsYXRyaWJ1dGVzKQ0KCQkJCQkJCQkJbGlzdDI9W2F0cmlidXRlc1snIm90IiddXQ0KCQkJCQkJCQkJbGlzdDIuZXh0ZW5kKGxpc3QxKQ0KCQkJCQkJCQkJbGlzdDM9ZXRhcDMobGlzdDIsSXRlbVNpemUpDQoJCQkJCQkJCQkjd3JpdGUobG9nLGxpc3QzLDApCQkJCQkJCQ0KCQkJCQkJCQkJaWYgYm9uZTpuZXcuaShbU2l6ZV0pDQoJCQkJCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCQkJCQl2YWx1ZT1saXN0M1ttXQ0KCQkJCQkJCQkJCWlmIGJvbmU6DQoJCQkJCQkJCQkJCW5ldy5mKFt2YWx1ZV0pDQoJCQkJCQkJCQkJCWJvbmUucG9zRnJhbWVMaXN0LmFwcGVuZChpbnQodmFsdWUqMzMpKQ0KCQkJCQkJCQkJZmlsZS5jbG9zZSgpDQoJCQkJCQkJZWxzZTpwcmludCAndW5rbm93IGFycmF5IHR5cGUnCQ0KCQkJCQkJZWxzZTpwcmludCAnbm8gdGltZScJDQoJCQkJCQ0KCQkJCQkNCgkJCQkJDQoJCQlRdWF0U2xlcnBDaGFubmVsPXlzLmdldChhLCcib3NnQW5pbWF0aW9uLlF1YXRTbGVycENoYW5uZWwiJykNCgkJCWlmIFF1YXRTbGVycENoYW5uZWw6DQoJCQkJS2V5RnJhbWVzPXlzLmdldChhLCciS2V5RnJhbWVzIicpDQoJCQkJaWYgS2V5RnJhbWVzOg0KCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEtleUZyYW1lc1swXS5oZWFkZXIsJzonKQ0KCQkJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJykNCgkJCQkJVGFyZ2V0TmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJUYXJnZXROYW1lIicsJyIiJykNCgkJCQkJI3dyaXRlKGxvZyxbJ1F1YXRTbGVycENoYW5uZWw6JyxOYW1lLCdUYXJnZXROYW1lOicsVGFyZ2V0TmFtZV0sbis0KQ0KCQkJCQluYW1lPWdldFNwbGl0TmFtZShUYXJnZXROYW1lLCdfJywtMSkNCgkJCQkJYm9uZT1Ob25lDQoJCQkJCWlmIFRhcmdldE5hbWUgaW4gYm9uZUluZGVrc0xpc3Q6DQoJCQkJCQluYW1lPWJvbmVJbmRla3NMaXN0W1RhcmdldE5hbWVdDQoJCQkJCQlpZiBuYW1lIG5vdCBpbiBib25lTGlzdC5rZXlzKCk6DQoJCQkJCQkJYm9uZT1BY3Rpb25Cb25lKCkNCgkJCQkJCQlhY3Rpb24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpDQoJCQkJCQkJYm9uZS5uYW1lPW5hbWUNCgkJCQkJCQlib25lTGlzdFtuYW1lXT1ib25lDQoJCQkJCQlib25lPWJvbmVMaXN0W25hbWVdDQoJCQkJCWVsc2U6DQoJCQkJCQlwcmludCAnc2tpcGVkIHF1YXRlcm5pb24gYm9uZTonLFRhcmdldE5hbWUNCgkJCQkJDQoJCQkJCQ0KCQkJCQkNCgkJCQkJS2V5PXlzLmdldChhLCciS2V5IicpDQoJCQkJCWlmIEtleToNCgkJCQkJCXZhbHVlcz15cy52YWx1ZXMoS2V5WzBdLmRhdGEsJzonKQ0KCQkJCQkJSXRlbVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJykJCQkJCQkNCgkJCQkJCUZsb2F0MzJBcnJheT15cy5nZXQoS2V5WzBdLCciRmxvYXQzMkFycmF5IicpDQoJCQkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwnOicpDQoJCQkJCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicpDQoJCQkJCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicpDQoJCQkJCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInKQ0KCQkJCQkJCSN3cml0ZShsb2csW0ZpbGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0l0ZW1TaXplOicsSXRlbVNpemVdLG4rNCkNCgkJCQkJCQkNCgkJCQkJCQkJDQoJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCciJylbMV0JCQkNCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZSBhbmQgb3MucGF0aC5leGlzdHMocGF0aC5zcGxpdCgnLmd6JylbMF0pPT1GYWxzZToNCgkJCQkJCQkJY21kPUNtZCgpDQoJCQkJCQkJCWNtZC5pbnB1dD1wYXRoDQoJCQkJCQkJCWNtZC5aSVA9VHJ1ZQ0KCQkJCQkJCQljbWQucnVuKCkNCgkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6DQoJCQkJCQkJCXBhdGgrPScnDQoJCQkJCQkJCQ0KCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KCQkJCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQlnLnNlZWsoaW50KE9mZnNldCkpCQkJCQkJCQ0KCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJbmV3LndyaXRlKGJvbmUubmFtZSsnXHgwMCcpDQoJCQkJCQkJCQluZXcud3JpdGUoJ3F1YXRlcm5pb24nKydceDAwJykNCgkJCQkJCQkJCW5ldy5pKFtpbnQoU2l6ZSldKQ0KCQkJCQkJCQlmb3IgbSBpbiByYW5nZShpbnQoU2l6ZSkpOg0KCQkJCQkJCQkJdmFsdWU9Zy5mKDQpDQoJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCW5ldy5mKHZhbHVlKQ0KCQkJCQkJCQkJdmFsdWU9UXVhdGVybmlvbih2YWx1ZSkNCgkJCQkJCQkJCWlmIGJvbmU6DQoJCQkJCQkJCQkJI25ldy5mKHZhbHVlKQ0KCQkJCQkJCQkJCWJvbmVNYXRyaXg9c2tlbGV0b24ub2JqZWN0LmdldERhdGEoKS5ib25lc1tib25lLm5hbWVdLm1hdHJpeFsnQVJNQVRVUkVTUEFDRSddDQoJCQkJCQkJCQkJI2JvbmUucm90S2V5TGlzdC5hcHBlbmQoYm9uZU1hdHJpeCpRdWF0TWF0cml4KHZhbHVlKS5yZXNpemU0eDQoKSkNCgkJCQkJCQkJCQltYXRyaXg9UXVhdE1hdHJpeCh2YWx1ZSkucmVzaXplNHg0KCkjKmJvbmVNYXRyaXgNCgkJCQkJCQkJCQlib25lLnJvdEtleUxpc3QuYXBwZW5kKG1hdHJpeCkNCgkJCQkJCQkJZmlsZS5jbG9zZSgpDQoJCQkJCQ0KCQkJCQlUaW1lPXlzLmdldChhLCciVGltZSInKQ0KCQkJCQlpZiBUaW1lOg0KCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhUaW1lWzBdLmRhdGEsJzonKQ0KCQkJCQkJSXRlbVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJywnaScpCQkJCQkJDQoJCQkJCQlGbG9hdDMyQXJyYXk9eXMuZ2V0KFRpbWVbMF0sJyJGbG9hdDMyQXJyYXkiJykNCgkJCQkJCWlmIEZsb2F0MzJBcnJheToNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCQkJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJykNCgkJCQkJCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJykNCgkJCQkJCQlPZmZzZXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicpDQoJCQkJCQkJI3dyaXRlKGxvZyxbRmlsZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnSXRlbVNpemU6JyxJdGVtU2l6ZV0sbis0KQ0KCQkJCQkJCQ0KCQkJCQkJCQkNCgkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXQkJCQ0KCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1UcnVlIGFuZCBvcy5wYXRoLmV4aXN0cyhwYXRoLnNwbGl0KCcuZ3onKVswXSk9PUZhbHNlOg0KCQkJCQkJCQljbWQ9Q21kKCkNCgkJCQkJCQkJY21kLmlucHV0PXBhdGgNCgkJCQkJCQkJY21kLlpJUD1UcnVlDQoJCQkJCQkJCWNtZC5ydW4oKQ0KCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdLnNwbGl0KCcuZ3onKVswXQ0KCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1GYWxzZToNCgkJCQkJCQkJcGF0aCs9JycNCgkJCQkJCQkJDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk6DQoJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCWcuc2VlayhpbnQoT2Zmc2V0KSkJCQkJCQkJDQoJCQkJCQkJCWlmIGJvbmU6bmV3LmkoW2ludChTaXplKV0pDQoJCQkJCQkJCWZvciBtIGluIHJhbmdlKGludChTaXplKSk6DQoJCQkJCQkJCQl2YWx1ZT1nLmYoSXRlbVNpemUpDQoJCQkJCQkJCQlpZiBJdGVtU2l6ZT09MTp2YWx1ZT12YWx1ZVswXQ0KCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQluZXcuZihbdmFsdWVdKQ0KCQkJCQkJCQkJCWJvbmUucm90RnJhbWVMaXN0LmFwcGVuZChpbnQodmFsdWUqMzMpKQ0KCQkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQkJDQoJCQkJCQkJCQkNCgkJCVF1YXRTbGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkPXlzLmdldChhLCcib3NnQW5pbWF0aW9uLlF1YXRTbGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkIicpDQoJCQlpZiBRdWF0U2xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZDoNCgkJCQlUYXJnZXROYW1lPU5vbmUNCgkJCQl0cnk6DQoJCQkNCgkJCQkJYXRyaWJ1dGVzPXt9DQoJCQkJCVVzZXJEYXRhQ29udGFpbmVyPXlzLmdldChRdWF0U2xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZFswXSwnIlVzZXJEYXRhQ29udGFpbmVyIicpDQoJCQkJCWlmIFVzZXJEYXRhQ29udGFpbmVyOg0KCQkJCQkJVmFsdWVzPXlzLmdldChVc2VyRGF0YUNvbnRhaW5lclswXSwnIlZhbHVlcyInKQ0KCQkJCQkJaWYgVmFsdWVzOg0KCQkJCQkJCWZvciBjaGlsZCBpbiBWYWx1ZXNbMF0uY2hpbGRyZW46DQoJCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoY2hpbGQuZGF0YSwnOicpDQoJCQkJCQkJCU5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciTmFtZSInKQ0KCQkJCQkJCQlWYWx1ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJWYWx1ZSInLCciZiInKQ0KCQkJCQkJCQkjd3JpdGUobG9nLFtOYW1lLFZhbHVlXSxuKzQpDQoJCQkJCQkJCWF0cmlidXRlc1tOYW1lXT1WYWx1ZQ0KCQkJCQ0KCQkJCQlLZXlGcmFtZXM9eXMuZ2V0KGEsJyJLZXlGcmFtZXMiJykNCgkJCQkJaWYgS2V5RnJhbWVzOgkJCQkNCgkJCQkJCXZhbHVlcz15cy52YWx1ZXMoS2V5RnJhbWVzWzBdLmhlYWRlciwnOicpDQoJCQkJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJykNCgkJCQkJCVRhcmdldE5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciVGFyZ2V0TmFtZSInLCciIicpDQoJCQkJCQkjd3JpdGUobG9nLFsnUXVhdFNsZXJwQ2hhbm5lbENvbXByZXNzZWRQYWNrZWQ6JyxOYW1lLCdUYXJnZXROYW1lOicsVGFyZ2V0TmFtZV0sbis0KQ0KCQkJCQkJbmFtZT1nZXRTcGxpdE5hbWUoVGFyZ2V0TmFtZSwnXycsLTEpDQoJCQkJCQkjcHJpbnQgVGFyZ2V0TmFtZQ0KCQkJCQkJYm9uZT1Ob25lDQoJCQkJCQkjcHJpbnQgVGFyZ2V0TmFtZQ0KCQkJCQkJI3ByaW50IGF0cmlidXRlcw0KCQkJCQkJaWYgVGFyZ2V0TmFtZSBpbiBib25lSW5kZWtzTGlzdDoNCgkJCQkJCQluYW1lPWJvbmVJbmRla3NMaXN0W1RhcmdldE5hbWVdDQoJCQkJCQkJaWYgbmFtZSBub3QgaW4gYm9uZUxpc3Qua2V5cygpOg0KCQkJCQkJCQlib25lPUFjdGlvbkJvbmUoKQ0KCQkJCQkJCQlhY3Rpb24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpDQoJCQkJCQkJCWJvbmUubmFtZT1uYW1lDQoJCQkJCQkJCWJvbmVMaXN0W25hbWVdPWJvbmUNCgkJCQkJCQlib25lPWJvbmVMaXN0W25hbWVdDQoJCQkJCQllbHNlOg0KCQkJCQkJCXByaW50ICdza2lwZWQgcXVhdGVybmlvbiBib25lOicsVGFyZ2V0TmFtZQ0KCQkJCQkJCQ0KCQkJCQkJS2V5PXlzLmdldChhLCciS2V5IicpDQoJCQkJCQlpZiBLZXk6DQoJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhLZXlbMF0uZGF0YSwnOicpDQoJCQkJCQkJSXRlbVNpemU9aW50KHlzLmdldFZhbHVlKHZhbHVlcywnIkl0ZW1TaXplIicpKQkJCQkJCQ0KCQkJCQkJCVVpbnQxNkFycmF5PXlzLmdldChLZXlbMF0sJyJVaW50MTZBcnJheSInKQ0KCQkJCQkJCXR5cGU9IlVpbnQxNkFycmF5Ig0KCQkJCQkJCWlmIFVpbnQxNkFycmF5Og0KCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKFVpbnQxNkFycmF5WzBdLmRhdGEsJzonKQ0KCQkJCQkJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJykNCgkJCQkJCQkJU2l6ZT1pbnQoeXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInKSkNCgkJCQkJCQkJT2Zmc2V0PWludCh5cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJykpDQoJCQkJCQkJCUVuY29kaW5nPXlzLmdldFZhbHVlKHZhbHVlcywnIkVuY29kaW5nIicpDQoJCQkJCQkJCSN3cml0ZShsb2csW0ZpbGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmcsJ0l0ZW1TaXplOicsSXRlbVNpemVdLG4rNCkNCgkJCQkJCQkJDQoJCQkJCQkJCQkNCgkJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCciJylbMV0JCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWUgYW5kIG9zLnBhdGguZXhpc3RzKHBhdGguc3BsaXQoJy5neicpWzBdKT09RmFsc2U6DQoJCQkJCQkJCQljbWQ9Q21kKCkNCgkJCQkJCQkJCWNtZC5pbnB1dD1wYXRoDQoJCQkJCQkJCQljbWQuWklQPVRydWUNCgkJCQkJCQkJCWNtZC5ydW4oKQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOg0KCQkJCQkJCQkJcGF0aCs9JycNCgkJCQkJCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKToNCgkJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQkJDQoJCQkJCQkJCQlsaXN0PWRlY29kZVZhcmludChnLE9mZnNldCxTaXplKkl0ZW1TaXplLHR5cGUpDQoJCQkJCQkJCQkjd3JpdGUobG9nLGxpc3QsMCkNCgkJCQkJCQkJCWxpc3QxPWV0YXAxKGxpc3QsSXRlbVNpemUpDQoJCQkJCQkJCQkjd3JpdGUobG9nLGxpc3QxLDApDQoJCQkJCQkJCQlpZiAnIm94IicgaW4gYXRyaWJ1dGVzOg0KCQkJCQkJCQkJCWxpc3QyPWludDNmbG9hdDQobGlzdDEsYXRyaWJ1dGVzLEl0ZW1TaXplKQkJCQkJCQkJDQoJCQkJCQkJCQkJI3dyaXRlKGxvZyxsaXN0MiwwKQ0KCQkJCQkJCQkJCWxpc3QzPVthdHJpYnV0ZXNbJyJveCInXSxhdHJpYnV0ZXNbJyJveSInXSxhdHJpYnV0ZXNbJyJveiInXSxhdHJpYnV0ZXNbJyJvdyInXV0NCgkJCQkJCQkJCQlsaXN0My5leHRlbmQobGlzdDIpDQoJCQkJCQkJCQkJbGlzdDQ9ZXRhcDQobGlzdDMpDQoJCQkJCQkJCQkJI3dyaXRlKGxvZyxsaXN0NCwwKQ0KCQkJCQkJCQkJCQkJCQkJCQkNCgkJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCQluZXcud3JpdGUoYm9uZS5uYW1lKydceDAwJykNCgkJCQkJCQkJCQkJbmV3LndyaXRlKCdxdWF0ZXJuaW9uJysnXHgwMCcpDQoJCQkJCQkJCQkJCW5ldy5pKFtTaXplXSkNCgkJCQkJCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCQkJCQkJdmFsdWU9bGlzdDRbbSo0Om0qNCs0XQ0KCQkJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCQkJbmV3LmYodmFsdWUpCQkJCQkJCQkJDQoJCQkJCQkJCQkJCXZhbHVlPVF1YXRlcm5pb24odmFsdWUpDQoJCQkJCQkJCQkJCSN3cml0ZShsb2csdmFsdWUsbis4KQ0KCQkJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCQkJI25ldy5mKHZhbHVlKQ0KCQkJCQkJCQkJCQkJYm9uZU1hdHJpeD1za2VsZXRvbi5vYmplY3QuZ2V0RGF0YSgpLmJvbmVzW2JvbmUubmFtZV0ubWF0cml4WydBUk1BVFVSRVNQQUNFJ10NCgkJCQkJCQkJCQkJCSMjYm9uZS5yb3RLZXlMaXN0LmFwcGVuZCgoYm9uZU1hdHJpeC5yb3RhdGlvblBhcnQoKSpRdWF0TWF0cml4KHZhbHVlKSkucmVzaXplNHg0KCkpDQoJCQkJCQkJCQkJCQltYXRyaXg9UXVhdE1hdHJpeCh2YWx1ZSkucmVzaXplNHg0KCkjKmJvbmVNYXRyaXgNCgkJCQkJCQkJCQkJCWJvbmUucm90S2V5TGlzdC5hcHBlbmQobWF0cml4KQ0KCQkJCQkJCQkJZmlsZS5jbG9zZSgpDQoJCQkJCQkNCgkJCQkJCVRpbWU9eXMuZ2V0KGEsJyJUaW1lIicpDQoJCQkJCQlpZiBUaW1lOg0KCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoVGltZVswXS5kYXRhLCc6JykNCgkJCQkJCQlJdGVtU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJJdGVtU2l6ZSInLCdpJykJCQkJCQkNCgkJCQkJCQlGbG9hdDMyQXJyYXk9eXMuZ2V0KFRpbWVbMF0sJyJGbG9hdDMyQXJyYXkiJykNCgkJCQkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQkJCQkJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJykNCgkJCQkJCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicsJ2knKQ0KCQkJCQkJCQlPZmZzZXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicsJ2knKQ0KCQkJCQkJCQkjd3JpdGUobG9nLFtGaWxlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdJdGVtU2l6ZTonLEl0ZW1TaXplXSxuKzQpDQoJCQkJCQkJCQ0KCQkJCQkJCQkJDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdCQkJCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZSBhbmQgb3MucGF0aC5leGlzdHMocGF0aC5zcGxpdCgnLmd6JylbMF0pPT1GYWxzZToNCgkJCQkJCQkJCWNtZD1DbWQoKQ0KCQkJCQkJCQkJY21kLmlucHV0PXBhdGgNCgkJCQkJCQkJCWNtZC5aSVA9VHJ1ZQ0KCQkJCQkJCQkJY21kLnJ1bigpDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdLnNwbGl0KCcuZ3onKVswXQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6DQoJCQkJCQkJCQlwYXRoKz0nJw0KCQkJCQkJCQkJDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KCQkJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCQlnLnNlZWsoaW50KE9mZnNldCkpDQoJCQkJCQkJCQlsaXN0PWcuZihTaXplKkl0ZW1TaXplKQ0KCQkJCQkJCQkJbGlzdDE9ZXRhcDEobGlzdCxJdGVtU2l6ZSkNCgkJCQkJCQkJCSNvdXQ9ZXRhcDIobGlzdDEsSXRlbVNpemUsYXRyaWJ1dGVzKQ0KCQkJCQkJCQkJaWYgJyJvdCInIGluIGF0cmlidXRlczoNCgkJCQkJCQkJCQlsaXN0Mj1bYXRyaWJ1dGVzWycib3QiJ11dDQoJCQkJCQkJCQkJbGlzdDIuZXh0ZW5kKGxpc3QxKQ0KCQkJCQkJCQkJCWxpc3QzPWV0YXAzKGxpc3QyLEl0ZW1TaXplKQ0KCQkJCQkJCQkJCSN3cml0ZShsb2csbGlzdDMsMCkJCQ0KCQkJCQkJCQkJCWlmIGJvbmU6bmV3LmkoW1NpemVdKQ0KCQkJCQkJCQkJCWZvciBtIGluIHJhbmdlKFNpemUpOg0KCQkJCQkJCQkJCQl2YWx1ZT1saXN0MlttXQ0KCQkJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCQkJbmV3LmYoW3ZhbHVlXSkNCgkJCQkJCQkJCQkJCWJvbmUucm90RnJhbWVMaXN0LmFwcGVuZChpbnQodmFsdWUqMzMpKQ0KCQkJCQkJCQkJZmlsZS5jbG9zZSgpDQoJCQkJZXhjZXB0Og0KCQkJCQlwcmludCAnbmllcG93b2R6ZW5pZTpRdWF0U2xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZDonLFRhcmdldE5hbWUNCgkJCQkJDQoJCQkjaWYgYm9uZToJDQoJCQkjCXByaW50IG5hbWUsYm9uZS5uYW1lDQoJCW5ldy5jbG9zZSgpCQkNCgkjYWN0aW9uLmRyYXcoKQ0KCSNhY3Rpb24uc2V0Q29udGV4dCgpCQ0KCQkNCg0KZGVmIGRlY29kZVZhcmludChnLG9mZnNldCxzaXplLHR5cGUpOg0KCWcuc2VlayhvZmZzZXQpDQoJbj1bMF0qc2l6ZQ0KCWE9MA0KCXM9MAkNCgl3aGlsZShhIT1zaXplKToNCgkJc2hpZnQgPSAwDQoJCXJlc3VsdCA9IDANCgkJd2hpbGUgVHJ1ZToNCgkJCWJ5dGUgPSBnLkIoMSlbMF0NCgkJCXJlc3VsdCB8PSAoYnl0ZSAmIDEyNykgPDwgc2hpZnQNCgkJCXNoaWZ0ICs9IDcNCgkJCWlmIG5vdCAoYnl0ZSAmIDB4ODApOmJyZWFrCQkJDQoJCW5bYV09cmVzdWx0CQkNCgkJYSs9MQ0KCWlmIHR5cGVbMF0hPSdVJzoNCgkJbD0wDQoJCXdoaWxlKGw8c2l6ZSk6DQoJCQloPW5bbF0NCgkJCW5bbF09aD4+MV4tKDEmaCkNCgkJCWwrPTENCglyZXR1cm4gbg0KCQkNCgkNCgkJDQpkZWYgZGVjb2RlRGVsdGEodCxlKToNCglpPWV8MA0KCW49bGVuKHQpDQoJaWYgaT49bGVuKHQpOnI9Tm9uZQ0KCWVsc2U6cj10W2ldDQoJYT1pKzENCgl3aGlsZShhPG4pOg0KCQlzPXRbYV0NCgkJcj10W2FdPXIrKHM+PjFeLSgxJnMpKQ0KCQlhKz0xDQoJcmV0dXJuIHQJDQoNCg0KZGVmIGRlY29kZUltcGxpY2l0KGlucHV0LG4pOg0KCUlNUExJQ0lUX0hFQURFUl9MRU5HVEg9Mw0KCUlNUExJQ0lUX0hFQURFUl9NQVNLX0xFTkdUSD0xDQoJSU1QTElDSVRfSEVBREVSX1BSSU1JVElWRV9MRU5HVEg9MA0KCUlNUExJQ0lUX0hFQURFUl9FWFBFQ1RFRF9JTkRFWD0yDQoJaGlnaFdhdGVybWFyaz0yDQoJDQoJdD1pbnB1dA0KCWU9WzBdKnRbSU1QTElDSVRfSEVBREVSX1BSSU1JVElWRV9MRU5HVEhdDQoJYT10W0lNUExJQ0lUX0hFQURFUl9FWFBFQ1RFRF9JTkRFWF0NCglzPXRbSU1QTElDSVRfSEVBREVSX01BU0tfTEVOR1RIXQ0KCW89dFtJTVBMSUNJVF9IRUFERVJfTEVOR1RIOnMrSU1QTElDSVRfSEVBREVSX0xFTkdUSF0NCglyPWhpZ2hXYXRlcm1hcmsNCgl1PTMyKnMtbGVuKGUpDQoJbD0xPDwzMQ0KCWg9MAkNCgl3aGlsZShoPHMpOg0KCQljPW9baF0NCgkJZD0zMg0KCQlwPWgqZA0KCQlpZiBoPT1zLTE6Zj11DQoJCWVsc2U6Zj0wDQoJCWcxPWYNCgkJd2hpbGUoZzE8ZCk6DQoJCQlpZiBjJmw+PmcxOg0KCQkJCWVbcF09dFtuXQ0KCQkJCW4rPTEJDQoJCQllbHNlOg0KCQkJCWlmIHI6DQoJCQkJCWVbcF09YQ0KCQkJCWVsc2U6DQoJCQkJCWVbcF09YQ0KCQkJCQlhKz0xCQkJDQoJCQlnMSs9MQ0KCQkJcCs9MQ0KCQloKz0xDQoJcmV0dXJuIGUJCQ0KCQ0KCQ0KZGVmIGRlY29kZVdhdGVybWFyayh0LGUsaSk6DQoJbj1pWzBdDQoJcj1sZW4odCkNCglhPTANCgl3aGlsZShhPHIpOg0KCQlzPW4tdFthXQ0KCQllW2FdPXMNCgkJaWYgbjw9czpuPXMrMQ0KCQlhKz0xDQoJcmV0dXJuIGUsbg0KDQoNCmRlZiBkZWNvZGVRdWFudGl6ZShpbnB1dCxzLGEsaXRlbXNpemUpOg0KCXg9WzBdKmxlbihpbnB1dCkNCglpZD0wDQoJZm9yIHIgaW4gcmFuZ2UobGVuKGlucHV0KS9pdGVtc2l6ZSk6DQoJCWZvciBsIGluIHJhbmdlKGl0ZW1zaXplKToNCgkJCXhbaWRdPXNbbF0raW5wdXRbaWRdKmFbbF0NCgkJCWlkKz0xDQoJcmV0dXJuIHgJCQ0KCQkNCg0KZGVmIGRlY29kZVByZWRpY3QoaW5kaWNlcyxpbnB1dCxpdGVtc2l6ZSk6CQ0KCXQ9aW5wdXQJDQoJaWYgbGVuKGluZGljZXMpPjA6DQoJCXQ9aW5wdXQJDQoJCWU9aXRlbXNpemUNCgkJaT1pbmRpY2VzCQ0KCQluPWxlbih0KS9lDQoJCXI9WzBdKm4NCgkJYT1sZW4oaSktMQ0KCQlyW2lbMF1dPTENCgkJcltpWzFdXT0xDQoJCXJbaVsyXV09MQkNCgkJcz0yDQoJCXdoaWxlKHM8YSk6DQoJCQlvPXMtMg0KCQkJdT1pW29dDQoJCQlsPWlbbysxXQ0KCQkJaD1pW28rMl0NCgkJCWM9aVtvKzNdDQoJCQlpZiAxIT1yW2NdOg0KCQkJCXJbY109MQ0KCQkJCXUqPWUNCgkJCQlsKj1lDQoJCQkJaCo9ZQ0KCQkJCWMqPWUJCQkNCgkJCQlkPTANCgkJCQl3aGlsZShkPGUpOg0KCQkJCQl0W2MrZF09dFtjK2RdK3RbbCtkXSt0W2grZF0tdFt1K2RdDQoJCQkJCWQrPTENCgkJCXMrPTENCglyZXR1cm4gdA0KDQoNCg0KY2xhc3MgTm9kZToNCglkZWYgX19pbml0X18oc2VsZik6DQoJCXNlbGYubmFtZT1Ob25lDQoJCXNlbGYuY2hpbGRyZW49W10NCgkJc2VsZi5vc2dDaGlsZHJlbj1bXQ0KCQlzZWxmLm9mZnNldD1Ob25lDQoJCXNlbGYuc3RhcnQ9Tm9uZQ0KCQlzZWxmLmVuZD1Ob25lDQoJCXNlbGYuaGVhZGVyPScnDQoJCXNlbGYuZGF0YT0nJw0KCQlzZWxmLnBhcmVudD1Ob25lDQoJDQpjbGFzcyBZc29uOg0KCWRlZiBfX2luaXRfXyhzZWxmKToNCgkJc2VsZi5pbnB1dD1Ob25lDQoJCXNlbGYuZmlsZW5hbWU9Tm9uZQ0KCQlzZWxmLnJvb3Q9Tm9kZSgpDQoJCXNlbGYubG9nPUZhbHNlDQoJZGVmIHBhcnNlKHNlbGYpOg0KCQlnbG9iYWwgb2Zmc2V0LHN0cmluZyx0eHQNCgkJaWYgc2VsZi5maWxlbmFtZSBpcyBub3QgTm9uZToNCgkJCWZpbGU9b3BlbihzZWxmLmZpbGVuYW1lLCdyYicpDQoJCQlzZWxmLmlucHV0PWZpbGUucmVhZCgpLnJlcGxhY2UoJ1x4MjAnLCcnKS5yZXBsYWNlKCdceDBBJywnJykucmVwbGFjZSgnJiMzNDsnLCciJykJCQ0KCQkNCgkJCWxpbmU9c2VsZi5pbnB1dA0KCQkJaWYgc2VsZi5sb2c9PVRydWU6dHh0PW9wZW4oc2VsZi5maWxlbmFtZSsnLnlzJywndycpDQoJCQkNCgkJCWlmIGxpbmUgaXMgbm90IE5vbmUgYW5kIGxlbihsaW5lKT4wOg0KCQkJCW9mZnNldD0wDQoJCQkJbj0wDQoJCQkJc3RyaW5nPVtdDQoJCQkJaWYgc2VsZi5pbnB1dFtvZmZzZXRdPT0neyc6DQoJCQkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCQkJdHh0LndyaXRlKCdcbicpDQoJCQkJCQl0eHQud3JpdGUoJyAnKm4rJ2hlYWRlcjonK3N0cihOb25lKSkNCgkJCQkJCXR4dC53cml0ZSgnIHsgJytzdHIob2Zmc2V0KSkNCgkJCQkJCXR4dC53cml0ZSgnICcqKG4rNCkpDQoJCQkJaWYgc2VsZi5pbnB1dFtvZmZzZXRdPT0nWyc6DQoJCQkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCQkJdHh0LndyaXRlKCdcbicpDQoJCQkJCQl0eHQud3JpdGUoJyAnKm4rJ2hlYWRlcjonK3N0cihOb25lKSkNCgkJCQkJCXR4dC53cml0ZSgnIFsgJytzdHIob2Zmc2V0KSkNCgkJCQkJCXR4dC53cml0ZSgnICcqKG4rNCkpDQoJCQkJc2VsZi50cmVlKHNlbGYucm9vdCxuKQ0KCQkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCQl0eHQud3JpdGUoJyAnKm4pDQoJCQkJDQoJCQlmaWxlLmNsb3NlKCkJDQoJCQkNCgkJaWYgc2VsZi5sb2c9PVRydWU6dHh0LmNsb3NlKCkNCg0KCWRlZiBnZXRUcmVlMShzZWxmLHBhcmVudCxsaXN0LGtleSk6DQoJCWZvciBjaGlsZCBpbiBwYXJlbnQuY2hpbGRyZW46DQoJCQlpZiBrZXkgaW4gY2hpbGQuaGVhZGVyOg0KCQkJCWxpc3QuYXBwZW5kKGNoaWxkKQ0KCQkJc2VsZi5nZXRUcmVlKGNoaWxkLGxpc3Qsa2V5KQ0KCQkJDQoJCQ0KCWRlZiBnZXRUcmVlKHNlbGYscGFyZW50LGxpc3Qsa2V5KToNCgkJaWYga2V5IGluIHBhcmVudC5oZWFkZXIgb3Iga2V5IGluIHBhcmVudC5kYXRhOg0KCQkJbGlzdC5hcHBlbmQocGFyZW50KQ0KCQlmb3IgY2hpbGQgaW4gcGFyZW50LmNoaWxkcmVuOg0KCQkJc2VsZi5nZXRUcmVlKGNoaWxkLGxpc3Qsa2V5KQkNCg0KCWRlZiB2YWx1ZXMoc2VsZixkYXRhLHR5cGUpOg0KCQlsaXN0PXt9DQoJCUE9ZGF0YS5zcGxpdCgnLCcpDQoJCWlmIHR5cGU9PSc6JzoNCgkJCWZvciBhIGluIEE6DQoJCQkJaWYgJzonIGluIGE6DQoJCQkJCWM9MA0KCQkJCQlhbGlzdD1bXQ0KCQkJCQlzdHJpbmc9JycNCgkJCQkJZm9yIGIgaW4gYToNCgkJCQkJCWlmIGI9PSciJyBhbmQgYz09MDoNCgkJCQkJCQlpZiBsZW4oc3RyaW5nKT4wOmFsaXN0LmFwcGVuZChzdHJpbmcpDQoJCQkJCQkJc3RyaW5nPScnDQoJCQkJCQkJc3RyaW5nKz1iDQoJCQkJCQkJYz0xDQoJCQkJCQllbGlmIGI9PSciJyBhbmQgYz09MToNCgkJCQkJCQlzdHJpbmcrPWINCgkJCQkJCQlpZiBsZW4oc3RyaW5nKT4wOmFsaXN0LmFwcGVuZChzdHJpbmcpDQoJCQkJCQkJc3RyaW5nPScnDQoJCQkJCQkJYz0wDQoJCQkJCQllbGlmIGI9PSc6JzoNCgkJCQkJCQlwYXNzDQoJCQkJCQllbHNlOnN0cmluZys9Yg0KCQkJCQlpZiBsZW4oc3RyaW5nKT4wOmFsaXN0LmFwcGVuZChzdHJpbmcpDQoJCQkJCWlmIGxlbihhbGlzdCk9PTI6CQ0KCQkJCQkJbGlzdFthbGlzdFswXV09YWxpc3RbMV0JCQ0KCQkJCQlpZiBsZW4oYWxpc3QpPT0xOgkNCgkJCQkJCWxpc3RbYWxpc3RbMF1dPSdOb25lJwkJCQkJCQ0KCQkJCQkJCQkJDQoJCQkJCQkNCgkJCQkJCQkNCgkJCQkJI2lmIGEuY291bnQoJzonKT4xOg0KCQlpZiB0eXBlPT0nZic6DQoJCQlsaXN0PW1hcChmbG9hdCxBKQ0KCQlpZiB0eXBlPT0naSc6DQoJCQlsaXN0PW1hcChpbnQsQSkNCgkJaWYgdHlwZT09J3MnOg0KCQkJbGlzdD1BDQoJCXJldHVybiBsaXN0CQ0KDQoJZGVmIGdldFZhbHVlKHNlbGYsdmFsdWVzLG5hbWUsdHlwZT1Ob25lKToNCgkJaWYgbmFtZSBpbiB2YWx1ZXM6DQoJCQlpZiB0eXBlPT0nImYiJzoNCgkJCQlyZXR1cm4gZmxvYXQodmFsdWVzW25hbWVdLnNwbGl0KCciJylbMV0pDQoJCQllbGlmIHR5cGU9PSciaSInOg0KCQkJCXJldHVybiBpbnQodmFsdWVzW25hbWVdLnNwbGl0KCciJylbMV0pDQoJCQllbGlmIHR5cGU9PSdpJzoNCgkJCQkjcHJpbnQgbmFtZSx2YWx1ZXNbbmFtZV0NCgkJCQlpZiB2YWx1ZXNbbmFtZV0hPSdOb25lJzoNCgkJCQkJcmV0dXJuIGludCh2YWx1ZXNbbmFtZV0ucmVwbGFjZSgnXCInLCAnJykpDQoJCQkJZWxzZToNCgkJCQkJcmV0dXJuIE5vbmUNCgkJCWVsaWYgdHlwZT09JyIiJzoNCgkJCQlyZXR1cm4gdmFsdWVzW25hbWVdLnNwbGl0KCciJylbMV0NCgkJCWVsc2U6DQoJCQkJcmV0dXJuIHZhbHVlc1tuYW1lXQ0KCQllbHNlOg0KCQkJcmV0dXJuIE5vbmUNCgkJDQoJZGVmIGdldChzZWxmLG5vZGUsa2V5KToJCQ0KCQlsaXN0PVtdDQoJCXNlbGYuZ2V0VHJlZShub2RlLGxpc3Qsa2V5KQ0KCQlpZiBsZW4obGlzdCk+MDoNCgkJCXJldHVybiBsaXN0CQ0KCQllbHNlOg0KCQkJcmV0dXJuIE5vbmUNCgkJCQ0KCWRlZiB0cmVlKHNlbGYscGFyZW50Tm9kZSxuKToNCgkJZ2xvYmFsIG9mZnNldCxzdHJpbmcNCgkJbis9NA0KCQlvZmZzZXQrPTENCgkJd2hpbGUoVHJ1ZSk6CQ0KCQkJaWYJb2Zmc2V0Pj1sZW4oc2VsZi5pbnB1dCk6YnJlYWsNCgkJCXZhbHVlPXNlbGYuaW5wdXRbb2Zmc2V0XQ0KCQkJaWYgdmFsdWU9PSd9JzoNCgkJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQkJdHh0LndyaXRlKCdcbicpDQoJCQkJCWlmIGxlbihzdHJpbmcpPjA6DQoJCQkJCQl0eHQud3JpdGUoJyAnKm4rJ2RhdGE6JytzZWxmLmlucHV0W3N0cmluZ1swXTpvZmZzZXRdKQkNCgkJCQkJZWxzZToJDQoJCQkJCQl0eHQud3JpdGUoJyAnKm4rJ2RhdGE6Tm9uZScpCQkJCQ0KCQkJCQl0eHQud3JpdGUoJ1xuJysnICcqbisnIH0gJytzdHIob2Zmc2V0KSkNCgkJCQlpZiBsZW4oc3RyaW5nKT4wOgkNCgkJCQkJcGFyZW50Tm9kZS5kYXRhPXNlbGYuaW5wdXRbc3RyaW5nWzBdOm9mZnNldF0NCgkJCQlzdHJpbmc9W10NCgkJCQlvZmZzZXQrPTEJCQkNCgkJCQlicmVhaw0KCQkJDQoJCQllbGlmIHZhbHVlPT0neyc6DQoJCQkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQkJCXR4dC53cml0ZSgnXG4nKQ0KCQkJCQlpZiBsZW4oc3RyaW5nKT4wOg0KCQkJCQkJdHh0LndyaXRlKCcgJypuKydoZWFkZXI6JytzZWxmLmlucHV0W3N0cmluZ1swXTpvZmZzZXRdKQkNCgkJCQkJZWxzZToJDQoJCQkJCQl0eHQud3JpdGUoJyAnKm4rJ2hlYWRlcjpOb25lJykJCQkJDQoJCQkJCXR4dC53cml0ZSgnIHsgJytzdHIob2Zmc2V0KSkNCgkJCQkJdHh0LndyaXRlKCcgJyoobis0KSkNCgkJCQkjcHJpbnQgcm91bmQoMTAwKm9mZnNldC9mbG9hdChsZW4oc2VsZi5pbnB1dCkpLDMpLCdwcm9jZW50Jw0KCQkJCW5vZGU9Tm9kZSgpDQoJCQkJbm9kZS5wYXJlbnQ9cGFyZW50Tm9kZQ0KCQkJCXBhcmVudE5vZGUuY2hpbGRyZW4uYXBwZW5kKG5vZGUpDQoJCQkJbm9kZS5vZmZzZXQ9b2Zmc2V0DQoJCQkJaWYgbGVuKHN0cmluZyk+MDoNCgkJCQkJbm9kZS5oZWFkZXI9c2VsZi5pbnB1dFtzdHJpbmdbMF06b2Zmc2V0XQ0KCQkJCXN0cmluZz1bXQ0KCQkJCXNlbGYudHJlZShub2RlLG4pDQoJCQkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQkJCXR4dC53cml0ZSgnICcqbikNCgkJCQkNCgkJCWVsaWYgdmFsdWU9PSddJzoNCgkJCQlpZiBsZW4oc3RyaW5nKT4wOg0KCQkJCQlwYXJlbnROb2RlLmRhdGE9c2VsZi5pbnB1dFtzdHJpbmdbMF06b2Zmc2V0XQ0KCQkJCQ0KCQkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCQl0eHQud3JpdGUoJ1xuJykNCgkJCQkJaWYgbGVuKHN0cmluZyk+MDoNCgkJCQkJCXR4dC53cml0ZSgnICcqbisnZGF0YTonK3NlbGYuaW5wdXRbc3RyaW5nWzBdOm9mZnNldF0rJ1xuJykJDQoJCQkJCWVsc2U6CQ0KCQkJCQkJdHh0LndyaXRlKCcgJypuKydkYXRhOk5vbmUnKQkJCQkJCQkNCgkJCQkJdHh0LndyaXRlKCcgJypuKycgXSAnK3N0cihvZmZzZXQpKQ0KCQkJCQkNCgkJCQlvZmZzZXQrPTENCgkJCQlzdHJpbmc9W10NCgkJCQlicmVhaw0KCQkJDQoJCQllbGlmIHZhbHVlPT0nWyc6DQoJCQkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQkJCXR4dC53cml0ZSgnXG4nKQ0KCQkJCQlpZiBsZW4oc3RyaW5nKT4wOg0KCQkJCQkJdHh0LndyaXRlKCcgJypuKydoZWFkZXI6JytzZWxmLmlucHV0W3N0cmluZ1swXTpvZmZzZXRdKQ0KCQkJCQllbHNlOgkNCgkJCQkJCXR4dC53cml0ZSgnICcqbisnaGVhZGVyOk5vbmUnKQ0KCQkJCQl0eHQud3JpdGUoJyBbICcrc3RyKG9mZnNldCkpDQoJCQkJCXR4dC53cml0ZSgnICcqKG4rNCkpDQoJCQkJI3ByaW50IHJvdW5kKDEwMCpvZmZzZXQvZmxvYXQobGVuKHNlbGYuaW5wdXQpKSwzKSwncHJvY2VudCcNCgkJCQlub2RlPU5vZGUoKQ0KCQkJCW5vZGUucGFyZW50PXBhcmVudE5vZGUNCgkJCQlwYXJlbnROb2RlLmNoaWxkcmVuLmFwcGVuZChub2RlKQ0KCQkJCW5vZGUub2Zmc2V0PW9mZnNldA0KCQkJCW5vZGUubmFtZT1zdHJpbmcNCgkJCQlpZiBsZW4oc3RyaW5nKT4wOg0KCQkJCQlub2RlLmhlYWRlcj1zZWxmLmlucHV0W3N0cmluZ1swXTpvZmZzZXRdDQoJCQkJZWxzZToNCgkJCQkJbm9kZS5oZWFkZXI9JycNCgkJCQlzdHJpbmc9W10NCgkJCQlzZWxmLnRyZWUobm9kZSxuKQ0KCQkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCQl0eHQud3JpdGUoJyAnKm4pDQoJCQllbHNlOgkJCQ0KCQkJCSNzdHJpbmcrPXZhbHVlDQoJCQkJaWYgbGVuKHN0cmluZyk9PTA6DQoJCQkJCXN0cmluZy5hcHBlbmQob2Zmc2V0KQ0KCQkJCW9mZnNldCs9MQ0KCQkNCmRlZiBnZXRVbmlxdWVJRCh5cyxkYXRhKToNCglVbmlxdWVJRD1Ob25lDQoJdmFsdWVzPXlzLnZhbHVlcyhkYXRhLCc6JykNCglpZiAnIlVuaXF1ZUlEIicgaW4gdmFsdWVzOg0KCQlVbmlxdWVJRD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJVbmlxdWVJRCInLCdpJykNCglyZXR1cm4gVW5pcXVlSUQJDQoJDQoNCmNsYXNzIE5ld05vZGU6DQoJZGVmIF9faW5pdF9fKHNlbGYpOg0KCQlzZWxmLm5vZGU9Tm9uZQ0KCQlzZWxmLnBhcmVudD1Ob25lDQoJCXNlbGYuY2hpbGRyZW49W10NCgkJc2VsZi5VbmlxdWVJRD1Ob25lDQoJDQpkZWYgZ2V0SURUcmVlKHlzLHBhcmVudE5vZGUsbixwYXJlbnROZXdOb2RlKToNCglpZiBsZW4ocGFyZW50Tm9kZS5oZWFkZXIpIT0wIGFuZCBwYXJlbnROb2RlLmhlYWRlciE9JywnOg0KCQluKz00DQoJVW5pcXVlSUQ9Z2V0VW5pcXVlSUQoeXMscGFyZW50Tm9kZS5kYXRhKQ0KCWlmIFVuaXF1ZUlEOg0KCQlwYXJlbnROZXdOb2RlLlVuaXF1ZUlEPVVuaXF1ZUlEDQoJZm9yIGNoaWxkIGluIHBhcmVudE5vZGUuY2hpbGRyZW46DQoJCWlmIGxlbihjaGlsZC5oZWFkZXIpIT0wIGFuZCBjaGlsZC5oZWFkZXIhPScsJzoNCgkJCW5ld05vZGU9TmV3Tm9kZSgpDQoJCQlVbmlxdWVJRD1nZXRVbmlxdWVJRCh5cyxjaGlsZC5oZWFkZXIpDQoJCQlpZiBVbmlxdWVJRDoNCgkJCQlwYXJlbnROZXdOb2RlLlVuaXF1ZUlEPVVuaXF1ZUlEDQoJCQluZXdOb2RlLm5vZGU9Y2hpbGQNCgkJCXBhcmVudE5ld05vZGUuY2hpbGRyZW4uYXBwZW5kKG5ld05vZGUpDQoJCQluZXdOb2RlTGlzdC5hcHBlbmQobmV3Tm9kZSkNCgkJCW5ld05vZGUucGFyZW50PXBhcmVudE5vZGUNCgkJCXBhcmVudE5ld05vZGUxPW5ld05vZGUNCgkJCWdldElEVHJlZSh5cyxjaGlsZCxuLHBhcmVudE5ld05vZGUxKQ0KCQllbHNlOgkNCgkJCWdldElEVHJlZSh5cyxjaGlsZCxuLHBhcmVudE5ld05vZGUpDQoJCQkNCgkJCQkJCQkJDQpkZWYgZ2V0UGF0aChGaWxlKToNCglwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJy5neicpWzBdDQoJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOnBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZSsnLnR4dCcNCglpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6cGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlDQoJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWU6cmV0dXJuIHBhdGgNCgllbHNlOnJldHVybiBOb25lDQoJCQkNCmRlZiByZWFkRmxvYXRzKGJyLG9mZnNldCxzaXplLGl0ZW1TaXplKToNCglpZiBici5pbnB1dEZpbGUubW9kZT09J3JiJzoNCgkJYnIuc2VlayhvZmZzZXQpDQoJCWkgPSAwDQoJCW51bWJlcnMgPSBbXQ0KCQl3aGlsZSBpIDwgc2l6ZSAqIGl0ZW1TaXplOg0KCQkJbnVtYmVycy5hcHBlbmQoZmxvYXQoc3RydWN0LnVucGFjaygnPGYnLGJyLmlucHV0RmlsZS5yZWFkKDQpKVswXSkpDQoJCQlpICs9IDENCgkJcmV0dXJuIG51bWJlcnMJCQkNCg0KZGVmIFZlcnRleE5vcm1hbCh5cyxiKToNCgluPTIwDQoJU2l6ZT1Ob25lDQoJT2Zmc2V0PU5vbmUNCglFbmNvZGluZz1Ob25lDQoJSXRlbVNpemU9Tm9uZQ0KCXR5cGU9Tm9uZQ0KCW5vcm1hbEFycmF5PVtdCQ0KCXZhbHVlcz15cy52YWx1ZXMoYi5kYXRhLCc6JykNCglpZiAnIkl0ZW1TaXplIicgaW4gdmFsdWVzOg0KCQlJdGVtU2l6ZT1pbnQodmFsdWVzWyciSXRlbVNpemUiJ10pCQkJCQkNCgkJVWludDMyQXJyYXk9eXMuZ2V0KGIsJyJVaW50MzJBcnJheSInKQ0KCQlpZiBVaW50MzJBcnJheToNCgkJCXR5cGU9J1VpbnQzMkFycmF5Jw0KCQkJdmFsdWVzPXlzLnZhbHVlcyhVaW50MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJywnIiInKQ0KCQkJRW5jb2Rpbmc9eXMuZ2V0VmFsdWUodmFsdWVzLCciRW5jb2RpbmciJykNCgkJCWlmIEVuY29kaW5nPT0nInZhcmludCInOgkJCQkJCQ0KCQkJCXBhdGg9Z2V0UGF0aChGaWxlKQ0KCQkJCWlmIHBhdGg6DQoJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCWJ5dGVzPWRlY29kZVZhcmludChnLE9mZnNldCxTaXplKkl0ZW1TaXplLHR5cGUpDQoJCQkJCW5vcm1hbEFycmF5LmFwcGVuZChbYnl0ZXMsRW5jb2RpbmcsSXRlbVNpemVdKQ0KCQkJCQlmaWxlLmNsb3NlKCkNCgkJRmxvYXQzMkFycmF5ID0geXMuZ2V0KGIsICciRmxvYXQzMkFycmF5IicpDQoJCWlmIEZsb2F0MzJBcnJheToNCgkJCXR5cGU9J0Zsb2F0MzJBcnJheScNCgkJCXZhbHVlcz15cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicsJ2knKQ0KCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInLCdpJykNCgkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInLCciIicpDQoJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInKQ0KCQkJaWYgRW5jb2RpbmcgIT0gJyJ2YXJpbnQiJzoNCgkJCQlwYXRoID0gZ2V0UGF0aChGaWxlKQ0KCQkJCWlmIHBhdGg6DQoJCQkJCWdsb2JhbCBtb2RlbElEDQoJCQkJCWZpbGUgPSBvcGVuKHBhdGgsICJyYiIpDQoJCQkJCWcgPSBCaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJYnl0ZXMgPSByZWFkRmxvYXRzKGcsIE9mZnNldCwgU2l6ZSwgSXRlbVNpemUpDQoJCQkJCXdpdGggb3BlbigiLi97dGVtcFBhdGh9L3ZlcnRleE5vcm1hbERhdGEvIiArIHN0cihtb2RlbElEKSArICIuZGF0IiwgImEiKSBhcyBtb2RlbERhdGE6DQoJCQkJCQltb2RlbElEICs9IDENCgkJCQkJCWZvciBsaW5lIGluIGJ5dGVzOg0KCQkJCQkJCW1vZGVsRGF0YS53cml0ZShzdHIobGluZSkgKyAiXG4iKQ0KCQkJCQlub3JtYWxBcnJheS5hcHBlbmQoW2J5dGVzLCBFbmNvZGluZywgSXRlbVNpemVdKQ0KCQkJCQlmaWxlLmNsb3NlKCkNCglyZXR1cm4gbm9ybWFsQXJyYXkJDQoJDQpkZWYgVmVydGV4KHlzLGIpOg0KCW49MjANCglTaXplPU5vbmUNCglPZmZzZXQ9Tm9uZQ0KCUVuY29kaW5nPU5vbmUNCglJdGVtU2l6ZT1Ob25lDQoJdHlwZT1Ob25lDQoJdmVydGV4QXJyYXk9W10JDQoJdmFsdWVzPXlzLnZhbHVlcyhiLmRhdGEsJzonKQ0KCWlmICciSXRlbVNpemUiJyBpbiB2YWx1ZXM6DQoJCUl0ZW1TaXplPWludCh2YWx1ZXNbJyJJdGVtU2l6ZSInXSkJCQkJCQ0KCQlJbnQzMkFycmF5PXlzLmdldChiLCciSW50MzJBcnJheSInKQ0KCQlpZiBJbnQzMkFycmF5Og0KCQkJdHlwZT0nSW50MzJBcnJheScNCgkJCXZhbHVlcz15cy52YWx1ZXMoSW50MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJywnIiInKQ0KCQkJRW5jb2Rpbmc9eXMuZ2V0VmFsdWUodmFsdWVzLCciRW5jb2RpbmciJykNCgkJCSN3cml0ZShsb2csW3R5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmddLG4pDQoJCQlpZiBFbmNvZGluZz09JyJ2YXJpbnQiJzoJCQkJCQkNCgkJCQlwYXRoPWdldFBhdGgoRmlsZSkNCgkJCQlpZiBwYXRoOg0KCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQlieXRlcz1kZWNvZGVWYXJpbnQoZyxPZmZzZXQsU2l6ZSpJdGVtU2l6ZSx0eXBlKQ0KCQkJCQl2ZXJ0ZXhBcnJheS5hcHBlbmQoW2J5dGVzLEVuY29kaW5nLEl0ZW1TaXplXSkNCgkJCQkJZmlsZS5jbG9zZSgpDQoJCQkJCQ0KCQlGbG9hdDMyQXJyYXk9eXMuZ2V0KGIsJyJGbG9hdDMyQXJyYXkiJykNCgkJaWYgRmxvYXQzMkFycmF5Og0KCQkJdHlwZT0nRmxvYXQzMkFycmF5Jw0KCQkJI3ByaW50IG1vZGUsdHlwZQ0KCQkJdmFsdWVzPXlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwnOicpDQoJCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJywnaScpDQoJCQlPZmZzZXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicsJ2knKQ0KCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicsJyIiJykNCgkJCUVuY29kaW5nPXlzLmdldFZhbHVlKHZhbHVlcywnIkVuY29kaW5nIicpDQoJCQkjd3JpdGUobG9nLFt0eXBlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nXSxuKQ0KCQkJaWYgRW5jb2RpbmchPScidmFyaW50Iic6CQkJCQkJDQoJCQkJcGF0aD1nZXRQYXRoKEZpbGUpDQoJCQkJaWYgcGF0aDoNCgkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJZy5zZWVrKE9mZnNldCkNCgkJCQkJYnl0ZXM9Zy5mKFNpemUqSXRlbVNpemUpDQoJCQkJCWxpc3Q9W10NCgkJCQkJZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQoJCQkJCQlsaXN0LmFwcGVuZChieXRlc1ttKkl0ZW1TaXplOm0qSXRlbVNpemUrSXRlbVNpemVdKQ0KCQkJCQl2ZXJ0ZXhBcnJheS5hcHBlbmQoW2xpc3QsRW5jb2RpbmddKQ0KCQkJCQlmaWxlLmNsb3NlKCkNCglyZXR1cm4gdmVydGV4QXJyYXkJCQkJDQoJDQpkZWYgVGV4Q29vcmQoeXMsYik6DQoJbj0yMA0KCVNpemU9Tm9uZQ0KCU9mZnNldD1Ob25lDQoJRW5jb2Rpbmc9Tm9uZQ0KCUl0ZW1TaXplPU5vbmUNCgl0eXBlPU5vbmUJDQoJVGV4Q29vcmRBcnJheT1bXQ0KCXZhbHVlcz15cy52YWx1ZXMoYi5kYXRhLCc6JykNCglpZiAnIkl0ZW1TaXplIicgaW4gdmFsdWVzOg0KCQlJdGVtU2l6ZT1pbnQodmFsdWVzWyciSXRlbVNpemUiJ10pCQkJCQkNCgkJSW50MzJBcnJheT15cy5nZXQoYiwnIkludDMyQXJyYXkiJykNCgkJaWYgSW50MzJBcnJheToNCgkJCXR5cGU9J0ludDMyQXJyYXknDQoJCQl2YWx1ZXM9eXMudmFsdWVzKEludDMyQXJyYXlbMF0uZGF0YSwnOicpDQoJCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJywnaScpDQoJCQlPZmZzZXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicsJ2knKQ0KCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicsJyIiJykNCgkJCUVuY29kaW5nPXlzLmdldFZhbHVlKHZhbHVlcywnIkVuY29kaW5nIicpDQoJCQlpZiBFbmNvZGluZz09JyJ2YXJpbnQiJzoJCQkJCQkNCgkJCQlwYXRoPWdldFBhdGgoRmlsZSkNCgkJCQlpZiBwYXRoOg0KCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQlieXRlcz1kZWNvZGVWYXJpbnQoZyxPZmZzZXQsU2l6ZSpJdGVtU2l6ZSx0eXBlKQ0KCQkJCQlUZXhDb29yZEFycmF5LmFwcGVuZChbYnl0ZXMsRW5jb2RpbmcsSXRlbVNpemVdKQ0KCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQkJDQoJCUZsb2F0MzJBcnJheT15cy5nZXQoYiwnIkZsb2F0MzJBcnJheSInKQ0KCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQl0eXBlPSdGbG9hdDMyQXJyYXknDQoJCQl2YWx1ZXM9eXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJywnIiInKQ0KCQkJRW5jb2Rpbmc9eXMuZ2V0VmFsdWUodmFsdWVzLCciRW5jb2RpbmciJykNCgkJCWlmIEVuY29kaW5nIT0nInZhcmludCInOgkJCQkJCQ0KCQkJCXBhdGg9Z2V0UGF0aChGaWxlKQ0KCQkJCWlmIHBhdGg6DQoJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCWcuc2VlayhPZmZzZXQpDQoJCQkJCWJ5dGVzPWcuZihTaXplKkl0ZW1TaXplKQ0KCQkJCQlsaXN0PVtdDQoJCQkJCWZvciBtIGluIHJhbmdlKFNpemUpOg0KCQkJCQkJdSx2PWJ5dGVzW20qSXRlbVNpemU6bSpJdGVtU2l6ZStJdGVtU2l6ZV0NCgkJCQkJCWxpc3QuYXBwZW5kKFt1LDEtdl0pDQoJCQkJCVRleENvb3JkQXJyYXkuYXBwZW5kKFtsaXN0LEVuY29kaW5nXSkNCgkJCQkJZmlsZS5jbG9zZSgpDQoJcmV0dXJuIFRleENvb3JkQXJyYXkNCgkNCmRlZiBDb2xvcih5cyxiKToNCgluPTIwDQoJU2l6ZT1Ob25lDQoJT2Zmc2V0PU5vbmUNCglFbmNvZGluZz1Ob25lDQoJSXRlbVNpemU9Tm9uZQ0KCXR5cGU9Tm9uZQkJCQkNCgl2YWx1ZXM9eXMudmFsdWVzKGIuZGF0YSwnOicpDQoJY29sb3JBcnJheT1bXQ0KCWlmICciSXRlbVNpemUiJyBpbiB2YWx1ZXM6DQoJCUl0ZW1TaXplPWludCh2YWx1ZXNbJyJJdGVtU2l6ZSInXSkJCQkJCQ0KCQlVaW50OEFycmF5PXlzLmdldChiLCciVWludDhBcnJheSInKQ0KCQlpZiBVaW50OEFycmF5Og0KCQkJdHlwZT0iVWludDhBcnJheSINCgkJCXZhbHVlcz15cy52YWx1ZXMoVWludDhBcnJheVswXS5kYXRhLCc6JykNCgkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInLCciIicpCQ0KCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicsJyIiJykJCQkJCQ0KCQkJcGF0aD1nZXRQYXRoKEZpbGUpDQoJCQlpZiBwYXRoOg0KCQkJCWlmIEVuY29kaW5nIT0nInZhcmludCInOg0KCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQlnLnNlZWsoT2Zmc2V0KQ0KCQkJCQlieXRlcz1nLkIoU2l6ZSpJdGVtU2l6ZSkNCgkJCQkJbGlzdD1bXQ0KCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCWxpc3QuYXBwZW5kKGJ5dGVzW20qSXRlbVNpemU6bSpJdGVtU2l6ZStJdGVtU2l6ZV0pDQoJCQkJCWNvbG9yQXJyYXk9bGlzdA0KCQkJCQlmaWxlLmNsb3NlKCkJCQkJCQ0KCQlGbG9hdDMyQXJyYXk9eXMuZ2V0KGIsJyJGbG9hdDMyQXJyYXkiJykNCgkJaWYgRmxvYXQzMkFycmF5Og0KCQkJdHlwZT0iRmxvYXQzMkFycmF5Ig0KCQkJdmFsdWVzPXlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwnOicpDQoJCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJywnaScpDQoJCQlPZmZzZXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicsJ2knKQ0KCQkJRW5jb2Rpbmc9eXMuZ2V0VmFsdWUodmFsdWVzLCciRW5jb2RpbmciJywnIiInKQkNCgkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInLCciIicpCQkJCQkNCgkJCXBhdGg9Z2V0UGF0aChGaWxlKQ0KCQkJaWYgcGF0aDoNCgkJCQlpZiBFbmNvZGluZyE9JyJ2YXJpbnQiJzoNCgkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJZy5zZWVrKE9mZnNldCkNCgkJCQkJYnl0ZXM9Zy5mKFNpemUqSXRlbVNpemUpDQoJCQkJCWxpc3Q9W10NCgkJCQkJZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQoJCQkJCQlpdGVtcz1ieXRlc1ttKkl0ZW1TaXplOm0qSXRlbVNpemUrSXRlbVNpemVdDQoJCQkJCQlBPVtdDQoJCQkJCQlmb3IgaXRlbSBpbiBpdGVtczoNCgkJCQkJCQlBLmFwcGVuZChpbnQoaXRlbSoyNTYpKQ0KCQkJCQkJbGlzdC5hcHBlbmQoQSkNCgkJCQkJY29sb3JBcnJheT1saXN0DQoJCQkJCWZpbGUuY2xvc2UoKQ0KCXJldHVybiBjb2xvckFycmF5CQkJCQkJCQ0KCQ0KCQ0KCQ0KZGVmIGdldEluZGljZXMoaXRlbXNpemUsc2l6ZSxvZmZzZXQsdHlwZSxnLG1vZGUsbWFnaWMpOg0KCWlmIHR5cGUhPSJVaW50OEFycmF5IjpieXRlcz1kZWNvZGVWYXJpbnQoZyxvZmZzZXQsc2l6ZSppdGVtc2l6ZSx0eXBlKQ0KCWVsc2U6DQoJCWcuc2VlayhvZmZzZXQpDQoJCWJ5dGVzPWxpc3QoZy5CKHNpemUqaXRlbXNpemUpKQkJDQoJd3JpdGUobG9nLFttYWdpYyxtb2RlLHR5cGVdLDApDQoJd3JpdGUobG9nLGJ5dGVzLDApCQkNCgkNCglJTVBMSUNJVF9IRUFERVJfTEVOR1RIPTMNCglJTVBMSUNJVF9IRUFERVJfTUFTS19MRU5HVEg9MQ0KCUlNUExJQ0lUX0hFQURFUl9QUklNSVRJVkVfTEVOR1RIPTANCglJTVBMSUNJVF9IRUFERVJfRVhQRUNURURfSU5ERVg9Mg0KCWhpZ2hXYXRlcm1hcms9Mg0KCQ0KCU1pc3NpbmdDb25kaXRpb249c2tpcGRlY29kZQ0KCWlmIE1pc3NpbmdDb25kaXRpb24hPTE6DQoJCQ0KCQlpZiBtb2RlPT0nIlRSSUFOR0xFX1NUUklQIic6DQoJCQkJCWs9SU1QTElDSVRfSEVBREVSX0xFTkdUSCtieXRlc1tJTVBMSUNJVF9IRUFERVJfTUFTS19MRU5HVEhdDQoJCQkJCWJ5dGVzPWRlY29kZURlbHRhKGJ5dGVzLGspCQ0KCQkJCQkjd3JpdGUobG9nLFttYWdpYyxrXSwwKQkNCgkJCQkJI3dyaXRlKGxvZyxieXRlcywwKQkJDQoJCQkJCWJ5dGVzPWRlY29kZUltcGxpY2l0KGJ5dGVzLGspDQoJCQkJCSN3cml0ZShsb2csW21hZ2ljLGtdLDApCQ0KCQkJCQkjd3JpdGUobG9nLGJ5dGVzLDApCQkJDQoJCQkJCWk9W21hZ2ljXQkNCgkJCQkJYnl0ZXMsbWFnaWM9ZGVjb2RlV2F0ZXJtYXJrKGJ5dGVzLGJ5dGVzLGkpDQoJCQkJCSN3cml0ZShsb2csW21hZ2ljXSwwKQkNCgkJCQkJI3dyaXRlKGxvZyxieXRlcywwKQkNCgkJCQkNCgkJZWxpZiBtb2RlPT0nIlRSSUFOR0xFUyInOg0KCQkJCQlrPTANCgkJCQkJYnl0ZXM9ZGVjb2RlRGVsdGEoYnl0ZXMsaykNCgkJCQkJI3dyaXRlKGxvZyxbbWFnaWNdLDApCQ0KCQkJCQkjd3JpdGUobG9nLGJ5dGVzLDApCQkJDQoJCQkJCWk9W21hZ2ljXQkNCgkJCQkJYnl0ZXMsbWFnaWM9ZGVjb2RlV2F0ZXJtYXJrKGJ5dGVzLGJ5dGVzLGkpDQoJCQkJCSN3cml0ZShsb2csW21hZ2ljXSwwKQkNCgkJCQkJI3dyaXRlKGxvZyxieXRlcywwKQkNCgkJDQoJCQ0KCQkNCgkJDQoJcmV0dXJuIG1hZ2ljLGJ5dGVzDQoJDQoJCQkJDQpkZWYgUHJpbWl0aXZlU2V0TGlzdCh5cyxjaGlsZCk6DQoJZ2xvYmFsIG1hZ2ljDQoJbW9kZT1Ob25lDQoJbWFnaWM9MA0KCW49MTYNCglpbmRpY2VBcnJheT1bXQ0KCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoJCQkJCQ0KCQliPWNoaWxkLm5vZGUNCgkJaWYgJyJEcmF3RWxlbWVudHNVSW50IicgaW4gYi5oZWFkZXI6CQkJDQoJCQl2YWx1ZXM9eXMudmFsdWVzKGIuZGF0YSwnOicpDQoJCQltb2RlPXZhbHVlc1snIk1vZGUiJ10JCQkNCgkJCVNpemU9Tm9uZQ0KCQkJT2Zmc2V0PU5vbmUNCgkJCUVuY29kaW5nPU5vbmUNCgkJCUl0ZW1TaXplPU5vbmUNCgkJCXR5cGU9Tm9uZQ0KCQkJaWYgbW9kZSE9JyJMSU5FUyInOg0KCQkJCUluZGljZXM9eXMuZ2V0KGIsJyJJbmRpY2VzIicpDQoJCQkJaWYgSW5kaWNlczoNCgkJCQkJdmFsdWVzPXlzLnZhbHVlcyhJbmRpY2VzWzBdLmRhdGEsJzonKQ0KCQkJCQlJdGVtU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJJdGVtU2l6ZSInLCdpJykNCgkJCQkJVWludDMyQXJyYXk9eXMuZ2V0KEluZGljZXNbMF0sJyJVaW50MzJBcnJheSInKQ0KCQkJCQl0eXBlPSJVaW50MzJBcnJheSINCgkJCQkJI3ByaW50ICJEcmF3RWxlbWVudHNVSW50Iix0eXBlDQoJCQkJCWlmIFVpbnQzMkFycmF5Og0KCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhVaW50MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCQkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCQkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQkJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInLCciIicpDQoJCQkJCQkjd3JpdGUobG9nLFsnSW5kaWNlOicsJ21vZGU6Jyxtb2RlLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmcsJ21hZ2ljOicsbWFnaWNdLG4pDQoJCQkJCQlpZiBFbmNvZGluZz09J3ZhcmludCc6DQoJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpK29zLnNlcCsibW9kZWxfZmlsZS5iaW4iDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOnBhdGg9b3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKStvcy5zZXArIm1vZGVsX2ZpbGUuYmluIg0KCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1GYWxzZTpwYXRoPW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkrb3Muc2VwK3ZhbHVlc1snIkZpbGUiJ10uc3BsaXQoJyInKVsxXSMrJy50eHQnDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWU6DQoJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCW1hZ2ljLGluZGljZUxpc3Q9Z2V0SW5kaWNlcyhJdGVtU2l6ZSxTaXplLE9mZnNldCx0eXBlLGcsbW9kZSxtYWdpYykNCgkJCQkJCQkJaW5kaWNlQXJyYXkuYXBwZW5kKFtpbmRpY2VMaXN0LG1vZGVdKQ0KCQkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCSNlbHNlOg0KCQkJIwlwcmludCAnTElORVMnDQoJCQkJDQoJCWlmICciRHJhd0VsZW1lbnRzVVNob3J0IicgaW4gYi5oZWFkZXI6CQkNCgkJCXZhbHVlcz15cy52YWx1ZXMoYi5kYXRhLCc6JykNCgkJCW1vZGU9dmFsdWVzWyciTW9kZSInXQkJCQ0KCQkJU2l6ZT1Ob25lDQoJCQlPZmZzZXQ9Tm9uZQ0KCQkJRW5jb2Rpbmc9Tm9uZQ0KCQkJSXRlbVNpemU9Tm9uZQ0KCQkJdHlwZT1Ob25lDQoJCQlpZiBtb2RlIT0nIkxJTkVTIic6DQoJCQkJSW5kaWNlcz15cy5nZXQoYiwnIkluZGljZXMiJykNCgkJCQlpZiBJbmRpY2VzOg0KCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEluZGljZXNbMF0uZGF0YSwnOicpDQoJCQkJCUl0ZW1TaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIkl0ZW1TaXplIicsJ2knKQ0KCQkJCQlVaW50MTZBcnJheT15cy5nZXQoSW5kaWNlc1swXSwnIlVpbnQxNkFycmF5IicpDQoJCQkJCXR5cGU9IlVpbnQxNkFycmF5Ig0KCQkJCQkjcHJpbnQgIkRyYXdFbGVtZW50c1VTaG9ydCIsdHlwZQ0KCQkJCQlpZiBVaW50MTZBcnJheToNCgkJCQkJCXZhbHVlcz15cy52YWx1ZXMoVWludDE2QXJyYXlbMF0uZGF0YSwnOicpDQoJCQkJCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJywnaScpDQoJCQkJCQlPZmZzZXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicsJ2knKQ0KCQkJCQkJRW5jb2Rpbmc9eXMuZ2V0VmFsdWUodmFsdWVzLCciRW5jb2RpbmciJywnIiInKQ0KCQkJCQkJI3dyaXRlKGxvZyxbJ0luZGljZTonLCdtb2RlOicsbW9kZSx0eXBlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nLCdtYWdpYzonLG1hZ2ljXSxuKQ0KCQkJCQkJI3ByaW50IEVuY29kaW5nDQoJCQkJCQlpZiBFbmNvZGluZz09J3ZhcmludCc6DQoJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpK29zLnNlcCsibW9kZWxfZmlsZS5iaW4iDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOnBhdGg9b3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKStvcy5zZXArIm1vZGVsX2ZpbGUuYmluIg0KCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1GYWxzZTpwYXRoPW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkrb3Muc2VwK3ZhbHVlc1snIkZpbGUiJ10uc3BsaXQoJyInKVsxXSMrJy50eHQnDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWU6DQoJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCW1hZ2ljLGluZGljZUxpc3Q9Z2V0SW5kaWNlcyhJdGVtU2l6ZSxTaXplLE9mZnNldCx0eXBlLGcsbW9kZSxtYWdpYykNCgkJCQkJCQkJaW5kaWNlQXJyYXkuYXBwZW5kKFtpbmRpY2VMaXN0LG1vZGVdKQ0KCQkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQkJCWVsc2U6DQoJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpK29zLnNlcCsibW9kZWxfZmlsZS5iaW4iDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOnBhdGg9b3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKStvcy5zZXArIm1vZGVsX2ZpbGUuYmluIg0KCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1GYWxzZTpwYXRoPW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkrb3Muc2VwK3ZhbHVlc1snIkZpbGUiJ10uc3BsaXQoJyInKVsxXSMrJy50eHQnDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWU6DQoJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCWcuc2VlayhPZmZzZXQpDQoJCQkJCQkJCWluZGljZUxpc3Q9Zy5IKEl0ZW1TaXplKlNpemUpDQoJCQkJCQkJCWluZGljZUFycmF5LmFwcGVuZChbaW5kaWNlTGlzdCxtb2RlXSkNCgkJCQkJCQkJZmlsZS5jbG9zZSgpDQoJCQkjZWxzZToNCgkJCSMJcHJpbnQgJ0xJTkVTJw0KCQkJDQoJCWlmICciRHJhd0VsZW1lbnRzVUJ5dGUiJyBpbiBiLmhlYWRlcjoJCQkNCgkJCXZhbHVlcz15cy52YWx1ZXMoYi5kYXRhLCc6JykNCgkJCW1vZGU9dmFsdWVzWyciTW9kZSInXQkJCQ0KCQkJU2l6ZT1Ob25lDQoJCQlPZmZzZXQ9Tm9uZQ0KCQkJRW5jb2Rpbmc9Tm9uZQ0KCQkJSXRlbVNpemU9Tm9uZQ0KCQkJdHlwZT1Ob25lDQoJCQlpZiBtb2RlIT0nIkxJTkVTIic6DQoJCQkJSW5kaWNlcz15cy5nZXQoYiwnIkluZGljZXMiJykNCgkJCQlpZiBJbmRpY2VzOg0KCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEluZGljZXNbMF0uZGF0YSwnOicpDQoJCQkJCUl0ZW1TaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIkl0ZW1TaXplIicsJ2knKQ0KCQkJCQlVaW50OEFycmF5PXlzLmdldChJbmRpY2VzWzBdLCciVWludDhBcnJheSInKQ0KCQkJCQl0eXBlPSJVaW50OEFycmF5Ig0KCQkJCQkjcHJpbnQgIkRyYXdFbGVtZW50c1VCeXRlIix0eXBlDQoJCQkJCWlmIFVpbnQ4QXJyYXk6DQoJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKFVpbnQ4QXJyYXlbMF0uZGF0YSwnOicpDQoJCQkJCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJywnaScpDQoJCQkJCQlPZmZzZXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicsJ2knKQ0KCQkJCQkJRW5jb2Rpbmc9eXMuZ2V0VmFsdWUodmFsdWVzLCciRW5jb2RpbmciJywnIiInKQ0KCQkJCQkJI3dyaXRlKGxvZyxbJ0luZGljZTonLCdtb2RlOicsbW9kZSx0eXBlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nLCdtYWdpYzonLG1hZ2ljXSxuKQ0KCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpK29zLnNlcCsibW9kZWxfZmlsZS5iaW4iDQoJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6cGF0aD1vcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpK29zLnNlcCsibW9kZWxfZmlsZS5iaW4iDQoJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6cGF0aD1vcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpK29zLnNlcCt2YWx1ZXNbJyJGaWxlIiddLnNwbGl0KCciJylbMV0jKycudHh0Jw0KCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWU6DQoJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCW1hZ2ljLGluZGljZUxpc3Q9Z2V0SW5kaWNlcyhJdGVtU2l6ZSxTaXplLE9mZnNldCx0eXBlLGcsbW9kZSxtYWdpYykNCgkJCQkJCQlpbmRpY2VBcnJheS5hcHBlbmQoW2luZGljZUxpc3QsbW9kZV0pDQoJCQkJCQkJZmlsZS5jbG9zZSgpDQoJCQkjZWxzZToNCgkJCSMJcHJpbnQgJ0xJTkVTJw0KCQkJCQ0KCXJldHVybiBpbmRpY2VBcnJheQ0KCQ0KCQ0KCQkJDQpkZWYgQm9uZXMoeXMsYik6DQoJbj0yMA0KCWJvbmVzPVtdDQoJdmFsdWVzPXlzLnZhbHVlcyhiLmRhdGEsJzonKQ0KCUl0ZW1TaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIkl0ZW1TaXplIicsJ2knKQ0KCVVpbnQxNkFycmF5PXlzLmdldChiLCciVWludDE2QXJyYXkiJykNCglpZiBVaW50MTZBcnJheToNCgkJdHlwZT0iVWludDE2QXJyYXkiDQoJCXZhbHVlcz15cy52YWx1ZXMoVWludDE2QXJyYXlbMF0uZGF0YSwnOicpDQoJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInLCciIicpDQoJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInLCdpJykNCgkJRW5jb2Rpbmc9eXMuZ2V0VmFsdWUodmFsdWVzLCciRW5jb2RpbmciJywnIiInKQ0KCQkNCgkJaWYgRW5jb2Rpbmc9PSd2YXJpbnQnOgkJCQkJCQ0KCQkJcGF0aD1nZXRQYXRoKEZpbGUpDQoJCQlpZiBwYXRoOg0KCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQlsaXN0PWRlY29kZVZhcmludChnLE9mZnNldCxTaXplKkl0ZW1TaXplLHR5cGUpDQoJCQkJZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQoJCQkJCWJvbmVzLmFwcGVuZChsaXN0W20qSXRlbVNpemU6bSpJdGVtU2l6ZStJdGVtU2l6ZV0pDQoJCQkJZmlsZS5jbG9zZSgpDQoJcmV0dXJuIGJvbmVzCQkNCgkJCQ0KZGVmIFdlaWdodHMoeXMsYik6DQoJbj0yMA0KCXdlaWdodHM9W10NCgl2YWx1ZXM9eXMudmFsdWVzKGIuZGF0YSwnOicpDQoJSXRlbVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJywnaScpDQoJRmxvYXQzMkFycmF5PXlzLmdldChiLCciRmxvYXQzMkFycmF5IicpDQoJaWYgRmxvYXQzMkFycmF5Og0KCQl2YWx1ZXM9eXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCc6JykNCgkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicsJyIiJykNCgkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicsJ2knKQ0KCQlPZmZzZXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicsJ2knKQ0KCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInLCciIicpDQoJCQ0KCQlpZiBFbmNvZGluZz09J3ZhcmludCc6CQkJCQkNCgkJCXBhdGg9Z2V0UGF0aChGaWxlKQ0KCQkJaWYgcGF0aDoNCgkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJbGlzdD1kZWNvZGVWYXJpbnQoZyxPZmZzZXQsU2l6ZSpJdGVtU2l6ZSx0eXBlKQ0KCQkJCWZpbGUuY2xvc2UoKQ0KCQllbHNlOgkJCQkJDQoJCQlwYXRoPWdldFBhdGgoRmlsZSkNCgkJCWlmIHBhdGg6DQoJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCWcuc2VlayhPZmZzZXQpDQoJCQkJbGlzdD1nLmYoU2l6ZSpJdGVtU2l6ZSkNCgkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJd2VpZ2h0cy5hcHBlbmQobGlzdFttKkl0ZW1TaXplOm0qSXRlbVNpemUrSXRlbVNpemVdKQ0KCQkJCWZpbGUuY2xvc2UoKQ0KCXJldHVybiB3ZWlnaHRzCQ0KCQ0KZGVmIEJvbmVNYXAoeXMsYik6CQ0KCUJvbmVNYXA9e30NCgl2YWx1ZXM9eXMudmFsdWVzKGIuZGF0YSwnOicpDQoJZm9yIHZhbHVlIGluIHZhbHVlczoNCgkJaWQ9eXMuZ2V0VmFsdWUodmFsdWVzLHZhbHVlLCdpJykNCgkJbmFtZT12YWx1ZS5yZXBsYWNlKCciJywgJycpDQoJCUJvbmVNYXBbbmFtZV09aWQNCglyZXR1cm4gQm9uZU1hcAkNCgkJDQoJCQ0KZGVmIG9zZ0FuaW1hdGlvblJpZ0dlb21ldHJ5KHlzLHBhcmVudE5ld05vZGUpOg0KDQoJbWVzaD1NZXNoKCkNCgltZXNoLnZlcnRleEFycmF5PVtdDQoJbWVzaC5pbmRpY2VBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQwQXJyYXk9W10NCgltZXNoLlRleENvb3JkMUFycmF5PVtdDQoJbWVzaC5UZXhDb29yZDNBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQ1QXJyYXk9W10NCgltZXNoLlRleENvb3JkNkFycmF5PVtdDQoJbWVzaC5jb2xvckFycmF5PVtdDQoJbWVzaC5ub3JtYWxBcnJheT1bXQ0KCW1lc2gubW9ycGhBcnJheT17fQ0KCW1lc2guQm9uZXM9W10NCgltZXNoLldlaWdodHM9W10NCgltZXNoLkJvbmVNYXA9e30NCgltZXNoLmF0cmlidXRlcz17fQ0KCW1lc2gucGFyZW50Tm9kZT1wYXJlbnROZXdOb2RlLm5vZGUNCglmb3IgY2hpbGQgaW4gcGFyZW50TmV3Tm9kZS5jaGlsZHJlbjoNCgkJI3dyaXRlKGxvZyxbY2hpbGQubm9kZS5oZWFkZXJdLDQpDQoJCWlmICciU291cmNlR2VvbWV0cnkiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQkjd3JpdGUobG9nLFtjaGlsZC5ub2RlLmhlYWRlcl0sOCkNCgkJCQlpZiAnIm9zZ0FuaW1hdGlvbi5Nb3JwaEdlb21ldHJ5IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQkJCSN3cml0ZShsb2csW2NoaWxkLm5vZGUuaGVhZGVyXSwxMikNCgkJCQkJCWlmICciVmVydGV4QXR0cmlidXRlTGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQkJCQkJaWYgJyJWZXJ0ZXgiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2gudmVydGV4QXJyYXk9VmVydGV4KHlzLGNoaWxkLm5vZGUpDQoJCQkJCQkJCQlwcmludCAiVHJpYW5nbGVzOiAiICsgc3RyKGxlbihtZXNoLnZlcnRleEFycmF5KSkNCgkJCQkJCQkJCXN5czIuc3Rkb3V0LmZsdXNoKCkNCgkJCQkJCQkJaWYgJyJOb3JtYWwiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2gubm9ybWFsQXJyYXk9VmVydGV4Tm9ybWFsKHlzLGNoaWxkLm5vZGUpDQoJCQkJCQkJCWlmICciVGV4Q29vcmQwIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQltZXNoLlRleENvb3JkMEFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJCQkJCWlmICciVGV4Q29vcmQxIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQltZXNoLlRleENvb3JkMUFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJCQkJCWlmICciVGV4Q29vcmQzIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQltZXNoLlRleENvb3JkM0FycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJCQkJCWlmICciVGV4Q29vcmQ1IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQltZXNoLlRleENvb3JkNUFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJCQkJCWlmICciVGV4Q29vcmQ2IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQltZXNoLlRleENvb3JkNkFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJCQkJCWlmICciQ29sb3IiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2guY29sb3JBcnJheT1Db2xvcih5cyxjaGlsZC5ub2RlKQ0KCQkJCQkJaWYgJyJQcmltaXRpdmVTZXRMaXN0IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJbWVzaC5pbmRpY2VBcnJheT1QcmltaXRpdmVTZXRMaXN0KHlzLGNoaWxkKQ0KCQkJCQkJaWYgJyJVc2VyRGF0YUNvbnRhaW5lciInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCW1lc2guYXRyaWJ1dGVzPVVzZXJEYXRhQ29udGFpbmVyKHlzLGNoaWxkKQ0KCQkJCQkJaWYgJyJNb3JwaFRhcmdldHMiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQlwcmludCAiTW9ycGhUYXJnZXRzIg0KCQkJCQkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQkJCQkJI3dyaXRlKGxvZyxbY2hpbGQubm9kZS5oZWFkZXJdLDE2KQ0KCQkJCQkJCQlpZiAnIm9zZy5HZW9tZXRyeSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJTmFtZT1Ob25lDQoJCQkJCQkJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJCQkJCQkJI3dyaXRlKGxvZyxbY2hpbGQubm9kZS5oZWFkZXJdLDIwKQkJCQkJCQkJCQkNCgkJCQkJCQkJCQlpZiAnIlZlcnRleEF0dHJpYnV0ZUxpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCQkJCQkJCQkJaWYgJyJWZXJ0ZXgiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCQkJCQlpZiBOYW1lOg0KCQkJCQkJCQkJCQkJCQltZXNoLm1vcnBoQXJyYXlbTmFtZV09VmVydGV4KHlzLGNoaWxkLm5vZGUpCQkJCQkJCQkJCQ0KCQkJCQkJCQkJCWlmICciVW5pcXVlSUQiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5ub2RlLmhlYWRlciwnOicpDQoJCQkJCQkJCQkJCVVuaXF1ZUlEPXlzLmdldFZhbHVlKHZhbHVlcywnIlVuaXF1ZUlEIicsJ2knKQ0KCQkJCQkJCQkJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJywnIiInKQ0KCQkJCQkJCQkJCQkjd3JpdGUobG9nLFtVbmlxdWVJRCxOYW1lXSwyNCkNCgkJCQlpZiAnIm9zZy5HZW9tZXRyeSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJCQlpZiAnIlZlcnRleEF0dHJpYnV0ZUxpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJCQkJCWlmICciVmVydGV4IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQltZXNoLnZlcnRleEFycmF5PVZlcnRleCh5cyxjaGlsZC5ub2RlKQ0KCQkJCQkJCQkJcHJpbnQgIlRyaWFuZ2xlczogIiArIHN0cihsZW4obWVzaC52ZXJ0ZXhBcnJheSkpDQoJCQkJCQkJCQlzeXMyLnN0ZG91dC5mbHVzaCgpDQoJCQkJCQkJCWlmICciTm9ybWFsIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQltZXNoLm5vcm1hbEFycmF5PVZlcnRleE5vcm1hbCh5cyxjaGlsZC5ub2RlKQ0KCQkJCQkJCQlpZiAnIlRleENvb3JkMCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJbWVzaC5UZXhDb29yZDBBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCQkJCQlpZiAnIlRleENvb3JkMSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJbWVzaC5UZXhDb29yZDFBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCQkJCQlpZiAnIlRleENvb3JkMyInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJbWVzaC5UZXhDb29yZDNBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCQkJCQlpZiAnIlRleENvb3JkNSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJbWVzaC5UZXhDb29yZDVBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCQkJCQlpZiAnIlRleENvb3JkNiInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJbWVzaC5UZXhDb29yZDZBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCQkJCQlpZiAnIkNvbG9yIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQltZXNoLmNvbG9yQXJyYXk9Q29sb3IoeXMsY2hpbGQubm9kZSkNCgkJCQkJCWlmICciUHJpbWl0aXZlU2V0TGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCW1lc2guaW5kaWNlQXJyYXk9UHJpbWl0aXZlU2V0TGlzdCh5cyxjaGlsZCkNCgkJCQkJCWlmICciVXNlckRhdGFDb250YWluZXIiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQltZXNoLmF0cmlidXRlcz1Vc2VyRGF0YUNvbnRhaW5lcih5cyxjaGlsZCkNCgkJCQkJCQkJDQoJCQkJCQkJCQ0KCQlpZiAnIlZlcnRleEF0dHJpYnV0ZUxpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQlpZiAnIkJvbmVzIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2guQm9uZXM9Qm9uZXMoeXMsY2hpbGQubm9kZSkNCgkJCQlpZiAnIldlaWdodHMiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5XZWlnaHRzPVdlaWdodHMoeXMsY2hpbGQubm9kZSkNCgkJaWYgJyJCb25lTWFwIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQltZXNoLkJvbmVNYXA9Qm9uZU1hcCh5cyxjaGlsZC5ub2RlKQ0KCQkJCQ0KCXJldHVybiBtZXNoCQ0KCQ0KZGVmIG9zZ0dlb21ldHJ5KHlzLHBhcmVudE5ld05vZGUpOg0KDQoJbWVzaD1NZXNoKCkNCgltZXNoLnZlcnRleEFycmF5PVtdDQoJbWVzaC5pbmRpY2VBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQwQXJyYXk9W10NCgltZXNoLlRleENvb3JkMUFycmF5PVtdDQoJbWVzaC5UZXhDb29yZDNBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQ1QXJyYXk9W10NCgltZXNoLlRleENvb3JkNkFycmF5PVtdDQoJbWVzaC5jb2xvckFycmF5PVtdDQoJbWVzaC5ub3JtYWxBcnJheT1bXQ0KCW1lc2gubW9ycGhBcnJheT17fQ0KCW1lc2guQm9uZXM9W10NCgltZXNoLldlaWdodHM9W10NCgltZXNoLkJvbmVNYXA9e30NCgltZXNoLmF0cmlidXRlcz17fQ0KCW1lc2gucGFyZW50Tm9kZT1wYXJlbnROZXdOb2RlLm5vZGUNCglmb3IgY2hpbGQgaW4gcGFyZW50TmV3Tm9kZS5jaGlsZHJlbjoNCgkJI3dyaXRlKGxvZyxbY2hpbGQubm9kZS5oZWFkZXJdLDQpDQoJCWlmICciVmVydGV4QXR0cmlidXRlTGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCSN3cml0ZShsb2csW2NoaWxkLm5vZGUuaGVhZGVyXSw4KQ0KCQkJCWlmICciVmVydGV4IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2gudmVydGV4QXJyYXk9VmVydGV4KHlzLGNoaWxkLm5vZGUpDQoJCQkJCXByaW50ICJUcmlhbmdsZXM6ICIgKyBzdHIobGVuKG1lc2gudmVydGV4QXJyYXkpKQ0KCQkJCQlzeXMyLnN0ZG91dC5mbHVzaCgpDQoJCQkJaWYgJyJOb3JtYWwiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5ub3JtYWxBcnJheT1WZXJ0ZXhOb3JtYWwoeXMsY2hpbGQubm9kZSkNCgkJCQlpZiAnIlRleENvb3JkMCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLlRleENvb3JkMEFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJaWYgJyJUZXhDb29yZDEiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5UZXhDb29yZDFBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCWlmICciVGV4Q29vcmQzIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2guVGV4Q29vcmQzQXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQlpZiAnIlRleENvb3JkNSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLlRleENvb3JkNUFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJaWYgJyJUZXhDb29yZDYiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5UZXhDb29yZDZBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCWlmICciQ29sb3IiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5jb2xvckFycmF5PUNvbG9yKHlzLGNoaWxkLm5vZGUpDQoJCWlmICciUHJpbWl0aXZlU2V0TGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJbWVzaC5pbmRpY2VBcnJheT1QcmltaXRpdmVTZXRMaXN0KHlzLGNoaWxkKQ0KCQlpZiAnIlVzZXJEYXRhQ29udGFpbmVyIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQltZXNoLmF0cmlidXRlcz1Vc2VyRGF0YUNvbnRhaW5lcih5cyxjaGlsZCkNCglyZXR1cm4gbWVzaAkJDQoJDQoJDQpkZWYgb3NnQW5pbWF0aW9uTW9ycGhHZW9tZXRyeSh5cyxwYXJlbnROZXdOb2RlKToNCg0KCW1lc2g9TWVzaCgpDQoJbWVzaC52ZXJ0ZXhBcnJheT1bXQ0KCW1lc2guaW5kaWNlQXJyYXk9W10NCgltZXNoLlRleENvb3JkMEFycmF5PVtdDQoJbWVzaC5UZXhDb29yZDFBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQzQXJyYXk9W10NCgltZXNoLlRleENvb3JkNUFycmF5PVtdDQoJbWVzaC5UZXhDb29yZDZBcnJheT1bXQ0KCW1lc2guY29sb3JBcnJheT1bXQ0KCW1lc2gubm9ybWFsQXJyYXk9W10NCgltZXNoLm1vcnBoQXJyYXk9e30NCgltZXNoLkJvbmVzPVtdDQoJbWVzaC5XZWlnaHRzPVtdDQoJbWVzaC5Cb25lTWFwPXt9DQoJbWVzaC5hdHJpYnV0ZXM9e30NCgltZXNoLnBhcmVudE5vZGU9cGFyZW50TmV3Tm9kZS5ub2RlDQoJZm9yIGNoaWxkIGluIHBhcmVudE5ld05vZGUuY2hpbGRyZW46DQoJCWlmICciTW9ycGhUYXJnZXRzIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQlwcmludCAiTW9ycGhUYXJnZXRzIg0KCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCSN3cml0ZShsb2csW2NoaWxkLm5vZGUuaGVhZGVyXSwxNikNCgkJCQlpZiAnIm9zZy5HZW9tZXRyeSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQlOYW1lPU5vbmUNCgkJCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCQkJI3dyaXRlKGxvZyxbY2hpbGQubm9kZS5oZWFkZXJdLDIwKQkJCQkJCQkJCQkNCgkJCQkJCWlmICciVmVydGV4QXR0cmlidXRlTGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQkJCQkJaWYgJyJWZXJ0ZXgiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCWlmIE5hbWU6DQoJCQkJCQkJCQkJbWVzaC5tb3JwaEFycmF5W05hbWVdPVZlcnRleCh5cyxjaGlsZC5ub2RlKQkJCQkJCQkJCQkNCgkJCQkJCWlmICciVW5pcXVlSUQiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGNoaWxkLm5vZGUuaGVhZGVyLCc6JykNCgkJCQkJCQlVbmlxdWVJRD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJVbmlxdWVJRCInLCdpJykNCgkJCQkJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJywnIiInKQ0KCQkJCQkJCSN3cml0ZShsb2csW1VuaXF1ZUlELE5hbWVdLDI0KQ0KCQlpZiAnIlZlcnRleEF0dHJpYnV0ZUxpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQkjcHJpbnQgY2hpbGQubm9kZS5oZWFkZXINCgkJCQlpZiAnIlZlcnRleCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLnZlcnRleEFycmF5PVZlcnRleCh5cyxjaGlsZC5ub2RlKQ0KCQkJCQlwcmludCAiVHJpYW5nbGVzOiAiICsgc3RyKGxlbihtZXNoLnZlcnRleEFycmF5KSkNCgkJCQkJc3lzMi5zdGRvdXQuZmx1c2goKQ0KCQkJCWlmICciTm9ybWFsIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2gubm9ybWFsQXJyYXk9VmVydGV4Tm9ybWFsKHlzLGNoaWxkLm5vZGUpDQoJCQkJaWYgJyJUZXhDb29yZDAiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5UZXhDb29yZDBBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCWlmICciVGV4Q29vcmQxIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2guVGV4Q29vcmQxQXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQlpZiAnIlRleENvb3JkMyInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLlRleENvb3JkM0FycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJaWYgJyJUZXhDb29yZDUiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5UZXhDb29yZDVBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCWlmICciVGV4Q29vcmQ2IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2guVGV4Q29vcmQ2QXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQlpZiAnIkNvbG9yIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2guY29sb3JBcnJheT1Db2xvcih5cyxjaGlsZC5ub2RlKQ0KCQlpZiAnIlByaW1pdGl2ZVNldExpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCW1lc2guaW5kaWNlQXJyYXk9UHJpbWl0aXZlU2V0TGlzdCh5cyxjaGlsZCkNCgkJaWYgJyJVc2VyRGF0YUNvbnRhaW5lciInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJbWVzaC5hdHJpYnV0ZXM9VXNlckRhdGFDb250YWluZXIoeXMsY2hpbGQpDQoJCQkJCQkJCQ0KCQkJCQkJDQoJCQkJDQoJcmV0dXJuIG1lc2gJDQoJCQ0KCQkNCmRlZiBkcmF3TWVzaCh5cyxtZXNoKToJDQoJZGlmZnVzZT1Ob25lCQkNCglub3JtYWw9Tm9uZQkNCglzcGVjdWxhcj1Ob25lDQoJdHJhbnM9Tm9uZQkNCglhbz1Ob25lDQoJcmdiQ29sPU5vbmUNCglyZ2JTcGVjPU5vbmUNCglyZ2JhPU5vbmUJDQoJbW9kZT1Ob25lCQ0KDQoNCg0KCW1hdE5hbWUsZGlmZnVzZSxzcGVjdWxhcixub3JtYWwsYW8sdHJhbnMscmdiQ29sLHJnYlNwZWMscmdiYT1nZXRNYXROYW1lKHlzLG1lc2gucGFyZW50Tm9kZSkNCgkjcHJpbnQgJ21hdE5hbWU6JyxtYXROYW1lLGRpZmZ1c2UNCgl0cnk6DQoJCWlmIGxlbihtZXNoLm5vcm1hbEFycmF5KSA9PSAxOg0KCQkJaWYgbWVzaC5ub3JtYWxBcnJheVswXVsxXSA9PSAnInZhcmludCInOg0KCQkJCWJ5dGVzID0gbWVzaC5ub3JtYWxBcnJheVswXVswXQ0KCQkJCUl0ZW1TaXplID0gbWVzaC5ub3JtYWxBcnJheVswXVsyXQ0KCQkJCWVwcyA9IGZsb2F0KG1lc2guYXRyaWJ1dGVzWyJlcHNpbG9uIl0pDQoJCQkJbnBoaSA9IGZsb2F0KG1lc2guYXRyaWJ1dGVzWyJucGhpIl0pDQoJCQkJc2l6ZSA9IGxlbihieXRlcykgLyBJdGVtU2l6ZQ0KCQkJCWludHMgPSBieXRlcw0KCQkJCWdsb2JhbCBtb2RlbElEDQoJCQkJDQoJCQkJaWYgb3MucGF0aC5leGlzdHMoIm1vZGVsRGF0YS5qcyIpOg0KCQkJCQlvcy5yZW1vdmUoIm1vZGVsRGF0YS5qcyIpDQoJCQkJaWYgb3MucGF0aC5leGlzdHMoIm5vcm1hbHMuZGF0Iik6DQoJCQkJCW9zLnJlbW92ZSgibm9ybWFscy5kYXQiKQ0KCQkJCXdpdGggb3BlbigibW9kZWxEYXRhLmpzIiwgImEiKSBhcyBtb2RlbERhdGE6DQoJCQkJCW1vZGVsSUQgKz0gMQ0KCQkJCQltb2RlbERhdGEud3JpdGUoIm1vZHVsZS5leHBvcnRzLmVwcyA9ICIgKyBzdHIoZXBzKSArICI7XG4iKQ0KCQkJCQltb2RlbERhdGEud3JpdGUoIm1vZHVsZS5leHBvcnRzLm5waGkgPSAiICsgc3RyKG5waGkpICsgIjtcbiIpDQoJCQkJCW1vZGVsRGF0YS53cml0ZSgibW9kdWxlLmV4cG9ydHMuc2l6ZSA9ICIgKyBzdHIoc2l6ZSkgKyAiO1xuIikNCgkJCQkJbW9kZWxEYXRhLndyaXRlKCJtb2R1bGUuZXhwb3J0cy5pZCA9ICIgKyBzdHIobW9kZWxJRCkgKyAiO1xuIikNCgkJCQkJbW9kZWxEYXRhLndyaXRlKCJtb2R1bGUuZXhwb3J0cy5pbnRzID0gIiArIHN0cihieXRlcykgKyAiO1xuIikNCgkJCQkNCgkJCQlzdWJwcm9jZXNzLmNhbGwoKCdub2RlLmV4ZSAuL3t0ZW1wUGF0aH0vY2FsY1ZlcnRleE5vcm1hbHMuanMnKSkNCglleGNlcHQ6DQoJCXBhc3MNCglpZiBsZW4obWVzaC5pbmRpY2VBcnJheSk+MDoNCgkJZm9yIFtpbmRpY2VzLG1vZGVdIGluIG1lc2guaW5kaWNlQXJyYXk6DQoJCQltYXQ9TWF0KCkNCgkJCW1hdC5tYXROYW1lPW1hdE5hbWUNCgkJCW1hdC5yZ2JDb2w9cmdiQ29sDQoJCQltYXQuZGlmZnVzZT1kaWZmdXNlDQoJCQltYXQubm9ybWFsPW5vcm1hbA0KCQkJbWF0LnNwZWN1bGFyPXNwZWN1bGFyDQoJCQltYXQudHJhbnM9dHJhbnMNCgkJCWlmIHRyYW5zOg0KCQkJCW1hdC5aVFJBTlM9VHJ1ZQ0KCQkJI21hdC5hbz1hbw0KCQkJaWYgcmdiYTptYXQucmdiYT1yZ2JhDQoJCQltZXNoLm1hdExpc3QuYXBwZW5kKG1hdCkNCgkJCW1hdC5JRFN0YXJ0PWxlbihtZXNoLmluZGljZUxpc3QpDQoJCQltYXQuSURDb3VudD1sZW4oaW5kaWNlcykNCgkJCW1lc2guaW5kaWNlTGlzdC5leHRlbmQoaW5kaWNlcykNCgkJCWlmIG1vZGU9PSciVFJJQU5HTEVfU1RSSVAiJzptYXQuVFJJU1RSSVA9VHJ1ZQ0KCQkJaWYgbW9kZT09JyJUUklBTkdMRVMiJzptYXQuVFJJQU5HTEU9VHJ1ZQ0KCQkJDQoJCWluZGljZXM9bWVzaC5pbmRpY2VBcnJheVswXVswXQ0KCQltb2RlPW1lc2guaW5kaWNlQXJyYXlbMF1bMV0JCQ0KCWlmIGxlbihtZXNoLnZlcnRleEFycmF5KT09MToNCgkJaWYgbWVzaC52ZXJ0ZXhBcnJheVswXVsxXT09JyJ2YXJpbnQiJzoNCgkJCWlmIG1vZGU6DQoJCQkJYnl0ZXM9bWVzaC52ZXJ0ZXhBcnJheVswXVswXQkJCQkNCgkJCQlJdGVtU2l6ZT1tZXNoLnZlcnRleEFycmF5WzBdWzJdDQoJCQkJaWYgbW9kZT09JyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcz1kZWNvZGVQcmVkaWN0KGluZGljZXMsYnl0ZXMsSXRlbVNpemUpDQoJCQkJczE9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3Z0eF9iYmxfeCddKQ0KCQkJCXMyPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd2dHhfYmJsX3knXSkNCgkJCQlzMz1mbG9hdChtZXNoLmF0cmlidXRlc1sndnR4X2JibF96J10pDQoJCQkJcz1bczEsczIsczNdCQkJDQoJCQkJYTE9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3Z0eF9oX3gnXSkNCgkJCQlhMj1mbG9hdChtZXNoLmF0cmlidXRlc1sndnR4X2hfeSddKQ0KCQkJCWEzPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd2dHhfaF96J10pDQoJCQkJYT1bYTEsYTIsYTNdDQoJCQkJZmxvYXRzPWRlY29kZVF1YW50aXplKGJ5dGVzLHMsYSxJdGVtU2l6ZSkNCgkJCQltZXNoLnZlcnRQb3NMaXN0PVtmbG9hdHNbbTptK0l0ZW1TaXplXWZvciBtIGluIHJhbmdlKDAsbGVuKGZsb2F0cyksMyldDQoJCQkJI3ByaW50IG1lc2gudmVydFBvc0xpc3QNCgkJCQkjbWVzaC5pbmRpDQoJCQkJI21lc2guZHJhdygpDQoJCWVsc2U6DQoJCQlsaXN0PW1lc2gudmVydGV4QXJyYXlbMF1bMF0NCgkJCW1lc2gudmVydFBvc0xpc3Q9bGlzdA0KCQkJDQoJaWYgbGVuKG1lc2guVGV4Q29vcmQwQXJyYXkpPT0xOg0KCQlpZiBtZXNoLlRleENvb3JkMEFycmF5WzBdWzFdPT0nInZhcmludCInOg0KCQkJaWYgbW9kZToNCgkJCQlieXRlcz1tZXNoLlRleENvb3JkMEFycmF5WzBdWzBdCQkJCQ0KCQkJCUl0ZW1TaXplPW1lc2guVGV4Q29vcmQwQXJyYXlbMF1bMl0NCgkJCQlpZiBtb2RlPT0nIlRSSUFOR0xFX1NUUklQIic6DQoJCQkJCWJ5dGVzPWRlY29kZVByZWRpY3QoaW5kaWNlcyxieXRlcyxJdGVtU2l6ZSkNCgkJCQlzMT1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfMF9iYmxfeCddKQ0KCQkJCXMyPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8wX2JibF95J10pDQoJCQkJcz1bczEsczJdCQkJDQoJCQkJYTE9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzBfaF94J10pDQoJCQkJYTI9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzBfaF95J10pDQoJCQkJYT1bYTEsYTJdDQoJCQkJZmxvYXRzPWRlY29kZVF1YW50aXplKGJ5dGVzLHMsYSxJdGVtU2l6ZSkNCgkJCQlmb3IgbSBpbiByYW5nZSgwLGxlbihmbG9hdHMpLEl0ZW1TaXplKToNCgkJCQkJdSx2PWZsb2F0c1ttOm0rSXRlbVNpemVdDQoJCQkJCW1lc2gudmVydFVWTGlzdC5hcHBlbmQoW3UsMS12XSkNCgkJZWxzZToNCgkJCWxpc3Q9bWVzaC5UZXhDb29yZDBBcnJheVswXVswXQ0KCQkJbWVzaC52ZXJ0VVZMaXN0PWxpc3QNCgllbGlmIGxlbihtZXNoLlRleENvb3JkMUFycmF5KT09MToNCgkJaWYgbWVzaC5UZXhDb29yZDFBcnJheVswXVsxXT09JyJ2YXJpbnQiJzoNCgkJCWlmIG1vZGU6DQoJCQkJYnl0ZXM9bWVzaC5UZXhDb29yZDFBcnJheVswXVswXQkJCQkNCgkJCQlJdGVtU2l6ZT1tZXNoLlRleENvb3JkMUFycmF5WzBdWzJdDQoJCQkJaWYgbW9kZT09JyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcz1kZWNvZGVQcmVkaWN0KGluZGljZXMsYnl0ZXMsSXRlbVNpemUpDQoJCQkJczE9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzFfYmJsX3gnXSkNCgkJCQlzMj1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfMV9iYmxfeSddKQ0KCQkJCXM9W3MxLHMyXQkJCQ0KCQkJCWExPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8xX2hfeCddKQ0KCQkJCWEyPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8xX2hfeSddKQ0KCQkJCWE9W2ExLGEyXQ0KCQkJCWZsb2F0cz1kZWNvZGVRdWFudGl6ZShieXRlcyxzLGEsSXRlbVNpemUpDQoJCQkJZm9yIG0gaW4gcmFuZ2UoMCxsZW4oZmxvYXRzKSxJdGVtU2l6ZSk6DQoJCQkJCXUsdj1mbG9hdHNbbTptK0l0ZW1TaXplXQ0KCQkJCQltZXNoLnZlcnRVVkxpc3QuYXBwZW5kKFt1LDEtdl0pDQoJCWVsc2U6DQoJCQlsaXN0PW1lc2guVGV4Q29vcmQxQXJyYXlbMF1bMF0NCgkJCW1lc2gudmVydFVWTGlzdD1saXN0DQoJZWxpZiBsZW4obWVzaC5UZXhDb29yZDNBcnJheSk9PTE6DQoJCWlmIG1lc2guVGV4Q29vcmQzQXJyYXlbMF1bMV09PScidmFyaW50Iic6DQoJCQlpZiBtb2RlOg0KCQkJCWJ5dGVzPW1lc2guVGV4Q29vcmQzQXJyYXlbMF1bMF0JCQkJDQoJCQkJSXRlbVNpemU9bWVzaC5UZXhDb29yZDNBcnJheVswXVsyXQ0KCQkJCWlmIG1vZGU9PSciVFJJQU5HTEVfU1RSSVAiJzoNCgkJCQkJYnl0ZXM9ZGVjb2RlUHJlZGljdChpbmRpY2VzLGJ5dGVzLEl0ZW1TaXplKQ0KCQkJCXMxPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8zX2JibF94J10pDQoJCQkJczI9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzNfYmJsX3knXSkNCgkJCQlzPVtzMSxzMl0JCQkNCgkJCQlhMT1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfM19oX3gnXSkNCgkJCQlhMj1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfM19oX3knXSkNCgkJCQlhPVthMSxhMl0NCgkJCQlmbG9hdHM9ZGVjb2RlUXVhbnRpemUoYnl0ZXMscyxhLEl0ZW1TaXplKQ0KCQkJCWZvciBtIGluIHJhbmdlKDAsbGVuKGZsb2F0cyksSXRlbVNpemUpOg0KCQkJCQl1LHY9ZmxvYXRzW206bStJdGVtU2l6ZV0NCgkJCQkJbWVzaC52ZXJ0VVZMaXN0LmFwcGVuZChbdSwxLXZdKQ0KCQllbHNlOg0KCQkJbGlzdD1tZXNoLlRleENvb3JkM0FycmF5WzBdWzBdDQoJCQltZXNoLnZlcnRVVkxpc3Q9bGlzdA0KCWVsaWYgbGVuKG1lc2guVGV4Q29vcmQ1QXJyYXkpPT0xOg0KCQlpZiBtZXNoLlRleENvb3JkNUFycmF5WzBdWzFdPT0nInZhcmludCInOg0KCQkJaWYgbW9kZToNCgkJCQlieXRlcz1tZXNoLlRleENvb3JkNUFycmF5WzBdWzBdCQkJCQ0KCQkJCUl0ZW1TaXplPW1lc2guVGV4Q29vcmQ1QXJyYXlbMF1bMl0NCgkJCQlpZiBtb2RlPT0nIlRSSUFOR0xFX1NUUklQIic6DQoJCQkJCWJ5dGVzPWRlY29kZVByZWRpY3QoaW5kaWNlcyxieXRlcyxJdGVtU2l6ZSkNCgkJCQlzMT1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfNV9iYmxfeCddKQ0KCQkJCXMyPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl81X2JibF95J10pDQoJCQkJcz1bczEsczJdCQkJDQoJCQkJYTE9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzVfaF94J10pDQoJCQkJYTI9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzVfaF95J10pDQoJCQkJYT1bYTEsYTJdDQoJCQkJZmxvYXRzPWRlY29kZVF1YW50aXplKGJ5dGVzLHMsYSxJdGVtU2l6ZSkNCgkJCQlmb3IgbSBpbiByYW5nZSgwLGxlbihmbG9hdHMpLEl0ZW1TaXplKToNCgkJCQkJdSx2PWZsb2F0c1ttOm0rSXRlbVNpemVdDQoJCQkJCW1lc2gudmVydFVWTGlzdC5hcHBlbmQoW3UsMS12XSkNCgkJZWxzZToNCgkJCWxpc3Q9bWVzaC5UZXhDb29yZDVBcnJheVswXVswXQ0KCQkJbWVzaC52ZXJ0VVZMaXN0PWxpc3QNCgllbGlmIGxlbihtZXNoLlRleENvb3JkNkFycmF5KT09MToNCgkJaWYgbWVzaC5UZXhDb29yZDZBcnJheVswXVsxXT09JyJ2YXJpbnQiJzoNCgkJCWlmIG1vZGU6DQoJCQkJYnl0ZXM9bWVzaC5UZXhDb29yZDZBcnJheVswXVswXQkJCQkNCgkJCQlJdGVtU2l6ZT1tZXNoLlRleENvb3JkNkFycmF5WzBdWzJdDQoJCQkJaWYgbW9kZT09JyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcz1kZWNvZGVQcmVkaWN0KGluZGljZXMsYnl0ZXMsSXRlbVNpemUpDQoJCQkJczE9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzZfYmJsX3gnXSkNCgkJCQlzMj1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfNl9iYmxfeSddKQ0KCQkJCXM9W3MxLHMyXQkJCQ0KCQkJCWExPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl82X2hfeCddKQ0KCQkJCWEyPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl82X2hfeSddKQ0KCQkJCWE9W2ExLGEyXQ0KCQkJCWZsb2F0cz1kZWNvZGVRdWFudGl6ZShieXRlcyxzLGEsSXRlbVNpemUpDQoJCQkJZm9yIG0gaW4gcmFuZ2UoMCxsZW4oZmxvYXRzKSxJdGVtU2l6ZSk6DQoJCQkJCXUsdj1mbG9hdHNbbTptK0l0ZW1TaXplXQ0KCQkJCQltZXNoLnZlcnRVVkxpc3QuYXBwZW5kKFt1LDEtdl0pDQoJCWVsc2U6DQoJCQlsaXN0PW1lc2guVGV4Q29vcmQ2QXJyYXlbMF1bMF0NCgkJCW1lc2gudmVydFVWTGlzdD1saXN0DQoJaWYgbGVuKG1lc2guY29sb3JBcnJheSk+MDoNCgkJbWVzaC52ZXJ0Q29sTGlzdD1tZXNoLmNvbG9yQXJyYXkNCgkJDQoJCQ0KCQkNCg0KZGVmIFVzZXJEYXRhQ29udGFpbmVyKHlzLGIpOg0KCWF0cmlidXRlcz17fQ0KCVZhbHVlcz15cy5nZXQoYi5ub2RlLCciVmFsdWVzIicpDQoJaWYgVmFsdWVzOg0KCQlmb3IgYSBpbiBWYWx1ZXNbMF0uY2hpbGRyZW46DQoJCQl2YWx1ZXM9eXMudmFsdWVzKGEuZGF0YSwnOicpDQoJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJywnIiInKQ0KCQkJVmFsdWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciVmFsdWUiJywnIiInKQ0KCQkJI2lmIE5hbWU6d3JpdGUobG9nLFtOYW1lLFZhbHVlXSxuKzQpDQoJCQlpZiBOYW1lOmF0cmlidXRlc1tOYW1lXT1WYWx1ZQkNCglyZXR1cm4gYXRyaWJ1dGVzCQkJDQoJCQ0KZGVmIG9zZ05vZGUoeXMscGFyZW50TmV3Tm9kZSxwYXJlbnRCb25lKToNCglmb3IgY2hpbGQgaW4gcGFyZW50TmV3Tm9kZS5jaGlsZHJlbjoNCgkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJaWYgJyJvc2cuR2VvbWV0cnkiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQltZXNoPW9zZ0dlb21ldHJ5KHlzLGNoaWxkKQ0KCQkJCW1lc2gucGFyZW50Qm9uZT1wYXJlbnRCb25lDQoJCQkJbW9kZWwubWVzaExpc3QuYXBwZW5kKG1lc2gpDQoJCQlpZiAnIm9zZ0FuaW1hdGlvbi5SaWdHZW9tZXRyeSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCW1lc2g9b3NnQW5pbWF0aW9uUmlnR2VvbWV0cnkoeXMsY2hpbGQpDQoJCQkJbWVzaC5wYXJlbnRCb25lPXBhcmVudEJvbmUNCgkJCQltb2RlbC5tZXNoTGlzdC5hcHBlbmQobWVzaCkNCgkJCWlmICcib3NnQW5pbWF0aW9uLk1vcnBoR2VvbWV0cnkiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQltZXNoPW9zZ0FuaW1hdGlvbk1vcnBoR2VvbWV0cnkoeXMsY2hpbGQpDQoJCQkJbWVzaC5wYXJlbnRCb25lPXBhcmVudEJvbmUNCgkJCQltb2RlbC5tZXNoTGlzdC5hcHBlbmQobWVzaCkNCgkJCQkNCgkJCQkNCmRlZiBvc2dNYXRyaXhUcmFuc2Zvcm0oeXMscGFyZW50TmV3Tm9kZSxwYXJlbnRCb25lKToNCglib25lPUJvbmUoKQkNCglib25lLk5hbWU9Tm9uZQ0KCWJvbmUuVXBkYXRlTmFtZT1Ob25lDQoJYm9uZS5tYXRyaXg9TWF0cml4KCkucmVzaXplNHg0KCkjLmludmVydCgpDQoJaWYgcGFyZW50Qm9uZTpib25lLnBhcmVudE5hbWU9cGFyZW50Qm9uZS5uYW1lDQoJc2tlbGV0b24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpDQoJZm9yIGNoaWxkIGluIHBhcmVudE5ld05vZGUuY2hpbGRyZW46DQoJCWlmICciTWF0cml4IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQl2YWx1ZXM9eXMudmFsdWVzKGNoaWxkLm5vZGUuZGF0YSwnZicpCQ0KCQkJYm9uZS5tYXRyaXg9TWF0cml4NHg0KHZhbHVlcykNCgkJCWlmIHBhcmVudEJvbmU6Ym9uZS5tYXRyaXgqPXBhcmVudEJvbmUubWF0cml4CQ0KCQlpZiAnIlVuaXF1ZUlEIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQl2YWx1ZXM9eXMudmFsdWVzKGNoaWxkLm5vZGUuaGVhZGVyLCc6JykNCgkJCVVuaXF1ZUlEPXlzLmdldFZhbHVlKHZhbHVlcywnIlVuaXF1ZUlEIicsJ2knKQ0KCQkJYm9uZS5uYW1lPSdVbmlxdWVJRF8nK3N0cihVbmlxdWVJRCkNCgkJaWYgJyJOYW1lIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQl2YWx1ZXM9eXMudmFsdWVzKGNoaWxkLm5vZGUuaGVhZGVyLCc6JykNCgkJCU5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciTmFtZSInLCciIicpDQoJCQkjYmluZEJvbmUuTmFtZT1OYW1lDQoJCQlib25lLk5hbWU9TmFtZQ0KCQlpZiAnIlVwZGF0ZUNhbGxiYWNrcyInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCWlmICcib3NnQW5pbWF0aW9uLlVwZGF0ZU1hdHJpeFRyYW5zZm9ybSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJCQlpZiAnIk5hbWUiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGNoaWxkLm5vZGUuaGVhZGVyLCc6JykNCgkJCQkJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJywnIiInKQ0KCQkJCQkJCSNiaW5kQm9uZS5VcGRhdGVOYW1lPU5hbWUNCgkJCQkJCQlib25lLlVwZGF0ZU5hbWU9TmFtZQ0KCXJldHVybiBib25lCQkNCgkJCQ0KCQkNCmRlZiBvc2dBbmltYXRpb25Cb25lKHlzLHBhcmVudE5ld05vZGUscGFyZW50Qm9uZSk6DQoJYm9uZT1Cb25lKCkNCglza2VsZXRvbi5ib25lTGlzdC5hcHBlbmQoYm9uZSkJCQ0KCWJvbmUubWF0cml4PU1hdHJpeCgpLnJlc2l6ZTR4NCgpIy5pbnZlcnQoKQ0KCWJpbmRCb25lPUJvbmUoKQ0KCWJpbmRCb25lLm1hdHJpeD1NYXRyaXgoKS5yZXNpemU0eDQoKSMuaW52ZXJ0KCkNCgliaW5kQm9uZS5OYW1lPU5vbmUNCglib25lLk5hbWU9Tm9uZQ0KCWJvbmUuVXBkYXRlTmFtZT1Ob25lDQoJYmluZEJvbmUuVXBkYXRlTmFtZT1Ob25lDQoJZm9yIGNoaWxkIGluIHBhcmVudE5ld05vZGUuY2hpbGRyZW46DQoJCWlmICciSW52QmluZE1hdHJpeEluU2tlbGV0b25TcGFjZSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5ub2RlLmRhdGEsJ2YnKQkNCgkJCW1hdHJpeD1NYXRyaXg0eDQodmFsdWVzKQ0KCQkJYmluZEJvbmUubWF0cml4PW1hdHJpeC5pbnZlcnQoKQkNCgkJCWJpbmRza2VsZXRvbi5ib25lTGlzdC5hcHBlbmQoYmluZEJvbmUpDQoJCWlmICciVW5pcXVlSUQiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCXZhbHVlcz15cy52YWx1ZXMoY2hpbGQubm9kZS5oZWFkZXIsJzonKQ0KCQkJVW5pcXVlSUQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciVW5pcXVlSUQiJywnaScpDQoJCQliaW5kQm9uZS5uYW1lPSdVbmlxdWVJRF8nK3N0cihVbmlxdWVJRCkNCgkJCWJvbmUubmFtZT0nVW5pcXVlSURfJytzdHIoVW5pcXVlSUQpDQoJCWlmICciTmFtZSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5ub2RlLmhlYWRlciwnOicpDQoJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJywnIiInKQ0KCQkJYmluZEJvbmUuTmFtZT1OYW1lDQoJCQlib25lLk5hbWU9TmFtZQ0KCQkJI2JvbmVJbmRla3NMaXN0W05hbWVdPWJvbmUubmFtZQ0KCQlpZiAnIk1hdHJpeCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5ub2RlLmRhdGEsJ2YnKQkNCgkJCWJvbmUubWF0cml4PU1hdHJpeDR4NCh2YWx1ZXMpDQoJCQlpZiBwYXJlbnRCb25lOg0KCQkJCWlmICdNYXRyaXhUcmFuc2Zvcm0nIG5vdCBpbiBwYXJlbnRCb25lLm5hbWU6DQoJCQkJCWJvbmUucGFyZW50TmFtZT1wYXJlbnRCb25lLm5hbWUNCgkJCQlib25lLm1hdHJpeCo9cGFyZW50Qm9uZS5tYXRyaXgNCgkJaWYgJyJVcGRhdGVDYWxsYmFja3MiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQlpZiAnIm9zZ0FuaW1hdGlvbi5VcGRhdGVCb25lIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQkJCWlmICciTmFtZSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoY2hpbGQubm9kZS5oZWFkZXIsJzonKQ0KCQkJCQkJCU5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciTmFtZSInLCciIicpDQoJCQkJCQkJYmluZEJvbmUuVXBkYXRlTmFtZT1OYW1lDQoJCQkJCQkJYm9uZS5VcGRhdGVOYW1lPU5hbWUNCglyZXR1cm4gYm9uZQkJCQ0KCQkNCmRlZiBnZXROZXdOb2RlVHJlZSh5cyxwYXJlbnROZXdOb2RlLG4scGFyZW50Qm9uZSxkYXRhKToNCgkNCglpZiAnIm9zZ0FuaW1hdGlvbi5Ta2VsZXRvbiInIGluIHBhcmVudE5ld05vZGUubm9kZS5oZWFkZXI6DQoJCXBhcmVudEJvbmU9b3NnQW5pbWF0aW9uQm9uZSh5cyxwYXJlbnROZXdOb2RlLHBhcmVudEJvbmUpDQoJCWJpbmRza2VsZXRvbi5wYXJlbnRCb25lPXBhcmVudEJvbmUNCglpZiAnIm9zZy5Ob2RlIicgaW4gcGFyZW50TmV3Tm9kZS5ub2RlLmhlYWRlcjoNCgkJb3NnTm9kZSh5cyxwYXJlbnROZXdOb2RlLHBhcmVudEJvbmUpDQoJaWYgJyJvc2cuTWF0cml4VHJhbnNmb3JtIicgaW4gcGFyZW50TmV3Tm9kZS5ub2RlLmhlYWRlcjoNCgkJcGFyZW50Qm9uZT1vc2dNYXRyaXhUcmFuc2Zvcm0oeXMscGFyZW50TmV3Tm9kZSxwYXJlbnRCb25lKQ0KCWlmICcib3NnQW5pbWF0aW9uLkJvbmUiJyBpbiBwYXJlbnROZXdOb2RlLm5vZGUuaGVhZGVyOg0KCQlwYXJlbnRCb25lPW9zZ0FuaW1hdGlvbkJvbmUoeXMscGFyZW50TmV3Tm9kZSxwYXJlbnRCb25lKQ0KCW4rPTQNCglmb3IgY2hpbGQgaW4gcGFyZW50TmV3Tm9kZS5jaGlsZHJlbjoNCgkJI3dyaXRlKGxvZyxbY2hpbGQubm9kZS5oZWFkZXIsY2hpbGQuVW5pcXVlSURdLG4pDQoJCWdldE5ld05vZGVUcmVlKHlzLGNoaWxkLG4scGFyZW50Qm9uZSxkYXRhKQkJDQoJDQpkZWYgb3NnUGFyc2VyKGZpbGVuYW1lKToNCglnbG9iYWwgc2tlbGV0b24sYmluZHNrZWxldG9uLG1vZGVsLGJvbmVJbmRla3NMaXN0LGZpcnN0bWF0cml4LG5ld05vZGVMaXN0DQoJI1JpZ0dlb21ldHJ5PUZhbHNlDQoJYm9uZUluZGVrc0xpc3Q9e30NCgltb2RlbD1Nb2RlbChmaWxlbmFtZSkNCgltb2RlbC5tYXRMaXN0PXt9DQoJc2tlbGV0b249U2tlbGV0b24oKQ0KCXNrZWxldG9uLkFSTUFUVVJFU1BBQ0U9VHJ1ZQ0KCWJpbmRza2VsZXRvbj1Ta2VsZXRvbigpDQoJYmluZHNrZWxldG9uLnBhcmVudEJvbmU9Tm9uZQ0KCWJpbmRza2VsZXRvbi5BUk1BVFVSRVNQQUNFPVRydWUNCglVbmlxdWVJRExpc3Q9e30NCgl5cz1Zc29uKCkNCgl5cy5sb2c9VHJ1ZQ0KCXlzLmZpbGVuYW1lPWZpbGVuYW1lDQoJeXMucGFyc2UoKQ0KCQ0KCXJvb3Q9eXMucm9vdA0KCW49MA0KCW5ld05vZGVMaXN0PVtdDQoJbmV3Um9vdD1OZXdOb2RlKCkNCgluZXdSb290Lm5vZGU9eXMucm9vdA0KCW5ld05vZGVMaXN0LmFwcGVuZChuZXdSb290KQ0KCWdldElEVHJlZSh5cyx5cy5yb290LG4sbmV3Um9vdCkNCgkNCglyb290PW5ld1Jvb3QNCglnZXROZXdOb2RlVHJlZSh5cyxyb290LG4sTm9uZSxOb25lKQ0KCQ0KI2RlZiBzc3MoKToJDQoJDQoJc2tlbGV0b24uZHJhdygpDQoJCSNmb3IgYm9uZSBpbiBiaW5kc2tlbGV0b24uYm9uZUxpc3Q6DQoJCSMJYm9uZS5tYXRyaXgqPWJpbmRza2VsZXRvbi5wYXJlbnRCb25lLm1hdHJpeA0KCWlmIGxlbihiaW5kc2tlbGV0b24uYm9uZUxpc3QpPjA6CQkNCgkJYmluZHNrZWxldG9uLmRyYXcoKQ0KCWlmIGJpbmRza2VsZXRvbi5wYXJlbnRCb25lIGFuZCBiaW5kc2tlbGV0b24ub2JqZWN0Og0KCQliaW5kc2tlbGV0b24ub2JqZWN0LnNldE1hdHJpeChiaW5kc2tlbGV0b24ucGFyZW50Qm9uZS5tYXRyaXgpDQoJI2JvbmVOYW1lTGlzdD1bXQ0KCQ0KCWZvciBib25lIGluIHNrZWxldG9uLmJvbmVMaXN0Og0KCQlpZiBib25lLlVwZGF0ZU5hbWU6DQoJCQkjTmFtZT1nZXRTcGxpdE5hbWUoYm9uZS5OYW1lLCdfJywtMSkNCgkJCWJvbmVJbmRla3NMaXN0W2JvbmUuVXBkYXRlTmFtZV09Ym9uZS5uYW1lDQoJCQkjcHJpbnQgTmFtZSxib25lLm5hbWUNCgkJCQ0KCW49MAkNCglyZXN1bHQ9MQ0KCUFuaW1hdGlvbnM9eXMuZ2V0KHlzLnJvb3QsJyJvc2dBbmltYXRpb24uQW5pbWF0aW9uIicpCQkNCglpZiBBbmltYXRpb25zOg0KCQkjcmVzdWx0PUJsZW5kZXIuRHJhdy5QdXBNZW51KCJleHBvcnQgYW5pbWF0aW9ucyBhcyAqLmFjdGlvbj8ldHxZZXN8Tm8iKQ0KCQlpZiByZXN1bHQ9PTE6DQoJCQlmb3IgYW5pbWF0aW9uIGluIEFuaW1hdGlvbnM6CQ0KCQkJCWdldEFuaW1hdGlvbih5cyxhbmltYXRpb24sbikNCgkJCQkNCgkJCQkNCgkJDQoJCQ0KCQkNCglmb3IgbWVzaCBpbiBtb2RlbC5tZXNoTGlzdDoNCgkJbWVzaC5CSU5EU0tFTEVUT049c2tlbGV0b24ubmFtZQ0KCQlkcmF3TWVzaCh5cyxtZXNoKQ0KCQkJCQ0KCSNtb2RlbC5nZXRNYXQoKQkNCglyZXN1bHQ9MQ0KCSNyZXN1bHQ9QmxlbmRlci5EcmF3LlB1cE1lbnUoIlNlbmQgbWVzaGVzIHRvIHN0YXJ0cG9zZT8ldHxZZXN8Tm8iKQ0KCQ0KCXJlc3VsdDEwPTEgDQoJCQ0KCWlmIHJlc3VsdDEwPT0xOg0KCQlmb3IgaTEsbWVzaCBpbiBlbnVtZXJhdGUobW9kZWwubWVzaExpc3QpOg0KCQkJcHJpbnQgaTEsJ3ZlcnQ6JyxsZW4obWVzaC52ZXJ0UG9zTGlzdCksJ2NvbDonLGxlbihtZXNoLnZlcnRDb2xMaXN0KSwndXY6JyxsZW4obWVzaC52ZXJ0VVZMaXN0KSwnaW5kaWNlOicsbGVuKG1lc2guaW5kaWNlTGlzdCksJ21hdDonLGxlbihtZXNoLm1hdExpc3QpLCdza2luOicsbGVuKG1lc2guc2tpbkxpc3QpIyxtYXROYW1lDQoJCQlzeXMyLnN0ZG91dC5mbHVzaCgpDQoJCQkjQmxlbmRlci5XaW5kb3cuRHJhd1Byb2dyZXNzQmFyKGZsb2F0KChpMSkvZmxvYXQobGVuKG1vZGVsLm1lc2hMaXN0KSkpLHN0cihsZW4obW9kZWwubWVzaExpc3QpLTEtaTEpKQ0KCQkJDQoJCQltZXNoLkJJTkRTS0VMRVRPTj1za2VsZXRvbi5uYW1lDQoJCQlpZiBsZW4obWVzaC52ZXJ0UG9zTGlzdCk+MDoJDQoJCQkJaWYgbGVuKG1lc2guQm9uZXMpPjAgYW5kIGxlbihtZXNoLldlaWdodHMpPjA6DQoJCQkJCXNraW49U2tpbigpDQoJCQkJCXNraW4uYm9uZU1hcD1bMF0qbGVuKG1lc2guQm9uZU1hcCkNCgkJCQkJbWVzaC5ib25lTmFtZUxpc3Q9WycnXSpsZW4obWVzaC5Cb25lTWFwKQ0KCQkJCQlmb3IgYm9uZU5hbWUgaW4gbWVzaC5Cb25lTWFwOg0KCQkJCQkJZm9yIGJvbmUgaW4gc2tlbGV0b24uYm9uZUxpc3Q6DQoJCQkJCQkJaWYgYm9uZS5OYW1lPT1ib25lTmFtZToNCgkJCQkJCQkJaWQ9bWVzaC5Cb25lTWFwW2JvbmVOYW1lXQ0KCQkJCQkJCQlza2luLmJvbmVNYXBbaWRdPWlkDQoJCQkJCQkJCW1lc2guYm9uZU5hbWVMaXN0W2lkXT1ib25lLm5hbWUJDQoJCQkJCQkJCWJyZWFrCQkJCQ0KCQkJCQltZXNoLnNraW5MaXN0LmFwcGVuZChza2luKQ0KCQkJCQltZXNoLnNraW5JbmRpY2VMaXN0PW1lc2guQm9uZXMNCgkJCQkJbWVzaC5za2luV2VpZ2h0TGlzdD1tZXNoLldlaWdodHMNCgkJCQkNCgkJCQlpZiBiaW5kc2tlbGV0b24ub2JqZWN0IGFuZCBza2VsZXRvbi5vYmplY3Q6DQoJCQkJCWlmIG1lc2gucGFyZW50Qm9uZSBhbmQgbGVuKG1lc2guc2tpbkxpc3QpPjA6DQoJCQkJCQltZXNoLmRyYXcoKQkNCgkJCQkJCW1lc2gub2JqZWN0LmdldERhdGEobWVzaD0xKS50cmFuc2Zvcm0obWVzaC5wYXJlbnRCb25lLm1hdHJpeCkNCgkJCQkJCW1lc2gub2JqZWN0LmdldERhdGEobWVzaD0xKS51cGRhdGUoKQ0KCQkJCQkJI21lc2gub2JqZWN0LnNldE1hdHJpeChtZXNoLnBhcmVudEJvbmUubWF0cml4KQ0KCQkJCQkJaWYgcmVzdWx0PT0xOg0KCQkJCQkJCWJpbmRQb3NlKGJpbmRza2VsZXRvbi5vYmplY3Qsc2tlbGV0b24ub2JqZWN0LG1lc2gub2JqZWN0KQ0KCQkJCQkJc2tlbGV0b24ub2JqZWN0Lm1ha2VQYXJlbnREZWZvcm0oW21lc2gub2JqZWN0XSwxLDApDQoJCQkJCWVsaWYgbWVzaC5wYXJlbnRCb25lIGFuZCBsZW4obWVzaC5za2luTGlzdCk9PTA6DQoJCQkJCQltZXNoLnNldFNraW4obWVzaC5wYXJlbnRCb25lLm5hbWUpCQ0KCQkJCQkJbWVzaC5kcmF3KCkJDQoJCQkJCQltZXNoLm9iamVjdC5nZXREYXRhKG1lc2g9MSkudHJhbnNmb3JtKG1lc2gucGFyZW50Qm9uZS5tYXRyaXgpDQoJCQkJCQltZXNoLm9iamVjdC5nZXREYXRhKG1lc2g9MSkudXBkYXRlKCkNCgkJCQkJCXNrZWxldG9uLm9iamVjdC5tYWtlUGFyZW50RGVmb3JtKFttZXNoLm9iamVjdF0sMSwwKQ0KCQkJCWVsc2U6CQ0KCQkJCQlpZiBtZXNoLnBhcmVudEJvbmU6DQoJCQkJCQlpZiBsZW4obWVzaC5za2luTGlzdCk9PTA6DQoJCQkJCQkJbWVzaC5zZXRTa2luKG1lc2gucGFyZW50Qm9uZS5uYW1lKQkNCgkJCQkJCW1lc2guZHJhdygpCQ0KCQkJCQkJbWVzaC5vYmplY3QuZ2V0RGF0YShtZXNoPTEpLnRyYW5zZm9ybShtZXNoLnBhcmVudEJvbmUubWF0cml4KQ0KCQkJCQkJbWVzaC5vYmplY3QuZ2V0RGF0YShtZXNoPTEpLnVwZGF0ZSgpDQoJCQkJCQkjbWVzaC5vYmplY3Quc2V0TWF0cml4KG1lc2gucGFyZW50Qm9uZS5tYXRyaXgpDQoJCQkJCQkjc2tlbGV0b24ub2JqZWN0Lm1ha2VQYXJlbnRCb25lKFttZXNoLm9iamVjdF0sbWVzaC5wYXJlbnRCb25lLm5hbWUsMCwwKQ0KCQkJCQkJaWYgc2tlbGV0b24ub2JqZWN0IGFuZCBza2VsZXRvbi5vYmplY3Q6DQoJCQkJCQkJc2tlbGV0b24ub2JqZWN0Lm1ha2VQYXJlbnREZWZvcm0oW21lc2gub2JqZWN0XSwxLDApDQoJCQkJCWVsc2U6DQoJCQkJCQkjcHJpbnQgbGVuKG1lc2gudmVydFBvc0xpc3QpDQoJCQkJCQkjcHJpbnQgbWVzaC5pbmRpY2VMaXN0DQoJCQkJCQkjbWVzaC5pbmRpY2VMaXN0PVtdDQoJCQkJCQltZXNoLmRyYXcoKQkNCgkJCQkJCSNtZXNoLm9iamVjdC5nZXREYXRhKG1lc2g9MSkudHJhbnNmb3JtKG1lc2gucGFyZW50Qm9uZS5tYXRyaXgpDQoJCQkJCQkjbWVzaC5vYmplY3QuZ2V0RGF0YShtZXNoPTEpLnVwZGF0ZSgpDQoJCQkJCQkjbWVzaC5vYmplY3Quc2V0TWF0cml4KG1lc2gucGFyZW50Qm9uZS5tYXRyaXgpDQoJCQkJDQoJCQkJIiIiDQoJCQkJaWYgbGVuKG1lc2gubW9ycGhBcnJheSk+MDoJCQ0KCQkJCQluYW1lPW1lc2gub2JqZWN0Lm5hbWUNCgkJCQkJYWN0aW9uPUFjdGlvbigpCQkNCgkJCQkJYWN0aW9uLk1FU0hTUEFDRT1UcnVlDQoJCQkJCWFjdGlvbi5uYW1lPW5hbWUNCgkJCQkJZm9yIGksbW9ycGggaW4gZW51bWVyYXRlKG1lc2gubW9ycGhBcnJheSk6DQoJCQkJCQkjbW9ycGhNZXNoPU1lc2goKQ0KCQkJCQkJI21vcnBoTWVzaC52ZXJ0UG9zTGlzdD1tZXNoLm1vcnBoQXJyYXlbbW9ycGhdWzBdWzBdDQoJCQkJCQkjcHJpbnQgbW9ycGgNCgkJCQkJCSNtb3JwaE1lc2guZHJhdygpDQoJCQkJCQl2ZXJ0TGlzdD1tZXNoLm1vcnBoQXJyYXlbbW9ycGhdWzBdWzBdDQoJCQkJCQlmcmFtZT1pKjUNCgkJCQkJCWFjdGlvbi5zaGFwZUZyYW1lTGlzdC5hcHBlbmQoZnJhbWUpDQoJCQkJCQlhY3Rpb24uc2hhcGVLZXlMaXN0LmFwcGVuZCh2ZXJ0TGlzdCkNCgkJCQkJYWN0aW9uLmRyYXcoKQ0KCQkJCQlhY3Rpb24uc2V0Q29udGV4dCgpDQoJCQkJCSIiIg0KCQkJCQkJDQoJCQkJCQkNCgkJCQkJCQ0KDQoNCgkJbW9kZWwuc2V0KCkJDQoJCQkJCQkNCg0KDQoNCg0KDQoNCg0KDQoNCgkJDQoJCSNmb3IgaSxtZXNoIGluIGVudW1lcmF0ZShtb2RlbC5tZXNoTGlzdCk6DQoJCSMJQmxlbmRlci5XaW5kb3cuRHJhd1Byb2dyZXNzQmFyKGZsb2F0KGkvZmxvYXQobGVuKG1vZGVsLm1lc2hMaXN0KSsxKSksc3RyKC0xK2xlbihtb2RlbC5tZXNoTGlzdCktaSkpDQoJCSNwcmludCAncmVzdWx0OicscmVzdWx0DQoJCWlmIHJlc3VsdCE9MjoNCgkJCWlmCWJpbmRza2VsZXRvbi5vYmplY3Q6DQoJCQkJc2NlbmUgPSBicHkuZGF0YS5zY2VuZXMuYWN0aXZlDQoJCQkJc2NlbmUub2JqZWN0cy51bmxpbmsoYmluZHNrZWxldG9uLm9iamVjdCkNCgkJDQpkZWYgaHRtUGFyc2VyKGZpbGVuYW1lKToNCgl5cz1Zc29uKCkNCgl5cy5sb2c9VHJ1ZQ0KCXlzLmZpbGVuYW1lPWZpbGVuYW1lDQoJeXMucGFyc2UoKQkJDQoJIyNvcy5zeXN0ZW0oJ2NscycpDQoJDQoJCQkNCgkjc3p1a2FtIGlrb255DQoJcHJpbnQgJ3N6dWthbSBpa29ueScNCgkjcHJpbnQgeXMucm9vdA0KCVRIVU1CTkFJTFM9eXMuZ2V0KHlzLnJvb3QsJyJ0aHVtYm5haWxzIicpDQoJcHJpbnQgVEhVTUJOQUlMUw0KCWlrb25hPU5vbmUNCglTSVpFPTANCglpZiBUSFVNQk5BSUxTOg0KCQlmb3IgdGh1bWJuYWlscyBpbiBUSFVNQk5BSUxTOg0KCQkJI3ByaW50IHRodW1ibmFpbHMuaGVhZGVyDQoJCQlVUkw9eXMuZ2V0KHRodW1ibmFpbHMsJyJ1cmwiJykNCgkJCWZvciBhIGluIFVSTDoNCgkJCQl2YWx1ZXM9eXMudmFsdWVzKGEuZGF0YSwnOicpDQoJCQkJdXJsPXlzLmdldFZhbHVlKHZhbHVlcywnInVybCInLCciIicpDQoJCQkJc2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJzaXplIicsJ2knKQ0KCQkJCWlmIHVybDoNCgkJCQkJYmFzZW5hbWU9b3MucGF0aC5iYXNlbmFtZSh1cmwpCQkJDQoJCQkJCWlmICcuanBlZycgaW4gYmFzZW5hbWU6cGF0aD1zeXMuZGlyK29zLnNlcCtvcy5wYXRoLmJhc2VuYW1lKHVybCkrJy5qcGcnDQoJCQkJCWVsc2U6cGF0aD1zeXMuZGlyK29zLnNlcCtvcy5wYXRoLmJhc2VuYW1lKHVybCkNCgkJCQkJZXhpc3RzPW9zLnBhdGguZXhpc3RzKHBhdGgpDQoJCQkJCSNwcmludCAnaWtvbmEnLGV4aXN0cyxvcy5wYXRoLmJhc2VuYW1lKHVybCkrJy5qcGcnCQkJCQkJCQ0KCQkJCQlpZiBleGlzdHM9PVRydWU6DQoJCQkJCQlpZiBzaXplPlNJWkU6DQoJCQkJCQkJU0laRT1zaXplDQoJCQkJCQkJaWtvbmE9cGF0aA0KCQkJCQkJCQ0KCWlmIGlrb25hOg0KCQkjcHJpbnQgaWtvbmENCgkJZm9yIGZpbGUgaW4gb3MubGlzdGRpcihzeXMuZGlyKToNCgkJCWlmICcuaHRtJyBpbiBmaWxlOg0KCQkJCWlmIG9zLnBhdGguZXhpc3RzKHN5cy5kaXIrb3Muc2VwK2ZpbGUrIi50aHVtYi4xMC5wbmciKT09RmFsc2U6DQoJCQkJCWlmIG9zLnBhdGguZXhpc3RzKGlrb25hKToNCgkJCQkJCW9zLnJlbmFtZShpa29uYSxzeXMuZGlyK29zLnNlcCtmaWxlKyIudGh1bWIuMTAucG5nIikNCgkJCQllbHNlOg0KCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhzeXMuZGlyK29zLnNlcCtmaWxlKyIudGh1bWIuMTEucG5nIik9PUZhbHNlOg0KCQkJCQkJaWYgb3MucGF0aC5leGlzdHMoaWtvbmEpOgkJCQkJCQ0KCQkJCQkJCW9zLnJlbmFtZShpa29uYSxzeXMuZGlyK29zLnNlcCtmaWxlKyIudGh1bWIuMTEucG5nIikNCgkJCQkJDQoJCQkNCgkJDQoJDQoJUkVTVUxUUz15cy5nZXQoeXMucm9vdCwnInJlc3VsdHMiJykJDQoJaWYgUkVTVUxUUzoNCgkJZm9yIHJlc3VsdHMgaW4gUkVTVUxUUzoNCgkJCXdyaXRlKGxvZyxbInJlc3VsdHMiXSwwKQ0KCQkJVUlEUz15cy5nZXQocmVzdWx0cywnInVpZCInKQkNCgkJCWlmIFVJRFM6DQoJCQkJZm9yIFVJRCBpbiBVSURTOg0KCQkJCQkjd3JpdGUobG9nLFtVSUQuaGVhZGVyXSw0KQ0KCQkJCQl1aWQ9Tm9uZQ0KCQkJCQl2YWx1ZXM9Tm9uZQ0KCQkJCQlpZiAnInVpZCInIGluIFVJRC5oZWFkZXI6dmFsdWVzPXlzLnZhbHVlcyhVSUQuaGVhZGVyLCc6JykNCgkJCQkJaWYgJyJ1aWQiJyBpbiBVSUQuZGF0YTp2YWx1ZXM9eXMudmFsdWVzKFVJRC5kYXRhLCc6JykNCgkJCQkJaWYgdmFsdWVzOnVpZD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJ1aWQiJywnIiInKQ0KCQkJCQl3cml0ZShsb2csWyd1aWQ6Jyx1aWRdLDQpDQoJCQkJCWlmIHVpZDoNCgkJCQkJCWZvcm1hdHM9eXMuZ2V0KFVJRCwnImZvcm1hdCInKQ0KCQkJCQkJaWYgZm9ybWF0czoJCQkJCQkJDQoJCQkJCQkJSU1BR0VTW3VpZF09e30NCgkJCQkJCQlJTUFHRVNbdWlkXVsnQSddPVtOb25lLE5vbmUsMTAwXQ0KCQkJCQkJCUlNQUdFU1t1aWRdWydSR0InXT1bTm9uZSxOb25lLDEwMF0NCgkJCQkJCQlJTUFHRVNbdWlkXVsnTiddPVtOb25lLE5vbmUsMTAwXQ0KCQkJCQkJCUlNQUdFU1t1aWRdWydSJ109W05vbmUsTm9uZSwxMDBdDQoJCQkJCQkJZm9yIGZvcm1hdE5vZGUgaW4gZm9ybWF0czoNCgkJCQkJCQkJd3JpdGUobG9nLFsnaW1hZ2UnXSw4KQkJCQkJCQkJDQoJCQkJCQkJCXZhbHVlcz1Ob25lDQoJCQkJCQkJCWZvcm1hdD1Ob25lDQoJCQkJCQkJCWlmICciZm9ybWF0IicgaW4gZm9ybWF0Tm9kZS5oZWFkZXI6dmFsdWVzPXlzLnZhbHVlcyhmb3JtYXROb2RlLmhlYWRlciwnOicpDQoJCQkJCQkJCWlmICciZm9ybWF0IicgaW4gZm9ybWF0Tm9kZS5kYXRhOnZhbHVlcz15cy52YWx1ZXMoZm9ybWF0Tm9kZS5kYXRhLCc6JykNCgkJCQkJCQkJaWYgdmFsdWVzOmZvcm1hdD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJmb3JtYXQiJywnIiInKQ0KCQkJCQkJCQl3cml0ZShsb2csWydmb3JtYXQ6Jyxmb3JtYXRdLDEyKQkJCQkJCQkJDQoJCQkJCQkJCXZhbHVlcz1Ob25lDQoJCQkJCQkJCXF1YWxpdHk9Tm9uZQ0KCQkJCQkJCQlpZiAnInF1YWxpdHkiJyBpbiBmb3JtYXROb2RlLmhlYWRlcjp2YWx1ZXM9eXMudmFsdWVzKGZvcm1hdE5vZGUuaGVhZGVyLCc6JykNCgkJCQkJCQkJaWYgJyJxdWFsaXR5IicgaW4gZm9ybWF0Tm9kZS5kYXRhOnZhbHVlcz15cy52YWx1ZXMoZm9ybWF0Tm9kZS5kYXRhLCc6JykNCgkJCQkJCQkJaWYgdmFsdWVzOnF1YWxpdHk9eXMuZ2V0VmFsdWUodmFsdWVzLCcicXVhbGl0eSInLCdpJykNCgkJCQkJCQkJd3JpdGUobG9nLFsncXVhbGl0eTonLHF1YWxpdHldLDEyKQkJCQkJCQkJDQoJCQkJCQkJCXZhbHVlcz1Ob25lDQoJCQkJCQkJCXVybD1Ob25lDQoJCQkJCQkJCWlmICcidXJsIicgaW4gZm9ybWF0Tm9kZS5oZWFkZXI6dmFsdWVzPXlzLnZhbHVlcyhmb3JtYXROb2RlLmhlYWRlciwnOicpDQoJCQkJCQkJCWlmICcidXJsIicgaW4gZm9ybWF0Tm9kZS5kYXRhOnZhbHVlcz15cy52YWx1ZXMoZm9ybWF0Tm9kZS5kYXRhLCc6JykNCgkJCQkJCQkJaWYgdmFsdWVzOnVybD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJ1cmwiJywnIiInKQkJCQkJCQkJDQoJCQkJCQkJCSN3cml0ZShsb2csWyd1cmw6Jyx1cmxdLDEyKQ0KCQkJCQkJCQlpZiBub3QgdXJsOg0KCQkJCQkJCQkJaWYgJyJ1cmwiJyBpbiBmb3JtYXROb2RlLnBhcmVudC5oZWFkZXI6dmFsdWVzPXlzLnZhbHVlcyhmb3JtYXROb2RlLnBhcmVudC5oZWFkZXIsJzonKQ0KCQkJCQkJCQkJaWYgJyJ1cmwiJyBpbiBmb3JtYXROb2RlLnBhcmVudC5kYXRhOnZhbHVlcz15cy52YWx1ZXMoZm9ybWF0Tm9kZS5wYXJlbnQuZGF0YSwnOicpDQoJCQkJCQkJCQlpZiB2YWx1ZXM6dXJsPXlzLmdldFZhbHVlKHZhbHVlcywnInVybCInLCciIicpCQ0KCQkJCQkJCQlpZiB1cmw6DQoJCQkJCQkJCQliYXNlbmFtZT1vcy5wYXRoLmJhc2VuYW1lKHVybCkJCQkNCgkJCQkJCQkJCWlmICcuanBlZycgaW4gYmFzZW5hbWU6cGF0aD1zeXMuZGlyK29zLnNlcCtvcy5wYXRoLmJhc2VuYW1lKHVybCkrJy5qcGcnDQoJCQkJCQkJCQllbHNlOnBhdGg9c3lzLmRpcitvcy5zZXArb3MucGF0aC5iYXNlbmFtZSh1cmwpDQoJCQkJCQkJCQlleGlzdHM9b3MucGF0aC5leGlzdHMocGF0aCkJCQkJCQkJCQ0KCQkJCQkJCQkJd3JpdGUobG9nLFsncGF0aDonLHBhdGgsZXhpc3RzXSwxMikNCgkJCQkJCQkJCQ0KCQkJCQkJCQkJaWYgZm9ybWF0IG5vdCBpbiBJTUFHRVNbdWlkXS5rZXlzKCk6DQoJCQkJCQkJCQkJcHJpbnQgJ05PV1kgRk9STUFUOicsZm9ybWF0DQoJCQkJCQkJCQkJSU1BR0VTW3VpZF1bZm9ybWF0XT1bcGF0aCxleGlzdHMscXVhbGl0eV0NCgkJCQkJCQkJCWVsc2U6DQoJCQkJCQkJCQkJaWYgcXVhbGl0eSBhbmQgZm9ybWF0Og0KCQkJCQkJCQkJCQlpZiBxdWFsaXR5PD1JTUFHRVNbdWlkXVtmb3JtYXRdWzJdIGFuZCBleGlzdHM9PVRydWU6DQoJCQkJCQkJCQkJCQlJTUFHRVNbdWlkXVtmb3JtYXRdPVtwYXRoLGV4aXN0cyxxdWFsaXR5XQ0KCQkJCQkJCQkJDQoJCQkJCQkJCQkNCgkJCQkJCQkJDQoJCQkJCQkJDQoJCQ0KCQkJCQkJDQoJCQkJDQoJCQkNCglhbGxJbWFnZVBhdGhzPVtdCQkJDQoJCQkJCQkNCgkNCgl1c2VkSW1hZ2VQYXRocz1bXQ0KCWZvciBrZXkgaW4gSU1BR0VTOg0KCQkjd3JpdGUobG9nLFtrZXldLDApDQoJCWZvciBpdGVtIGluIElNQUdFU1trZXldOg0KCQkJI3dyaXRlKGxvZyxbaXRlbSwnOicsSU1BR0VTW2tleV1baXRlbV1dLDQpDQoJCQlpZiBJTUFHRVNba2V5XVtpdGVtXVswXToNCgkJCQlpZiBJTUFHRVNba2V5XVtpdGVtXVswXSBub3QgaW4gdXNlZEltYWdlUGF0aHM6DQoJCQkJCXVzZWRJbWFnZVBhdGhzLmFwcGVuZChJTUFHRVNba2V5XVtpdGVtXVswXSkNCgkNCglmb3IgaW1hZ2UgaW4gYWxsSW1hZ2VQYXRoczoNCgkJaWYgaW1hZ2Ugbm90IGluIHVzZWRJbWFnZVBhdGhzOg0KCQkJaWYgb3MucGF0aC5leGlzdHMoaW1hZ2UpPT1UcnVlOg0KCQkJCXByaW50ICd1c3V3YW06JyxpbWFnZQ0KCQkJCSNvcy5yZW1vdmUoaW1hZ2UpDQoJDQoJbWF0ZXJpYWxzPXlzLmdldCh5cy5yb290LCcibWF0ZXJpYWxzIicpDQoJaWYgbWF0ZXJpYWxzOg0KCQlmb3IgYSBpbiBtYXRlcmlhbHM6DQoJCQlmb3IgYiBpbiBhLmNoaWxkcmVuOg0KCQkJCW1hdE5hbWU9Tm9uZQkNCgkJCQlpZiAnIm5hbWUiJyBpbiBiLmRhdGE6DQoJCQkJCXZhbHVlcz15cy52YWx1ZXMoYi5kYXRhLCc6JykNCgkJCQkJbWF0TmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJuYW1lIicsJyIiJykucmVwbGFjZSgnOicsJycpDQoJCQkJCW1hdE5hbWU9bWF0TmFtZS5yZXBsYWNlKCc6JywnJykNCgkJCQkJaWYgJ1xcJyBpbiBtYXROYW1lOm1hdE5hbWU9bWF0TmFtZS5zcGxpdCgnXFwnKVswXQ0KCQkJCQlNQVRFUklBTFNbbWF0TmFtZV09e30NCgkJCQllbHNlOgkNCgkJCQkJZm9yIGMgaW4gYi5jaGlsZHJlbjoJCQ0KCQkJCQkJaWYgJyJuYW1lIicgaW4gYy5oZWFkZXI6DQoJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhjLmhlYWRlciwnOicpDQoJCQkJCQkJbWF0TmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJuYW1lIicsJyIiJykNCgkJCQkJCQlNQVRFUklBTFNbbWF0TmFtZV09e30NCgkJCQkjcHJpbnQgbWF0TmFtZQ0KCQkJCXdyaXRlKGxvZyxbbWF0TmFtZV0sMCkNCgkJCQlpZgltYXROYW1lOg0KCQkJCQkjbWF0TmFtZT1tYXROYW1lLnJlcGxhY2UoJzonLCcnKQ0KCQkJCQkjaWYgJ1xcJyBpbiBtYXROYW1lOm1hdE5hbWU9bWF0TmFtZS5zcGxpdCgnXFwnKVswXQ0KCQkJCQljaGFubmVscz15cy5nZXQoYiwnImNoYW5uZWxzIicpDQoJCQkJCWlmIGNoYW5uZWxzOg0KCQkJCQkJZm9yIGMgaW4gY2hhbm5lbHNbMF0uY2hpbGRyZW46CQkJCQkNCgkJCQkJCQlNQVRFUklBTFNbbWF0TmFtZV1bYy5oZWFkZXIuc3BsaXQoJyInKVsxXV09WycnLFtdLFtdXQ0KCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoYy5kYXRhLCc6JykNCgkJCQkJCQllbmFibGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciZW5hYmxlIicsJ3MnKQ0KCQkJCQkJCWlmIGVuYWJsZToNCgkJCQkJCQkJaWYgZW5hYmxlPT0ndHJ1ZSc6DQoJCQkJCQkJCQlmb3IgZCBpbiBjLmNoaWxkcmVuOg0KCQkJCQkJCQkJCWR2YWx1ZXM9eXMudmFsdWVzKGQuaGVhZGVyLCc6JykNCgkJCQkJCQkJCQkjcHJpbnQgZHZhbHVlcw0KCQkJCQkJCQkJCWlmICcidGV4dHVyZSInIGluIGQuaGVhZGVyOg0KCQkJCQkJCQkJCQlpZiAnInVpZCInIGluIGQuZGF0YToNCgkJCQkJCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoZC5kYXRhLCc6JykNCgkJCQkJCQkJCQkJCXVpZD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJ1aWQiJywnIiInKQ0KCQkJCQkJCQkJCQkJd3JpdGUobG9nLFt1aWRdLDQpDQoJCQkJCQkJCQkJCQlpZiB1aWQgaW4gSU1BR0VTLmtleXMoKToNCgkJCQkJCQkJCQkJCQlmb3IgZm9ybWF0IGluIElNQUdFU1t1aWRdOg0KCQkJCQkJCQkJCQkJCQl3cml0ZShsb2csW2Zvcm1hdCxJTUFHRVNbdWlkXVtmb3JtYXRdXSw4KQ0KCQkJCQkJCQkJCQkJCQlwYXNzDQoJCQkJCQkJCQkJCQllbHNlOg0KCQkJCQkJCQkJCQkJCXdyaXRlKGxvZyxbJ01JU1NJTkc6Jyx1aWRdLDgpDQoJCQkJCQkJCQkJCQkJcGFzcw0KCQkJCQkJCQkJCQkJCQ0KCQkJCQkJCQkJCQkJTUFURVJJQUxTW21hdE5hbWVdW2MuaGVhZGVyLnNwbGl0KCciJylbMV1dPVsndGV4dHVyZScsdWlkXQ0KCQkJCQkJCQkJCQkJdWlkPU1BVEVSSUFMU1ttYXROYW1lXVtjLmhlYWRlci5zcGxpdCgnIicpWzFdXVsxXQ0KCQkJCQkJCQkJCQkJI3ByaW50IElNQUdFU1t1aWRdDQoJCQkJCQkJCQkJaWYgJyJjb2xvciInIGluIGQuaGVhZGVyOg0KCQkJCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGQuZGF0YSwnZicpDQoJCQkJCQkJCQkJCU1BVEVSSUFMU1ttYXROYW1lXVtjLmhlYWRlci5zcGxpdCgnIicpWzFdXT1bJ2NvbG9yJyx2YWx1ZXNdDQoJCQkJCQkJZWxzZToNCgkJCQkJCQkJCWZvciBkIGluIGMuY2hpbGRyZW46DQoJCQkJCQkJCQkNCgkJCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGQuaGVhZGVyLCc6JykNCgkJCQkJCQkJCQllbmFibGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciZW5hYmxlIicsJ3MnKQ0KCQkJCQkJCQkJCWlmIGVuYWJsZToNCgkJCQkJCQkJCQ0KCQkJCQkJCQkJCQlpZiBlbmFibGU9PSd0cnVlJzoNCgkJCQkJCQkJCQkJCQ0KCQkJCQkJCQkJCQkJCWR2YWx1ZXM9eXMudmFsdWVzKGQuaGVhZGVyLCc6JykNCgkJCQkJCQkJCQkJCQkjcHJpbnQgZHZhbHVlcw0KCQkJCQkJCQkJCQkJCWlmICcidGV4dHVyZSInIGluIGQuaGVhZGVyOg0KCQkJCQkJCQkJCQkJCQlpZiAnInVpZCInIGluIGQuZGF0YToNCgkJCQkJCQkJCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoZC5kYXRhLCc6JykNCgkJCQkJCQkJCQkJCQkJCXVpZD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJ1aWQiJywnIiInKQ0KCQkJCQkJCQkJCQkJCQkJd3JpdGUobG9nLFt1aWRdLDQpDQoJCQkJCQkJCQkJCQkJCQlpZiB1aWQgaW4gSU1BR0VTLmtleXMoKToNCgkJCQkJCQkJCQkJCQkJCQlmb3IgZm9ybWF0IGluIElNQUdFU1t1aWRdOg0KCQkJCQkJCQkJCQkJCQkJCQl3cml0ZShsb2csW2Zvcm1hdCxJTUFHRVNbdWlkXVtmb3JtYXRdLGVuYWJsZV0sOCkNCgkJCQkJCQkJCQkJCQkJCQkJcGFzcw0KCQkJCQkJCQkJCQkJCQkJZWxzZToNCgkJCQkJCQkJCQkJCQkJCQl3cml0ZShsb2csWydNSVNTSU5HOicsdWlkXSw4KQ0KCQkJCQkJCQkJCQkJCQkJCXBhc3MNCgkJCQkJCQkJCQkJCQkJCQkNCgkJCQkJCQkJCQkJCQkJCU1BVEVSSUFMU1ttYXROYW1lXVtjLmhlYWRlci5zcGxpdCgnIicpWzFdXT1bJ3RleHR1cmUnLHVpZF0NCgkJCQkJCQkJCQkJCQkJCXVpZD1NQVRFUklBTFNbbWF0TmFtZV1bYy5oZWFkZXIuc3BsaXQoJyInKVsxXV1bMV0NCgkJCQkJCQkJCQkJCQkJCSNwcmludCBJTUFHRVNbdWlkXQ0KCQkJCQkJCQkJCQkJCWlmICciY29sb3IiJyBpbiBkLmhlYWRlcjoNCgkJCQkJCQkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhkLmRhdGEsJ2YnKQ0KCQkJCQkJCQkJCQkJCQlNQVRFUklBTFNbbWF0TmFtZV1bYy5oZWFkZXIuc3BsaXQoJyInKVsxXV09Wydjb2xvcicsdmFsdWVzXQ0KCQkJCQkJCQkNCg0KDQpkZWYgYWN0aW9uUGFyc2VyKGZpbGVuYW1lLGcpOg0KCWFjdGlvbj1BY3Rpb24oKQ0KCWFjdGlvbi5CT05FU1BBQ0U9VHJ1ZQ0KCWFjdGlvbi5CT05FU09SVD1UcnVlDQoJd2hpbGUoVHJ1ZSk6DQoJCWlmIGcudGVsbCgpPj1nLmZpbGVTaXplKCk6YnJlYWsNCgkJYm9uZT1BY3Rpb25Cb25lKCkNCgkJYWN0aW9uLmJvbmVMaXN0LmFwcGVuZChib25lKQ0KCQlib25lLm5hbWU9Zy5maW5kKCdceDAwJykNCgkJdHlwZT1nLmZpbmQoJ1x4MDAnKQ0KCQkjcHJpbnQgYm9uZS5uYW1lLHR5cGUsZy50ZWxsKCkNCgkJaWYgdHlwZT09J3NpemUnOg0KCQkJY291bnQ9Zy5pKDEpWzBdDQoJCQkjcHJpbnQgY291bnQNCgkJCWZvciBtIGluIHNhZmUoY291bnQpOg0KCQkJCW1hdHJpeD1WZWN0b3JTY2FsZU1hdHJpeChnLmYoMykpDQoJCQkJYm9uZS5zaXplS2V5TGlzdC5hcHBlbmQobWF0cml4KQ0KCQkJY291bnQ9Zy5pKDEpWzBdDQoJCQkjcHJpbnQgY291bnQNCgkJCWZvciBtIGluIHNhZmUoY291bnQpOg0KCQkJCWZyYW1lPWludChnLmYoMSlbMF0qMzMpDQoJCQkJYm9uZS5zaXplRnJhbWVMaXN0LmFwcGVuZChmcmFtZSkNCgkJaWYgdHlwZT09J3RyYW5zbGF0ZSc6DQoJCQljb3VudD1nLmkoMSlbMF0NCgkJCSNwcmludCBjb3VudA0KCQkJZm9yIG0gaW4gc2FmZShjb3VudCk6DQoJCQkJbWF0cml4PVZlY3Rvck1hdHJpeChnLmYoMykpDQoJCQkJYm9uZS5wb3NLZXlMaXN0LmFwcGVuZChtYXRyaXgpDQoJCQljb3VudD1nLmkoMSlbMF0NCgkJCSNwcmludCBjb3VudA0KCQkJZm9yIG0gaW4gc2FmZShjb3VudCk6DQoJCQkJZnJhbWU9aW50KGcuZigxKVswXSozMykNCgkJCQlib25lLnBvc0ZyYW1lTGlzdC5hcHBlbmQoZnJhbWUpDQoJCWlmIHR5cGU9PSdxdWF0ZXJuaW9uJzoNCgkJCWNvdW50PWcuaSgxKVswXQ0KCQkJI3ByaW50IGNvdW50DQoJCQlmb3IgbSBpbiBzYWZlKGNvdW50KToNCgkJCQlxdWF0PVF1YXRlcm5pb24oZy5mKDQpKQ0KCQkJCW1hdHJpeD1RdWF0TWF0cml4KHF1YXQpLnJlc2l6ZTR4NCgpDQoJCQkJYm9uZS5yb3RLZXlMaXN0LmFwcGVuZChtYXRyaXgpDQoJCQljb3VudD1nLmkoMSlbMF0NCgkJCSNwcmludCBjb3VudA0KCQkJZm9yIG0gaW4gc2FmZShjb3VudCk6DQoJCQkJZnJhbWU9aW50KGcuZigxKVswXSozMykNCgkJCQlib25lLnJvdEZyYW1lTGlzdC5hcHBlbmQoZnJhbWUpDQoJYWN0aW9uLmRyYXcoKQ0KCWFjdGlvbi5zZXRDb250ZXh0KCkJDQoJDQoJDQoJDQpkZWYgZ2V0Q2Fub25pY2FsKGZpbGVuYW1lKToNCglmaWxlPW9wZW4oZmlsZW5hbWUsJ3InKQ0KCWRhdGE9ZmlsZS5yZWFkKCkNCgkjcHJpbnQgZGF0YQ0KCWNhbm9uaWNhbD1Ob25lDQoJaWYgJyJjYW5vbmljYWwiJyBpbiBkYXRhOg0KCQljYW5vbmljYWw9ZGF0YS5zcGxpdCgnImNhbm9uaWNhbCInKVsxXS5zcGxpdCgnIicpWzFdLnNwbGl0KCcvJylbNF0NCgkJIygnPGxpbmsgcmVsPSJjYW5vbmljYWwiIGhyZWY9Imh0dHBzOi8vc2tldGNoZmFiLmNvbS8zZC1tb2RlbHMvJylbMV0uc3BsaXQoJyI+JylbMF0NCgkJaWYgIi0iIGluIGNhbm9uaWNhbDoNCgkJCWNhbm9uaWNhbD1jYW5vbmljYWwuc3BsaXQoIi0iKVstMV0NCgkjaWYgCQkNCglmaWxlLmNsb3NlKCkJDQoJcmV0dXJuIGNhbm9uaWNhbA0KCQkJCQkJCQkJCQ0KZGVmIFBhcnNlcihwYXRoKToNCglnbG9iYWwgc3lzLE1BVEVSSUFMUyxJTUFHRVMsTEFTVE5PREVOQU1FLGxvZyxza2lwZGVjb2RlLGZpbGVuYW1lDQoJbG9nPW9wZW4oJ2xvZy50eHQnLCd3JykNCglMQVNUTk9ERU5BTUU9Tm9uZQ0KCU1BVEVSSUFMUz17fQ0KCUlNQUdFUz17fQ0KCQ0KCQ0KCWZpbGVuYW1lPXBhdGgNCglzeXM9U3lzKGZpbGVuYW1lKQ0KCW9zLnN5c3RlbSgiY2xzIikNCglleHQ9ZmlsZW5hbWUuc3BsaXQoJy4nKVstMV0ubG93ZXIoKQ0KCWlmIGV4dD09J2d6JzoNCgkJb3NnPXN5cy5kaXIrb3Muc2VwKydmaWxlLm9zZ2pzJw0KCQlpZiBvcy5wYXRoLmV4aXN0cyhvc2cpPT1GYWxzZToNCgkJCWNtZD1DbWQoKQ0KCQkJY21kLmlucHV0PWZpbGVuYW1lDQoJCQljbWQuWklQPVRydWUNCgkJCWNtZC5ydW4oKQ0KCQkJbW9kZWw9c3lzLmRpcitvcy5zZXArJ21vZGVsX2ZpbGUuYmluLmd6Jw0KCQkJaWYgb3MucGF0aC5leGlzdHMobW9kZWwpPT1UcnVlOg0KCQkJCWNtZD1DbWQoKQ0KCQkJCWNtZC5pbnB1dD1tb2RlbA0KCQkJCWNtZC5aSVA9VHJ1ZQ0KCQkJCWNtZC5ydW4oKQ0KCQkJb3NnUGFyc2VyKGZpbGVuYW1lLnNwbGl0KCcuZ3onKVswXSkNCgkJDQoJaWYgZXh0PT0nb3NnanMnOg0KCQlvc2dQYXJzZXIoZmlsZW5hbWUpDQoJaWYgZXh0PT0ndHh0JzoNCgkJb3NnUGFyc2VyKGZpbGVuYW1lKQ0KCWlmIGV4dCBpbiBbJ2h0bScsJ2h0bWwnXToNCgkJb3NnPXN5cy5kaXIrb3Muc2VwKydmaWxlLm9zZ2pzLmd6Jw0KCQlpZiBvcy5wYXRoLmV4aXN0cyhvc2cpPT1UcnVlOg0KCQkJY21kPUNtZCgpDQoJCQljbWQuaW5wdXQ9b3NnDQoJCQljbWQuWklQPVRydWUNCgkJCWNtZC5ydW4oKQ0KCQkJbW9kZWw9c3lzLmRpcitvcy5zZXArJ21vZGVsX2ZpbGUuYmluLmd6Jw0KCQllbHNlOg0KCQkJb3NnPXN5cy5kaXIrb3Muc2VwKydmaWxlLm9zZ2pzJw0KCQltb2RlbD1zeXMuZGlyK29zLnNlcCsnbW9kZWxfZmlsZS5iaW4uZ3onDQoJCWlmIG9zLnBhdGguZXhpc3RzKG1vZGVsKT09VHJ1ZToNCgkJCWNtZD1DbWQoKQ0KCQkJY21kLmlucHV0PW1vZGVsDQoJCQljbWQuWklQPVRydWUNCgkJCWNtZC5ydW4oKQ0KCQllbHNlOg0KCQkJbW9kZWw9c3lzLmRpcitvcy5zZXArJ21vZGVsX2ZpbGUuYmluJw0KCQlpZiBvcy5wYXRoLmV4aXN0cyhtb2RlbCk6DQoJCQ0KCQkJcmVzdWx0PTANCgkJCSNyZXN1bHQ9QmxlbmRlci5EcmF3LlB1cE1lbnUoIlNrZXRjaGZhYiBWaWV3ZXIgPyV0fFllc3xObyIpCQ0KCQkJaWYgcmVzdWx0PT0xOg0KCQkJCWNhbm9uaWNhbD1nZXRDYW5vbmljYWwoZmlsZW5hbWUpDQoJCQkJY2hyb21lRXhlPSJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXEdvb2dsZVxDaHJvbWVcQXBwbGljYXRpb25cY2hyb21lLmV4ZSINCgkJCQkjb3Muc3lzdGVtKGNocm9tZUV4ZSkNCgkJCQkjc3VicHJvY2Vzcy5Qb3BlbihbY2hyb21lRXhlLGZpbGVuYW1lXSkud2FpdCgpDQoJCQkJI3R4dD1odG0xK2h0bTIraHRtMw0KCQkJCXR4dD1vcGVuKCJza2V0Y2hmYWIuaHRtbCIsInciKQ0KCQkJCXR4dC53cml0ZShodG0xLnJlcGxhY2UoIiMiLCIiKSkNCgkJCQlpZiBjYW5vbmljYWwgaXMgbm90IE5vbmU6DQoJCQkJDQoJCQkJCXR4dC53cml0ZShjYW5vbmljYWwpDQoJCQkJZWxzZToJDQoJCQkJCSN0eHQud3JpdGUoaHRtMikNCgkJCQkJdHh0LndyaXRlKG9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkuc3BsaXQob3Muc2VwKVstMV0pDQoJCQkJdHh0LndyaXRlKGh0bTMpDQoJCQkJdHh0LmNsb3NlKCkNCgkJCQlzdWJwcm9jZXNzLlBvcGVuKFtjaHJvbWVFeGUsYmxlbmREaXIrb3Muc2VwKyJza2V0Y2hmYWIuaHRtbCJdKSMud2FpdCgpDQoJCQllbHNlOgkNCgkJCQ0KCQkJDQoJCQkJcmVzdWx0PTENCgkJCQlmaWxlU2l6ZT1vcy5wYXRoLmdldHNpemUobW9kZWwpDQoJCQkJI3Jlc3VsdD1CbGVuZGVyLkRyYXcuUHVwTWVudSgiaW1wb3J0ICIrc3RyKHJvdW5kKGZpbGVTaXplLzEwMDAwMDAuMCwxKSkrIiBNYiA/JXR8WWVzfE5vIikNCgkJCQkNCgkJCQlodG1QYXJzZXIoZmlsZW5hbWUpDQoJCQkJaWYgcmVzdWx0PT0xOgkNCgkJCQkJc2tpcGRlY29kZT0wDQoJCQkJCQ0KCQkJCQlpbmRleFJlc3VsdD0wDQoJCQkJCSNyZXN1bHQ9QmxlbmRlci5EcmF3LlB1cE1lbnUoImluZGljZSBwcm9ibGVtIisiID8ldHxZZXN8Tm8iKQ0KCQkJCQlpZiBpbmRleFJlc3VsdD09MToNCgkJCQkJCXNraXBkZWNvZGU9MQ0KCQkJCQkJDQoJCQkJCQ0KCQkJCQkNCgkJCQkJb3NnUGF0aD1zeXMuZGlyK29zLnNlcCsnZmlsZS5vc2dqcycNCgkJCQkJaWYgb3MucGF0aC5leGlzdHMob3NnUGF0aCk9PVRydWU6DQoJCQkJCQlvc2dQYXJzZXIob3NnUGF0aCkNCgkJCQkJCXBhc3MNCgkJCQkJZWxzZToNCgkJCQkJCW9zZ1BhdGg9c3lzLmRpcitvcy5zZXArJ2ZpbGUub3NnanMnDQoJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhvc2dQYXRoKT09VHJ1ZToNCgkJCQkJCQlvc2dQYXJzZXIob3NnUGF0aCkNCgkJCQkJCQlwYXNzCQ0KCQkJCQ0KCWlmIGV4dD09J2FjdGlvbic6DQoJCWZpbGU9b3BlbihmaWxlbmFtZSwncmInKQ0KCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQlhY3Rpb25QYXJzZXIoZmlsZW5hbWUsZykNCgkJZmlsZS5jbG9zZSgpDQoJbG9nLmNsb3NlKCkJDQoJCQ0KCQ0KIA0KbW9kZWxJRCA9IDANClBhcnNlcignLi97dGVtcFBhdGh9L2R1bW15Lmh0bWwnKQ=="));
			blenderScript = blenderScript.Replace("{tempPath}", tempDir);
			if (indexFix)
			{
				blenderScript = blenderScript.Replace("indexResult=0", "indexResult=1");
			}
			return blenderScript;
		}

		public static void WriteAnimatedPartial(string animName)
		{
			byte[] blenderScriptPartial = Convert.FromBase64String("aW1wb3J0IG5ld0dhbWVMaWINCmZyb20gbmV3R2FtZUxpYiBpbXBvcnQgKg0KaW1wb3J0IEJsZW5kZXINCg0KaW1wb3J0IGFycmF5DQppbXBvcnQgc3VicHJvY2Vzcw0KDQoNCmh0bTE9IiIiDQo8aGVhZD4NCiAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Imh0dHBzOi8vc3RhdGljLnNrZXRjaGZhYi5jb20vYXBpL3NrZXRjaGZhYi12aWV3ZXItMS4zLjAuanMiPjwvc2NyaXB0Pg0KICANCiAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9zaGFkZXJieXRlcy9Ta2V0Y2hmYWItVmlld2VyLUFQSS1VdGlsaXR5QHYyLjAuMC43L1NrZXRjaGZhYkFQSVV0aWxpdHkuanMiPjwvc2NyaXB0Pg0KICAgDQo8L2hlYWQ+DQoNCjxib2R5Pg0KICA8ZGl2IGNsYXNzPSJjZW50ZXItZGl2Ij4NCgk8aWZyYW1lIGlkPSJhcGktZnJhbWUiIHdpZHRoPSIxMDAwIiBoZWlnaHQ9IjU1MCIJIGFsbG93ZnVsbHNjcmVlbiBtb3phbGxvd2Z1bGxzY3JlZW49InRydWUiIHdlYmtpdGFsbG93ZnVsbHNjcmVlbj0idHJ1ZSI+PC9pZnJhbWU+DQogIDwvZGl2Pg0KICANCiAgPHNjcmlwdD4NCgkgIGZ1bmN0aW9uIG9uU2tldGNoZmFiVXRpbGl0eVJlYWR5KCl7DQoJCSBza2V0Y2hmYWJBUElVdGlsaXR5SW5zdGFuY2UucmVtb3ZlRXZlbnRMaXN0ZW5lcihza2V0Y2hmYWJBUElVdGlsaXR5SW5zdGFuY2UuRVZFTlRfSU5JVElBTElaRUQsIG9uU2tldGNoZmFiVXRpbGl0eVJlYWR5KTsNCgkJIC8vc29tZSBjb2RlIGhlcmUuLg0KCSAgfTsNCgkgIHZhciBza2V0Y2hmYWJBUElVdGlsaXR5SW5zdGFuY2UgPSBuZXcgU2tldGNoZmFiQVBJVXRpbGl0eSgiIyMjIiIiDQpodG0yPSIiImFmNTI4ZTNkZjVmNzY2Y2EwMTJmNWUwNjVjN2NiODEyIiIiDQpodG0zPSIiIiIsIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhcGktZnJhbWUiKSwgeyJhdXRvc3RhcnQiOiAxIH0pOw0KCSAgc2tldGNoZmFiQVBJVXRpbGl0eUluc3RhbmNlLmFkZEV2ZW50TGlzdGVuZXIoc2tldGNoZmFiQVBJVXRpbGl0eUluc3RhbmNlLkVWRU5UX0lOSVRJQUxJWkVELCBvblNrZXRjaGZhYlV0aWxpdHlSZWFkeSk7DQoJICBza2V0Y2hmYWJBUElVdGlsaXR5SW5zdGFuY2UuY3JlYXRlKCk7DQogICA8L3NjcmlwdD4NCiAgDQo8L2JvZHk+DQoiIiINCg0KDQoJDQpjbGFzcyBCaW5hcnlSZWFkZXIoZmlsZSk6DQoJIiIiZ2VuZXJhbCBCaW5hcnlSZWFkZXINCgkiIiINCglkZWYgX19pbml0X18oc2VsZiwgaW5wdXRGaWxlKToNCgkJc2VsZi5pbnB1dEZpbGU9aW5wdXRGaWxlDQoJCXNlbGYuZW5kaWFuPSc8Jw0KCQlzZWxmLmRlYnVnPUZhbHNlDQoJCXNlbGYuc3RyZWFtPXt9DQoJCXNlbGYubG9nZmlsZT1Ob25lDQoJCXNlbGYubG9nPUZhbHNlDQoJCXNlbGYuZGlybmFtZT1CbGVuZGVyLnN5cy5kaXJuYW1lKHNlbGYuaW5wdXRGaWxlLm5hbWUpDQoJCXNlbGYuYmFzZW5hbWU9QmxlbmRlci5zeXMuYmFzZW5hbWUoc2VsZi5pbnB1dEZpbGUubmFtZSkuc3BsaXQoJy4nKVswXQ0KCQlzZWxmLmV4dD1CbGVuZGVyLnN5cy5iYXNlbmFtZShzZWxmLmlucHV0RmlsZS5uYW1lKS5zcGxpdCgnLicpWy0xXQ0KCQlzZWxmLnhvcktleT1Ob25lDQoJCXNlbGYueG9yT2Zmc2V0PTANCgkJc2VsZi54b3JEYXRhPScnDQoJCXNlbGYubG9nc2tpcD1GYWxzZQ0KCQkNCglkZWYgY2xvc2Uoc2VsZik6DQoJCXNlbGYuaW5wdXRGaWxlLmNsb3NlKCkNCgkJDQoJZGVmIFhPUihzZWxmLGRhdGEpOg0KCQkJc2VsZi54b3JEYXRhPScnDQoJCQlmb3IgbSBpbiByYW5nZShsZW4oZGF0YSkpOg0KCQkJCWNoPW9yZCgJY2hyKGRhdGFbbV0gXiBzZWxmLnhvcktleVtzZWxmLnhvck9mZnNldF0pCSkNCgkJCQlzZWxmLnhvckRhdGErPXN0cnVjdC5wYWNrKCdCJyxjaCkNCgkJCQlpZiBzZWxmLnhvck9mZnNldD09bGVuKHNlbGYueG9yS2V5KS0xOg0KCQkJCQlzZWxmLnhvck9mZnNldD0wDQoJCQkJZWxzZToNCgkJCQkJc2VsZi54b3JPZmZzZXQrPTEJDQoJCQ0KCQkNCglkZWYgbG9nT3BlbihzZWxmKToJDQoJCWxvZ0Rpcj0nbG9nJw0KCQlpZiBvcy5wYXRoLmV4aXN0cyhsb2dEaXIpPT1GYWxzZTpvcy5tYWtlZGlycyhsb2dEaXIpDQoJCXNlbGYubG9nPVRydWUNCgkJc2VsZi5sb2dmaWxlPW9wZW4obG9nRGlyK29zLnNlcCtvcy5wYXRoLmJhc2VuYW1lKHNlbGYuaW5wdXRGaWxlLm5hbWUpKycubG9nJywndycpDQoJZGVmIGxvZ0Nsb3NlKHNlbGYpOg0KCQlzZWxmLmxvZz1GYWxzZQ0KCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmU6DQoJCQlzZWxmLmxvZ2ZpbGUuY2xvc2UoKQ0KCWRlZiBsb2dXcml0ZShzZWxmLGRhdGEpOg0KCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmU6DQoJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoc3RyKGRhdGEpKydcbicpDQoJCWVsc2U6DQoJCQlwcmludCAnV0FSTklORzogbm8gbG9nJw0KCQkJDQoJZGVmIGRpcm5hbWUoc2VsZik6DQoJCXJldHVybiBCbGVuZGVyLnN5cy5kaXJuYW1lKHNlbGYuaW5wdXRGaWxlLm5hbWUpDQoJZGVmIGJhc2VuYW1lKHNlbGYpOg0KCQlyZXR1cm4gQmxlbmRlci5zeXMuYmFzZW5hbWUoc2VsZi5pbnB1dEZpbGUubmFtZSkuc3BsaXQoJy4nKVswXQ0KCWRlZiBleHQoc2VsZik6DQoJCXJldHVybiBCbGVuZGVyLnN5cy5iYXNlbmFtZShzZWxmLmlucHV0RmlsZS5uYW1lKS5zcGxpdCgnLicpWy0xXQ0KCQkNCgkJDQoJZGVmIHEoc2VsZixuKToNCgkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbioncScsc2VsZi5pbnB1dEZpbGUucmVhZChuKjgpKQ0KCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJcHJpbnQgJ3EnLGRhdGENCgkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihvZmZzZXQpKycJJytzdHIoZGF0YSkrJ1xuJykNCgkJcmV0dXJuIGRhdGENCgkJDQoJZGVmIGkoc2VsZixuKToNCgkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3JiJzoNCgkJCW9mZnNldD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJCWlmIHNlbGYueG9yS2V5IGlzIE5vbmU6DQoJCQkJI2RhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidpJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qNCkpDQoJCQkJCQkNCgkJCQlkYXRhID0gYXJyYXkuYXJyYXkoJ2knKQ0KCQkJCWRhdGEuZnJvbWZpbGUoc2VsZi5pbnB1dEZpbGUsIG4pDQoJCQkJaWYgc2VsZi5lbmRpYW4gPT0gIj4iOiBkYXRhLmJ5dGVzd2FwKCkNCgkJCQkNCgkJCQkNCgkJCWVsc2U6DQoJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qNConQicsc2VsZi5pbnB1dEZpbGUucmVhZChuKjQpKQ0KCQkJCXNlbGYuWE9SKGRhdGEpDQoJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2knLHNlbGYueG9yRGF0YSkJDQoJCQkJCQ0KCQkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCQlwcmludCAnaScsZGF0YQ0KCQkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3N0cihkYXRhKSsnXG4nKQ0KCQkJcmV0dXJuIGRhdGENCgkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3diJzoNCgkJCWZvciBtIGluIHJhbmdlKGxlbihuKSk6DQoJCQkJZGF0YT1zdHJ1Y3QucGFjayhzZWxmLmVuZGlhbisnaScsblttXSkNCgkJCQlzZWxmLmlucHV0RmlsZS53cml0ZShkYXRhKQ0KCQ0KCWRlZiBJKHNlbGYsbik6DQoJCW9mZnNldD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJaWYgc2VsZi54b3JLZXkgaXMgTm9uZToNCgkJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidJJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qNCkpDQoJCWVsc2U6DQoJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbio0KidCJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qNCkpDQoJCQlzZWxmLlhPUihkYXRhKQ0KCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ0knLHNlbGYueG9yRGF0YSkJDQoJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQlwcmludCAnSScsZGF0YQ0KCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3N0cihkYXRhKSsnXG4nKQ0KCQlyZXR1cm4gZGF0YQ0KCQ0KCWRlZiBCKHNlbGYsbik6DQoJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSdyYic6DQoJCQlvZmZzZXQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCQlpZiBzZWxmLnhvcktleSBpcyBOb25lOg0KCQkJCSNkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionQicsc2VsZi5pbnB1dEZpbGUucmVhZChuKSkNCgkJCQkNCgkJCQlkYXRhID0gYXJyYXkuYXJyYXkoJ0InKQ0KCQkJCWRhdGEuZnJvbWZpbGUoc2VsZi5pbnB1dEZpbGUsIG4pDQoJCQkJaWYgc2VsZi5lbmRpYW4gPT0gIj4iOiBkYXRhLmJ5dGVzd2FwKCkNCgkJCQkNCgkJCQkNCgkJCWVsc2U6DQoJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ0InLHNlbGYuaW5wdXRGaWxlLnJlYWQobikpDQoJCQkJc2VsZi5YT1IoZGF0YSkNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionQicsc2VsZi54b3JEYXRhKQkNCgkJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQkJcHJpbnQgJ0InLGRhdGENCgkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihvZmZzZXQpKycJJytzdHIoZGF0YSkrJ1xuJykNCgkJCXJldHVybiBkYXRhDQoJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSd3Yic6DQoJCQlmb3IgbSBpbiByYW5nZShsZW4obikpOg0KCQkJCWRhdGE9c3RydWN0LnBhY2soc2VsZi5lbmRpYW4rJ0InLG5bbV0pDQoJCQkJc2VsZi5pbnB1dEZpbGUud3JpdGUoZGF0YSkNCglkZWYgYihzZWxmLG4pOg0KCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0ncmInOg0KCQkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkJaWYgc2VsZi54b3JLZXkgaXMgTm9uZToNCgkJCQkjZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2InLHNlbGYuaW5wdXRGaWxlLnJlYWQobikpDQoJCQkJZGF0YSA9IGFycmF5LmFycmF5KCdiJykNCgkJCQlkYXRhLmZyb21maWxlKHNlbGYuaW5wdXRGaWxlLCBuKQ0KCQkJCWlmIHNlbGYuZW5kaWFuID09ICI+IjogZGF0YS5ieXRlc3dhcCgpDQoJCQllbHNlOg0KCQkJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidiJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4pKQ0KCQkJCXNlbGYuWE9SKGRhdGEpDQoJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2InLHNlbGYueG9yRGF0YSkJDQoJCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJCXByaW50ICdiJyxkYXRhDQoJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIob2Zmc2V0KSsnCScrc3RyKGRhdGEpKydcbicpDQoJCQlyZXR1cm4gZGF0YQ0KCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0nd2InOg0KCQkJZm9yIG0gaW4gcmFuZ2UobGVuKG4pKToNCgkJCQlkYXRhPXN0cnVjdC5wYWNrKHNlbGYuZW5kaWFuKydiJyxuW21dKQ0KCQkJCXNlbGYuaW5wdXRGaWxlLndyaXRlKGRhdGEpDQoJZGVmIGgoc2VsZixuKToNCgkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3JiJzoNCgkJCW9mZnNldD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJCWlmIHNlbGYueG9yS2V5IGlzIE5vbmU6DQoJCQkJI2RhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidoJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qMikpDQoJCQkJDQoJCQkJZGF0YSA9IGFycmF5LmFycmF5KCdoJykNCgkJCQlkYXRhLmZyb21maWxlKHNlbGYuaW5wdXRGaWxlLCBuKQ0KCQkJCWlmIHNlbGYuZW5kaWFuID09ICI+IjogZGF0YS5ieXRlc3dhcCgpDQoJCQkJDQoJCQkJDQoJCQllbHNlOg0KCQkJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKjIqJ0InLHNlbGYuaW5wdXRGaWxlLnJlYWQobioyKSkNCgkJCQlzZWxmLlhPUihkYXRhKQ0KCQkJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbituKidoJyxzZWxmLnhvckRhdGEpCQ0KCQkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCQlwcmludCAnaCcsZGF0YQ0KCQkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3N0cihkYXRhKSsnXG4nKQ0KCQkJcmV0dXJuIGRhdGENCgkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3diJzoNCgkJCWZvciBtIGluIHJhbmdlKGxlbihuKSk6DQoJCQkJZGF0YT1zdHJ1Y3QucGFjayhzZWxmLmVuZGlhbisnaCcsblttXSkNCgkJCQlzZWxmLmlucHV0RmlsZS53cml0ZShkYXRhKQ0KCWRlZiBIKHNlbGYsbik6DQoJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSdyYic6DQoJCQlvZmZzZXQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCQlpZiBzZWxmLnhvcktleSBpcyBOb25lOg0KCQkJCSNkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionSCcsc2VsZi5pbnB1dEZpbGUucmVhZChuKjIpKQ0KCQkJCQ0KCQkJCWRhdGEgPSBhcnJheS5hcnJheSgnSCcpDQoJCQkJZGF0YS5mcm9tZmlsZShzZWxmLmlucHV0RmlsZSwgbikNCgkJCQlpZiBzZWxmLmVuZGlhbiA9PSAiPiI6IGRhdGEuYnl0ZXN3YXAoKQ0KCQkJCQ0KCQkJCQ0KCQkJZWxzZToNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbioyKidCJyxzZWxmLmlucHV0RmlsZS5yZWFkKG4qMikpDQoJCQkJc2VsZi5YT1IoZGF0YSkNCgkJCQlkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionSCcsc2VsZi54b3JEYXRhKQkNCgkJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQkJcHJpbnQgJ0gnLGRhdGENCgkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihvZmZzZXQpKycJJytzdHIoZGF0YSkrJ1xuJykNCgkJCXJldHVybiBkYXRhDQoJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSd3Yic6DQoJCQlmb3IgbSBpbiByYW5nZShsZW4obikpOg0KCQkJCWRhdGE9c3RydWN0LnBhY2soc2VsZi5lbmRpYW4rJ0gnLG5bbV0pDQoJCQkJc2VsZi5pbnB1dEZpbGUud3JpdGUoZGF0YSkNCglkZWYgZihzZWxmLG4pOg0KCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0ncmInOg0KCQkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkJaWYgc2VsZi54b3JLZXkgaXMgTm9uZToNCgkJCQkjZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2YnLHNlbGYuaW5wdXRGaWxlLnJlYWQobio0KSkNCgkJCQkNCgkJCQlkYXRhID0gYXJyYXkuYXJyYXkoJ2YnKQ0KCQkJCWRhdGEuZnJvbWZpbGUoc2VsZi5pbnB1dEZpbGUsIG4pDQoJCQkJaWYgc2VsZi5lbmRpYW4gPT0gIj4iOiBkYXRhLmJ5dGVzd2FwKCkNCgkJCQkNCgkJCWVsc2U6DQoJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qNConQicsc2VsZi5pbnB1dEZpbGUucmVhZChuKjQpKQ0KCQkJCXNlbGYuWE9SKGRhdGEpDQoJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2YnLHNlbGYueG9yRGF0YSkJDQoJCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJCXByaW50ICdmJyxkYXRhDQoJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIob2Zmc2V0KSsnCScrc3RyKGRhdGEpKydcbicpDQoJCQlyZXR1cm4gZGF0YQ0KCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0nd2InOg0KCQkJZm9yIG0gaW4gcmFuZ2UobGVuKG4pKToNCgkJCQlkYXRhPXN0cnVjdC5wYWNrKHNlbGYuZW5kaWFuKydmJyxuW21dKQ0KCQkJCXNlbGYuaW5wdXRGaWxlLndyaXRlKGRhdGEpDQoJZGVmIGQoc2VsZixuKToNCgkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3JiJzoNCgkJCW9mZnNldD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJCWlmIHNlbGYueG9yS2V5IGlzIE5vbmU6DQoJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2QnLHNlbGYuaW5wdXRGaWxlLnJlYWQobio4KSkNCgkJCWVsc2U6DQoJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qNConQicsc2VsZi5pbnB1dEZpbGUucmVhZChuKjgpKQ0KCQkJCXNlbGYuWE9SKGRhdGEpDQoJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2QnLHNlbGYueG9yRGF0YSkJDQoJCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJCXByaW50ICdkJyxkYXRhDQoJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIob2Zmc2V0KSsnCScrc3RyKGRhdGEpKydcbicpDQoJCQlyZXR1cm4gZGF0YQ0KCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0nd2InOg0KCQkJZm9yIG0gaW4gcmFuZ2UobGVuKG4pKToNCgkJCQlkYXRhPXN0cnVjdC5wYWNrKHNlbGYuZW5kaWFuKydkJyxuW21dKQ0KCQkJCXNlbGYuaW5wdXRGaWxlLndyaXRlKGRhdGEpDQoJZGVmIGhhbGYoc2VsZixuLGg9J2gnKToNCgkJYXJyYXkgPSBbXSANCgkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQlmb3IgaWQgaW4gcmFuZ2Uobik6IA0KCQkJI2FycmF5LmFwcGVuZChjb252ZXJ0aGFsZjJmbG9hdChzdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuKydIJyxzZWxmLmlucHV0RmlsZS5yZWFkKDIpKVswXSkpDQoJCQlhcnJheS5hcHBlbmQoY29udmVydGhhbGYyZmxvYXQoc3RydWN0LnVucGFjayhzZWxmLmVuZGlhbitoLHNlbGYuaW5wdXRGaWxlLnJlYWQoMikpWzBdKSkNCgkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCXByaW50ICdoYWxmJyxhcnJheQ0KCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3N0cihhcnJheSkrJ1xuJykNCgkJcmV0dXJuIGFycmF5DQoJCQ0KCWRlZiBzaG9ydChzZWxmLG4saD0naCcsZXhwPTEyKToNCgkJYXJyYXkgPSBbXSANCgkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQlmb3IgaWQgaW4gcmFuZ2Uobik6IA0KCQkJYXJyYXkuYXBwZW5kKHN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4raCxzZWxmLmlucHV0RmlsZS5yZWFkKDIpKVswXSoyKiotZXhwKQ0KCQkJI2FycmF5LmFwcGVuZChzZWxmLkgoMSlbMF0qMioqLWV4cCkNCgkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCXByaW50ICdzaG9ydCcsYXJyYXkNCgkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihvZmZzZXQpKycJJytzdHIoYXJyYXkpKydcbicpDQoJCXJldHVybiBhcnJheQ0KCQkNCglkZWYgaTEyKHNlbGYsbik6DQoJCWFycmF5ID0gW10gDQoJCW9mZnNldD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJZm9yIGlkIGluIHJhbmdlKG4pOiANCgkJCWlmIHNlbGYuZW5kaWFuPT0nPic6DQoJCQkJdmFyPSdceDAwJytzZWxmLmlucHV0RmlsZS5yZWFkKDMpDQoJCQlpZiBzZWxmLmVuZGlhbj09JzwnOg0KCQkJCXZhcj1zZWxmLmlucHV0RmlsZS5yZWFkKDMpKydceDAwJw0KCQkJYXJyYXkuYXBwZW5kKHN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rJ2knLHZhcilbMF0pDQoJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQlwcmludCBhcnJheQ0KCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3N0cihhcnJheSkrJ1xuJykNCgkJcmV0dXJuIGFycmF5DQoJCQ0KCQkNCgkJDQoJZGVmIGZpbmQoc2VsZix2YXIpOiANCgkJc3RhcnQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCXM9JycNCgkJd2hpbGUoVHJ1ZSk6DQoJCQljPXNlbGYuaW5wdXRGaWxlLnJlYWQoMSkNCgkJCSNwcmludCBjDQoJCQlpZiBjPT12YXJbMF06DQoJCQkJaWYgbGVuKHZhcik+MToNCgkJCQkJZm9yIG0gaW4gcmFuZ2UoMSxsZW4odmFyKSk6DQoJCQkJCQljPXNlbGYuaW5wdXRGaWxlLnJlYWQoMSkNCgkJCQkJCWlmIGMhPXZhclttXToNCgkJCQkJCQlicmVhaw0KCQkJCQlpZiBtPT1sZW4odmFyKS0xOg0KCQkJCQkJYnJlYWsNCgkJCQllbHNlOg0KCQkJCQlicmVhaw0KCQkJZWxzZToJDQoJCQkJcys9YwkNCgkJCQkJCQ0KCQkNCgkJDQoJCQ0KCQkNCgkJI2lmIHNlbGYubG9nPT1UcnVlOg0KCQkjCWlmIHNlbGYubG9nZmlsZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5sb2dza2lwIGlzIG5vdCBUcnVlOg0KCQkjCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihzdGFydCkrJwknK3MrJ1xuJykNCgkJcmV0dXJuIHMJDQoJDQoJZGVmIGZpbmQxKHNlbGYsdmFyLHNpemU9OTk5KTogDQoJCQ0KCQlzdGFydD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJcz0nJw0KCQl3aGlsZShUcnVlKToNCgkJCWRhdGE9c2VsZi5pbnB1dEZpbGUucmVhZChzaXplKQ0KCQkJb2ZmPWRhdGEuZmluZCh2YXIpDQoJCQkjcHJpbnQgb2ZmDQoJCQlpZiBvZmY+PTA6DQoJCQkJcys9ZGF0YVs6b2ZmXQ0KCQkJCXNlbGYuaW5wdXRGaWxlLnNlZWsoc3RhcnQrb2ZmK2xlbih2YXIpKQ0KCQkJCSNwcmludCAnem5hbGV6aW9ubycsdmFyLCdvZmZzZXQ9JyxzZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJCQlicmVhaw0KCQkJZWxzZToNCgkJCQlzKz1kYXRhDQoJCQkJc3RhcnQrPXNpemUNCgkJCSNwcmludCBzZWxmLmlucHV0RmlsZS50ZWxsKCkJLHNlbGYuZmlsZVNpemUoKQ0KCQkJaWYgc2VsZi5pbnB1dEZpbGUudGVsbCgpPj1zZWxmLmZpbGVTaXplKCk6YnJlYWsJDQoJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQlwcmludCBzDQoJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIoc3RhcnQpKycJJytzKydcbicpDQoJCXJldHVybiBzCQ0KCQkNCglkZWYgZmluZDEwKHNlbGYsdmFyKTogDQoJCQ0KCQlzdGFydD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJcz0nJw0KCQlkYXRhPXNlbGYuaW5wdXRGaWxlLnJlYWQoKQ0KCQlvZmY9ZGF0YS5maW5kKHZhcikNCgkJaWYgb2ZmPj0wOg0KCQkJcys9ZGF0YVs6b2ZmXQ0KCQkJc2VsZi5pbnB1dEZpbGUuc2VlayhzdGFydCtvZmYrbGVuKHZhcikpDQoJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJc2VsZi5sb2dmaWxlLndyaXRlKCdvZmZzZXQgJytzdHIoc3RhcnQpKycJJytzKydcbicpDQoJCXJldHVybiBzCQ0KCQ0KCWRlZiBmaW5kQWxsKHNlbGYsdmFyLHNpemU9MTAwKTogDQoJCWxpc3Q9W10NCgkJd2hpbGUoVHJ1ZSk6DQoJCQlzdGFydD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJCWRhdGE9c2VsZi5pbnB1dEZpbGUucmVhZChzaXplKQ0KCQkJb2ZmPWRhdGEuZmluZCh2YXIpDQoJCQkjcHJpbnQgb2ZmLHNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkJaWYgb2ZmPj0wOg0KCQkJCWxpc3QuYXBwZW5kKHN0YXJ0K29mZikNCgkJCQkjcHJpbnQgc3RhcnQrb2ZmDQoJCQkJc2VsZi5pbnB1dEZpbGUuc2VlayhzdGFydCtvZmYrbGVuKHZhcikpDQoJCQkJI2lmIHNlbGYuZGVidWc9PVRydWU6DQoJCQkJIwlwcmludCBzdGFydCtvZmYNCgkJCWVsc2U6DQoJCQkJc3RhcnQrPXNpemUNCgkJCQlzZWxmLmlucHV0RmlsZS5zZWVrKHN0YXJ0KQ0KCQkJaWYJc2VsZi5pbnB1dEZpbGUudGVsbCgpPnNlbGYuZmlsZVNpemUoKToNCgkJCQlicmVhaw0KCQlyZXR1cm4gbGlzdAkNCgkJDQoJCQ0KCWRlZiBmaW5kY2hhcihzZWxmLHZhcik6DQoJCW9mZnNldD1zZWxmLmlucHV0RmlsZS5maW5kKHZhcikNCgkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCXByaW50IHZhciwnem5hbGV6aW9ubycsb2Zmc2V0DQoJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJc2VsZi5sb2dmaWxlLndyaXRlKHZhcisnIHpuYWxlemlvbm8gJytzdHIob2Zmc2V0KSsnXG4nKQ0KCQlyZXR1cm4gb2Zmc2V0CQ0KCQkNCgkJDQoJZGVmIGZpbGVTaXplKHNlbGYpOg0KCQliYWNrPXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQlzZWxmLmlucHV0RmlsZS5zZWVrKDAsMikNCgkJdGVsbD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJI3NlbGYuaW5wdXRGaWxlLnNlZWsoMCkNCgkJc2VsZi5pbnB1dEZpbGUuc2VlayhiYWNrKQ0KCQlyZXR1cm4gdGVsbA0KCQkNCglkZWYgc2VlayhzZWxmLG9mZixhPTApOg0KCQlzZWxmLmlucHV0RmlsZS5zZWVrKG9mZixhKQ0KCQ0KCWRlZiBzZWVrcGFkKHNlbGYscGFkLHR5cGU9MCk6DQoJCScnJyAxNi1ieXRlIGNodW5rIGFsaWdubWVudCcnJw0KCQlzaXplPXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQlzZWVrID0gKHBhZCAtIChzaXplICUgcGFkKSkgJSBwYWQNCgkJaWYgdHlwZT09MToNCgkJCWlmIHNlZWs9PTA6DQoJCQkJc2Vlays9cGFkDQoJCXNlbGYuaW5wdXRGaWxlLnNlZWsoc2VlaywgMSkNCgkJDQoJZGVmIHJlYWQoc2VsZixjb3VudCk6DQoJCWJhY2s9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCWlmIHNlbGYueG9yS2V5IGlzIE5vbmU6DQoJCQlyZXR1cm4gc2VsZi5pbnB1dEZpbGUucmVhZChjb3VudCkNCgkJZWxzZToNCgkJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbitjb3VudConQicsc2VsZi5pbnB1dEZpbGUucmVhZChjb3VudCkpDQoJCQlzZWxmLlhPUihkYXRhKQ0KCQkJcmV0dXJuIHNlbGYueG9yRGF0YQ0KCQkJDQoJDQoJCQ0KCWRlZiB3cml0ZShzZWxmLHN0cmluZyk6DQoJCXNlbGYuaW5wdXRGaWxlLndyaXRlKHN0cmluZykNCgkJDQoJZGVmIHRlbGwoc2VsZik6DQoJCXZhbD1zZWxmLmlucHV0RmlsZS50ZWxsKCkNCgkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCXByaW50ICdjdXJyZW50IG9mZnNldCBpcycsdmFsDQoJCXJldHVybiB2YWwJDQoJCQ0KCWRlZiB3b3JkKHNlbGYsbG9uZyk6DQoJCWlmIGxvbmc8MTAwMDA6DQoJCQlpZiBzZWxmLmlucHV0RmlsZS5tb2RlPT0ncmInOiANCgkJCQlvZmZzZXQ9c2VsZi5pbnB1dEZpbGUudGVsbCgpDQoJCQkJcz0nJw0KCQkJCWZvciBqIGluIHJhbmdlKDAsbG9uZyk6IA0KCQkJCQkNCgkJCQkJDQoJCQkJCWlmIHNlbGYueG9yS2V5IGlzIE5vbmU6DQoJCQkJCQlsaXQgPSAgc3RydWN0LnVucGFjaygnYycsc2VsZi5pbnB1dEZpbGUucmVhZCgxKSlbMF0NCgkJCQkJCSNkYXRhPXN0cnVjdC51bnBhY2soc2VsZi5lbmRpYW4rbionaScsc2VsZi5pbnB1dEZpbGUucmVhZChuKjQpKQ0KCQkJCQllbHNlOg0KCQkJCQkJZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuKydCJyxzZWxmLmlucHV0RmlsZS5yZWFkKDEpKQ0KCQkJCQkJc2VsZi5YT1IoZGF0YSkNCgkJCQkJCWxpdD1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuKydjJyxzZWxmLnhvckRhdGEpWzBdDQoJCQkJCQ0KCQkJCQkJI2xpdCA9CXN0cnVjdC51bnBhY2soJ2MnLHNlbGYuaW5wdXRGaWxlLnJlYWQoMSkpWzBdDQoJCQkJCQ0KCQkJCQkNCgkJCQkJDQoJCQkJCWlmIG9yZChsaXQpIT0wOg0KCQkJCQkJcys9bGl0DQoJCQkJaWYgc2VsZi5kZWJ1Zz09VHJ1ZToNCgkJCQkJcHJpbnQgcw0KCQkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCQlpZiBzZWxmLmxvZ2ZpbGUgaXMgbm90IE5vbmUgYW5kIHNlbGYubG9nc2tpcCBpcyBub3QgVHJ1ZToNCgkJCQkJCXNlbGYubG9nZmlsZS53cml0ZSgnb2Zmc2V0ICcrc3RyKG9mZnNldCkrJwknK3MrJ1xuJykNCgkJCQlyZXR1cm4gcw0KCQkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3diJzoNCgkJCQkjZGF0YT1zZWxmLmlucHV0RmlsZS5yZWFkKGxvbmcpDQoJCQkJc2VsZi5pbnB1dEZpbGUud3JpdGUobG9uZykNCgkJCSNyZXR1cm4gMAkNCgkJZWxzZToNCgkJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQkJcHJpbnQgJ1dBUk5JTkc6dG9vIGxvbmcnDQoJCQkjcmV0dXJuIDENCgkJDQoJCQ0KCQkNCglkZWYgcyhzZWxmLGxvbmcpOg0KCQlpZiBsb25nPDEwMDAwOg0KCQkJaWYgc2VsZi5pbnB1dEZpbGUubW9kZT09J3JiJzogDQoJCQkJb2Zmc2V0PXNlbGYuaW5wdXRGaWxlLnRlbGwoKQ0KCQkJCXM9JycNCgkJCQlmb3IgaiBpbiByYW5nZSgwLGxvbmcpOiANCgkJCQkJDQoJCQkJCQ0KCQkJCQlpZiBzZWxmLnhvcktleSBpcyBOb25lOg0KCQkJCQkJbGl0ID0gIHN0cnVjdC51bnBhY2soJ2MnLHNlbGYuaW5wdXRGaWxlLnJlYWQoMSkpWzBdDQoJCQkJCQkjZGF0YT1zdHJ1Y3QudW5wYWNrKHNlbGYuZW5kaWFuK24qJ2knLHNlbGYuaW5wdXRGaWxlLnJlYWQobio0KSkNCgkJCQkJZWxzZToNCgkJCQkJCWRhdGE9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbisnQicsc2VsZi5pbnB1dEZpbGUucmVhZCgxKSkNCgkJCQkJCXNlbGYuWE9SKGRhdGEpDQoJCQkJCQlsaXQ9c3RydWN0LnVucGFjayhzZWxmLmVuZGlhbisnYycsc2VsZi54b3JEYXRhKVswXQ0KCQkJCQkNCgkJCQkJCSNsaXQgPQlzdHJ1Y3QudW5wYWNrKCdjJyxzZWxmLmlucHV0RmlsZS5yZWFkKDEpKVswXQ0KCQkJCQkNCgkJCQkJDQoJCQkJCQ0KCQkJCQlpZiBvcmQobGl0KSE9MDoNCgkJCQkJCXMrPWxpdA0KCQkJCWlmIHNlbGYuZGVidWc9PVRydWU6DQoJCQkJCXByaW50IHMNCgkJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQkJaWYgc2VsZi5sb2dmaWxlIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxvZ3NraXAgaXMgbm90IFRydWU6DQoJCQkJCQlzZWxmLmxvZ2ZpbGUud3JpdGUoJ29mZnNldCAnK3N0cihvZmZzZXQpKycJJytzKydcbicpDQoJCQkJcmV0dXJuIHMNCgkJCWlmIHNlbGYuaW5wdXRGaWxlLm1vZGU9PSd3Yic6DQoJCQkJI2RhdGE9c2VsZi5pbnB1dEZpbGUucmVhZChsb25nKQ0KCQkJCXNlbGYuaW5wdXRGaWxlLndyaXRlKGxvbmcpDQoJCQkjcmV0dXJuIDAJDQoJCWVsc2U6DQoJCQlpZiBzZWxmLmRlYnVnPT1UcnVlOg0KCQkJCXByaW50ICdXQVJOSU5HOnRvbyBsb25nJw0KCQkJI3JldHVybiAxDQoJCQ0KCQkNCglkZWYgU3RyZWFtKHNlbGYsc3RyZWFtX25hbWUsZWxlbWVudF9jb3VudCxlbGVtZW50X3NpemUpOg0KCQlzZWxmLmlucHV0RmlsZS5zZWVrKGVsZW1lbnRfY291bnQqZWxlbWVudF9zaXplLDEpDQoJCXNlbGYuc3RyZWFtW3N0cmVhbV9uYW1lXVsnb2Zmc2V0J109b2Zmc2V0DQoJCXNlbGYuc3RyZWFtW3N0cmVhbV9uYW1lXVsnZWxlbWVudF9jb3VudCddPWVsZW1lbnRfY291bnQJDQoJCXNlbGYuc3RyZWFtW3N0cmVhbV9uYW1lXVsnZWxlbWVudF9zaXplJ109ZWxlbWVudF9zaXplCQ0KCQkNCg0KDQoNCmRlZiBnZXRNYXROYW1lKHlzLHBhcmVudCk6DQoJI3ByaW50ICdnZXRNYXROYW1lJw0KCW1hdE5hbWU9Tm9uZQ0KCWlmCW1hdE5hbWUgbm90IGluIE1BVEVSSUFMUy5rZXlzKCk6DQoJCVVuaXF1ZUlEPXlzLmdldChwYXJlbnQsJyJVbmlxdWVJRCInKQ0KCQlpZiBVbmlxdWVJRDoNCgkJCXZhbHVlcz15cy52YWx1ZXMoVW5pcXVlSURbMF0uaGVhZGVyLCdzJykNCgkJCWlmIGxlbih2YWx1ZXMpPjE6DQoJCQkJaWYgJyInIGluIHZhbHVlc1sxXSBhbmQgJ18nIGluIHZhbHVlc1sxXToNCgkJCQkJbWF0TmFtZT12YWx1ZXNbMV0uc3BsaXQoJyInKVszXS5zcGxpdCgnXycpWy0yXQ0KCQ0KCXJnYmE9Tm9uZQkNCglBdHRyaWJ1dGVMaXN0PXlzLmdldChwYXJlbnQsJyJBdHRyaWJ1dGVMaXN0IicpCQ0KCWlmIEF0dHJpYnV0ZUxpc3Q6CQkJDQoJCXZhbHVlcz15cy52YWx1ZXMoQXR0cmlidXRlTGlzdFswXS5oZWFkZXIsJzonKQ0KCQlVbmlxdWVJRD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJVbmlxdWVJRCInLCdpJykNCgkJRGlmZnVzZT15cy5nZXQocGFyZW50LCciRGlmZnVzZSInKQ0KCQlpZiBEaWZmdXNlOg0KCQkJcmdiYT15cy52YWx1ZXMoRGlmZnVzZVswXS5kYXRhLCdmJykJCQkJDQoJCWlmCW1hdE5hbWUgbm90IGluIE1BVEVSSUFMUy5rZXlzKCk6DQoJCQlNYXRlcmlhbD15cy5nZXQoQXR0cmlidXRlTGlzdFswXSwnIm9zZy5NYXRlcmlhbCInKQ0KCQkJaWYgTWF0ZXJpYWw6CQ0KCQkJCWZvciBhIGluIE1hdGVyaWFsWzBdLmNoaWxkcmVuOg0KCQkJCQlpZiAnIk5hbWUiJyBpbiBhLmhlYWRlcjoJCQkJCQkJCQ0KCQkJCQkJc3BsaXRzPWEuaGVhZGVyLnNwbGl0KCciJykNCgkJCQkJCWlmIGxlbihzcGxpdHMpPjQ6DQoJCQkJCQkJbWF0TmFtZT1zcGxpdHNbNV0NCgkJCQkJCQlpZiAnOicgaW4gbWF0TmFtZToNCgkJCQkJCQkJbWF0TmFtZT1tYXROYW1lLnJlcGxhY2UoJzonLCcnKQ0KCQkJCQkJCW1vZGVsLm1hdExpc3RbVW5pcXVlSURdPW1hdE5hbWUJDQoJCQkJDQoJaWYJbWF0TmFtZSBub3QgaW4gTUFURVJJQUxTLmtleXMoKToJDQoJCVN0YXRlU2V0PXlzLmdldChwYXJlbnQsJyJTdGF0ZVNldCInKQ0KCQlpZiBTdGF0ZVNldDoNCgkJCW9zZ1N0YXRlU2V0PXlzLmdldChTdGF0ZVNldFswXSwnIm9zZy5TdGF0ZVNldCInKQ0KCQkJaWYgb3NnU3RhdGVTZXQ6CQ0KCQkJCWlmIGxlbihvc2dTdGF0ZVNldFswXS5jaGlsZHJlbik+MDoNCgkJCQkJZm9yIGNoaWxkIGluIG9zZ1N0YXRlU2V0WzBdLmNoaWxkcmVuOgkJCQkNCgkJCQkJCXZhbHVlcz15cy52YWx1ZXMoY2hpbGQuaGVhZGVyLCc6JykNCgkJCQkJCWlmICciVW5pcXVlSUQiJyBpbiB2YWx1ZXMgYW5kICciTmFtZSInIGluIHZhbHVlczoNCgkJCQkJCQlVbmlxdWVJRD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJVbmlxdWVJRCInLCdpJykNCgkJCQkJCQltYXROYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJywnIiInKQ0KCQkJCQkJCW1vZGVsLm1hdExpc3RbVW5pcXVlSURdPW1hdE5hbWUNCgkJCQllbHNlOgkJCQkNCgkJCQkJdmFsdWVzPXlzLnZhbHVlcyhvc2dTdGF0ZVNldFswXS5kYXRhLCc6JykNCgkJCQkJaWYgJyJBdHRyaWJ1dGVMaXN0Iicgbm90IGluIHZhbHVlczoNCgkJCQkJCVVuaXF1ZUlEPXlzLmdldFZhbHVlKHZhbHVlcywnIlVuaXF1ZUlEIicsJ2knKQ0KCQkJCQkJaWYgVW5pcXVlSUQgaW4gbW9kZWwubWF0TGlzdDoNCgkJCQkJCQltYXROYW1lPW1vZGVsLm1hdExpc3RbVW5pcXVlSURdDQoJCQkNCglpZgltYXROYW1lOgkNCgkJaWYJbGVuKG1hdE5hbWUpPT0wOg0KCQkJbWF0TmFtZT0nUm9vdE5vZGUnDQoJCWlmICdceGVmJyBpbiBtYXROYW1lOg0KCQkJbWF0TmFtZT1tYXROYW1lLnNwbGl0KCdceGVmJylbMF0NCglkaWZmdXNlPU5vbmUJCQ0KCW5vcm1hbD1Ob25lCQ0KCXNwZWN1bGFyPU5vbmUNCgl0cmFucz1Ob25lCQ0KCWFvPU5vbmUNCglyZ2JDb2w9Tm9uZQ0KCXJnYlNwZWM9Tm9uZQ0KCQ0KCQ0KCQ0KCQ0KCQ0KCWlmIGxlbihNQVRFUklBTFMua2V5cygpKT09MToNCgkJCWtleT1NQVRFUklBTFMua2V5cygpWzBdDQoJCQlmb3IgaW1hZ2VUeXBlIGluIE1BVEVSSUFMU1trZXldOg0KCQkJCWlmIE1BVEVSSUFMU1trZXldW2ltYWdlVHlwZV1bMF09PSd0ZXh0dXJlJzoNCgkJCQkJaGFzaD1NQVRFUklBTFNba2V5XVtpbWFnZVR5cGVdWzFdCQkJCQkNCgkJCQkJaWYgaGFzaCBpbiBJTUFHRVMua2V5cygpOg0KCQkJCQkJaWYgSU1BR0VTW2hhc2hdWydSR0InXToNCgkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnUkdCJ10NCgkJCQkJCQlpZiBleGlzdHM9PTE6DQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J09wYWNpdHknOnRyYW5zPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nQWxiZWRvUEJSJzpkaWZmdXNlPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nRGlmZnVzZUNvbG9yJzpkaWZmdXNlPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nTm9ybWFsTWFwJzpub3JtYWw9cGF0aA0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdTcGVjdWxhckNvbG9yJzpzcGVjdWxhcj1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J0RpZmZ1c2VQQlInOmRpZmZ1c2U9cGF0aA0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdTcGVjdWxhckYwJzpzcGVjdWxhcj1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J1NwZWN1bGFyQ29sb3InOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nRGlmZnVzZUludGVuc2l0eSc6YW89cGF0aA0KCQkJCQkJaWYgSU1BR0VTW2hhc2hdWydBJ106DQoJCQkJCQkJcGF0aCxleGlzdHMscXVhbGl0eT1JTUFHRVNbaGFzaF1bJ0EnXQ0KCQkJCQkJCWlmIGV4aXN0cz09MToNCgkJCQkJCQkJdHJhbnM9cGF0aA0KCQkJCQkJaWYgSU1BR0VTW2hhc2hdWydOJ106DQoJCQkJCQkJcGF0aCxleGlzdHMscXVhbGl0eT1JTUFHRVNbaGFzaF1bJ04nXQ0KCQkJCQkJCWlmIGV4aXN0cz09MToNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nTm9ybWFsTWFwJzpub3JtYWw9cGF0aA0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdCdW1wTWFwJzpub3JtYWw9cGF0aA0KCQkJCQkJaWYgSU1BR0VTW2hhc2hdWydSJ106DQoJCQkJCQkJcGF0aCxleGlzdHMscXVhbGl0eT1JTUFHRVNbaGFzaF1bJ1InXQ0KCQkJCQkJCWlmIGV4aXN0cz09MToNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nT3BhY2l0eSc6dHJhbnM9cGF0aA0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdTcGVjdWxhckYwJzpzcGVjdWxhcj1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J0FPUEJSJzphbz1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J1JvdWdobmVzc1BCUic6c3BlY3VsYXI9cGF0aA0KCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdHbG9zc2luZXNzUEJSJzpzcGVjdWxhcj1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J0J1bXBNYXAnOm5vcm1hbD1wYXRoDQoJCQkJCQkJCWlmIGltYWdlVHlwZT09J1NwZWN1bGFyQ29sb3InOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nRGlmZnVzZUludGVuc2l0eSc6YW89cGF0aA0KCQkJCWlmIE1BVEVSSUFMU1trZXldW2ltYWdlVHlwZV1bMF09PSdjb2xvcic6DQoJCQkJCWlmIGltYWdlVHlwZT09J0RpZmZ1c2VDb2xvcic6DQoJCQkJCQlyZ2JDb2w9TUFURVJJQUxTW2tleV1baW1hZ2VUeXBlXVsxXQ0KCQkJCQkJCQkNCgllbHNlOgkJCQkJCQkNCgkJZm9yIGtleSBpbiBNQVRFUklBTFMua2V5cygpOg0KCQkJaWYga2V5PT1tYXROYW1lOg0KCQkJCWZvciBpbWFnZVR5cGUgaW4gTUFURVJJQUxTW2tleV06DQoJCQkJCWlmIE1BVEVSSUFMU1trZXldW2ltYWdlVHlwZV1bMF09PSd0ZXh0dXJlJzoNCgkJCQkJCWhhc2g9TUFURVJJQUxTW2tleV1baW1hZ2VUeXBlXVsxXQkJCQkJDQoJCQkJCQlpZiBoYXNoIGluIElNQUdFUy5rZXlzKCk6DQoJCQkJCQkJaWYgSU1BR0VTW2hhc2hdWydSR0InXToNCgkJCQkJCQkJcGF0aCxleGlzdHMscXVhbGl0eT1JTUFHRVNbaGFzaF1bJ1JHQiddDQoJCQkJCQkJCWlmIGV4aXN0cz09MToNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J0FsYmVkb1BCUic6ZGlmZnVzZT1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdEaWZmdXNlQ29sb3InOmRpZmZ1c2U9cGF0aA0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nRGlmZnVzZVBCUic6ZGlmZnVzZT1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdOb3JtYWxNYXAnOm5vcm1hbD1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdFbWl0Q29sb3InOmRpZmZ1c2U9cGF0aA0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nU3BlY3VsYXJQQlInOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J09wYWNpdHknOnRyYW5zPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J1NwZWN1bGFyRjAnOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J1NwZWN1bGFyQ29sb3InOnNwZWN1bGFyPXBhdGgNCgkJCQkJCQkJCWlmIGltYWdlVHlwZT09J0RpZmZ1c2VJbnRlbnNpdHknOmFvPXBhdGgNCgkJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ0EnXToNCgkJCQkJCQkJcGF0aCxleGlzdHMscXVhbGl0eT1JTUFHRVNbaGFzaF1bJ0EnXQ0KCQkJCQkJCQlpZiBleGlzdHM9PTE6DQoJCQkJCQkJCQl0cmFucz1wYXRoDQoJCQkJCQkJaWYgSU1BR0VTW2hhc2hdWydOJ106DQoJCQkJCQkJCXBhdGgsZXhpc3RzLHF1YWxpdHk9SU1BR0VTW2hhc2hdWydOJ10NCgkJCQkJCQkJaWYgZXhpc3RzPT0xOg0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nTm9ybWFsTWFwJzpub3JtYWw9cGF0aA0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nQnVtcE1hcCc6bm9ybWFsPXBhdGgNCgkJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ1InXToNCgkJCQkJCQkJcGF0aCxleGlzdHMscXVhbGl0eT1JTUFHRVNbaGFzaF1bJ1InXQ0KCQkJCQkJCQlpZiBleGlzdHM9PTE6DQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdPcGFjaXR5Jzp0cmFucz1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdTcGVjdWxhckYwJzpzcGVjdWxhcj1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdBT1BCUic6YW89cGF0aA0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nUm91Z2huZXNzUEJSJzpzcGVjdWxhcj1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdHbG9zc2luZXNzUEJSJzpzcGVjdWxhcj1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdCdW1wTWFwJzpub3JtYWw9cGF0aA0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nU3BlY3VsYXJDb2xvcic6c3BlY3VsYXI9cGF0aA0KCQkJCQkJCQkJaWYgaW1hZ2VUeXBlPT0nRGlmZnVzZUludGVuc2l0eSc6YW89cGF0aA0KCQkJCQlpZiBNQVRFUklBTFNba2V5XVtpbWFnZVR5cGVdWzBdPT0nY29sb3InOg0KCQkJCQkJaWYgaW1hZ2VUeXBlPT0nRGlmZnVzZUNvbG9yJzoNCgkJCQkJCQlyZ2JDb2w9TUFURVJJQUxTW2tleV1baW1hZ2VUeXBlXVsxXQ0KCQkJCQ0KCVRleHR1cmVBdHRyaWJ1dGVMaXN0PXlzLmdldChwYXJlbnQsJyJUZXh0dXJlQXR0cmlidXRlTGlzdCInKQ0KCWlmIFRleHR1cmVBdHRyaWJ1dGVMaXN0Og0KCQkJI3ByaW50ICdoZXJlJw0KCQkJb3NnX1RleHR1cmU9eXMuZ2V0KHBhcmVudCwnIm9zZy5UZXh0dXJlIicpDQoJCQlpZiBvc2dfVGV4dHVyZToNCgkJCQl2YWx1ZXM9eXMudmFsdWVzKG9zZ19UZXh0dXJlWzBdLmRhdGEsJzonKQkJCQkNCgkJCQloYXNoPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJywnIiInKQ0KCQkJCWlmIGhhc2g6DQoJCQkJCWlmICcvJyBpbiBoYXNoOg0KCQkJCQkJaGFzaD1oYXNoLnNwbGl0KCcvJylbMV0NCgkJCQkJCSNwcmludCBoYXNoDQoJCQkJCQlpZiBoYXNoIGluIElNQUdFUy5rZXlzKCk6DQoJCQkJCQkJaWYgSU1BR0VTW2hhc2hdWydSR0InXToNCgkJCQkJCQkJcGF0aCxleGlzdHMscXVhbGl0eT1JTUFHRVNbaGFzaF1bJ1JHQiddDQoJCQkJCQkJCWlmIGV4aXN0cz09MToNCgkJCQkJCQkJCWRpZmZ1c2U9cGF0aA0KCQkJCQkJCWlmIElNQUdFU1toYXNoXVsnQSddOg0KCQkJCQkJCQlwYXRoLGV4aXN0cyxxdWFsaXR5PUlNQUdFU1toYXNoXVsnQSddDQoJCQkJCQkJCWlmIGV4aXN0cz09MToNCgkJCQkJCQkJCXRyYW5zPXBhdGgNCgkJCQkJCQlpZiBJTUFHRVNbaGFzaF1bJ04nXToNCgkJCQkJCQkJcGF0aCxleGlzdHMscXVhbGl0eT1JTUFHRVNbaGFzaF1bJ04nXQ0KCQkJCQkJCQlpZiBleGlzdHM9PTE6DQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdOb3JtYWxNYXAnOm5vcm1hbD1wYXRoDQoJCQkJCQkJCQlpZiBpbWFnZVR5cGU9PSdCdW1wTWFwJzpub3JtYWw9cGF0aA0KCQkNCglyZXR1cm4gbWF0TmFtZSxkaWZmdXNlLHNwZWN1bGFyLG5vcm1hbCxhbyx0cmFucyxyZ2JDb2wscmdiU3BlYyxyZ2JhDQoJDQoNCmRlZiBnZXRTcGxpdE5hbWUobmFtZSx3aGF0LHdoaWNoKToNCglhPU5vbmUNCglpZiB3aGF0IGluIG5hbWU6DQoJCWE9JycNCgkJc3BsaXRzPW5hbWUuc3BsaXQod2hhdCkNCgkJaWYgd2hpY2g8MDoNCgkJCW51bT1sZW4oc3BsaXRzKSt3aGljaC0xDQoJCWVsc2U6DQoJCQludW09d2hpY2gNCgkJaWYgbnVtPDA6DQoJCQlhPW5hbWUNCgkJZWxzZToJCQ0KCQkJaWYgd2hpY2g8bGVuKHNwbGl0cyk6CQkJDQoJCQkJZm9yIG0gaW4gcmFuZ2UobnVtKToNCgkJCQkJYSs9c3BsaXRzW21dK3doYXQNCgkJCQlhKz1zcGxpdHNbbnVtXQ0KCQkJZWxzZToNCgkJCQlhPW5hbWUJCQ0KCXJldHVybiBhCQ0KCQkNCg0KZGVmIGV0YXAxKGlucHV0LEl0ZW1TaXplKToNCgluPWxlbihpbnB1dCkvSXRlbVNpemUNCglyPTANCglvdXRwdXQ9WzBdKmxlbihpbnB1dCkNCgl3aGlsZShyPG4pOg0KCQlhPXIqSXRlbVNpemUNCgkJcz0wDQoJCXdoaWxlKHM8SXRlbVNpemUpOg0KCQkJb3V0cHV0W2Erc109aW5wdXRbcituKnNdDQoJCQlzKz0xCQ0KCQlyKz0xDQoJcmV0dXJuIG91dHB1dAkNCgkNCmRlZiBldGFwMihpbnB1dCxJdGVtU2l6ZSxhdHJpYnV0ZXMpOg0KCWk9W2F0cmlidXRlc1snImJ4IiddLGF0cmlidXRlc1snImJ5IiddLGF0cmlidXRlc1snImJ6IiddXQ0KCW49W2F0cmlidXRlc1snImh4IiddLGF0cmlidXRlc1snImh5IiddLGF0cmlidXRlc1snImh6IiddXQ0KCWE9bGVuKGlucHV0KS9JdGVtU2l6ZQ0KCXM9MA0KCW91dHB1dD1bMF0qbGVuKGlucHV0KQ0KCXdoaWxlKHM8YSk6DQoJCW89cypJdGVtU2l6ZQ0KCQl1PTANCgkJd2hpbGUodTxJdGVtU2l6ZSk6DQoJCQlvdXRwdXRbbyt1XT1pW3VdK2lucHV0W28rdV0qblt1XTsNCgkJCXUrPTEJDQoJCXMrPTENCglyZXR1cm4gb3V0cHV0CQ0KCQ0KCQ0KCQ0KCQ0KZGVmIGV0YXAzKGlucHV0LEl0ZW1TaXplKToNCglpPUl0ZW1TaXplfDENCgluPTENCglyPWxlbihpbnB1dCkvaQ0KCXdoaWxlKG48cik6DQoJCWE9KG4tMSkqaQ0KCQlzPW4qaQ0KCQlvPTANCgkJd2hpbGUobzxpKToJCQkNCgkJCWlucHV0W3Mrb10rPWlucHV0W2Erb10NCgkJCW8rPTEJDQoJCW4rPTENCglyZXR1cm4gaW5wdXQNCgkNCmRlZiBldGFwNChpbnB1dCk6DQoJZT0xDQoJaT1sZW4oaW5wdXQpLzQNCgl3aGlsZShlPGkpOg0KCQluPTQqKGUtMSkNCgkJcj00KmUNCgkJYT1pbnB1dFtuXQ0KCQlzPWlucHV0W24rMV0NCgkJbz1pbnB1dFtuKzJdDQoJCXU9aW5wdXRbbiszXQ0KCQlsPWlucHV0W3JdDQoJCWg9aW5wdXRbcisxXQ0KCQljPWlucHV0W3IrMl0NCgkJZD1pbnB1dFtyKzNdDQoJCWlucHV0W3JdPWEqZCtzKmMtbypoK3UqbA0KCQlpbnB1dFtyKzFdPS1hKmMrcypkK28qbCt1KmgNCgkJaW5wdXRbcisyXT1hKmgtcypsK28qZCt1KmMNCgkJaW5wdXRbciszXT0tYSpsLXMqaC1vKmMrdSpkDQoJCWUrPTENCglyZXR1cm4JaW5wdXQNCgkNCg0KDQpkZWYgaW50M2Zsb2F0NChpbnB1dCxhdHJpYnV0ZXMsSXRlbVNpemUpOg0KCWM9NA0KCWQ9YXRyaWJ1dGVzWyciZXBzaWxvbiInXQ0KCXA9aW50KGF0cmlidXRlc1snIm5waGkiJ10pDQoJZT1bMF0qbGVuKGlucHV0KSo0DQoJaT0xLjU3MDc5NjMyNjc5DQoJbj02LjI4MzE4NTMwNzE4DQoJcj0zLjE0MTU5MjY1MzU5DQoJYT0wLjAxNzQ1MzI5MjUxDQoJcz0wLjI1DQoJbz03MjANCgl1PTgzMg0KCWw9NDc5MzgzNjI1ODQxNTE2MzVlLTIxDQoJaD17fQ0KCWY9VHJ1ZQ0KCQ0KCWQ9ZCBvciBzDQoJcD1wIG9yIG8NCglnPW1hdGguY29zKGQqYSkNCgltPTANCgl2PTANCglfPVtdDQoJDQoJdj0ocCsxKSoodSsxKSozDQoJXz1bTm9uZV0qdg0KCQ0KCWI9ci9mbG9hdChwLTEpDQoJeD1pL2Zsb2F0KHAtMSkNCgkNCglpZiBmOnk9Mw0KCWVsc2U6eT0yDQoJCQ0KCQkNCgltPTANCgl2PWxlbihpbnB1dCkveQ0KCXdoaWxlKG08dik6DQoJCUE9bSpjDQoJCVM9bSp5DQoJCUM9aW5wdXRbU10NCgkJdz1pbnB1dFtTKzFdDQoJCWlmIGM9PTA6DQoJCQlpZiBmPT0wOg0KCQkJCWlmIChDJi0xMDI1KSE9NDoJCQ0KCQkJCQllW0ErM109LTENCgkJCQllbHNlOg0KCQkJCQllW0ErM109MQ0KCQlNPU5vbmUNCgkJVD1Ob25lDQoJCUU9Tm9uZQ0KCQlJPTMqKEMrcCp3KQkJDQoJCU09X1tJXQ0KCQlpZglNPT1Ob25lOgkJCQkNCgkJCU49QypiDQoJCQlrPWNvcyhOKQ0KCQkJRj1zaW4oTikNCgkJCU4rPXgNCgkJCUQ9KGctaypjb3MoTikpL2Zsb2F0KG1heCgxZS01LEYqc2luKE4pKSkNCgkJCWlmIEQ+MTpEPTENCgkJCWVsc2U6DQoJCQkJaWYgRDwtMTpEPS0xDQoJCQlQPXcqbi9mbG9hdChtYXRoLmNlaWwoci9mbG9hdChtYXgoMWUtNSxtYXRoLmFjb3MoRCkpKSkpDQoJCQlNPV9bSV09RiptYXRoLmNvcyhQKQ0KCQkJVD1fW0krMV09RiptYXRoLnNpbihQKQ0KCQkJRT1fW0krMl09aw0KCQllbHNlOiANCgkJCVQ9X1tJKzFdDQoJCQlFPV9bSSsyXQ0KCQlpZiBmOg0KCQkJUj1pbnB1dFtTKzJdKmwNCgkJCU89bWF0aC5zaW4oUikNCgkJCWVbQV09TypNDQoJCQllW0ErMV09TypUDQoJCQllW0ErMl09TypFDQoJCQllW0ErM109bWF0aC5jb3MoUikNCgkJCSN3cml0ZShsb2csW0EsZVtBXSxlW0ErMV0sZVtBKzJdLGVbQSszXV0sMCkNCgkJZWxzZTogDQoJCQllW0FdPU0NCgkJCWVbQSsxXT1UDQoJCQllW0ErMl09RQ0KCQltKz0xDQoJDQoJcmV0dXJuIGUJDQoJDQoNCmRlZiBnZXRBbmltYXRpb24oeXMsQSxuKToNCglhY3Rpb249QWN0aW9uKCkNCglhY3Rpb24uQk9ORVNQQUNFPVRydWUNCgkjYWN0aW9uLkFSTUFUVVJFU1BBQ0U9VHJ1ZQ0KCWFjdGlvbi5GUkFNRVNPUlQ9VHJ1ZQ0KCWFjdGlvbi5za2VsZXRvbj1za2VsZXRvbi5uYW1lDQoJbis9NA0KCUNoYW5uZWxzPXlzLmdldChBLCciQ2hhbm5lbHMiJykNCglib25lTGlzdD17fQ0KCWlmIENoYW5uZWxzOg0KCQl2YWx1ZXM9eXMudmFsdWVzKENoYW5uZWxzWzBdLmhlYWRlciwnOicpDQoJCU5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciTmFtZSInKQ0KCQlhY3Rpb24ubmFtZT1OYW1lDQoJCW5ldz1OZXcoTmFtZS5yZXBsYWNlKCciJywnJykucmVwbGFjZSgnfCcsJycpKycuYWN0aW9uJywnd2InLHN5cykub3BlbigpDQoJCWZvciBhIGluICBDaGFubmVsc1swXS5jaGlsZHJlbjoNCgkJCVZlYzNMZXJwQ2hhbm5lbD15cy5nZXQoYSwnIm9zZ0FuaW1hdGlvbi5WZWMzTGVycENoYW5uZWwiJykNCgkJCWlmIFZlYzNMZXJwQ2hhbm5lbDoNCgkJCQlLZXlGcmFtZXM9eXMuZ2V0KGEsJyJLZXlGcmFtZXMiJykNCgkJCQlpZiBLZXlGcmFtZXM6DQoJCQkJCXZhbHVlcz15cy52YWx1ZXMoS2V5RnJhbWVzWzBdLmhlYWRlciwnOicpDQoJCQkJCU5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciTmFtZSInKQ0KCQkJCQlUYXJnZXROYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIlRhcmdldE5hbWUiJywnIiInKQ0KCQkJCQluYW1lPWdldFNwbGl0TmFtZShUYXJnZXROYW1lLCdfJywtMSkNCgkJCQkJaWYgTmFtZT09JyJ0cmFuc2xhdGUiJzoNCgkJCQkJCWJvbmU9Tm9uZQ0KCQkJCQkJaWYgVGFyZ2V0TmFtZSBpbiBib25lSW5kZWtzTGlzdDoNCgkJCQkJCQluYW1lPWJvbmVJbmRla3NMaXN0W1RhcmdldE5hbWVdDQoJCQkJCQkJaWYgbmFtZSBub3QgaW4gYm9uZUxpc3Qua2V5cygpOg0KCQkJCQkJCQlib25lPUFjdGlvbkJvbmUoKQ0KCQkJCQkJCQlhY3Rpb24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpDQoJCQkJCQkJCWJvbmUubmFtZT1uYW1lDQoJCQkJCQkJCWJvbmVMaXN0W25hbWVdPWJvbmUNCgkJCQkJCQlib25lPWJvbmVMaXN0W25hbWVdDQoJCQkJCQllbHNlOg0KCQkJCQkJCXByaW50ICdza2lwZWQgdHJhbnNsYXRlIGJvbmU6JyxUYXJnZXROYW1lDQoJCQkJCQkNCgkJCQkJCQ0KCQkJCQkJS2V5PXlzLmdldChhLCciS2V5IicpDQoJCQkJCQlpZiBLZXk6DQoJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhLZXlbMF0uZGF0YSwnOicpDQoJCQkJCQkJSXRlbVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJywnaScpCQkJCQkJDQoJCQkJCQkJRmxvYXQzMkFycmF5PXlzLmdldChLZXlbMF0sJyJGbG9hdDMyQXJyYXkiJykNCgkJCQkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQkJCQkJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJykNCgkJCQkJCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicpDQoJCQkJCQkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJykNCgkJCQkJCQkJd3JpdGUobG9nLFtGaWxlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdJdGVtU2l6ZTonLEl0ZW1TaXplXSxuKzQpDQoJCQkJCQkJCQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXQkJCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWUgYW5kIG9zLnBhdGguZXhpc3RzKHBhdGguc3BsaXQoJy5neicpWzBdKT09RmFsc2U6DQoJCQkJCQkJCQljbWQ9Q21kKCkNCgkJCQkJCQkJCWNtZC5pbnB1dD1wYXRoDQoJCQkJCQkJCQljbWQuWklQPVRydWUNCgkJCQkJCQkJCWNtZC5ydW4oKQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOg0KCQkJCQkJCQkJcGF0aCs9JycNCgkJCQkJCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZToNCgkJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQkJZy5zZWVrKGludChPZmZzZXQpKQkJCQkJCQkJCQ0KCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQluZXcud3JpdGUoYm9uZS5uYW1lKydceDAwJykNCgkJCQkJCQkJCQluZXcud3JpdGUoJ3RyYW5zbGF0ZScrJ1x4MDAnKQ0KCQkJCQkJCQkJCW5ldy5pKFtpbnQoU2l6ZSldKQ0KCQkJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoaW50KFNpemUpKToNCgkJCQkJCQkJCQl2YWx1ZT1nLmYoSXRlbVNpemUpDQoJCQkJCQkJCQkJI3dyaXRlKGxvZyx2YWx1ZSxuKzgpDQoJCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQkJbmV3LmYodmFsdWUpDQoJCQkJCQkJCQkJCWJvbmVNYXRyaXg9c2tlbGV0b24ub2JqZWN0LmdldERhdGEoKS5ib25lc1tib25lLm5hbWVdLm1hdHJpeFsnQVJNQVRVUkVTUEFDRSddDQoJCQkJCQkJCQkJCW1hdHJpeD1WZWN0b3JNYXRyaXgodmFsdWUpIypib25lTWF0cml4DQoJCQkJCQkJCQkJCWJvbmUucG9zS2V5TGlzdC5hcHBlbmQobWF0cml4KQ0KCQkJCQkJCQkJZmlsZS5jbG9zZSgpDQoJCQkJCQkJZWxzZTpwcmludCAndW5rbm93IGFycmF5IHR5cGUnDQoJCQkJCQllbHNlOnByaW50ICdubyBrZXknCQkJCQ0KCQkJCQkJDQoJCQkJCQlUaW1lPXlzLmdldChhLCciVGltZSInKQ0KCQkJCQkJaWYgVGltZToNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKFRpbWVbMF0uZGF0YSwnOicpDQoJCQkJCQkJSXRlbVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJywnaScpCQkJCQkJDQoJCQkJCQkJRmxvYXQzMkFycmF5PXlzLmdldChUaW1lWzBdLCciRmxvYXQzMkFycmF5IicpDQoJCQkJCQkJaWYgRmxvYXQzMkFycmF5Og0KCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCQkJCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicpDQoJCQkJCQkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInKQ0KCQkJCQkJCQlPZmZzZXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicpDQoJCQkJCQkJCSN3cml0ZShsb2csW0ZpbGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0l0ZW1TaXplOicsSXRlbVNpemVdLG4rNCkNCgkJCQkJCQkJDQoJCQkJCQkJCQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXQkJCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWUgYW5kIG9zLnBhdGguZXhpc3RzKHBhdGguc3BsaXQoJy5neicpWzBdKT09RmFsc2U6DQoJCQkJCQkJCQljbWQ9Q21kKCkNCgkJCQkJCQkJCWNtZC5pbnB1dD1wYXRoDQoJCQkJCQkJCQljbWQuWklQPVRydWUNCgkJCQkJCQkJCWNtZC5ydW4oKQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOg0KCQkJCQkJCQkJcGF0aCs9JycNCgkJCQkJCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKToNCgkJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQkJZy5zZWVrKGludChPZmZzZXQpKQkJCQkJCQkNCgkJCQkJCQkJCWlmIGJvbmU6bmV3LmkoW2ludChTaXplKV0pDQoJCQkJCQkJCQlmb3IgbSBpbiByYW5nZShpbnQoU2l6ZSkpOg0KCQkJCQkJCQkJCXZhbHVlPWcuZihJdGVtU2l6ZSkNCgkJCQkJCQkJCQlpZiBJdGVtU2l6ZT09MTp2YWx1ZT12YWx1ZVswXQ0KCQkJCQkJCQkJCSN3cml0ZShsb2csW3ZhbHVlXSxuKzgpDQoJCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQkJbmV3LmYoW3ZhbHVlXSkNCgkJCQkJCQkJCQkJYm9uZS5wb3NGcmFtZUxpc3QuYXBwZW5kKGludCh2YWx1ZSozMykpDQoJCQkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQkJCQllbHNlOnByaW50ICd1bmtub3cgYXJyYXkgdHlwZScNCgkJCQkJCWVsc2U6cHJpbnQgJ25vIHRpbWUnCQkNCgkJCQkJDQoJCQkJCQ0KCQkJCQkNCgkJCQkJDQoJCQkJCWlmIE5hbWU9PScic2NhbGUiJzoNCgkJCQkJCWJvbmU9Tm9uZQ0KCQkJCQkJaWYgVGFyZ2V0TmFtZSBpbiBib25lSW5kZWtzTGlzdDoNCgkJCQkJCQluYW1lPWJvbmVJbmRla3NMaXN0W1RhcmdldE5hbWVdDQoJCQkJCQkJaWYgbmFtZSBub3QgaW4gYm9uZUxpc3Qua2V5cygpOg0KCQkJCQkJCQlib25lPUFjdGlvbkJvbmUoKQ0KCQkJCQkJCQlhY3Rpb24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpDQoJCQkJCQkJCWJvbmUubmFtZT1uYW1lDQoJCQkJCQkJCWJvbmVMaXN0W25hbWVdPWJvbmUNCgkJCQkJCQlib25lPWJvbmVMaXN0W25hbWVdDQoJCQkJCQllbHNlOg0KCQkJCQkJCXByaW50ICdza2lwZWQgc2NhbGUgYm9uZTonLFRhcmdldE5hbWUNCgkJCQkJCQ0KCQkJCQkJDQoJCQkJCQlLZXk9eXMuZ2V0KGEsJyJLZXkiJykNCgkJCQkJCWlmIEtleToNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEtleVswXS5kYXRhLCc6JykNCgkJCQkJCQlJdGVtU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJJdGVtU2l6ZSInLCdpJykJCQkJCQkNCgkJCQkJCQlGbG9hdDMyQXJyYXk9eXMuZ2V0KEtleVswXSwnIkZsb2F0MzJBcnJheSInKQ0KCQkJCQkJCWlmIEZsb2F0MzJBcnJheToNCgkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwnOicpDQoJCQkJCQkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInKQ0KCQkJCQkJCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJykNCgkJCQkJCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInKQ0KCQkJCQkJCQkjd3JpdGUobG9nLFtGaWxlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdJdGVtU2l6ZTonLEl0ZW1TaXplXSxuKzQpDQoJCQkJCQkJCQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXQkJCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWUgYW5kIG9zLnBhdGguZXhpc3RzKHBhdGguc3BsaXQoJy5neicpWzBdKT09RmFsc2U6DQoJCQkJCQkJCQljbWQ9Q21kKCkNCgkJCQkJCQkJCWNtZC5pbnB1dD1wYXRoDQoJCQkJCQkJCQljbWQuWklQPVRydWUNCgkJCQkJCQkJCWNtZC5ydW4oKQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOg0KCQkJCQkJCQkJcGF0aCs9JycNCgkJCQkJCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZToNCgkJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQkJZy5zZWVrKGludChPZmZzZXQpKQkJCQkJCQkJCQ0KCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQluZXcud3JpdGUoYm9uZS5uYW1lKydceDAwJykNCgkJCQkJCQkJCQluZXcud3JpdGUoJ3NpemUnKydceDAwJykNCgkJCQkJCQkJCQluZXcuaShbaW50KFNpemUpXSkNCgkJCQkJCQkJCWZvciBtIGluIHJhbmdlKGludChTaXplKSk6DQoJCQkJCQkJCQkJdmFsdWU9Zy5mKEl0ZW1TaXplKQ0KCQkJCQkJCQkJCSN3cml0ZShsb2csdmFsdWUsbis4KQ0KCQkJCQkJCQkJCWlmIGJvbmU6DQoJCQkJCQkJCQkJCW5ldy5mKHZhbHVlKQ0KCQkJCQkJCQkJCQlib25lTWF0cml4PXNrZWxldG9uLm9iamVjdC5nZXREYXRhKCkuYm9uZXNbYm9uZS5uYW1lXS5tYXRyaXhbJ0FSTUFUVVJFU1BBQ0UnXQ0KCQkJCQkJCQkJCQltYXRyaXg9VmVjdG9yTWF0cml4KHZhbHVlKSMqYm9uZU1hdHJpeA0KCQkJCQkJCQkJCQlib25lLnNpemVLZXlMaXN0LmFwcGVuZChtYXRyaXgpDQoJCQkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQkJCQllbHNlOnByaW50ICd1bmtub3cgYXJyYXkgdHlwZScNCgkJCQkJCWVsc2U6cHJpbnQgJ25vIGtleScJCQkJDQoJCQkJCQkNCgkJCQkJCVRpbWU9eXMuZ2V0KGEsJyJUaW1lIicpDQoJCQkJCQlpZiBUaW1lOg0KCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoVGltZVswXS5kYXRhLCc6JykNCgkJCQkJCQlJdGVtU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJJdGVtU2l6ZSInLCdpJykJCQkJCQkNCgkJCQkJCQlGbG9hdDMyQXJyYXk9eXMuZ2V0KFRpbWVbMF0sJyJGbG9hdDMyQXJyYXkiJykNCgkJCQkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQkJCQkJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJykNCgkJCQkJCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicpDQoJCQkJCQkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJykNCgkJCQkJCQkJI3dyaXRlKGxvZyxbRmlsZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnSXRlbVNpemU6JyxJdGVtU2l6ZV0sbis0KQ0KCQkJCQkJCQkNCgkJCQkJCQkJDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZSBhbmQgb3MucGF0aC5leGlzdHMocGF0aC5zcGxpdCgnLmd6JylbMF0pPT1GYWxzZToNCgkJCQkJCQkJCWNtZD1DbWQoKQ0KCQkJCQkJCQkJY21kLmlucHV0PXBhdGgNCgkJCQkJCQkJCWNtZC5aSVA9VHJ1ZQ0KCQkJCQkJCQkJY21kLnJ1bigpDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdLnNwbGl0KCcuZ3onKVswXQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6DQoJCQkJCQkJCQlwYXRoKz0nJw0KCQkJCQkJCQkJDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KCQkJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJCQlnLnNlZWsoaW50KE9mZnNldCkpCQkJCQkJCQ0KCQkJCQkJCQkJaWYgYm9uZTpuZXcuaShbaW50KFNpemUpXSkNCgkJCQkJCQkJCWZvciBtIGluIHJhbmdlKGludChTaXplKSk6DQoJCQkJCQkJCQkJdmFsdWU9Zy5mKEl0ZW1TaXplKQ0KCQkJCQkJCQkJCWlmIEl0ZW1TaXplPT0xOnZhbHVlPXZhbHVlWzBdDQoJCQkJCQkJCQkJI3dyaXRlKGxvZyxbdmFsdWVdLG4rOCkNCgkJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCQluZXcuZihbdmFsdWVdKQ0KCQkJCQkJCQkJCQlib25lLnNpemVGcmFtZUxpc3QuYXBwZW5kKGludCh2YWx1ZSozMykpDQoJCQkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQkJCQllbHNlOnByaW50ICd1bmtub3cgYXJyYXkgdHlwZScNCgkJCQkJCWVsc2U6cHJpbnQgJ25vIHRpbWUnCQkNCgkJCQkJCQkJCQ0KCQkJVmVjM0xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZD15cy5nZXQoYSwnIm9zZ0FuaW1hdGlvbi5WZWMzTGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkIicpDQoJCQlpZiBWZWMzTGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkOg0KCQkJDQoJCQkJYXRyaWJ1dGVzPXt9DQoJCQkJVXNlckRhdGFDb250YWluZXI9eXMuZ2V0KFZlYzNMZXJwQ2hhbm5lbENvbXByZXNzZWRQYWNrZWRbMF0sJyJVc2VyRGF0YUNvbnRhaW5lciInKQ0KCQkJCWlmIFVzZXJEYXRhQ29udGFpbmVyOg0KCQkJCQlWYWx1ZXM9eXMuZ2V0KFVzZXJEYXRhQ29udGFpbmVyWzBdLCciVmFsdWVzIicpDQoJCQkJCWlmIFZhbHVlczoNCgkJCQkJCWZvciBjaGlsZCBpbiBWYWx1ZXNbMF0uY2hpbGRyZW46DQoJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5kYXRhLCc6JykNCgkJCQkJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJykNCgkJCQkJCQlWYWx1ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJWYWx1ZSInLCciZiInKQ0KCQkJCQkJCSN3cml0ZShsb2csW05hbWUsVmFsdWVdLG4rNCkNCgkJCQkJCQlhdHJpYnV0ZXNbTmFtZV09VmFsdWUNCgkJCQkNCgkJCQlLZXlGcmFtZXM9eXMuZ2V0KGEsJyJLZXlGcmFtZXMiJykNCgkJCQlpZiBLZXlGcmFtZXM6DQoJCQkJCXZhbHVlcz15cy52YWx1ZXMoS2V5RnJhbWVzWzBdLmhlYWRlciwnOicpDQoJCQkJCU5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciTmFtZSInKQ0KCQkJCQlUYXJnZXROYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIlRhcmdldE5hbWUiJywnIiInKQ0KCQkJCQkjd3JpdGUobG9nLFsnVmVjM0xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZDonLE5hbWUsJ1RhcmdldE5hbWU6JyxUYXJnZXROYW1lXSxuKzQpDQoJCQkJCW5hbWU9Z2V0U3BsaXROYW1lKFRhcmdldE5hbWUsJ18nLC0xKQ0KCQkJCQlpZiBOYW1lPT0nInRyYW5zbGF0ZSInOg0KCQkJCQkJYm9uZT1Ob25lDQoJCQkJCQlpZiBUYXJnZXROYW1lIGluIGJvbmVJbmRla3NMaXN0Og0KCQkJCQkJCSNuZXcud3JpdGUoVGFyZ2V0TmFtZSsnXHgwMCcpDQoJCQkJCQkJI25ldy53cml0ZSgndHJhbnNsYXRlJysnXHgwMCcpDQoJCQkJCQkJbmFtZT1ib25lSW5kZWtzTGlzdFtUYXJnZXROYW1lXQ0KCQkJCQkJCWlmIG5hbWUgbm90IGluIGJvbmVMaXN0LmtleXMoKToNCgkJCQkJCQkJYm9uZT1BY3Rpb25Cb25lKCkNCgkJCQkJCQkJYWN0aW9uLmJvbmVMaXN0LmFwcGVuZChib25lKQ0KCQkJCQkJCQlib25lLm5hbWU9bmFtZQ0KCQkJCQkJCQlib25lTGlzdFtuYW1lXT1ib25lDQoJCQkJCQkJYm9uZT1ib25lTGlzdFtuYW1lXQ0KCQkJCQkJZWxzZToNCgkJCQkJCQlwcmludCAnc2tpcGVkIHRyYW5zbGF0ZSBib25lOicsVGFyZ2V0TmFtZQ0KCQkJCQkJDQoJCQkJCQlLZXk9eXMuZ2V0KGEsJyJLZXkiJykNCgkJCQkJCWlmIEtleToNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEtleVswXS5kYXRhLCc6JykNCgkJCQkJCQlJdGVtU2l6ZT1pbnQoeXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJykpCQkJCQkJDQoJCQkJCQkJVWludDE2QXJyYXk9eXMuZ2V0KEtleVswXSwnIlVpbnQxNkFycmF5IicpDQoJCQkJCQkJdHlwZT0iVWludDE2QXJyYXkiDQoJCQkJCQkJaWYgVWludDE2QXJyYXk6DQoJCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoVWludDE2QXJyYXlbMF0uZGF0YSwnOicpDQoJCQkJCQkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInKQ0KCQkJCQkJCQlTaXplPWludCh5cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicpKQ0KCQkJCQkJCQlPZmZzZXQ9aW50KHlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInKSkNCgkJCQkJCQkJRW5jb2Rpbmc9eXMuZ2V0VmFsdWUodmFsdWVzLCciRW5jb2RpbmciJykNCgkJCQkJCQkJI3dyaXRlKGxvZyxbRmlsZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZywnSXRlbVNpemU6JyxJdGVtU2l6ZV0sbis0KQ0KCQkJCQkJCQkNCgkJCQkJCQkJDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdCQkJDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1UcnVlIGFuZCBvcy5wYXRoLmV4aXN0cyhwYXRoLnNwbGl0KCcuZ3onKVswXSk9PUZhbHNlOg0KCQkJCQkJCQkJY21kPUNtZCgpDQoJCQkJCQkJCQljbWQuaW5wdXQ9cGF0aA0KCQkJCQkJCQkJY21kLlpJUD1UcnVlDQoJCQkJCQkJCQljbWQucnVuKCkNCgkJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCciJylbMV0uc3BsaXQoJy5neicpWzBdDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1GYWxzZToNCgkJCQkJCQkJCXBhdGgrPScnDQoJCQkJCQkJCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk6DQoJCQkJCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJCQ0KCQkJCQkJCQkJbGlzdD1kZWNvZGVWYXJpbnQoZyxPZmZzZXQsU2l6ZSpJdGVtU2l6ZSx0eXBlKQ0KCQkJCQkJCQkJbGlzdDE9ZXRhcDEobGlzdCxJdGVtU2l6ZSkNCgkJCQkJCQkJCW91dD1ldGFwMihsaXN0MSxJdGVtU2l6ZSxhdHJpYnV0ZXMpDQoJCQkJCQkJCQlsaXN0Mj1bYXRyaWJ1dGVzWycib3giJ10sYXRyaWJ1dGVzWycib3kiJ10sYXRyaWJ1dGVzWycib3oiJ11dDQoJCQkJCQkJCQlsaXN0Mi5leHRlbmQob3V0KQ0KCQkJCQkJCQkJbGlzdDM9ZXRhcDMobGlzdDIsSXRlbVNpemUpCQkJCQkJCQ0KCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQluZXcud3JpdGUoYm9uZS5uYW1lKydceDAwJykNCgkJCQkJCQkJCQluZXcud3JpdGUoJ3RyYW5zbGF0ZScrJ1x4MDAnKQ0KCQkJCQkJCQkJCW5ldy5pKFtTaXplXSkNCgkJCQkJCQkJCWZvciBtIGluIHJhbmdlKFNpemUpOg0KCQkJCQkJCQkJCXZhbHVlPWxpc3QzW20qMzptKjMrM10NCgkJCQkJCQkJCQkjd3JpdGUobG9nLHZhbHVlLG4rOCkNCgkJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCQluZXcuZih2YWx1ZSkNCgkJCQkJCQkJCQkJaWYgYm9uZS5uYW1lIGluIHNrZWxldG9uLm9iamVjdC5nZXREYXRhKCkuYm9uZXMua2V5cygpOg0KCQkJCQkJCQkJCQkJYm9uZU1hdHJpeD1za2VsZXRvbi5vYmplY3QuZ2V0RGF0YSgpLmJvbmVzW2JvbmUubmFtZV0ubWF0cml4WydBUk1BVFVSRVNQQUNFJ10NCgkJCQkJCQkJCQkJCSNib25lTWF0cml4Kj1WZWN0b3JNYXRyaXgodmFsdWUpDQoJCQkJCQkJCQkJCQltYXRyaXg9VmVjdG9yTWF0cml4KHZhbHVlKSMqYm9uZU1hdHJpeA0KCQkJCQkJCQkJCQkJYm9uZS5wb3NLZXlMaXN0LmFwcGVuZChtYXRyaXgpDQoJCQkJCQkJCQkJCQkNCgkJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCQkJCWVsc2U6cHJpbnQgJ3Vua25vdyBhcnJheSB0eXBlJw0KCQkJCQkJZWxzZTpwcmludCAnbm8ga2V5JwkNCgkJCQkJCQ0KCQkJCQkJVGltZT15cy5nZXQoYSwnIlRpbWUiJykNCgkJCQkJCWlmIFRpbWU6DQoJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhUaW1lWzBdLmRhdGEsJzonKQ0KCQkJCQkJCUl0ZW1TaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIkl0ZW1TaXplIicsJ2knKQkJCQkJCQ0KCQkJCQkJCUZsb2F0MzJBcnJheT15cy5nZXQoVGltZVswXSwnIkZsb2F0MzJBcnJheSInKQ0KCQkJCQkJCWlmIEZsb2F0MzJBcnJheToNCgkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwnOicpDQoJCQkJCQkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInKQ0KCQkJCQkJCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJywnaScpDQoJCQkJCQkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQkJCQkJCSN3cml0ZShsb2csW0ZpbGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0l0ZW1TaXplOicsSXRlbVNpemVdLG4rNCkNCgkJCQkJCQkJDQoJCQkJCQkJCQ0KCQkJCQkJCQkNCgkJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCciJylbMV0JCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWUgYW5kIG9zLnBhdGguZXhpc3RzKHBhdGguc3BsaXQoJy5neicpWzBdKT09RmFsc2U6DQoJCQkJCQkJCQljbWQ9Q21kKCkNCgkJCQkJCQkJCWNtZC5pbnB1dD1wYXRoDQoJCQkJCQkJCQljbWQuWklQPVRydWUNCgkJCQkJCQkJCWNtZC5ydW4oKQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOg0KCQkJCQkJCQkJcGF0aCs9JycNCgkJCQkJCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKToNCgkJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQkJZy5zZWVrKGludChPZmZzZXQpKQ0KCQkJCQkJCQkJbGlzdD1nLmYoU2l6ZSpJdGVtU2l6ZSkNCgkJCQkJCQkJCWxpc3QxPWV0YXAxKGxpc3QsSXRlbVNpemUpDQoJCQkJCQkJCQkjb3V0PWV0YXAyKGxpc3QxLEl0ZW1TaXplLGF0cmlidXRlcykNCgkJCQkJCQkJCWxpc3QyPVthdHJpYnV0ZXNbJyJvdCInXV0NCgkJCQkJCQkJCWxpc3QyLmV4dGVuZChsaXN0MSkNCgkJCQkJCQkJCWxpc3QzPWV0YXAzKGxpc3QyLEl0ZW1TaXplKQ0KCQkJCQkJCQkJI3dyaXRlKGxvZyxsaXN0MywwKQkJCQkJCQkNCgkJCQkJCQkJCWlmIGJvbmU6bmV3LmkoW1NpemVdKQ0KCQkJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQoJCQkJCQkJCQkJdmFsdWU9bGlzdDNbbV0NCgkJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCQluZXcuZihbdmFsdWVdKQ0KCQkJCQkJCQkJCQlib25lLnBvc0ZyYW1lTGlzdC5hcHBlbmQoaW50KHZhbHVlKjMzKSkNCgkJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCQkJCWVsc2U6cHJpbnQgJ3Vua25vdyBhcnJheSB0eXBlJwkNCgkJCQkJCWVsc2U6cHJpbnQgJ25vIHRpbWUnCQ0KCQkJCQkNCgkJCQkJDQoJCQkJCQ0KCQkJUXVhdFNsZXJwQ2hhbm5lbD15cy5nZXQoYSwnIm9zZ0FuaW1hdGlvbi5RdWF0U2xlcnBDaGFubmVsIicpDQoJCQlpZiBRdWF0U2xlcnBDaGFubmVsOg0KCQkJCUtleUZyYW1lcz15cy5nZXQoYSwnIktleUZyYW1lcyInKQ0KCQkJCWlmIEtleUZyYW1lczoNCgkJCQkJdmFsdWVzPXlzLnZhbHVlcyhLZXlGcmFtZXNbMF0uaGVhZGVyLCc6JykNCgkJCQkJTmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJOYW1lIicpDQoJCQkJCVRhcmdldE5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciVGFyZ2V0TmFtZSInLCciIicpDQoJCQkJCSN3cml0ZShsb2csWydRdWF0U2xlcnBDaGFubmVsOicsTmFtZSwnVGFyZ2V0TmFtZTonLFRhcmdldE5hbWVdLG4rNCkNCgkJCQkJbmFtZT1nZXRTcGxpdE5hbWUoVGFyZ2V0TmFtZSwnXycsLTEpDQoJCQkJCWJvbmU9Tm9uZQ0KCQkJCQlpZiBUYXJnZXROYW1lIGluIGJvbmVJbmRla3NMaXN0Og0KCQkJCQkJbmFtZT1ib25lSW5kZWtzTGlzdFtUYXJnZXROYW1lXQ0KCQkJCQkJaWYgbmFtZSBub3QgaW4gYm9uZUxpc3Qua2V5cygpOg0KCQkJCQkJCWJvbmU9QWN0aW9uQm9uZSgpDQoJCQkJCQkJYWN0aW9uLmJvbmVMaXN0LmFwcGVuZChib25lKQ0KCQkJCQkJCWJvbmUubmFtZT1uYW1lDQoJCQkJCQkJYm9uZUxpc3RbbmFtZV09Ym9uZQ0KCQkJCQkJYm9uZT1ib25lTGlzdFtuYW1lXQ0KCQkJCQllbHNlOg0KCQkJCQkJcHJpbnQgJ3NraXBlZCBxdWF0ZXJuaW9uIGJvbmU6JyxUYXJnZXROYW1lDQoJCQkJCQ0KCQkJCQkNCgkJCQkJDQoJCQkJCUtleT15cy5nZXQoYSwnIktleSInKQ0KCQkJCQlpZiBLZXk6DQoJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEtleVswXS5kYXRhLCc6JykNCgkJCQkJCUl0ZW1TaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIkl0ZW1TaXplIicpCQkJCQkJDQoJCQkJCQlGbG9hdDMyQXJyYXk9eXMuZ2V0KEtleVswXSwnIkZsb2F0MzJBcnJheSInKQ0KCQkJCQkJaWYgRmxvYXQzMkFycmF5Og0KCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQkJCQkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInKQ0KCQkJCQkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInKQ0KCQkJCQkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJykNCgkJCQkJCQkjd3JpdGUobG9nLFtGaWxlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdJdGVtU2l6ZTonLEl0ZW1TaXplXSxuKzQpDQoJCQkJCQkJDQoJCQkJCQkJCQ0KCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdCQkJDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWUgYW5kIG9zLnBhdGguZXhpc3RzKHBhdGguc3BsaXQoJy5neicpWzBdKT09RmFsc2U6DQoJCQkJCQkJCWNtZD1DbWQoKQ0KCQkJCQkJCQljbWQuaW5wdXQ9cGF0aA0KCQkJCQkJCQljbWQuWklQPVRydWUNCgkJCQkJCQkJY21kLnJ1bigpDQoJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCciJylbMV0uc3BsaXQoJy5neicpWzBdDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOg0KCQkJCQkJCQlwYXRoKz0nJw0KCQkJCQkJCQkNCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKToNCgkJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJZy5zZWVrKGludChPZmZzZXQpKQkJCQkJCQkNCgkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCW5ldy53cml0ZShib25lLm5hbWUrJ1x4MDAnKQ0KCQkJCQkJCQkJbmV3LndyaXRlKCdxdWF0ZXJuaW9uJysnXHgwMCcpDQoJCQkJCQkJCQluZXcuaShbaW50KFNpemUpXSkNCgkJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoaW50KFNpemUpKToNCgkJCQkJCQkJCXZhbHVlPWcuZig0KQ0KCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQluZXcuZih2YWx1ZSkNCgkJCQkJCQkJCXZhbHVlPVF1YXRlcm5pb24odmFsdWUpDQoJCQkJCQkJCQlpZiBib25lOg0KCQkJCQkJCQkJCSNuZXcuZih2YWx1ZSkNCgkJCQkJCQkJCQlib25lTWF0cml4PXNrZWxldG9uLm9iamVjdC5nZXREYXRhKCkuYm9uZXNbYm9uZS5uYW1lXS5tYXRyaXhbJ0FSTUFUVVJFU1BBQ0UnXQ0KCQkJCQkJCQkJCSNib25lLnJvdEtleUxpc3QuYXBwZW5kKGJvbmVNYXRyaXgqUXVhdE1hdHJpeCh2YWx1ZSkucmVzaXplNHg0KCkpDQoJCQkJCQkJCQkJbWF0cml4PVF1YXRNYXRyaXgodmFsdWUpLnJlc2l6ZTR4NCgpIypib25lTWF0cml4DQoJCQkJCQkJCQkJYm9uZS5yb3RLZXlMaXN0LmFwcGVuZChtYXRyaXgpDQoJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCQkNCgkJCQkJVGltZT15cy5nZXQoYSwnIlRpbWUiJykNCgkJCQkJaWYgVGltZToNCgkJCQkJCXZhbHVlcz15cy52YWx1ZXMoVGltZVswXS5kYXRhLCc6JykNCgkJCQkJCUl0ZW1TaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIkl0ZW1TaXplIicsJ2knKQkJCQkJCQ0KCQkJCQkJRmxvYXQzMkFycmF5PXlzLmdldChUaW1lWzBdLCciRmxvYXQzMkFycmF5IicpDQoJCQkJCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhGbG9hdDMyQXJyYXlbMF0uZGF0YSwnOicpDQoJCQkJCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicpDQoJCQkJCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicpDQoJCQkJCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInKQ0KCQkJCQkJCSN3cml0ZShsb2csW0ZpbGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0l0ZW1TaXplOicsSXRlbVNpemVdLG4rNCkNCgkJCQkJCQkNCgkJCQkJCQkJDQoJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCciJylbMV0JCQkNCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZSBhbmQgb3MucGF0aC5leGlzdHMocGF0aC5zcGxpdCgnLmd6JylbMF0pPT1GYWxzZToNCgkJCQkJCQkJY21kPUNtZCgpDQoJCQkJCQkJCWNtZC5pbnB1dD1wYXRoDQoJCQkJCQkJCWNtZC5aSVA9VHJ1ZQ0KCQkJCQkJCQljbWQucnVuKCkNCgkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6DQoJCQkJCQkJCXBhdGgrPScnDQoJCQkJCQkJCQ0KCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOg0KCQkJCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQlnLnNlZWsoaW50KE9mZnNldCkpCQkJCQkJCQ0KCQkJCQkJCQlpZiBib25lOm5ldy5pKFtpbnQoU2l6ZSldKQ0KCQkJCQkJCQlmb3IgbSBpbiByYW5nZShpbnQoU2l6ZSkpOg0KCQkJCQkJCQkJdmFsdWU9Zy5mKEl0ZW1TaXplKQ0KCQkJCQkJCQkJaWYgSXRlbVNpemU9PTE6dmFsdWU9dmFsdWVbMF0NCgkJCQkJCQkJCWlmIGJvbmU6DQoJCQkJCQkJCQkJbmV3LmYoW3ZhbHVlXSkNCgkJCQkJCQkJCQlib25lLnJvdEZyYW1lTGlzdC5hcHBlbmQoaW50KHZhbHVlKjMzKSkNCgkJCQkJCQkJZmlsZS5jbG9zZSgpDQoJCQkJCQ0KCQkJCQkJCQkJDQoJCQlRdWF0U2xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZD15cy5nZXQoYSwnIm9zZ0FuaW1hdGlvbi5RdWF0U2xlcnBDaGFubmVsQ29tcHJlc3NlZFBhY2tlZCInKQ0KCQkJaWYgUXVhdFNsZXJwQ2hhbm5lbENvbXByZXNzZWRQYWNrZWQ6DQoJCQkJVGFyZ2V0TmFtZT1Ob25lDQoJCQkJdHJ5Og0KCQkJDQoJCQkJCWF0cmlidXRlcz17fQ0KCQkJCQlVc2VyRGF0YUNvbnRhaW5lcj15cy5nZXQoUXVhdFNsZXJwQ2hhbm5lbENvbXByZXNzZWRQYWNrZWRbMF0sJyJVc2VyRGF0YUNvbnRhaW5lciInKQ0KCQkJCQlpZiBVc2VyRGF0YUNvbnRhaW5lcjoNCgkJCQkJCVZhbHVlcz15cy5nZXQoVXNlckRhdGFDb250YWluZXJbMF0sJyJWYWx1ZXMiJykNCgkJCQkJCWlmIFZhbHVlczoNCgkJCQkJCQlmb3IgY2hpbGQgaW4gVmFsdWVzWzBdLmNoaWxkcmVuOg0KCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGNoaWxkLmRhdGEsJzonKQ0KCQkJCQkJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJykNCgkJCQkJCQkJVmFsdWU9eXMuZ2V0VmFsdWUodmFsdWVzLCciVmFsdWUiJywnImYiJykNCgkJCQkJCQkJI3dyaXRlKGxvZyxbTmFtZSxWYWx1ZV0sbis0KQ0KCQkJCQkJCQlhdHJpYnV0ZXNbTmFtZV09VmFsdWUNCgkJCQkNCgkJCQkJS2V5RnJhbWVzPXlzLmdldChhLCciS2V5RnJhbWVzIicpDQoJCQkJCWlmIEtleUZyYW1lczoJCQkJDQoJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEtleUZyYW1lc1swXS5oZWFkZXIsJzonKQ0KCQkJCQkJTmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJOYW1lIicpDQoJCQkJCQlUYXJnZXROYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIlRhcmdldE5hbWUiJywnIiInKQ0KCQkJCQkJI3dyaXRlKGxvZyxbJ1F1YXRTbGVycENoYW5uZWxDb21wcmVzc2VkUGFja2VkOicsTmFtZSwnVGFyZ2V0TmFtZTonLFRhcmdldE5hbWVdLG4rNCkNCgkJCQkJCW5hbWU9Z2V0U3BsaXROYW1lKFRhcmdldE5hbWUsJ18nLC0xKQ0KCQkJCQkJI3ByaW50IFRhcmdldE5hbWUNCgkJCQkJCWJvbmU9Tm9uZQ0KCQkJCQkJI3ByaW50IFRhcmdldE5hbWUNCgkJCQkJCSNwcmludCBhdHJpYnV0ZXMNCgkJCQkJCWlmIFRhcmdldE5hbWUgaW4gYm9uZUluZGVrc0xpc3Q6DQoJCQkJCQkJbmFtZT1ib25lSW5kZWtzTGlzdFtUYXJnZXROYW1lXQ0KCQkJCQkJCWlmIG5hbWUgbm90IGluIGJvbmVMaXN0LmtleXMoKToNCgkJCQkJCQkJYm9uZT1BY3Rpb25Cb25lKCkNCgkJCQkJCQkJYWN0aW9uLmJvbmVMaXN0LmFwcGVuZChib25lKQ0KCQkJCQkJCQlib25lLm5hbWU9bmFtZQ0KCQkJCQkJCQlib25lTGlzdFtuYW1lXT1ib25lDQoJCQkJCQkJYm9uZT1ib25lTGlzdFtuYW1lXQ0KCQkJCQkJZWxzZToNCgkJCQkJCQlwcmludCAnc2tpcGVkIHF1YXRlcm5pb24gYm9uZTonLFRhcmdldE5hbWUNCgkJCQkJCQkNCgkJCQkJCUtleT15cy5nZXQoYSwnIktleSInKQ0KCQkJCQkJaWYgS2V5Og0KCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoS2V5WzBdLmRhdGEsJzonKQ0KCQkJCQkJCUl0ZW1TaXplPWludCh5cy5nZXRWYWx1ZSh2YWx1ZXMsJyJJdGVtU2l6ZSInKSkJCQkJCQkNCgkJCQkJCQlVaW50MTZBcnJheT15cy5nZXQoS2V5WzBdLCciVWludDE2QXJyYXkiJykNCgkJCQkJCQl0eXBlPSJVaW50MTZBcnJheSINCgkJCQkJCQlpZiBVaW50MTZBcnJheToNCgkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhVaW50MTZBcnJheVswXS5kYXRhLCc6JykNCgkJCQkJCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicpDQoJCQkJCQkJCVNpemU9aW50KHlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJykpDQoJCQkJCQkJCU9mZnNldD1pbnQoeXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicpKQ0KCQkJCQkJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInKQ0KCQkJCQkJCQkjd3JpdGUobG9nLFtGaWxlLCdTaXplOicsU2l6ZSwnT2Zmc2V0OicsT2Zmc2V0LCdFbmNvZGluZzonLEVuY29kaW5nLCdJdGVtU2l6ZTonLEl0ZW1TaXplXSxuKzQpDQoJCQkJCQkJCQ0KCQkJCQkJCQkJDQoJCQkJCQkJCXBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZS5zcGxpdCgnIicpWzFdCQkJDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1UcnVlIGFuZCBvcy5wYXRoLmV4aXN0cyhwYXRoLnNwbGl0KCcuZ3onKVswXSk9PUZhbHNlOg0KCQkJCQkJCQkJY21kPUNtZCgpDQoJCQkJCQkJCQljbWQuaW5wdXQ9cGF0aA0KCQkJCQkJCQkJY21kLlpJUD1UcnVlDQoJCQkJCQkJCQljbWQucnVuKCkNCgkJCQkJCQkJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCciJylbMV0uc3BsaXQoJy5neicpWzBdDQoJCQkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1GYWxzZToNCgkJCQkJCQkJCXBhdGgrPScnDQoJCQkJCQkJCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk6DQoJCQkJCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJCQ0KCQkJCQkJCQkJbGlzdD1kZWNvZGVWYXJpbnQoZyxPZmZzZXQsU2l6ZSpJdGVtU2l6ZSx0eXBlKQ0KCQkJCQkJCQkJI3dyaXRlKGxvZyxsaXN0LDApDQoJCQkJCQkJCQlsaXN0MT1ldGFwMShsaXN0LEl0ZW1TaXplKQ0KCQkJCQkJCQkJI3dyaXRlKGxvZyxsaXN0MSwwKQ0KCQkJCQkJCQkJaWYgJyJveCInIGluIGF0cmlidXRlczoNCgkJCQkJCQkJCQlsaXN0Mj1pbnQzZmxvYXQ0KGxpc3QxLGF0cmlidXRlcyxJdGVtU2l6ZSkJCQkJCQkJCQ0KCQkJCQkJCQkJCSN3cml0ZShsb2csbGlzdDIsMCkNCgkJCQkJCQkJCQlsaXN0Mz1bYXRyaWJ1dGVzWycib3giJ10sYXRyaWJ1dGVzWycib3kiJ10sYXRyaWJ1dGVzWycib3oiJ10sYXRyaWJ1dGVzWycib3ciJ11dDQoJCQkJCQkJCQkJbGlzdDMuZXh0ZW5kKGxpc3QyKQ0KCQkJCQkJCQkJCWxpc3Q0PWV0YXA0KGxpc3QzKQ0KCQkJCQkJCQkJCSN3cml0ZShsb2csbGlzdDQsMCkNCgkJCQkJCQkJCQkJCQkJCQkJDQoJCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQkJbmV3LndyaXRlKGJvbmUubmFtZSsnXHgwMCcpDQoJCQkJCQkJCQkJCW5ldy53cml0ZSgncXVhdGVybmlvbicrJ1x4MDAnKQ0KCQkJCQkJCQkJCQluZXcuaShbU2l6ZV0pDQoJCQkJCQkJCQkJZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQoJCQkJCQkJCQkJCXZhbHVlPWxpc3Q0W20qNDptKjQrNF0NCgkJCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQkJCW5ldy5mKHZhbHVlKQkJCQkJCQkJCQ0KCQkJCQkJCQkJCQl2YWx1ZT1RdWF0ZXJuaW9uKHZhbHVlKQ0KCQkJCQkJCQkJCQkjd3JpdGUobG9nLHZhbHVlLG4rOCkNCgkJCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQkJCSNuZXcuZih2YWx1ZSkNCgkJCQkJCQkJCQkJCWJvbmVNYXRyaXg9c2tlbGV0b24ub2JqZWN0LmdldERhdGEoKS5ib25lc1tib25lLm5hbWVdLm1hdHJpeFsnQVJNQVRVUkVTUEFDRSddDQoJCQkJCQkJCQkJCQkjI2JvbmUucm90S2V5TGlzdC5hcHBlbmQoKGJvbmVNYXRyaXgucm90YXRpb25QYXJ0KCkqUXVhdE1hdHJpeCh2YWx1ZSkpLnJlc2l6ZTR4NCgpKQ0KCQkJCQkJCQkJCQkJbWF0cml4PVF1YXRNYXRyaXgodmFsdWUpLnJlc2l6ZTR4NCgpIypib25lTWF0cml4DQoJCQkJCQkJCQkJCQlib25lLnJvdEtleUxpc3QuYXBwZW5kKG1hdHJpeCkNCgkJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCQkJDQoJCQkJCQlUaW1lPXlzLmdldChhLCciVGltZSInKQ0KCQkJCQkJaWYgVGltZToNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKFRpbWVbMF0uZGF0YSwnOicpDQoJCQkJCQkJSXRlbVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJywnaScpCQkJCQkJDQoJCQkJCQkJRmxvYXQzMkFycmF5PXlzLmdldChUaW1lWzBdLCciRmxvYXQzMkFycmF5IicpDQoJCQkJCQkJaWYgRmxvYXQzMkFycmF5Og0KCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCQkJCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicpDQoJCQkJCQkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCQkJCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInLCdpJykNCgkJCQkJCQkJI3dyaXRlKGxvZyxbRmlsZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnSXRlbVNpemU6JyxJdGVtU2l6ZV0sbis0KQ0KCQkJCQkJCQkNCgkJCQkJCQkJCQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXQkJCQkJCQkNCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PVRydWUgYW5kIG9zLnBhdGguZXhpc3RzKHBhdGguc3BsaXQoJy5neicpWzBdKT09RmFsc2U6DQoJCQkJCQkJCQljbWQ9Q21kKCkNCgkJCQkJCQkJCWNtZC5pbnB1dD1wYXRoDQoJCQkJCQkJCQljbWQuWklQPVRydWUNCgkJCQkJCQkJCWNtZC5ydW4oKQ0KCQkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUuc3BsaXQoJyInKVsxXS5zcGxpdCgnLmd6JylbMF0NCgkJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOg0KCQkJCQkJCQkJcGF0aCs9JycNCgkJCQkJCQkJCQ0KCQkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKToNCgkJCQkJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQkJCQkJZy5zZWVrKGludChPZmZzZXQpKQ0KCQkJCQkJCQkJbGlzdD1nLmYoU2l6ZSpJdGVtU2l6ZSkNCgkJCQkJCQkJCWxpc3QxPWV0YXAxKGxpc3QsSXRlbVNpemUpDQoJCQkJCQkJCQkjb3V0PWV0YXAyKGxpc3QxLEl0ZW1TaXplLGF0cmlidXRlcykNCgkJCQkJCQkJCWlmICcib3QiJyBpbiBhdHJpYnV0ZXM6DQoJCQkJCQkJCQkJbGlzdDI9W2F0cmlidXRlc1snIm90IiddXQ0KCQkJCQkJCQkJCWxpc3QyLmV4dGVuZChsaXN0MSkNCgkJCQkJCQkJCQlsaXN0Mz1ldGFwMyhsaXN0MixJdGVtU2l6ZSkNCgkJCQkJCQkJCQkjd3JpdGUobG9nLGxpc3QzLDApCQkNCgkJCQkJCQkJCQlpZiBib25lOm5ldy5pKFtTaXplXSkNCgkJCQkJCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCQkJCQkJdmFsdWU9bGlzdDJbbV0NCgkJCQkJCQkJCQkJaWYgYm9uZToNCgkJCQkJCQkJCQkJCW5ldy5mKFt2YWx1ZV0pDQoJCQkJCQkJCQkJCQlib25lLnJvdEZyYW1lTGlzdC5hcHBlbmQoaW50KHZhbHVlKjMzKSkNCgkJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCWV4Y2VwdDoNCgkJCQkJcHJpbnQgJ25pZXBvd29kemVuaWU6UXVhdFNsZXJwQ2hhbm5lbENvbXByZXNzZWRQYWNrZWQ6JyxUYXJnZXROYW1lDQoJCQkJCQ0KCQkJI2lmIGJvbmU6CQ0KCQkJIwlwcmludCBuYW1lLGJvbmUubmFtZQ0KCQluZXcuY2xvc2UoKQkJDQoJI2FjdGlvbi5kcmF3KCkNCgkjYWN0aW9uLnNldENvbnRleHQoKQkNCgkJDQoNCmRlZiBkZWNvZGVWYXJpbnQoZyxvZmZzZXQsc2l6ZSx0eXBlKToNCglnLnNlZWsob2Zmc2V0KQ0KCW49WzBdKnNpemUNCglhPTANCglzPTAJDQoJd2hpbGUoYSE9c2l6ZSk6DQoJCXNoaWZ0ID0gMA0KCQlyZXN1bHQgPSAwDQoJCXdoaWxlIFRydWU6DQoJCQlieXRlID0gZy5CKDEpWzBdDQoJCQlyZXN1bHQgfD0gKGJ5dGUgJiAxMjcpIDw8IHNoaWZ0DQoJCQlzaGlmdCArPSA3DQoJCQlpZiBub3QgKGJ5dGUgJiAweDgwKTpicmVhawkJCQ0KCQluW2FdPXJlc3VsdAkJDQoJCWErPTENCglpZiB0eXBlWzBdIT0nVSc6DQoJCWw9MA0KCQl3aGlsZShsPHNpemUpOg0KCQkJaD1uW2xdDQoJCQluW2xdPWg+PjFeLSgxJmgpDQoJCQlsKz0xDQoJcmV0dXJuIG4NCgkJDQoJDQoJCQ0KZGVmIGRlY29kZURlbHRhKHQsZSk6DQoJaT1lfDANCgluPWxlbih0KQ0KCWlmIGk+PWxlbih0KTpyPU5vbmUNCgllbHNlOnI9dFtpXQ0KCWE9aSsxDQoJd2hpbGUoYTxuKToNCgkJcz10W2FdDQoJCXI9dFthXT1yKyhzPj4xXi0oMSZzKSkNCgkJYSs9MQ0KCXJldHVybiB0CQ0KDQoNCmRlZiBkZWNvZGVJbXBsaWNpdChpbnB1dCxuKToNCglJTVBMSUNJVF9IRUFERVJfTEVOR1RIPTMNCglJTVBMSUNJVF9IRUFERVJfTUFTS19MRU5HVEg9MQ0KCUlNUExJQ0lUX0hFQURFUl9QUklNSVRJVkVfTEVOR1RIPTANCglJTVBMSUNJVF9IRUFERVJfRVhQRUNURURfSU5ERVg9Mg0KCWhpZ2hXYXRlcm1hcms9Mg0KCQ0KCXQ9aW5wdXQNCgllPVswXSp0W0lNUExJQ0lUX0hFQURFUl9QUklNSVRJVkVfTEVOR1RIXQ0KCWE9dFtJTVBMSUNJVF9IRUFERVJfRVhQRUNURURfSU5ERVhdDQoJcz10W0lNUExJQ0lUX0hFQURFUl9NQVNLX0xFTkdUSF0NCglvPXRbSU1QTElDSVRfSEVBREVSX0xFTkdUSDpzK0lNUExJQ0lUX0hFQURFUl9MRU5HVEhdDQoJcj1oaWdoV2F0ZXJtYXJrDQoJdT0zMipzLWxlbihlKQ0KCWw9MTw8MzENCgloPTAJDQoJd2hpbGUoaDxzKToNCgkJYz1vW2hdDQoJCWQ9MzINCgkJcD1oKmQNCgkJaWYgaD09cy0xOmY9dQ0KCQllbHNlOmY9MA0KCQlnMT1mDQoJCXdoaWxlKGcxPGQpOg0KCQkJaWYgYyZsPj5nMToNCgkJCQllW3BdPXRbbl0NCgkJCQluKz0xCQ0KCQkJZWxzZToNCgkJCQlpZiByOg0KCQkJCQllW3BdPWENCgkJCQllbHNlOg0KCQkJCQllW3BdPWENCgkJCQkJYSs9MQkJCQ0KCQkJZzErPTENCgkJCXArPTENCgkJaCs9MQ0KCXJldHVybiBlCQkNCgkNCgkNCmRlZiBkZWNvZGVXYXRlcm1hcmsodCxlLGkpOg0KCW49aVswXQ0KCXI9bGVuKHQpDQoJYT0wDQoJd2hpbGUoYTxyKToNCgkJcz1uLXRbYV0NCgkJZVthXT1zDQoJCWlmIG48PXM6bj1zKzENCgkJYSs9MQ0KCXJldHVybiBlLG4NCg0KDQpkZWYgZGVjb2RlUXVhbnRpemUoaW5wdXQscyxhLGl0ZW1zaXplKToNCgl4PVswXSpsZW4oaW5wdXQpDQoJaWQ9MA0KCWZvciByIGluIHJhbmdlKGxlbihpbnB1dCkvaXRlbXNpemUpOg0KCQlmb3IgbCBpbiByYW5nZShpdGVtc2l6ZSk6DQoJCQl4W2lkXT1zW2xdK2lucHV0W2lkXSphW2xdDQoJCQlpZCs9MQ0KCXJldHVybiB4CQkNCgkJDQoNCmRlZiBkZWNvZGVQcmVkaWN0KGluZGljZXMsaW5wdXQsaXRlbXNpemUpOgkNCgl0PWlucHV0CQ0KCWlmIGxlbihpbmRpY2VzKT4wOg0KCQl0PWlucHV0CQ0KCQllPWl0ZW1zaXplDQoJCWk9aW5kaWNlcwkNCgkJbj1sZW4odCkvZQ0KCQlyPVswXSpuDQoJCWE9bGVuKGkpLTENCgkJcltpWzBdXT0xDQoJCXJbaVsxXV09MQ0KCQlyW2lbMl1dPTEJDQoJCXM9Mg0KCQl3aGlsZShzPGEpOg0KCQkJbz1zLTINCgkJCXU9aVtvXQ0KCQkJbD1pW28rMV0NCgkJCWg9aVtvKzJdDQoJCQljPWlbbyszXQ0KCQkJaWYgMSE9cltjXToNCgkJCQlyW2NdPTENCgkJCQl1Kj1lDQoJCQkJbCo9ZQ0KCQkJCWgqPWUNCgkJCQljKj1lCQkJDQoJCQkJZD0wDQoJCQkJd2hpbGUoZDxlKToNCgkJCQkJdFtjK2RdPXRbYytkXSt0W2wrZF0rdFtoK2RdLXRbdStkXQ0KCQkJCQlkKz0xDQoJCQlzKz0xDQoJcmV0dXJuIHQNCg0KDQoNCmNsYXNzIE5vZGU6DQoJZGVmIF9faW5pdF9fKHNlbGYpOg0KCQlzZWxmLm5hbWU9Tm9uZQ0KCQlzZWxmLmNoaWxkcmVuPVtdDQoJCXNlbGYub3NnQ2hpbGRyZW49W10NCgkJc2VsZi5vZmZzZXQ9Tm9uZQ0KCQlzZWxmLnN0YXJ0PU5vbmUNCgkJc2VsZi5lbmQ9Tm9uZQ0KCQlzZWxmLmhlYWRlcj0nJw0KCQlzZWxmLmRhdGE9JycNCgkJc2VsZi5wYXJlbnQ9Tm9uZQ0KCQ0KY2xhc3MgWXNvbjoNCglkZWYgX19pbml0X18oc2VsZik6DQoJCXNlbGYuaW5wdXQ9Tm9uZQ0KCQlzZWxmLmZpbGVuYW1lPU5vbmUNCgkJc2VsZi5yb290PU5vZGUoKQ0KCQlzZWxmLmxvZz1GYWxzZQ0KCWRlZiBwYXJzZShzZWxmKToNCgkJZ2xvYmFsIG9mZnNldCxzdHJpbmcsdHh0DQoJCWlmIHNlbGYuZmlsZW5hbWUgaXMgbm90IE5vbmU6DQoJCQlmaWxlPW9wZW4oc2VsZi5maWxlbmFtZSwncmInKQ0KCQkJc2VsZi5pbnB1dD1maWxlLnJlYWQoKS5yZXBsYWNlKCdceDIwJywnJykucmVwbGFjZSgnXHgwQScsJycpLnJlcGxhY2UoJyYjMzQ7JywnIicpCQkNCgkJDQoJCQlsaW5lPXNlbGYuaW5wdXQNCgkJCWlmIHNlbGYubG9nPT1UcnVlOnR4dD1vcGVuKHNlbGYuZmlsZW5hbWUrJy55cycsJ3cnKQ0KCQkJDQoJCQlpZiBsaW5lIGlzIG5vdCBOb25lIGFuZCBsZW4obGluZSk+MDoNCgkJCQlvZmZzZXQ9MA0KCQkJCW49MA0KCQkJCXN0cmluZz1bXQ0KCQkJCWlmIHNlbGYuaW5wdXRbb2Zmc2V0XT09J3snOg0KCQkJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQkJCXR4dC53cml0ZSgnXG4nKQ0KCQkJCQkJdHh0LndyaXRlKCcgJypuKydoZWFkZXI6JytzdHIoTm9uZSkpDQoJCQkJCQl0eHQud3JpdGUoJyB7ICcrc3RyKG9mZnNldCkpDQoJCQkJCQl0eHQud3JpdGUoJyAnKihuKzQpKQ0KCQkJCWlmIHNlbGYuaW5wdXRbb2Zmc2V0XT09J1snOg0KCQkJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQkJCXR4dC53cml0ZSgnXG4nKQ0KCQkJCQkJdHh0LndyaXRlKCcgJypuKydoZWFkZXI6JytzdHIoTm9uZSkpDQoJCQkJCQl0eHQud3JpdGUoJyBbICcrc3RyKG9mZnNldCkpDQoJCQkJCQl0eHQud3JpdGUoJyAnKihuKzQpKQ0KCQkJCXNlbGYudHJlZShzZWxmLnJvb3QsbikNCgkJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQkJdHh0LndyaXRlKCcgJypuKQ0KCQkJCQ0KCQkJZmlsZS5jbG9zZSgpCQ0KCQkJDQoJCWlmIHNlbGYubG9nPT1UcnVlOnR4dC5jbG9zZSgpDQoNCglkZWYgZ2V0VHJlZTEoc2VsZixwYXJlbnQsbGlzdCxrZXkpOg0KCQlmb3IgY2hpbGQgaW4gcGFyZW50LmNoaWxkcmVuOg0KCQkJaWYga2V5IGluIGNoaWxkLmhlYWRlcjoNCgkJCQlsaXN0LmFwcGVuZChjaGlsZCkNCgkJCXNlbGYuZ2V0VHJlZShjaGlsZCxsaXN0LGtleSkNCgkJCQ0KCQkNCglkZWYgZ2V0VHJlZShzZWxmLHBhcmVudCxsaXN0LGtleSk6DQoJCWlmIGtleSBpbiBwYXJlbnQuaGVhZGVyIG9yIGtleSBpbiBwYXJlbnQuZGF0YToNCgkJCWxpc3QuYXBwZW5kKHBhcmVudCkNCgkJZm9yIGNoaWxkIGluIHBhcmVudC5jaGlsZHJlbjoNCgkJCXNlbGYuZ2V0VHJlZShjaGlsZCxsaXN0LGtleSkJDQoNCglkZWYgdmFsdWVzKHNlbGYsZGF0YSx0eXBlKToNCgkJbGlzdD17fQ0KCQlBPWRhdGEuc3BsaXQoJywnKQ0KCQlpZiB0eXBlPT0nOic6DQoJCQlmb3IgYSBpbiBBOg0KCQkJCWlmICc6JyBpbiBhOg0KCQkJCQljPTANCgkJCQkJYWxpc3Q9W10NCgkJCQkJc3RyaW5nPScnDQoJCQkJCWZvciBiIGluIGE6DQoJCQkJCQlpZiBiPT0nIicgYW5kIGM9PTA6DQoJCQkJCQkJaWYgbGVuKHN0cmluZyk+MDphbGlzdC5hcHBlbmQoc3RyaW5nKQ0KCQkJCQkJCXN0cmluZz0nJw0KCQkJCQkJCXN0cmluZys9Yg0KCQkJCQkJCWM9MQ0KCQkJCQkJZWxpZiBiPT0nIicgYW5kIGM9PTE6DQoJCQkJCQkJc3RyaW5nKz1iDQoJCQkJCQkJaWYgbGVuKHN0cmluZyk+MDphbGlzdC5hcHBlbmQoc3RyaW5nKQ0KCQkJCQkJCXN0cmluZz0nJw0KCQkJCQkJCWM9MA0KCQkJCQkJZWxpZiBiPT0nOic6DQoJCQkJCQkJcGFzcw0KCQkJCQkJZWxzZTpzdHJpbmcrPWINCgkJCQkJaWYgbGVuKHN0cmluZyk+MDphbGlzdC5hcHBlbmQoc3RyaW5nKQ0KCQkJCQlpZiBsZW4oYWxpc3QpPT0yOgkNCgkJCQkJCWxpc3RbYWxpc3RbMF1dPWFsaXN0WzFdCQkNCgkJCQkJaWYgbGVuKGFsaXN0KT09MToJDQoJCQkJCQlsaXN0W2FsaXN0WzBdXT0nTm9uZScJCQkJCQkNCgkJCQkJCQkJCQ0KCQkJCQkJDQoJCQkJCQkJDQoJCQkJCSNpZiBhLmNvdW50KCc6Jyk+MToNCgkJaWYgdHlwZT09J2YnOg0KCQkJbGlzdD1tYXAoZmxvYXQsQSkNCgkJaWYgdHlwZT09J2knOg0KCQkJbGlzdD1tYXAoaW50LEEpDQoJCWlmIHR5cGU9PSdzJzoNCgkJCWxpc3Q9QQ0KCQlyZXR1cm4gbGlzdAkNCg0KCWRlZiBnZXRWYWx1ZShzZWxmLHZhbHVlcyxuYW1lLHR5cGU9Tm9uZSk6DQoJCWlmIG5hbWUgaW4gdmFsdWVzOg0KCQkJaWYgdHlwZT09JyJmIic6DQoJCQkJcmV0dXJuIGZsb2F0KHZhbHVlc1tuYW1lXS5zcGxpdCgnIicpWzFdKQ0KCQkJZWxpZiB0eXBlPT0nImkiJzoNCgkJCQlyZXR1cm4gaW50KHZhbHVlc1tuYW1lXS5zcGxpdCgnIicpWzFdKQ0KCQkJZWxpZiB0eXBlPT0naSc6DQoJCQkJI3ByaW50IG5hbWUsdmFsdWVzW25hbWVdDQoJCQkJaWYgdmFsdWVzW25hbWVdIT0nTm9uZSc6DQoJCQkJDQoJCQkJCXJldHVybiBpbnQodmFsdWVzW25hbWVdKQ0KCQkJCWVsc2U6DQoJCQkJCXJldHVybiBOb25lDQoJCQllbGlmIHR5cGU9PSciIic6DQoJCQkJcmV0dXJuIHZhbHVlc1tuYW1lXS5zcGxpdCgnIicpWzFdDQoJCQllbHNlOg0KCQkJCXJldHVybiB2YWx1ZXNbbmFtZV0NCgkJZWxzZToNCgkJCXJldHVybiBOb25lDQoJCQ0KCWRlZiBnZXQoc2VsZixub2RlLGtleSk6CQkNCgkJbGlzdD1bXQ0KCQlzZWxmLmdldFRyZWUobm9kZSxsaXN0LGtleSkNCgkJaWYgbGVuKGxpc3QpPjA6DQoJCQlyZXR1cm4gbGlzdAkNCgkJZWxzZToNCgkJCXJldHVybiBOb25lDQoJCQkNCglkZWYgdHJlZShzZWxmLHBhcmVudE5vZGUsbik6DQoJCWdsb2JhbCBvZmZzZXQsc3RyaW5nDQoJCW4rPTQNCgkJb2Zmc2V0Kz0xDQoJCXdoaWxlKFRydWUpOgkNCgkJCWlmCW9mZnNldD49bGVuKHNlbGYuaW5wdXQpOmJyZWFrDQoJCQl2YWx1ZT1zZWxmLmlucHV0W29mZnNldF0NCgkJCWlmIHZhbHVlPT0nfSc6DQoJCQkJaWYgc2VsZi5sb2c9PVRydWU6DQoJCQkJCXR4dC53cml0ZSgnXG4nKQ0KCQkJCQlpZiBsZW4oc3RyaW5nKT4wOg0KCQkJCQkJdHh0LndyaXRlKCcgJypuKydkYXRhOicrc2VsZi5pbnB1dFtzdHJpbmdbMF06b2Zmc2V0XSkJDQoJCQkJCWVsc2U6CQ0KCQkJCQkJdHh0LndyaXRlKCcgJypuKydkYXRhOk5vbmUnKQkJCQkNCgkJCQkJdHh0LndyaXRlKCdcbicrJyAnKm4rJyB9ICcrc3RyKG9mZnNldCkpDQoJCQkJaWYgbGVuKHN0cmluZyk+MDoJDQoJCQkJCXBhcmVudE5vZGUuZGF0YT1zZWxmLmlucHV0W3N0cmluZ1swXTpvZmZzZXRdDQoJCQkJc3RyaW5nPVtdDQoJCQkJb2Zmc2V0Kz0xCQkJDQoJCQkJYnJlYWsNCgkJCQ0KCQkJZWxpZiB2YWx1ZT09J3snOg0KCQkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCQl0eHQud3JpdGUoJ1xuJykNCgkJCQkJaWYgbGVuKHN0cmluZyk+MDoNCgkJCQkJCXR4dC53cml0ZSgnICcqbisnaGVhZGVyOicrc2VsZi5pbnB1dFtzdHJpbmdbMF06b2Zmc2V0XSkJDQoJCQkJCWVsc2U6CQ0KCQkJCQkJdHh0LndyaXRlKCcgJypuKydoZWFkZXI6Tm9uZScpCQkJCQ0KCQkJCQl0eHQud3JpdGUoJyB7ICcrc3RyKG9mZnNldCkpDQoJCQkJCXR4dC53cml0ZSgnICcqKG4rNCkpDQoJCQkJI3ByaW50IHJvdW5kKDEwMCpvZmZzZXQvZmxvYXQobGVuKHNlbGYuaW5wdXQpKSwzKSwncHJvY2VudCcNCgkJCQlub2RlPU5vZGUoKQ0KCQkJCW5vZGUucGFyZW50PXBhcmVudE5vZGUNCgkJCQlwYXJlbnROb2RlLmNoaWxkcmVuLmFwcGVuZChub2RlKQ0KCQkJCW5vZGUub2Zmc2V0PW9mZnNldA0KCQkJCWlmIGxlbihzdHJpbmcpPjA6DQoJCQkJCW5vZGUuaGVhZGVyPXNlbGYuaW5wdXRbc3RyaW5nWzBdOm9mZnNldF0NCgkJCQlzdHJpbmc9W10NCgkJCQlzZWxmLnRyZWUobm9kZSxuKQ0KCQkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCQl0eHQud3JpdGUoJyAnKm4pDQoJCQkJDQoJCQllbGlmIHZhbHVlPT0nXSc6DQoJCQkJaWYgbGVuKHN0cmluZyk+MDoNCgkJCQkJcGFyZW50Tm9kZS5kYXRhPXNlbGYuaW5wdXRbc3RyaW5nWzBdOm9mZnNldF0NCgkJCQkNCgkJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQkJdHh0LndyaXRlKCdcbicpDQoJCQkJCWlmIGxlbihzdHJpbmcpPjA6DQoJCQkJCQl0eHQud3JpdGUoJyAnKm4rJ2RhdGE6JytzZWxmLmlucHV0W3N0cmluZ1swXTpvZmZzZXRdKydcbicpCQ0KCQkJCQllbHNlOgkNCgkJCQkJCXR4dC53cml0ZSgnICcqbisnZGF0YTpOb25lJykJCQkJCQkJDQoJCQkJCXR4dC53cml0ZSgnICcqbisnIF0gJytzdHIob2Zmc2V0KSkNCgkJCQkJDQoJCQkJb2Zmc2V0Kz0xDQoJCQkJc3RyaW5nPVtdDQoJCQkJYnJlYWsNCgkJCQ0KCQkJZWxpZiB2YWx1ZT09J1snOg0KCQkJCWlmIHNlbGYubG9nPT1UcnVlOg0KCQkJCQl0eHQud3JpdGUoJ1xuJykNCgkJCQkJaWYgbGVuKHN0cmluZyk+MDoNCgkJCQkJCXR4dC53cml0ZSgnICcqbisnaGVhZGVyOicrc2VsZi5pbnB1dFtzdHJpbmdbMF06b2Zmc2V0XSkNCgkJCQkJZWxzZToJDQoJCQkJCQl0eHQud3JpdGUoJyAnKm4rJ2hlYWRlcjpOb25lJykNCgkJCQkJdHh0LndyaXRlKCcgWyAnK3N0cihvZmZzZXQpKQ0KCQkJCQl0eHQud3JpdGUoJyAnKihuKzQpKQ0KCQkJCSNwcmludCByb3VuZCgxMDAqb2Zmc2V0L2Zsb2F0KGxlbihzZWxmLmlucHV0KSksMyksJ3Byb2NlbnQnDQoJCQkJbm9kZT1Ob2RlKCkNCgkJCQlub2RlLnBhcmVudD1wYXJlbnROb2RlDQoJCQkJcGFyZW50Tm9kZS5jaGlsZHJlbi5hcHBlbmQobm9kZSkNCgkJCQlub2RlLm9mZnNldD1vZmZzZXQNCgkJCQlub2RlLm5hbWU9c3RyaW5nDQoJCQkJaWYgbGVuKHN0cmluZyk+MDoNCgkJCQkJbm9kZS5oZWFkZXI9c2VsZi5pbnB1dFtzdHJpbmdbMF06b2Zmc2V0XQ0KCQkJCWVsc2U6DQoJCQkJCW5vZGUuaGVhZGVyPScnDQoJCQkJc3RyaW5nPVtdDQoJCQkJc2VsZi50cmVlKG5vZGUsbikNCgkJCQlpZiBzZWxmLmxvZz09VHJ1ZToNCgkJCQkJdHh0LndyaXRlKCcgJypuKQ0KCQkJZWxzZToJCQkNCgkJCQkjc3RyaW5nKz12YWx1ZQ0KCQkJCWlmIGxlbihzdHJpbmcpPT0wOg0KCQkJCQlzdHJpbmcuYXBwZW5kKG9mZnNldCkNCgkJCQlvZmZzZXQrPTENCgkJDQpkZWYgZ2V0VW5pcXVlSUQoeXMsZGF0YSk6DQoJVW5pcXVlSUQ9Tm9uZQ0KCXZhbHVlcz15cy52YWx1ZXMoZGF0YSwnOicpDQoJaWYgJyJVbmlxdWVJRCInIGluIHZhbHVlczoNCgkJVW5pcXVlSUQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciVW5pcXVlSUQiJywnaScpDQoJcmV0dXJuIFVuaXF1ZUlECQ0KCQ0KDQpjbGFzcyBOZXdOb2RlOg0KCWRlZiBfX2luaXRfXyhzZWxmKToNCgkJc2VsZi5ub2RlPU5vbmUNCgkJc2VsZi5wYXJlbnQ9Tm9uZQ0KCQlzZWxmLmNoaWxkcmVuPVtdDQoJCXNlbGYuVW5pcXVlSUQ9Tm9uZQ0KCQ0KZGVmIGdldElEVHJlZSh5cyxwYXJlbnROb2RlLG4scGFyZW50TmV3Tm9kZSk6DQoJaWYgbGVuKHBhcmVudE5vZGUuaGVhZGVyKSE9MCBhbmQgcGFyZW50Tm9kZS5oZWFkZXIhPScsJzoNCgkJbis9NA0KCVVuaXF1ZUlEPWdldFVuaXF1ZUlEKHlzLHBhcmVudE5vZGUuZGF0YSkNCglpZiBVbmlxdWVJRDoNCgkJcGFyZW50TmV3Tm9kZS5VbmlxdWVJRD1VbmlxdWVJRA0KCWZvciBjaGlsZCBpbiBwYXJlbnROb2RlLmNoaWxkcmVuOg0KCQlpZiBsZW4oY2hpbGQuaGVhZGVyKSE9MCBhbmQgY2hpbGQuaGVhZGVyIT0nLCc6DQoJCQluZXdOb2RlPU5ld05vZGUoKQ0KCQkJVW5pcXVlSUQ9Z2V0VW5pcXVlSUQoeXMsY2hpbGQuaGVhZGVyKQ0KCQkJaWYgVW5pcXVlSUQ6DQoJCQkJcGFyZW50TmV3Tm9kZS5VbmlxdWVJRD1VbmlxdWVJRA0KCQkJbmV3Tm9kZS5ub2RlPWNoaWxkDQoJCQlwYXJlbnROZXdOb2RlLmNoaWxkcmVuLmFwcGVuZChuZXdOb2RlKQ0KCQkJbmV3Tm9kZUxpc3QuYXBwZW5kKG5ld05vZGUpDQoJCQluZXdOb2RlLnBhcmVudD1wYXJlbnROb2RlDQoJCQlwYXJlbnROZXdOb2RlMT1uZXdOb2RlDQoJCQlnZXRJRFRyZWUoeXMsY2hpbGQsbixwYXJlbnROZXdOb2RlMSkNCgkJZWxzZToJDQoJCQlnZXRJRFRyZWUoeXMsY2hpbGQsbixwYXJlbnROZXdOb2RlKQ0KCQkJDQoJCQkJCQkJCQ0KZGVmIGdldFBhdGgoRmlsZSk6DQoJcGF0aD1vcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpK29zLnNlcCtGaWxlLnNwbGl0KCcuZ3onKVswXQ0KCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1GYWxzZTpwYXRoPW9zLnBhdGguZGlybmFtZShmaWxlbmFtZSkrb3Muc2VwK0ZpbGUrJy50eHQnDQoJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOnBhdGg9b3MucGF0aC5kaXJuYW1lKGZpbGVuYW1lKStvcy5zZXArRmlsZQ0KCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1UcnVlOnJldHVybiBwYXRoDQoJZWxzZTpyZXR1cm4gTm9uZQ0KCQkJDQoJCQkNCmRlZiBWZXJ0ZXgoeXMsYik6DQoJbj0yMA0KCVNpemU9Tm9uZQ0KCU9mZnNldD1Ob25lDQoJRW5jb2Rpbmc9Tm9uZQ0KCUl0ZW1TaXplPU5vbmUNCgl0eXBlPU5vbmUNCgl2ZXJ0ZXhBcnJheT1bXQkNCgl2YWx1ZXM9eXMudmFsdWVzKGIuZGF0YSwnOicpDQoJaWYgJyJJdGVtU2l6ZSInIGluIHZhbHVlczoNCgkJSXRlbVNpemU9aW50KHZhbHVlc1snIkl0ZW1TaXplIiddKQkJCQkJDQoJCUludDMyQXJyYXk9eXMuZ2V0KGIsJyJJbnQzMkFycmF5IicpDQoJCWlmIEludDMyQXJyYXk6DQoJCQl0eXBlPSdJbnQzMkFycmF5Jw0KCQkJdmFsdWVzPXlzLnZhbHVlcyhJbnQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicsJ2knKQ0KCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInLCdpJykNCgkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInLCciIicpDQoJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInKQ0KCQkJI3dyaXRlKGxvZyxbdHlwZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZ10sbikNCgkJCWlmIEVuY29kaW5nPT0nInZhcmludCInOgkJCQkJCQ0KCQkJCXBhdGg9Z2V0UGF0aChGaWxlKQ0KCQkJCWlmIHBhdGg6DQoJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCWJ5dGVzPWRlY29kZVZhcmludChnLE9mZnNldCxTaXplKkl0ZW1TaXplLHR5cGUpDQoJCQkJCXZlcnRleEFycmF5LmFwcGVuZChbYnl0ZXMsRW5jb2RpbmcsSXRlbVNpemVdKQ0KCQkJCQlmaWxlLmNsb3NlKCkNCgkJCQkJDQoJCUZsb2F0MzJBcnJheT15cy5nZXQoYiwnIkZsb2F0MzJBcnJheSInKQ0KCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQl0eXBlPSdGbG9hdDMyQXJyYXknDQoJCQkjcHJpbnQgbW9kZSx0eXBlDQoJCQl2YWx1ZXM9eXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJywnIiInKQ0KCQkJRW5jb2Rpbmc9eXMuZ2V0VmFsdWUodmFsdWVzLCciRW5jb2RpbmciJykNCgkJCSN3cml0ZShsb2csW3R5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmddLG4pDQoJCQlpZiBFbmNvZGluZyE9JyJ2YXJpbnQiJzoJCQkJCQkNCgkJCQlwYXRoPWdldFBhdGgoRmlsZSkNCgkJCQlpZiBwYXRoOg0KCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQlnLnNlZWsoT2Zmc2V0KQ0KCQkJCQlieXRlcz1nLmYoU2l6ZSpJdGVtU2l6ZSkNCgkJCQkJbGlzdD1bXQ0KCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCWxpc3QuYXBwZW5kKGJ5dGVzW20qSXRlbVNpemU6bSpJdGVtU2l6ZStJdGVtU2l6ZV0pDQoJCQkJCXZlcnRleEFycmF5LmFwcGVuZChbbGlzdCxFbmNvZGluZ10pDQoJCQkJCWZpbGUuY2xvc2UoKQ0KCXJldHVybiB2ZXJ0ZXhBcnJheQkJCQkNCgkNCmRlZiBUZXhDb29yZCh5cyxiKToNCgluPTIwDQoJU2l6ZT1Ob25lDQoJT2Zmc2V0PU5vbmUNCglFbmNvZGluZz1Ob25lDQoJSXRlbVNpemU9Tm9uZQ0KCXR5cGU9Tm9uZQkNCglUZXhDb29yZEFycmF5PVtdDQoJdmFsdWVzPXlzLnZhbHVlcyhiLmRhdGEsJzonKQ0KCWlmICciSXRlbVNpemUiJyBpbiB2YWx1ZXM6DQoJCUl0ZW1TaXplPWludCh2YWx1ZXNbJyJJdGVtU2l6ZSInXSkJCQkJCQ0KCQlJbnQzMkFycmF5PXlzLmdldChiLCciSW50MzJBcnJheSInKQ0KCQlpZiBJbnQzMkFycmF5Og0KCQkJdHlwZT0nSW50MzJBcnJheScNCgkJCXZhbHVlcz15cy52YWx1ZXMoSW50MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJywnIiInKQ0KCQkJRW5jb2Rpbmc9eXMuZ2V0VmFsdWUodmFsdWVzLCciRW5jb2RpbmciJykNCgkJCWlmIEVuY29kaW5nPT0nInZhcmludCInOgkJCQkJCQ0KCQkJCXBhdGg9Z2V0UGF0aChGaWxlKQ0KCQkJCWlmIHBhdGg6DQoJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCWJ5dGVzPWRlY29kZVZhcmludChnLE9mZnNldCxTaXplKkl0ZW1TaXplLHR5cGUpDQoJCQkJCVRleENvb3JkQXJyYXkuYXBwZW5kKFtieXRlcyxFbmNvZGluZyxJdGVtU2l6ZV0pDQoJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCQkNCgkJRmxvYXQzMkFycmF5PXlzLmdldChiLCciRmxvYXQzMkFycmF5IicpDQoJCWlmIEZsb2F0MzJBcnJheToNCgkJCXR5cGU9J0Zsb2F0MzJBcnJheScNCgkJCXZhbHVlcz15cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicsJ2knKQ0KCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInLCdpJykNCgkJCUZpbGU9eXMuZ2V0VmFsdWUodmFsdWVzLCciRmlsZSInLCciIicpDQoJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInKQ0KCQkJaWYgRW5jb2RpbmchPScidmFyaW50Iic6CQkJCQkJDQoJCQkJcGF0aD1nZXRQYXRoKEZpbGUpDQoJCQkJaWYgcGF0aDoNCgkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJZy5zZWVrKE9mZnNldCkNCgkJCQkJYnl0ZXM9Zy5mKFNpemUqSXRlbVNpemUpDQoJCQkJCWxpc3Q9W10NCgkJCQkJZm9yIG0gaW4gcmFuZ2UoU2l6ZSk6DQoJCQkJCQl1LHY9Ynl0ZXNbbSpJdGVtU2l6ZTptKkl0ZW1TaXplK0l0ZW1TaXplXQ0KCQkJCQkJbGlzdC5hcHBlbmQoW3UsMS12XSkNCgkJCQkJVGV4Q29vcmRBcnJheS5hcHBlbmQoW2xpc3QsRW5jb2RpbmddKQ0KCQkJCQlmaWxlLmNsb3NlKCkNCglyZXR1cm4gVGV4Q29vcmRBcnJheQ0KCQ0KZGVmIENvbG9yKHlzLGIpOg0KCW49MjANCglTaXplPU5vbmUNCglPZmZzZXQ9Tm9uZQ0KCUVuY29kaW5nPU5vbmUNCglJdGVtU2l6ZT1Ob25lDQoJdHlwZT1Ob25lCQkJCQ0KCXZhbHVlcz15cy52YWx1ZXMoYi5kYXRhLCc6JykNCgljb2xvckFycmF5PVtdDQoJaWYgJyJJdGVtU2l6ZSInIGluIHZhbHVlczoNCgkJSXRlbVNpemU9aW50KHZhbHVlc1snIkl0ZW1TaXplIiddKQkJCQkJDQoJCVVpbnQ4QXJyYXk9eXMuZ2V0KGIsJyJVaW50OEFycmF5IicpDQoJCWlmIFVpbnQ4QXJyYXk6DQoJCQl0eXBlPSJVaW50OEFycmF5Ig0KCQkJdmFsdWVzPXlzLnZhbHVlcyhVaW50OEFycmF5WzBdLmRhdGEsJzonKQ0KCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicsJ2knKQ0KCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInLCdpJykNCgkJCUVuY29kaW5nPXlzLmdldFZhbHVlKHZhbHVlcywnIkVuY29kaW5nIicsJyIiJykJDQoJCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJywnIiInKQkJCQkJDQoJCQlwYXRoPWdldFBhdGgoRmlsZSkNCgkJCWlmIHBhdGg6DQoJCQkJaWYgRW5jb2RpbmchPScidmFyaW50Iic6DQoJCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCWcuc2VlayhPZmZzZXQpDQoJCQkJCWJ5dGVzPWcuQihTaXplKkl0ZW1TaXplKQ0KCQkJCQlsaXN0PVtdDQoJCQkJCWZvciBtIGluIHJhbmdlKFNpemUpOg0KCQkJCQkJbGlzdC5hcHBlbmQoYnl0ZXNbbSpJdGVtU2l6ZTptKkl0ZW1TaXplK0l0ZW1TaXplXSkNCgkJCQkJY29sb3JBcnJheT1saXN0DQoJCQkJCWZpbGUuY2xvc2UoKQkJCQkJDQoJCUZsb2F0MzJBcnJheT15cy5nZXQoYiwnIkZsb2F0MzJBcnJheSInKQ0KCQlpZiBGbG9hdDMyQXJyYXk6DQoJCQl0eXBlPSJGbG9hdDMyQXJyYXkiDQoJCQl2YWx1ZXM9eXMudmFsdWVzKEZsb2F0MzJBcnJheVswXS5kYXRhLCc6JykNCgkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInLCciIicpCQ0KCQkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicsJyIiJykJCQkJCQ0KCQkJcGF0aD1nZXRQYXRoKEZpbGUpDQoJCQlpZiBwYXRoOg0KCQkJCWlmIEVuY29kaW5nIT0nInZhcmludCInOg0KCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCQlnLnNlZWsoT2Zmc2V0KQ0KCQkJCQlieXRlcz1nLmYoU2l6ZSpJdGVtU2l6ZSkNCgkJCQkJbGlzdD1bXQ0KCQkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJCWl0ZW1zPWJ5dGVzW20qSXRlbVNpemU6bSpJdGVtU2l6ZStJdGVtU2l6ZV0NCgkJCQkJCUE9W10NCgkJCQkJCWZvciBpdGVtIGluIGl0ZW1zOg0KCQkJCQkJCUEuYXBwZW5kKGludChpdGVtKjI1NikpDQoJCQkJCQlsaXN0LmFwcGVuZChBKQ0KCQkJCQljb2xvckFycmF5PWxpc3QNCgkJCQkJZmlsZS5jbG9zZSgpDQoJcmV0dXJuIGNvbG9yQXJyYXkJCQkJCQkJDQoJDQoJDQoJDQpkZWYgZ2V0SW5kaWNlcyhpdGVtc2l6ZSxzaXplLG9mZnNldCx0eXBlLGcsbW9kZSxtYWdpYyk6DQoJaWYgdHlwZSE9IlVpbnQ4QXJyYXkiOmJ5dGVzPWRlY29kZVZhcmludChnLG9mZnNldCxzaXplKml0ZW1zaXplLHR5cGUpDQoJZWxzZToNCgkJZy5zZWVrKG9mZnNldCkNCgkJYnl0ZXM9bGlzdChnLkIoc2l6ZSppdGVtc2l6ZSkpCQkNCgl3cml0ZShsb2csW21hZ2ljLG1vZGUsdHlwZV0sMCkNCgl3cml0ZShsb2csYnl0ZXMsMCkJCQ0KCQ0KCUlNUExJQ0lUX0hFQURFUl9MRU5HVEg9Mw0KCUlNUExJQ0lUX0hFQURFUl9NQVNLX0xFTkdUSD0xDQoJSU1QTElDSVRfSEVBREVSX1BSSU1JVElWRV9MRU5HVEg9MA0KCUlNUExJQ0lUX0hFQURFUl9FWFBFQ1RFRF9JTkRFWD0yDQoJaGlnaFdhdGVybWFyaz0yDQoJDQoJTWlzc2luZ0NvbmRpdGlvbj1za2lwZGVjb2RlDQoJaWYgTWlzc2luZ0NvbmRpdGlvbiE9MToNCgkJDQoJCWlmIG1vZGU9PSciVFJJQU5HTEVfU1RSSVAiJzoNCgkJCQkJaz1JTVBMSUNJVF9IRUFERVJfTEVOR1RIK2J5dGVzW0lNUExJQ0lUX0hFQURFUl9NQVNLX0xFTkdUSF0NCgkJCQkJYnl0ZXM9ZGVjb2RlRGVsdGEoYnl0ZXMsaykJDQoJCQkJCSN3cml0ZShsb2csW21hZ2ljLGtdLDApCQ0KCQkJCQkjd3JpdGUobG9nLGJ5dGVzLDApCQkNCgkJCQkJYnl0ZXM9ZGVjb2RlSW1wbGljaXQoYnl0ZXMsaykNCgkJCQkJI3dyaXRlKGxvZyxbbWFnaWMsa10sMCkJDQoJCQkJCSN3cml0ZShsb2csYnl0ZXMsMCkJCQkNCgkJCQkJaT1bbWFnaWNdCQ0KCQkJCQlieXRlcyxtYWdpYz1kZWNvZGVXYXRlcm1hcmsoYnl0ZXMsYnl0ZXMsaSkNCgkJCQkJI3dyaXRlKGxvZyxbbWFnaWNdLDApCQ0KCQkJCQkjd3JpdGUobG9nLGJ5dGVzLDApCQ0KCQkJCQ0KCQllbGlmIG1vZGU9PSciVFJJQU5HTEVTIic6DQoJCQkJCWs9MA0KCQkJCQlieXRlcz1kZWNvZGVEZWx0YShieXRlcyxrKQ0KCQkJCQkjd3JpdGUobG9nLFttYWdpY10sMCkJDQoJCQkJCSN3cml0ZShsb2csYnl0ZXMsMCkJCQkNCgkJCQkJaT1bbWFnaWNdCQ0KCQkJCQlieXRlcyxtYWdpYz1kZWNvZGVXYXRlcm1hcmsoYnl0ZXMsYnl0ZXMsaSkNCgkJCQkJI3dyaXRlKGxvZyxbbWFnaWNdLDApCQ0KCQkJCQkjd3JpdGUobG9nLGJ5dGVzLDApCQ0KCQkNCgkJDQoJCQ0KCQkNCglyZXR1cm4gbWFnaWMsYnl0ZXMNCgkNCgkJCQkNCmRlZiBQcmltaXRpdmVTZXRMaXN0KHlzLGNoaWxkKToNCglnbG9iYWwgbWFnaWMNCgltb2RlPU5vbmUNCgltYWdpYz0wDQoJbj0xNg0KCWluZGljZUFycmF5PVtdDQoJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOgkJCQkJDQoJCWI9Y2hpbGQubm9kZQ0KCQlpZiAnIkRyYXdFbGVtZW50c1VJbnQiJyBpbiBiLmhlYWRlcjoJCQkNCgkJCXZhbHVlcz15cy52YWx1ZXMoYi5kYXRhLCc6JykNCgkJCW1vZGU9dmFsdWVzWyciTW9kZSInXQkJCQ0KCQkJU2l6ZT1Ob25lDQoJCQlPZmZzZXQ9Tm9uZQ0KCQkJRW5jb2Rpbmc9Tm9uZQ0KCQkJSXRlbVNpemU9Tm9uZQ0KCQkJdHlwZT1Ob25lDQoJCQlpZiBtb2RlIT0nIkxJTkVTIic6DQoJCQkJSW5kaWNlcz15cy5nZXQoYiwnIkluZGljZXMiJykNCgkJCQlpZiBJbmRpY2VzOg0KCQkJCQl2YWx1ZXM9eXMudmFsdWVzKEluZGljZXNbMF0uZGF0YSwnOicpDQoJCQkJCUl0ZW1TaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIkl0ZW1TaXplIicsJ2knKQ0KCQkJCQlVaW50MzJBcnJheT15cy5nZXQoSW5kaWNlc1swXSwnIlVpbnQzMkFycmF5IicpDQoJCQkJCXR5cGU9IlVpbnQzMkFycmF5Ig0KCQkJCQkjcHJpbnQgIkRyYXdFbGVtZW50c1VJbnQiLHR5cGUNCgkJCQkJaWYgVWludDMyQXJyYXk6DQoJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKFVpbnQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQkJCQkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicsJ2knKQ0KCQkJCQkJT2Zmc2V0PXlzLmdldFZhbHVlKHZhbHVlcywnIk9mZnNldCInLCdpJykNCgkJCQkJCUVuY29kaW5nPXlzLmdldFZhbHVlKHZhbHVlcywnIkVuY29kaW5nIicsJyIiJykNCgkJCQkJCSN3cml0ZShsb2csWydJbmRpY2U6JywnbW9kZTonLG1vZGUsdHlwZSwnU2l6ZTonLFNpemUsJ09mZnNldDonLE9mZnNldCwnRW5jb2Rpbmc6JyxFbmNvZGluZywnbWFnaWM6JyxtYWdpY10sbikNCgkJCQkJCWlmIEVuY29kaW5nPT0ndmFyaW50JzoNCgkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkrb3Muc2VwKyJtb2RlbF9maWxlLmJpbiINCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6cGF0aD1vcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpK29zLnNlcCsibW9kZWxfZmlsZS5iaW4iDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOnBhdGg9b3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKStvcy5zZXArdmFsdWVzWyciRmlsZSInXS5zcGxpdCgnIicpWzFdIysnLnR4dCcNCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZToNCgkJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJbWFnaWMsaW5kaWNlTGlzdD1nZXRJbmRpY2VzKEl0ZW1TaXplLFNpemUsT2Zmc2V0LHR5cGUsZyxtb2RlLG1hZ2ljKQ0KCQkJCQkJCQlpbmRpY2VBcnJheS5hcHBlbmQoW2luZGljZUxpc3QsbW9kZV0pDQoJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJI2Vsc2U6DQoJCQkjCXByaW50ICdMSU5FUycNCgkJCQkNCgkJaWYgJyJEcmF3RWxlbWVudHNVU2hvcnQiJyBpbiBiLmhlYWRlcjoJCQ0KCQkJdmFsdWVzPXlzLnZhbHVlcyhiLmRhdGEsJzonKQ0KCQkJbW9kZT12YWx1ZXNbJyJNb2RlIiddCQkJDQoJCQlTaXplPU5vbmUNCgkJCU9mZnNldD1Ob25lDQoJCQlFbmNvZGluZz1Ob25lDQoJCQlJdGVtU2l6ZT1Ob25lDQoJCQl0eXBlPU5vbmUNCgkJCWlmIG1vZGUhPSciTElORVMiJzoNCgkJCQlJbmRpY2VzPXlzLmdldChiLCciSW5kaWNlcyInKQ0KCQkJCWlmIEluZGljZXM6DQoJCQkJCXZhbHVlcz15cy52YWx1ZXMoSW5kaWNlc1swXS5kYXRhLCc6JykNCgkJCQkJSXRlbVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJywnaScpDQoJCQkJCVVpbnQxNkFycmF5PXlzLmdldChJbmRpY2VzWzBdLCciVWludDE2QXJyYXkiJykNCgkJCQkJdHlwZT0iVWludDE2QXJyYXkiDQoJCQkJCSNwcmludCAiRHJhd0VsZW1lbnRzVVNob3J0Iix0eXBlDQoJCQkJCWlmIFVpbnQxNkFycmF5Og0KCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhVaW50MTZBcnJheVswXS5kYXRhLCc6JykNCgkJCQkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCQkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQkJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInLCciIicpDQoJCQkJCQkjd3JpdGUobG9nLFsnSW5kaWNlOicsJ21vZGU6Jyxtb2RlLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmcsJ21hZ2ljOicsbWFnaWNdLG4pDQoJCQkJCQkjcHJpbnQgRW5jb2RpbmcNCgkJCQkJCWlmIEVuY29kaW5nPT0ndmFyaW50JzoNCgkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkrb3Muc2VwKyJtb2RlbF9maWxlLmJpbiINCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6cGF0aD1vcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpK29zLnNlcCsibW9kZWxfZmlsZS5iaW4iDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOnBhdGg9b3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKStvcy5zZXArdmFsdWVzWyciRmlsZSInXS5zcGxpdCgnIicpWzFdIysnLnR4dCcNCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZToNCgkJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJbWFnaWMsaW5kaWNlTGlzdD1nZXRJbmRpY2VzKEl0ZW1TaXplLFNpemUsT2Zmc2V0LHR5cGUsZyxtb2RlLG1hZ2ljKQ0KCQkJCQkJCQlpbmRpY2VBcnJheS5hcHBlbmQoW2luZGljZUxpc3QsbW9kZV0pDQoJCQkJCQkJCWZpbGUuY2xvc2UoKQ0KCQkJCQkJZWxzZToNCgkJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkrb3Muc2VwKyJtb2RlbF9maWxlLmJpbiINCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09RmFsc2U6cGF0aD1vcy5wYXRoLmRpcm5hbWUoeXMuZmlsZW5hbWUpK29zLnNlcCsibW9kZWxfZmlsZS5iaW4iDQoJCQkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk9PUZhbHNlOnBhdGg9b3MucGF0aC5kaXJuYW1lKHlzLmZpbGVuYW1lKStvcy5zZXArdmFsdWVzWyciRmlsZSInXS5zcGxpdCgnIicpWzFdIysnLnR4dCcNCgkJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZToNCgkJCQkJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQkJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQkJCQkJZy5zZWVrKE9mZnNldCkNCgkJCQkJCQkJaW5kaWNlTGlzdD1nLkgoSXRlbVNpemUqU2l6ZSkNCgkJCQkJCQkJaW5kaWNlQXJyYXkuYXBwZW5kKFtpbmRpY2VMaXN0LG1vZGVdKQ0KCQkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCSNlbHNlOg0KCQkJIwlwcmludCAnTElORVMnDQoJCQkNCgkJaWYgJyJEcmF3RWxlbWVudHNVQnl0ZSInIGluIGIuaGVhZGVyOgkJCQ0KCQkJdmFsdWVzPXlzLnZhbHVlcyhiLmRhdGEsJzonKQ0KCQkJbW9kZT12YWx1ZXNbJyJNb2RlIiddCQkJDQoJCQlTaXplPU5vbmUNCgkJCU9mZnNldD1Ob25lDQoJCQlFbmNvZGluZz1Ob25lDQoJCQlJdGVtU2l6ZT1Ob25lDQoJCQl0eXBlPU5vbmUNCgkJCWlmIG1vZGUhPSciTElORVMiJzoNCgkJCQlJbmRpY2VzPXlzLmdldChiLCciSW5kaWNlcyInKQ0KCQkJCWlmIEluZGljZXM6DQoJCQkJCXZhbHVlcz15cy52YWx1ZXMoSW5kaWNlc1swXS5kYXRhLCc6JykNCgkJCQkJSXRlbVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJywnaScpDQoJCQkJCVVpbnQ4QXJyYXk9eXMuZ2V0KEluZGljZXNbMF0sJyJVaW50OEFycmF5IicpDQoJCQkJCXR5cGU9IlVpbnQ4QXJyYXkiDQoJCQkJCSNwcmludCAiRHJhd0VsZW1lbnRzVUJ5dGUiLHR5cGUNCgkJCQkJaWYgVWludDhBcnJheToNCgkJCQkJCXZhbHVlcz15cy52YWx1ZXMoVWludDhBcnJheVswXS5kYXRhLCc6JykNCgkJCQkJCVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciU2l6ZSInLCdpJykNCgkJCQkJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCQkJCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInLCciIicpDQoJCQkJCQkjd3JpdGUobG9nLFsnSW5kaWNlOicsJ21vZGU6Jyxtb2RlLHR5cGUsJ1NpemU6JyxTaXplLCdPZmZzZXQ6JyxPZmZzZXQsJ0VuY29kaW5nOicsRW5jb2RpbmcsJ21hZ2ljOicsbWFnaWNdLG4pDQoJCQkJCQlwYXRoPW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkrb3Muc2VwKyJtb2RlbF9maWxlLmJpbiINCgkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1GYWxzZTpwYXRoPW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkrb3Muc2VwKyJtb2RlbF9maWxlLmJpbiINCgkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpPT1GYWxzZTpwYXRoPW9zLnBhdGguZGlybmFtZSh5cy5maWxlbmFtZSkrb3Muc2VwK3ZhbHVlc1snIkZpbGUiJ10uc3BsaXQoJyInKVsxXSMrJy50eHQnDQoJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwYXRoKT09VHJ1ZToNCgkJCQkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJCQkJbWFnaWMsaW5kaWNlTGlzdD1nZXRJbmRpY2VzKEl0ZW1TaXplLFNpemUsT2Zmc2V0LHR5cGUsZyxtb2RlLG1hZ2ljKQ0KCQkJCQkJCWluZGljZUFycmF5LmFwcGVuZChbaW5kaWNlTGlzdCxtb2RlXSkNCgkJCQkJCQlmaWxlLmNsb3NlKCkNCgkJCSNlbHNlOg0KCQkJIwlwcmludCAnTElORVMnDQoJCQkJDQoJcmV0dXJuIGluZGljZUFycmF5DQoJDQoJDQoJCQkNCmRlZiBCb25lcyh5cyxiKToNCgluPTIwDQoJYm9uZXM9W10NCgl2YWx1ZXM9eXMudmFsdWVzKGIuZGF0YSwnOicpDQoJSXRlbVNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCciSXRlbVNpemUiJywnaScpDQoJVWludDE2QXJyYXk9eXMuZ2V0KGIsJyJVaW50MTZBcnJheSInKQ0KCWlmIFVpbnQxNkFycmF5Og0KCQl0eXBlPSJVaW50MTZBcnJheSINCgkJdmFsdWVzPXlzLnZhbHVlcyhVaW50MTZBcnJheVswXS5kYXRhLCc6JykNCgkJRmlsZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJGaWxlIicsJyIiJykNCgkJU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJTaXplIicsJ2knKQ0KCQlPZmZzZXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciT2Zmc2V0IicsJ2knKQ0KCQlFbmNvZGluZz15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJFbmNvZGluZyInLCciIicpDQoJCQ0KCQlpZiBFbmNvZGluZz09J3ZhcmludCc6CQkJCQkJDQoJCQlwYXRoPWdldFBhdGgoRmlsZSkNCgkJCWlmIHBhdGg6DQoJCQkJZmlsZT1vcGVuKHBhdGgsJ3JiJykNCgkJCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQkJCWxpc3Q9ZGVjb2RlVmFyaW50KGcsT2Zmc2V0LFNpemUqSXRlbVNpemUsdHlwZSkNCgkJCQlmb3IgbSBpbiByYW5nZShTaXplKToNCgkJCQkJYm9uZXMuYXBwZW5kKGxpc3RbbSpJdGVtU2l6ZTptKkl0ZW1TaXplK0l0ZW1TaXplXSkNCgkJCQlmaWxlLmNsb3NlKCkNCglyZXR1cm4gYm9uZXMJCQ0KCQkJDQpkZWYgV2VpZ2h0cyh5cyxiKToNCgluPTIwDQoJd2VpZ2h0cz1bXQ0KCXZhbHVlcz15cy52YWx1ZXMoYi5kYXRhLCc6JykNCglJdGVtU2l6ZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJJdGVtU2l6ZSInLCdpJykNCglGbG9hdDMyQXJyYXk9eXMuZ2V0KGIsJyJGbG9hdDMyQXJyYXkiJykNCglpZiBGbG9hdDMyQXJyYXk6DQoJCXZhbHVlcz15cy52YWx1ZXMoRmxvYXQzMkFycmF5WzBdLmRhdGEsJzonKQ0KCQlGaWxlPXlzLmdldFZhbHVlKHZhbHVlcywnIkZpbGUiJywnIiInKQ0KCQlTaXplPXlzLmdldFZhbHVlKHZhbHVlcywnIlNpemUiJywnaScpDQoJCU9mZnNldD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJPZmZzZXQiJywnaScpDQoJCUVuY29kaW5nPXlzLmdldFZhbHVlKHZhbHVlcywnIkVuY29kaW5nIicsJyIiJykNCgkJDQoJCWlmIEVuY29kaW5nPT0ndmFyaW50JzoJCQkJCQ0KCQkJcGF0aD1nZXRQYXRoKEZpbGUpDQoJCQlpZiBwYXRoOg0KCQkJCWZpbGU9b3BlbihwYXRoLCdyYicpDQoJCQkJZz1CaW5hcnlSZWFkZXIoZmlsZSkNCgkJCQlsaXN0PWRlY29kZVZhcmludChnLE9mZnNldCxTaXplKkl0ZW1TaXplLHR5cGUpDQoJCQkJZmlsZS5jbG9zZSgpDQoJCWVsc2U6CQkJCQkNCgkJCXBhdGg9Z2V0UGF0aChGaWxlKQ0KCQkJaWYgcGF0aDoNCgkJCQlmaWxlPW9wZW4ocGF0aCwncmInKQ0KCQkJCWc9QmluYXJ5UmVhZGVyKGZpbGUpDQoJCQkJZy5zZWVrKE9mZnNldCkNCgkJCQlsaXN0PWcuZihTaXplKkl0ZW1TaXplKQ0KCQkJCWZvciBtIGluIHJhbmdlKFNpemUpOg0KCQkJCQl3ZWlnaHRzLmFwcGVuZChsaXN0W20qSXRlbVNpemU6bSpJdGVtU2l6ZStJdGVtU2l6ZV0pDQoJCQkJZmlsZS5jbG9zZSgpDQoJcmV0dXJuIHdlaWdodHMJDQoJDQpkZWYgQm9uZU1hcCh5cyxiKToJDQoJQm9uZU1hcD17fQ0KCXZhbHVlcz15cy52YWx1ZXMoYi5kYXRhLCc6JykNCglmb3IgdmFsdWUgaW4gdmFsdWVzOg0KCQlpZD15cy5nZXRWYWx1ZSh2YWx1ZXMsdmFsdWUsJ2knKQ0KCQluYW1lPXZhbHVlLnNwbGl0KCciJylbMV0NCgkJQm9uZU1hcFtuYW1lXT1pZA0KCXJldHVybiBCb25lTWFwCQ0KCQkNCgkJDQpkZWYgb3NnQW5pbWF0aW9uUmlnR2VvbWV0cnkoeXMscGFyZW50TmV3Tm9kZSk6DQoNCgltZXNoPU1lc2goKQ0KCW1lc2gudmVydGV4QXJyYXk9W10NCgltZXNoLmluZGljZUFycmF5PVtdDQoJbWVzaC5UZXhDb29yZDBBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQxQXJyYXk9W10NCgltZXNoLlRleENvb3JkM0FycmF5PVtdDQoJbWVzaC5UZXhDb29yZDVBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQ2QXJyYXk9W10NCgltZXNoLmNvbG9yQXJyYXk9W10NCgltZXNoLm1vcnBoQXJyYXk9e30NCgltZXNoLkJvbmVzPVtdDQoJbWVzaC5XZWlnaHRzPVtdDQoJbWVzaC5Cb25lTWFwPXt9DQoJbWVzaC5hdHJpYnV0ZXM9e30NCgltZXNoLnBhcmVudE5vZGU9cGFyZW50TmV3Tm9kZS5ub2RlDQoJZm9yIGNoaWxkIGluIHBhcmVudE5ld05vZGUuY2hpbGRyZW46DQoJCSN3cml0ZShsb2csW2NoaWxkLm5vZGUuaGVhZGVyXSw0KQ0KCQlpZiAnIlNvdXJjZUdlb21ldHJ5IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJI3dyaXRlKGxvZyxbY2hpbGQubm9kZS5oZWFkZXJdLDgpDQoJCQkJaWYgJyJvc2dBbmltYXRpb24uTW9ycGhHZW9tZXRyeSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJCQkjd3JpdGUobG9nLFtjaGlsZC5ub2RlLmhlYWRlcl0sMTIpDQoJCQkJCQlpZiAnIlZlcnRleEF0dHJpYnV0ZUxpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJCQkJCWlmICciVmVydGV4IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQltZXNoLnZlcnRleEFycmF5PVZlcnRleCh5cyxjaGlsZC5ub2RlKQ0KCQkJCQkJCQlpZiAnIlRleENvb3JkMCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJbWVzaC5UZXhDb29yZDBBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCQkJCQlpZiAnIlRleENvb3JkMSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJbWVzaC5UZXhDb29yZDFBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCQkJCQlpZiAnIlRleENvb3JkMyInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJbWVzaC5UZXhDb29yZDNBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCQkJCQlpZiAnIlRleENvb3JkNSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJbWVzaC5UZXhDb29yZDVBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCQkJCQlpZiAnIlRleENvb3JkNiInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJbWVzaC5UZXhDb29yZDZBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCQkJCQlpZiAnIkNvbG9yIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQltZXNoLmNvbG9yQXJyYXk9Q29sb3IoeXMsY2hpbGQubm9kZSkNCgkJCQkJCWlmICciUHJpbWl0aXZlU2V0TGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCW1lc2guaW5kaWNlQXJyYXk9UHJpbWl0aXZlU2V0TGlzdCh5cyxjaGlsZCkNCgkJCQkJCWlmICciVXNlckRhdGFDb250YWluZXIiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQltZXNoLmF0cmlidXRlcz1Vc2VyRGF0YUNvbnRhaW5lcih5cyxjaGlsZCkNCgkJCQkJCWlmICciTW9ycGhUYXJnZXRzIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJcHJpbnQgIk1vcnBoVGFyZ2V0cyINCgkJCQkJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJCQkJCSN3cml0ZShsb2csW2NoaWxkLm5vZGUuaGVhZGVyXSwxNikNCgkJCQkJCQkJaWYgJyJvc2cuR2VvbWV0cnkiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCU5hbWU9Tm9uZQ0KCQkJCQkJCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCQkJCQkJCSN3cml0ZShsb2csW2NoaWxkLm5vZGUuaGVhZGVyXSwyMCkJCQkJCQkJCQkJDQoJCQkJCQkJCQkJaWYgJyJWZXJ0ZXhBdHRyaWJ1dGVMaXN0IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQkJCQkJCQkJCWlmICciVmVydGV4IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQkJCQkJaWYgTmFtZToNCgkJCQkJCQkJCQkJCQkJbWVzaC5tb3JwaEFycmF5W05hbWVdPVZlcnRleCh5cyxjaGlsZC5ub2RlKQkJCQkJCQkJCQkNCgkJCQkJCQkJCQlpZiAnIlVuaXF1ZUlEIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoY2hpbGQubm9kZS5oZWFkZXIsJzonKQ0KCQkJCQkJCQkJCQlVbmlxdWVJRD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJVbmlxdWVJRCInLCdpJykNCgkJCQkJCQkJCQkJTmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJOYW1lIicsJyIiJykNCgkJCQkJCQkJCQkJI3dyaXRlKGxvZyxbVW5pcXVlSUQsTmFtZV0sMjQpDQoJCQkJaWYgJyJvc2cuR2VvbWV0cnkiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCQkJaWYgJyJWZXJ0ZXhBdHRyaWJ1dGVMaXN0IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCQkJCQlpZiAnIlZlcnRleCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJbWVzaC52ZXJ0ZXhBcnJheT1WZXJ0ZXgoeXMsY2hpbGQubm9kZSkNCgkJCQkJCQkJaWYgJyJUZXhDb29yZDAiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2guVGV4Q29vcmQwQXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQkJCQkJaWYgJyJUZXhDb29yZDEiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2guVGV4Q29vcmQxQXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQkJCQkJaWYgJyJUZXhDb29yZDMiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2guVGV4Q29vcmQzQXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQkJCQkJaWYgJyJUZXhDb29yZDUiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2guVGV4Q29vcmQ1QXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQkJCQkJaWYgJyJUZXhDb29yZDYiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCW1lc2guVGV4Q29vcmQ2QXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQkJCQkJaWYgJyJDb2xvciInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCQkJbWVzaC5jb2xvckFycmF5PUNvbG9yKHlzLGNoaWxkLm5vZGUpDQoJCQkJCQlpZiAnIlByaW1pdGl2ZVNldExpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQltZXNoLmluZGljZUFycmF5PVByaW1pdGl2ZVNldExpc3QoeXMsY2hpbGQpDQoJCQkJCQlpZiAnIlVzZXJEYXRhQ29udGFpbmVyIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJbWVzaC5hdHJpYnV0ZXM9VXNlckRhdGFDb250YWluZXIoeXMsY2hpbGQpDQoJCQkJCQkJCQ0KCQkJCQkJCQkNCgkJaWYgJyJWZXJ0ZXhBdHRyaWJ1dGVMaXN0IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJaWYgJyJCb25lcyInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLkJvbmVzPUJvbmVzKHlzLGNoaWxkLm5vZGUpDQoJCQkJaWYgJyJXZWlnaHRzIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2guV2VpZ2h0cz1XZWlnaHRzKHlzLGNoaWxkLm5vZGUpDQoJCWlmICciQm9uZU1hcCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJbWVzaC5Cb25lTWFwPUJvbmVNYXAoeXMsY2hpbGQubm9kZSkNCgkJCQkNCglyZXR1cm4gbWVzaAkNCgkNCmRlZiBvc2dHZW9tZXRyeSh5cyxwYXJlbnROZXdOb2RlKToNCg0KCW1lc2g9TWVzaCgpDQoJbWVzaC52ZXJ0ZXhBcnJheT1bXQ0KCW1lc2guaW5kaWNlQXJyYXk9W10NCgltZXNoLlRleENvb3JkMEFycmF5PVtdDQoJbWVzaC5UZXhDb29yZDFBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQzQXJyYXk9W10NCgltZXNoLlRleENvb3JkNUFycmF5PVtdDQoJbWVzaC5UZXhDb29yZDZBcnJheT1bXQ0KCW1lc2guY29sb3JBcnJheT1bXQ0KCW1lc2gubW9ycGhBcnJheT17fQ0KCW1lc2guQm9uZXM9W10NCgltZXNoLldlaWdodHM9W10NCgltZXNoLkJvbmVNYXA9e30NCgltZXNoLmF0cmlidXRlcz17fQ0KCW1lc2gucGFyZW50Tm9kZT1wYXJlbnROZXdOb2RlLm5vZGUNCglmb3IgY2hpbGQgaW4gcGFyZW50TmV3Tm9kZS5jaGlsZHJlbjoNCgkJI3dyaXRlKGxvZyxbY2hpbGQubm9kZS5oZWFkZXJdLDQpDQoJCWlmICciVmVydGV4QXR0cmlidXRlTGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCSN3cml0ZShsb2csW2NoaWxkLm5vZGUuaGVhZGVyXSw4KQ0KCQkJCWlmICciVmVydGV4IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2gudmVydGV4QXJyYXk9VmVydGV4KHlzLGNoaWxkLm5vZGUpDQoJCQkJaWYgJyJUZXhDb29yZDAiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5UZXhDb29yZDBBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCWlmICciVGV4Q29vcmQxIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2guVGV4Q29vcmQxQXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQlpZiAnIlRleENvb3JkMyInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLlRleENvb3JkM0FycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJaWYgJyJUZXhDb29yZDUiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5UZXhDb29yZDVBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCWlmICciVGV4Q29vcmQ2IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2guVGV4Q29vcmQ2QXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQlpZiAnIkNvbG9yIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2guY29sb3JBcnJheT1Db2xvcih5cyxjaGlsZC5ub2RlKQ0KCQlpZiAnIlByaW1pdGl2ZVNldExpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCW1lc2guaW5kaWNlQXJyYXk9UHJpbWl0aXZlU2V0TGlzdCh5cyxjaGlsZCkNCgkJaWYgJyJVc2VyRGF0YUNvbnRhaW5lciInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJbWVzaC5hdHJpYnV0ZXM9VXNlckRhdGFDb250YWluZXIoeXMsY2hpbGQpDQoJcmV0dXJuIG1lc2gJCQ0KCQ0KCQ0KZGVmIG9zZ0FuaW1hdGlvbk1vcnBoR2VvbWV0cnkoeXMscGFyZW50TmV3Tm9kZSk6DQoNCgltZXNoPU1lc2goKQ0KCW1lc2gudmVydGV4QXJyYXk9W10NCgltZXNoLmluZGljZUFycmF5PVtdDQoJbWVzaC5UZXhDb29yZDBBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQxQXJyYXk9W10NCgltZXNoLlRleENvb3JkM0FycmF5PVtdDQoJbWVzaC5UZXhDb29yZDVBcnJheT1bXQ0KCW1lc2guVGV4Q29vcmQ2QXJyYXk9W10NCgltZXNoLmNvbG9yQXJyYXk9W10NCgltZXNoLm1vcnBoQXJyYXk9e30NCgltZXNoLkJvbmVzPVtdDQoJbWVzaC5XZWlnaHRzPVtdDQoJbWVzaC5Cb25lTWFwPXt9DQoJbWVzaC5hdHJpYnV0ZXM9e30NCgltZXNoLnBhcmVudE5vZGU9cGFyZW50TmV3Tm9kZS5ub2RlDQoJZm9yIGNoaWxkIGluIHBhcmVudE5ld05vZGUuY2hpbGRyZW46DQoJCWlmICciTW9ycGhUYXJnZXRzIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQlwcmludCAiTW9ycGhUYXJnZXRzIg0KCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCSN3cml0ZShsb2csW2NoaWxkLm5vZGUuaGVhZGVyXSwxNikNCgkJCQlpZiAnIm9zZy5HZW9tZXRyeSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQlOYW1lPU5vbmUNCgkJCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCQkJI3dyaXRlKGxvZyxbY2hpbGQubm9kZS5oZWFkZXJdLDIwKQkJCQkJCQkJCQkNCgkJCQkJCWlmICciVmVydGV4QXR0cmlidXRlTGlzdCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQkJCQkJaWYgJyJWZXJ0ZXgiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQkJCWlmIE5hbWU6DQoJCQkJCQkJCQkJbWVzaC5tb3JwaEFycmF5W05hbWVdPVZlcnRleCh5cyxjaGlsZC5ub2RlKQkJCQkJCQkJCQkNCgkJCQkJCWlmICciVW5pcXVlSUQiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGNoaWxkLm5vZGUuaGVhZGVyLCc6JykNCgkJCQkJCQlVbmlxdWVJRD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJVbmlxdWVJRCInLCdpJykNCgkJCQkJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJywnIiInKQ0KCQkJCQkJCSN3cml0ZShsb2csW1VuaXF1ZUlELE5hbWVdLDI0KQ0KCQlpZiAnIlZlcnRleEF0dHJpYnV0ZUxpc3QiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQkjcHJpbnQgY2hpbGQubm9kZS5oZWFkZXINCgkJCQlpZiAnIlZlcnRleCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLnZlcnRleEFycmF5PVZlcnRleCh5cyxjaGlsZC5ub2RlKQ0KCQkJCWlmICciVGV4Q29vcmQwIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2guVGV4Q29vcmQwQXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQlpZiAnIlRleENvb3JkMSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLlRleENvb3JkMUFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJaWYgJyJUZXhDb29yZDMiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJbWVzaC5UZXhDb29yZDNBcnJheT1UZXhDb29yZCh5cyxjaGlsZC5ub2RlKQ0KCQkJCWlmICciVGV4Q29vcmQ1IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCW1lc2guVGV4Q29vcmQ1QXJyYXk9VGV4Q29vcmQoeXMsY2hpbGQubm9kZSkNCgkJCQlpZiAnIlRleENvb3JkNiInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLlRleENvb3JkNkFycmF5PVRleENvb3JkKHlzLGNoaWxkLm5vZGUpDQoJCQkJaWYgJyJDb2xvciInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQltZXNoLmNvbG9yQXJyYXk9Q29sb3IoeXMsY2hpbGQubm9kZSkNCgkJaWYgJyJQcmltaXRpdmVTZXRMaXN0IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQltZXNoLmluZGljZUFycmF5PVByaW1pdGl2ZVNldExpc3QoeXMsY2hpbGQpDQoJCWlmICciVXNlckRhdGFDb250YWluZXIiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCW1lc2guYXRyaWJ1dGVzPVVzZXJEYXRhQ29udGFpbmVyKHlzLGNoaWxkKQ0KCQkJCQkJCQkNCgkJCQkJCQ0KCQkJCQ0KCXJldHVybiBtZXNoCQ0KCQkNCgkJDQpkZWYgZHJhd01lc2goeXMsbWVzaCk6CQ0KCWRpZmZ1c2U9Tm9uZQkJDQoJbm9ybWFsPU5vbmUJDQoJc3BlY3VsYXI9Tm9uZQ0KCXRyYW5zPU5vbmUJDQoJYW89Tm9uZQ0KCXJnYkNvbD1Ob25lDQoJcmdiU3BlYz1Ob25lDQoJcmdiYT1Ob25lCQ0KCW1vZGU9Tm9uZQkNCg0KDQoNCgltYXROYW1lLGRpZmZ1c2Usc3BlY3VsYXIsbm9ybWFsLGFvLHRyYW5zLHJnYkNvbCxyZ2JTcGVjLHJnYmE9Z2V0TWF0TmFtZSh5cyxtZXNoLnBhcmVudE5vZGUpDQoJI3ByaW50ICdtYXROYW1lOicsbWF0TmFtZSxkaWZmdXNlDQoJaWYgbGVuKG1lc2guaW5kaWNlQXJyYXkpPjA6DQoJCWZvciBbaW5kaWNlcyxtb2RlXSBpbiBtZXNoLmluZGljZUFycmF5Og0KCQkJbWF0PU1hdCgpDQoJCQltYXQubWF0TmFtZT1tYXROYW1lDQoJCQltYXQucmdiQ29sPXJnYkNvbA0KCQkJbWF0LmRpZmZ1c2U9ZGlmZnVzZQ0KCQkJbWF0Lm5vcm1hbD1ub3JtYWwNCgkJCW1hdC5zcGVjdWxhcj1zcGVjdWxhcg0KCQkJbWF0LnRyYW5zPXRyYW5zDQoJCQlpZiB0cmFuczoNCgkJCQltYXQuWlRSQU5TPVRydWUNCgkJCSNtYXQuYW89YW8NCgkJCWlmIHJnYmE6bWF0LnJnYmE9cmdiYQ0KCQkJbWVzaC5tYXRMaXN0LmFwcGVuZChtYXQpDQoJCQltYXQuSURTdGFydD1sZW4obWVzaC5pbmRpY2VMaXN0KQ0KCQkJbWF0LklEQ291bnQ9bGVuKGluZGljZXMpDQoJCQltZXNoLmluZGljZUxpc3QuZXh0ZW5kKGluZGljZXMpDQoJCQlpZiBtb2RlPT0nIlRSSUFOR0xFX1NUUklQIic6bWF0LlRSSVNUUklQPVRydWUNCgkJCWlmIG1vZGU9PSciVFJJQU5HTEVTIic6bWF0LlRSSUFOR0xFPVRydWUNCgkJCQ0KCQlpbmRpY2VzPW1lc2guaW5kaWNlQXJyYXlbMF1bMF0NCgkJbW9kZT1tZXNoLmluZGljZUFycmF5WzBdWzFdCQkNCglpZiBsZW4obWVzaC52ZXJ0ZXhBcnJheSk9PTE6DQoJCWlmIG1lc2gudmVydGV4QXJyYXlbMF1bMV09PScidmFyaW50Iic6DQoJCQlpZiBtb2RlOg0KCQkJCWJ5dGVzPW1lc2gudmVydGV4QXJyYXlbMF1bMF0JCQkJDQoJCQkJSXRlbVNpemU9bWVzaC52ZXJ0ZXhBcnJheVswXVsyXQ0KCQkJCWlmIG1vZGU9PSciVFJJQU5HTEVfU1RSSVAiJzoNCgkJCQkJYnl0ZXM9ZGVjb2RlUHJlZGljdChpbmRpY2VzLGJ5dGVzLEl0ZW1TaXplKQ0KCQkJCXMxPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd2dHhfYmJsX3gnXSkNCgkJCQlzMj1mbG9hdChtZXNoLmF0cmlidXRlc1sndnR4X2JibF95J10pDQoJCQkJczM9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3Z0eF9iYmxfeiddKQ0KCQkJCXM9W3MxLHMyLHMzXQkJCQ0KCQkJCWExPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd2dHhfaF94J10pDQoJCQkJYTI9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3Z0eF9oX3knXSkNCgkJCQlhMz1mbG9hdChtZXNoLmF0cmlidXRlc1sndnR4X2hfeiddKQ0KCQkJCWE9W2ExLGEyLGEzXQ0KCQkJCWZsb2F0cz1kZWNvZGVRdWFudGl6ZShieXRlcyxzLGEsSXRlbVNpemUpDQoJCQkJbWVzaC52ZXJ0UG9zTGlzdD1bZmxvYXRzW206bStJdGVtU2l6ZV1mb3IgbSBpbiByYW5nZSgwLGxlbihmbG9hdHMpLDMpXQ0KCQkJCSNwcmludCBtZXNoLnZlcnRQb3NMaXN0DQoJCQkJI21lc2guaW5kaQ0KCQkJCSNtZXNoLmRyYXcoKQ0KCQllbHNlOg0KCQkJbGlzdD1tZXNoLnZlcnRleEFycmF5WzBdWzBdDQoJCQltZXNoLnZlcnRQb3NMaXN0PWxpc3QNCgkJCQ0KCWlmIGxlbihtZXNoLlRleENvb3JkMEFycmF5KT09MToNCgkJaWYgbWVzaC5UZXhDb29yZDBBcnJheVswXVsxXT09JyJ2YXJpbnQiJzoNCgkJCWlmIG1vZGU6DQoJCQkJYnl0ZXM9bWVzaC5UZXhDb29yZDBBcnJheVswXVswXQkJCQkNCgkJCQlJdGVtU2l6ZT1tZXNoLlRleENvb3JkMEFycmF5WzBdWzJdDQoJCQkJaWYgbW9kZT09JyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcz1kZWNvZGVQcmVkaWN0KGluZGljZXMsYnl0ZXMsSXRlbVNpemUpDQoJCQkJczE9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzBfYmJsX3gnXSkNCgkJCQlzMj1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfMF9iYmxfeSddKQ0KCQkJCXM9W3MxLHMyXQkJCQ0KCQkJCWExPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8wX2hfeCddKQ0KCQkJCWEyPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8wX2hfeSddKQ0KCQkJCWE9W2ExLGEyXQ0KCQkJCWZsb2F0cz1kZWNvZGVRdWFudGl6ZShieXRlcyxzLGEsSXRlbVNpemUpDQoJCQkJZm9yIG0gaW4gcmFuZ2UoMCxsZW4oZmxvYXRzKSxJdGVtU2l6ZSk6DQoJCQkJCXUsdj1mbG9hdHNbbTptK0l0ZW1TaXplXQ0KCQkJCQltZXNoLnZlcnRVVkxpc3QuYXBwZW5kKFt1LDEtdl0pDQoJCWVsc2U6DQoJCQlsaXN0PW1lc2guVGV4Q29vcmQwQXJyYXlbMF1bMF0NCgkJCW1lc2gudmVydFVWTGlzdD1saXN0DQoJZWxpZiBsZW4obWVzaC5UZXhDb29yZDFBcnJheSk9PTE6DQoJCWlmIG1lc2guVGV4Q29vcmQxQXJyYXlbMF1bMV09PScidmFyaW50Iic6DQoJCQlpZiBtb2RlOg0KCQkJCWJ5dGVzPW1lc2guVGV4Q29vcmQxQXJyYXlbMF1bMF0JCQkJDQoJCQkJSXRlbVNpemU9bWVzaC5UZXhDb29yZDFBcnJheVswXVsyXQ0KCQkJCWlmIG1vZGU9PSciVFJJQU5HTEVfU1RSSVAiJzoNCgkJCQkJYnl0ZXM9ZGVjb2RlUHJlZGljdChpbmRpY2VzLGJ5dGVzLEl0ZW1TaXplKQ0KCQkJCXMxPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8xX2JibF94J10pDQoJCQkJczI9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzFfYmJsX3knXSkNCgkJCQlzPVtzMSxzMl0JCQkNCgkJCQlhMT1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfMV9oX3gnXSkNCgkJCQlhMj1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfMV9oX3knXSkNCgkJCQlhPVthMSxhMl0NCgkJCQlmbG9hdHM9ZGVjb2RlUXVhbnRpemUoYnl0ZXMscyxhLEl0ZW1TaXplKQ0KCQkJCWZvciBtIGluIHJhbmdlKDAsbGVuKGZsb2F0cyksSXRlbVNpemUpOg0KCQkJCQl1LHY9ZmxvYXRzW206bStJdGVtU2l6ZV0NCgkJCQkJbWVzaC52ZXJ0VVZMaXN0LmFwcGVuZChbdSwxLXZdKQ0KCQllbHNlOg0KCQkJbGlzdD1tZXNoLlRleENvb3JkMUFycmF5WzBdWzBdDQoJCQltZXNoLnZlcnRVVkxpc3Q9bGlzdA0KCWVsaWYgbGVuKG1lc2guVGV4Q29vcmQzQXJyYXkpPT0xOg0KCQlpZiBtZXNoLlRleENvb3JkM0FycmF5WzBdWzFdPT0nInZhcmludCInOg0KCQkJaWYgbW9kZToNCgkJCQlieXRlcz1tZXNoLlRleENvb3JkM0FycmF5WzBdWzBdCQkJCQ0KCQkJCUl0ZW1TaXplPW1lc2guVGV4Q29vcmQzQXJyYXlbMF1bMl0NCgkJCQlpZiBtb2RlPT0nIlRSSUFOR0xFX1NUUklQIic6DQoJCQkJCWJ5dGVzPWRlY29kZVByZWRpY3QoaW5kaWNlcyxieXRlcyxJdGVtU2l6ZSkNCgkJCQlzMT1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfM19iYmxfeCddKQ0KCQkJCXMyPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl8zX2JibF95J10pDQoJCQkJcz1bczEsczJdCQkJDQoJCQkJYTE9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzNfaF94J10pDQoJCQkJYTI9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzNfaF95J10pDQoJCQkJYT1bYTEsYTJdDQoJCQkJZmxvYXRzPWRlY29kZVF1YW50aXplKGJ5dGVzLHMsYSxJdGVtU2l6ZSkNCgkJCQlmb3IgbSBpbiByYW5nZSgwLGxlbihmbG9hdHMpLEl0ZW1TaXplKToNCgkJCQkJdSx2PWZsb2F0c1ttOm0rSXRlbVNpemVdDQoJCQkJCW1lc2gudmVydFVWTGlzdC5hcHBlbmQoW3UsMS12XSkNCgkJZWxzZToNCgkJCWxpc3Q9bWVzaC5UZXhDb29yZDNBcnJheVswXVswXQ0KCQkJbWVzaC52ZXJ0VVZMaXN0PWxpc3QNCgllbGlmIGxlbihtZXNoLlRleENvb3JkNUFycmF5KT09MToNCgkJaWYgbWVzaC5UZXhDb29yZDVBcnJheVswXVsxXT09JyJ2YXJpbnQiJzoNCgkJCWlmIG1vZGU6DQoJCQkJYnl0ZXM9bWVzaC5UZXhDb29yZDVBcnJheVswXVswXQkJCQkNCgkJCQlJdGVtU2l6ZT1tZXNoLlRleENvb3JkNUFycmF5WzBdWzJdDQoJCQkJaWYgbW9kZT09JyJUUklBTkdMRV9TVFJJUCInOg0KCQkJCQlieXRlcz1kZWNvZGVQcmVkaWN0KGluZGljZXMsYnl0ZXMsSXRlbVNpemUpDQoJCQkJczE9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzVfYmJsX3gnXSkNCgkJCQlzMj1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfNV9iYmxfeSddKQ0KCQkJCXM9W3MxLHMyXQkJCQ0KCQkJCWExPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl81X2hfeCddKQ0KCQkJCWEyPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl81X2hfeSddKQ0KCQkJCWE9W2ExLGEyXQ0KCQkJCWZsb2F0cz1kZWNvZGVRdWFudGl6ZShieXRlcyxzLGEsSXRlbVNpemUpDQoJCQkJZm9yIG0gaW4gcmFuZ2UoMCxsZW4oZmxvYXRzKSxJdGVtU2l6ZSk6DQoJCQkJCXUsdj1mbG9hdHNbbTptK0l0ZW1TaXplXQ0KCQkJCQltZXNoLnZlcnRVVkxpc3QuYXBwZW5kKFt1LDEtdl0pDQoJCWVsc2U6DQoJCQlsaXN0PW1lc2guVGV4Q29vcmQ1QXJyYXlbMF1bMF0NCgkJCW1lc2gudmVydFVWTGlzdD1saXN0DQoJZWxpZiBsZW4obWVzaC5UZXhDb29yZDZBcnJheSk9PTE6DQoJCWlmIG1lc2guVGV4Q29vcmQ2QXJyYXlbMF1bMV09PScidmFyaW50Iic6DQoJCQlpZiBtb2RlOg0KCQkJCWJ5dGVzPW1lc2guVGV4Q29vcmQ2QXJyYXlbMF1bMF0JCQkJDQoJCQkJSXRlbVNpemU9bWVzaC5UZXhDb29yZDZBcnJheVswXVsyXQ0KCQkJCWlmIG1vZGU9PSciVFJJQU5HTEVfU1RSSVAiJzoNCgkJCQkJYnl0ZXM9ZGVjb2RlUHJlZGljdChpbmRpY2VzLGJ5dGVzLEl0ZW1TaXplKQ0KCQkJCXMxPWZsb2F0KG1lc2guYXRyaWJ1dGVzWyd1dl82X2JibF94J10pDQoJCQkJczI9ZmxvYXQobWVzaC5hdHJpYnV0ZXNbJ3V2XzZfYmJsX3knXSkNCgkJCQlzPVtzMSxzMl0JCQkNCgkJCQlhMT1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfNl9oX3gnXSkNCgkJCQlhMj1mbG9hdChtZXNoLmF0cmlidXRlc1sndXZfNl9oX3knXSkNCgkJCQlhPVthMSxhMl0NCgkJCQlmbG9hdHM9ZGVjb2RlUXVhbnRpemUoYnl0ZXMscyxhLEl0ZW1TaXplKQ0KCQkJCWZvciBtIGluIHJhbmdlKDAsbGVuKGZsb2F0cyksSXRlbVNpemUpOg0KCQkJCQl1LHY9ZmxvYXRzW206bStJdGVtU2l6ZV0NCgkJCQkJbWVzaC52ZXJ0VVZMaXN0LmFwcGVuZChbdSwxLXZdKQ0KCQllbHNlOg0KCQkJbGlzdD1tZXNoLlRleENvb3JkNkFycmF5WzBdWzBdDQoJCQltZXNoLnZlcnRVVkxpc3Q9bGlzdA0KCWlmIGxlbihtZXNoLmNvbG9yQXJyYXkpPjA6DQoJCW1lc2gudmVydENvbExpc3Q9bWVzaC5jb2xvckFycmF5DQoJCQ0KCQkNCgkJDQoNCmRlZiBVc2VyRGF0YUNvbnRhaW5lcih5cyxiKToNCglhdHJpYnV0ZXM9e30NCglWYWx1ZXM9eXMuZ2V0KGIubm9kZSwnIlZhbHVlcyInKQ0KCWlmIFZhbHVlczoNCgkJZm9yIGEgaW4gVmFsdWVzWzBdLmNoaWxkcmVuOg0KCQkJdmFsdWVzPXlzLnZhbHVlcyhhLmRhdGEsJzonKQ0KCQkJTmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJOYW1lIicsJyIiJykNCgkJCVZhbHVlPXlzLmdldFZhbHVlKHZhbHVlcywnIlZhbHVlIicsJyIiJykNCgkJCSNpZiBOYW1lOndyaXRlKGxvZyxbTmFtZSxWYWx1ZV0sbis0KQ0KCQkJaWYgTmFtZTphdHJpYnV0ZXNbTmFtZV09VmFsdWUJDQoJcmV0dXJuIGF0cmlidXRlcwkJCQ0KCQkNCmRlZiBvc2dOb2RlKHlzLHBhcmVudE5ld05vZGUscGFyZW50Qm9uZSk6DQoJZm9yIGNoaWxkIGluIHBhcmVudE5ld05vZGUuY2hpbGRyZW46DQoJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCWlmICcib3NnLkdlb21ldHJ5IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJbWVzaD1vc2dHZW9tZXRyeSh5cyxjaGlsZCkNCgkJCQltZXNoLnBhcmVudEJvbmU9cGFyZW50Qm9uZQ0KCQkJCW1vZGVsLm1lc2hMaXN0LmFwcGVuZChtZXNoKQ0KCQkJaWYgJyJvc2dBbmltYXRpb24uUmlnR2VvbWV0cnkiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQltZXNoPW9zZ0FuaW1hdGlvblJpZ0dlb21ldHJ5KHlzLGNoaWxkKQ0KCQkJCW1lc2gucGFyZW50Qm9uZT1wYXJlbnRCb25lDQoJCQkJbW9kZWwubWVzaExpc3QuYXBwZW5kKG1lc2gpDQoJCQlpZiAnIm9zZ0FuaW1hdGlvbi5Nb3JwaEdlb21ldHJ5IicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJbWVzaD1vc2dBbmltYXRpb25Nb3JwaEdlb21ldHJ5KHlzLGNoaWxkKQ0KCQkJCW1lc2gucGFyZW50Qm9uZT1wYXJlbnRCb25lDQoJCQkJbW9kZWwubWVzaExpc3QuYXBwZW5kKG1lc2gpDQoJCQkJDQoJCQkJDQpkZWYgb3NnTWF0cml4VHJhbnNmb3JtKHlzLHBhcmVudE5ld05vZGUscGFyZW50Qm9uZSk6DQoJYm9uZT1Cb25lKCkJDQoJYm9uZS5OYW1lPU5vbmUNCglib25lLlVwZGF0ZU5hbWU9Tm9uZQ0KCWJvbmUubWF0cml4PU1hdHJpeCgpLnJlc2l6ZTR4NCgpIy5pbnZlcnQoKQ0KCWlmIHBhcmVudEJvbmU6Ym9uZS5wYXJlbnROYW1lPXBhcmVudEJvbmUubmFtZQ0KCXNrZWxldG9uLmJvbmVMaXN0LmFwcGVuZChib25lKQ0KCWZvciBjaGlsZCBpbiBwYXJlbnROZXdOb2RlLmNoaWxkcmVuOg0KCQlpZiAnIk1hdHJpeCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5ub2RlLmRhdGEsJ2YnKQkNCgkJCWJvbmUubWF0cml4PU1hdHJpeDR4NCh2YWx1ZXMpDQoJCQlpZiBwYXJlbnRCb25lOmJvbmUubWF0cml4Kj1wYXJlbnRCb25lLm1hdHJpeAkNCgkJaWYgJyJVbmlxdWVJRCInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5ub2RlLmhlYWRlciwnOicpDQoJCQlVbmlxdWVJRD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJVbmlxdWVJRCInLCdpJykNCgkJCWJvbmUubmFtZT0nVW5pcXVlSURfJytzdHIoVW5pcXVlSUQpDQoJCWlmICciTmFtZSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5ub2RlLmhlYWRlciwnOicpDQoJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJywnIiInKQ0KCQkJI2JpbmRCb25lLk5hbWU9TmFtZQ0KCQkJYm9uZS5OYW1lPU5hbWUNCgkJaWYgJyJVcGRhdGVDYWxsYmFja3MiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCWZvciBjaGlsZCBpbiBjaGlsZC5jaGlsZHJlbjoNCgkJCQlpZiAnIm9zZ0FuaW1hdGlvbi5VcGRhdGVNYXRyaXhUcmFuc2Zvcm0iJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJZm9yIGNoaWxkIGluIGNoaWxkLmNoaWxkcmVuOg0KCQkJCQkJaWYgJyJOYW1lIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhjaGlsZC5ub2RlLmhlYWRlciwnOicpDQoJCQkJCQkJTmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJOYW1lIicsJyIiJykNCgkJCQkJCQkjYmluZEJvbmUuVXBkYXRlTmFtZT1OYW1lDQoJCQkJCQkJYm9uZS5VcGRhdGVOYW1lPU5hbWUNCglyZXR1cm4gYm9uZQkJDQoJCQkNCgkJDQpkZWYgb3NnQW5pbWF0aW9uQm9uZSh5cyxwYXJlbnROZXdOb2RlLHBhcmVudEJvbmUpOg0KCWJvbmU9Qm9uZSgpDQoJc2tlbGV0b24uYm9uZUxpc3QuYXBwZW5kKGJvbmUpCQkNCglib25lLm1hdHJpeD1NYXRyaXgoKS5yZXNpemU0eDQoKSMuaW52ZXJ0KCkNCgliaW5kQm9uZT1Cb25lKCkNCgliaW5kQm9uZS5tYXRyaXg9TWF0cml4KCkucmVzaXplNHg0KCkjLmludmVydCgpDQoJYmluZEJvbmUuTmFtZT1Ob25lDQoJYm9uZS5OYW1lPU5vbmUNCglib25lLlVwZGF0ZU5hbWU9Tm9uZQ0KCWJpbmRCb25lLlVwZGF0ZU5hbWU9Tm9uZQ0KCWZvciBjaGlsZCBpbiBwYXJlbnROZXdOb2RlLmNoaWxkcmVuOg0KCQlpZiAnIkludkJpbmRNYXRyaXhJblNrZWxldG9uU3BhY2UiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCXZhbHVlcz15cy52YWx1ZXMoY2hpbGQubm9kZS5kYXRhLCdmJykJDQoJCQltYXRyaXg9TWF0cml4NHg0KHZhbHVlcykNCgkJCWJpbmRCb25lLm1hdHJpeD1tYXRyaXguaW52ZXJ0KCkJDQoJCQliaW5kc2tlbGV0b24uYm9uZUxpc3QuYXBwZW5kKGJpbmRCb25lKQ0KCQlpZiAnIlVuaXF1ZUlEIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQl2YWx1ZXM9eXMudmFsdWVzKGNoaWxkLm5vZGUuaGVhZGVyLCc6JykNCgkJCVVuaXF1ZUlEPXlzLmdldFZhbHVlKHZhbHVlcywnIlVuaXF1ZUlEIicsJ2knKQ0KCQkJYmluZEJvbmUubmFtZT0nVW5pcXVlSURfJytzdHIoVW5pcXVlSUQpDQoJCQlib25lLm5hbWU9J1VuaXF1ZUlEXycrc3RyKFVuaXF1ZUlEKQ0KCQlpZiAnIk5hbWUiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCXZhbHVlcz15cy52YWx1ZXMoY2hpbGQubm9kZS5oZWFkZXIsJzonKQ0KCQkJTmFtZT15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJOYW1lIicsJyIiJykNCgkJCWJpbmRCb25lLk5hbWU9TmFtZQ0KCQkJYm9uZS5OYW1lPU5hbWUNCgkJCSNib25lSW5kZWtzTGlzdFtOYW1lXT1ib25lLm5hbWUNCgkJaWYgJyJNYXRyaXgiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCXZhbHVlcz15cy52YWx1ZXMoY2hpbGQubm9kZS5kYXRhLCdmJykJDQoJCQlib25lLm1hdHJpeD1NYXRyaXg0eDQodmFsdWVzKQ0KCQkJaWYgcGFyZW50Qm9uZToNCgkJCQlpZiAnTWF0cml4VHJhbnNmb3JtJyBub3QgaW4gcGFyZW50Qm9uZS5uYW1lOg0KCQkJCQlib25lLnBhcmVudE5hbWU9cGFyZW50Qm9uZS5uYW1lDQoJCQkJYm9uZS5tYXRyaXgqPXBhcmVudEJvbmUubWF0cml4DQoJCWlmICciVXBkYXRlQ2FsbGJhY2tzIicgaW4gY2hpbGQubm9kZS5oZWFkZXI6DQoJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJaWYgJyJvc2dBbmltYXRpb24uVXBkYXRlQm9uZSInIGluIGNoaWxkLm5vZGUuaGVhZGVyOg0KCQkJCQlmb3IgY2hpbGQgaW4gY2hpbGQuY2hpbGRyZW46DQoJCQkJCQlpZiAnIk5hbWUiJyBpbiBjaGlsZC5ub2RlLmhlYWRlcjoNCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGNoaWxkLm5vZGUuaGVhZGVyLCc6JykNCgkJCQkJCQlOYW1lPXlzLmdldFZhbHVlKHZhbHVlcywnIk5hbWUiJywnIiInKQ0KCQkJCQkJCWJpbmRCb25lLlVwZGF0ZU5hbWU9TmFtZQ0KCQkJCQkJCWJvbmUuVXBkYXRlTmFtZT1OYW1lDQoJcmV0dXJuIGJvbmUJCQkNCgkJDQpkZWYgZ2V0TmV3Tm9kZVRyZWUoeXMscGFyZW50TmV3Tm9kZSxuLHBhcmVudEJvbmUsZGF0YSk6DQoJDQoJaWYgJyJvc2dBbmltYXRpb24uU2tlbGV0b24iJyBpbiBwYXJlbnROZXdOb2RlLm5vZGUuaGVhZGVyOg0KCQlwYXJlbnRCb25lPW9zZ0FuaW1hdGlvbkJvbmUoeXMscGFyZW50TmV3Tm9kZSxwYXJlbnRCb25lKQ0KCQliaW5kc2tlbGV0b24ucGFyZW50Qm9uZT1wYXJlbnRCb25lDQoJaWYgJyJvc2cuTm9kZSInIGluIHBhcmVudE5ld05vZGUubm9kZS5oZWFkZXI6DQoJCW9zZ05vZGUoeXMscGFyZW50TmV3Tm9kZSxwYXJlbnRCb25lKQ0KCWlmICcib3NnLk1hdHJpeFRyYW5zZm9ybSInIGluIHBhcmVudE5ld05vZGUubm9kZS5oZWFkZXI6DQoJCXBhcmVudEJvbmU9b3NnTWF0cml4VHJhbnNmb3JtKHlzLHBhcmVudE5ld05vZGUscGFyZW50Qm9uZSkNCglpZiAnIm9zZ0FuaW1hdGlvbi5Cb25lIicgaW4gcGFyZW50TmV3Tm9kZS5ub2RlLmhlYWRlcjoNCgkJcGFyZW50Qm9uZT1vc2dBbmltYXRpb25Cb25lKHlzLHBhcmVudE5ld05vZGUscGFyZW50Qm9uZSkNCgluKz00DQoJZm9yIGNoaWxkIGluIHBhcmVudE5ld05vZGUuY2hpbGRyZW46DQoJCSN3cml0ZShsb2csW2NoaWxkLm5vZGUuaGVhZGVyLGNoaWxkLlVuaXF1ZUlEXSxuKQ0KCQlnZXROZXdOb2RlVHJlZSh5cyxjaGlsZCxuLHBhcmVudEJvbmUsZGF0YSkJCQ0KCQ0KZGVmIG9zZ1BhcnNlcihmaWxlbmFtZSk6DQoJZ2xvYmFsIHNrZWxldG9uLGJpbmRza2VsZXRvbixtb2RlbCxib25lSW5kZWtzTGlzdCxmaXJzdG1hdHJpeCxuZXdOb2RlTGlzdA0KCSNSaWdHZW9tZXRyeT1GYWxzZQ0KCWJvbmVJbmRla3NMaXN0PXt9DQoJbW9kZWw9TW9kZWwoZmlsZW5hbWUpDQoJbW9kZWwubWF0TGlzdD17fQ0KCXNrZWxldG9uPVNrZWxldG9uKCkNCglza2VsZXRvbi5BUk1BVFVSRVNQQUNFPVRydWUNCgliaW5kc2tlbGV0b249U2tlbGV0b24oKQ0KCWJpbmRza2VsZXRvbi5wYXJlbnRCb25lPU5vbmUNCgliaW5kc2tlbGV0b24uQVJNQVRVUkVTUEFDRT1UcnVlDQoJVW5pcXVlSURMaXN0PXt9DQoJeXM9WXNvbigpDQoJeXMubG9nPVRydWUNCgl5cy5maWxlbmFtZT1maWxlbmFtZQ0KCXlzLnBhcnNlKCkNCgkNCglyb290PXlzLnJvb3QNCgluPTANCgluZXdOb2RlTGlzdD1bXQ0KCW5ld1Jvb3Q9TmV3Tm9kZSgpDQoJbmV3Um9vdC5ub2RlPXlzLnJvb3QNCgluZXdOb2RlTGlzdC5hcHBlbmQobmV3Um9vdCkNCglnZXRJRFRyZWUoeXMseXMucm9vdCxuLG5ld1Jvb3QpDQoJDQoJcm9vdD1uZXdSb290DQoJZ2V0TmV3Tm9kZVRyZWUoeXMscm9vdCxuLE5vbmUsTm9uZSkNCgkNCiNkZWYgc3NzKCk6CQ0KCQ0KCXNrZWxldG9uLmRyYXcoKQ0KCQkjZm9yIGJvbmUgaW4gYmluZHNrZWxldG9uLmJvbmVMaXN0Og0KCQkjCWJvbmUubWF0cml4Kj1iaW5kc2tlbGV0b24ucGFyZW50Qm9uZS5tYXRyaXgNCglpZiBsZW4oYmluZHNrZWxldG9uLmJvbmVMaXN0KT4wOgkJDQoJCWJpbmRza2VsZXRvbi5kcmF3KCkNCglpZiBiaW5kc2tlbGV0b24ucGFyZW50Qm9uZSBhbmQgYmluZHNrZWxldG9uLm9iamVjdDoNCgkJYmluZHNrZWxldG9uLm9iamVjdC5zZXRNYXRyaXgoYmluZHNrZWxldG9uLnBhcmVudEJvbmUubWF0cml4KQ0KCSNib25lTmFtZUxpc3Q9W10NCgkNCglmb3IgYm9uZSBpbiBza2VsZXRvbi5ib25lTGlzdDoNCgkJaWYgYm9uZS5VcGRhdGVOYW1lOg0KCQkJI05hbWU9Z2V0U3BsaXROYW1lKGJvbmUuTmFtZSwnXycsLTEpDQoJCQlib25lSW5kZWtzTGlzdFtib25lLlVwZGF0ZU5hbWVdPWJvbmUubmFtZQ0KCQkJI3ByaW50IE5hbWUsYm9uZS5uYW1lDQoJCQkNCgluPTAJDQoJcmVzdWx0PTENCglBbmltYXRpb25zPXlzLmdldCh5cy5yb290LCcib3NnQW5pbWF0aW9uLkFuaW1hdGlvbiInKQkJDQoJaWYgQW5pbWF0aW9uczoNCgkJI3Jlc3VsdD1CbGVuZGVyLkRyYXcuUHVwTWVudSgiZXhwb3J0IGFuaW1hdGlvbnMgYXMgKi5hY3Rpb24/JXR8WWVzfE5vIikNCgkJaWYgcmVzdWx0PT0xOg0KCQkJZm9yIGFuaW1hdGlvbiBpbiBBbmltYXRpb25zOgkNCgkJCQlnZXRBbmltYXRpb24oeXMsYW5pbWF0aW9uLG4pDQoJCQkJDQoJCQkJDQoJCQ0KCQkNCgkJDQoJZm9yIG1lc2ggaW4gbW9kZWwubWVzaExpc3Q6DQoJCW1lc2guQklORFNLRUxFVE9OPXNrZWxldG9uLm5hbWUNCgkJZHJhd01lc2goeXMsbWVzaCkNCgkJCQkNCgkjbW9kZWwuZ2V0TWF0KCkJDQoJcmVzdWx0PTENCgkjcmVzdWx0PUJsZW5kZXIuRHJhdy5QdXBNZW51KCJTZW5kIG1lc2hlcyB0byBzdGFydHBvc2U/JXR8WWVzfE5vIikNCgkNCglyZXN1bHQxMD0xIA0KCQkNCglpZiByZXN1bHQxMD09MToNCgkJZm9yIGkxLG1lc2ggaW4gZW51bWVyYXRlKG1vZGVsLm1lc2hMaXN0KToNCgkJCXByaW50IGkxLCd2ZXJ0OicsbGVuKG1lc2gudmVydFBvc0xpc3QpLCdjb2w6JyxsZW4obWVzaC52ZXJ0Q29sTGlzdCksJ3V2OicsbGVuKG1lc2gudmVydFVWTGlzdCksJ2luZGljZTonLGxlbihtZXNoLmluZGljZUxpc3QpLCdtYXQ6JyxsZW4obWVzaC5tYXRMaXN0KSwnc2tpbjonLGxlbihtZXNoLnNraW5MaXN0KSMsbWF0TmFtZQ0KCQkJI0JsZW5kZXIuV2luZG93LkRyYXdQcm9ncmVzc0JhcihmbG9hdCgoaTEpL2Zsb2F0KGxlbihtb2RlbC5tZXNoTGlzdCkpKSxzdHIobGVuKG1vZGVsLm1lc2hMaXN0KS0xLWkxKSkNCgkJCQ0KCQkJbWVzaC5CSU5EU0tFTEVUT049c2tlbGV0b24ubmFtZQ0KCQkJaWYgbGVuKG1lc2gudmVydFBvc0xpc3QpPjA6CQ0KCQkJCWlmIGxlbihtZXNoLkJvbmVzKT4wIGFuZCBsZW4obWVzaC5XZWlnaHRzKT4wOg0KCQkJCQlza2luPVNraW4oKQ0KCQkJCQlza2luLmJvbmVNYXA9WzBdKmxlbihtZXNoLkJvbmVNYXApDQoJCQkJCW1lc2guYm9uZU5hbWVMaXN0PVsnJ10qbGVuKG1lc2guQm9uZU1hcCkNCgkJCQkJZm9yIGJvbmVOYW1lIGluIG1lc2guQm9uZU1hcDoNCgkJCQkJCWZvciBib25lIGluIHNrZWxldG9uLmJvbmVMaXN0Og0KCQkJCQkJCWlmIGJvbmUuTmFtZT09Ym9uZU5hbWU6DQoJCQkJCQkJCWlkPW1lc2guQm9uZU1hcFtib25lTmFtZV0NCgkJCQkJCQkJc2tpbi5ib25lTWFwW2lkXT1pZA0KCQkJCQkJCQltZXNoLmJvbmVOYW1lTGlzdFtpZF09Ym9uZS5uYW1lCQ0KCQkJCQkJCQlicmVhawkJCQkNCgkJCQkJbWVzaC5za2luTGlzdC5hcHBlbmQoc2tpbikNCgkJCQkJbWVzaC5za2luSW5kaWNlTGlzdD1tZXNoLkJvbmVzDQoJCQkJCW1lc2guc2tpbldlaWdodExpc3Q9bWVzaC5XZWlnaHRzDQoJCQkJDQoJCQkJaWYgYmluZHNrZWxldG9uLm9iamVjdCBhbmQgc2tlbGV0b24ub2JqZWN0Og0KCQkJCQlpZiBtZXNoLnBhcmVudEJvbmUgYW5kIGxlbihtZXNoLnNraW5MaXN0KT4wOg0KCQkJCQkJbWVzaC5kcmF3KCkJDQoJCQkJCQltZXNoLm9iamVjdC5nZXREYXRhKG1lc2g9MSkudHJhbnNmb3JtKG1lc2gucGFyZW50Qm9uZS5tYXRyaXgpDQoJCQkJCQltZXNoLm9iamVjdC5nZXREYXRhKG1lc2g9MSkudXBkYXRlKCkNCgkJCQkJCSNtZXNoLm9iamVjdC5zZXRNYXRyaXgobWVzaC5wYXJlbnRCb25lLm1hdHJpeCkNCgkJCQkJCWlmIHJlc3VsdD09MToNCgkJCQkJCQliaW5kUG9zZShiaW5kc2tlbGV0b24ub2JqZWN0LHNrZWxldG9uLm9iamVjdCxtZXNoLm9iamVjdCkNCgkJCQkJCXNrZWxldG9uLm9iamVjdC5tYWtlUGFyZW50RGVmb3JtKFttZXNoLm9iamVjdF0sMSwwKQ0KCQkJCQllbGlmIG1lc2gucGFyZW50Qm9uZSBhbmQgbGVuKG1lc2guc2tpbkxpc3QpPT0wOg0KCQkJCQkJbWVzaC5zZXRTa2luKG1lc2gucGFyZW50Qm9uZS5uYW1lKQkNCgkJCQkJCW1lc2guZHJhdygpCQ0KCQkJCQkJbWVzaC5vYmplY3QuZ2V0RGF0YShtZXNoPTEpLnRyYW5zZm9ybShtZXNoLnBhcmVudEJvbmUubWF0cml4KQ0KCQkJCQkJbWVzaC5vYmplY3QuZ2V0RGF0YShtZXNoPTEpLnVwZGF0ZSgpDQoJCQkJCQlza2VsZXRvbi5vYmplY3QubWFrZVBhcmVudERlZm9ybShbbWVzaC5vYmplY3RdLDEsMCkNCgkJCQllbHNlOgkNCgkJCQkJaWYgbWVzaC5wYXJlbnRCb25lOg0KCQkJCQkJaWYgbGVuKG1lc2guc2tpbkxpc3QpPT0wOg0KCQkJCQkJCW1lc2guc2V0U2tpbihtZXNoLnBhcmVudEJvbmUubmFtZSkJDQoJCQkJCQltZXNoLmRyYXcoKQkNCgkJCQkJCW1lc2gub2JqZWN0LmdldERhdGEobWVzaD0xKS50cmFuc2Zvcm0obWVzaC5wYXJlbnRCb25lLm1hdHJpeCkNCgkJCQkJCW1lc2gub2JqZWN0LmdldERhdGEobWVzaD0xKS51cGRhdGUoKQ0KCQkJCQkJI21lc2gub2JqZWN0LnNldE1hdHJpeChtZXNoLnBhcmVudEJvbmUubWF0cml4KQ0KCQkJCQkJI3NrZWxldG9uLm9iamVjdC5tYWtlUGFyZW50Qm9uZShbbWVzaC5vYmplY3RdLG1lc2gucGFyZW50Qm9uZS5uYW1lLDAsMCkNCgkJCQkJCWlmIHNrZWxldG9uLm9iamVjdCBhbmQgc2tlbGV0b24ub2JqZWN0Og0KCQkJCQkJCXNrZWxldG9uLm9iamVjdC5tYWtlUGFyZW50RGVmb3JtKFttZXNoLm9iamVjdF0sMSwwKQ0KCQkJCQllbHNlOg0KCQkJCQkJI3ByaW50IGxlbihtZXNoLnZlcnRQb3NMaXN0KQ0KCQkJCQkJI3ByaW50IG1lc2guaW5kaWNlTGlzdA0KCQkJCQkJI21lc2guaW5kaWNlTGlzdD1bXQ0KCQkJCQkJbWVzaC5kcmF3KCkJDQoJCQkJCQkjbWVzaC5vYmplY3QuZ2V0RGF0YShtZXNoPTEpLnRyYW5zZm9ybShtZXNoLnBhcmVudEJvbmUubWF0cml4KQ0KCQkJCQkJI21lc2gub2JqZWN0LmdldERhdGEobWVzaD0xKS51cGRhdGUoKQ0KCQkJCQkJI21lc2gub2JqZWN0LnNldE1hdHJpeChtZXNoLnBhcmVudEJvbmUubWF0cml4KQ0KCQkJCQ0KCQkJCSIiIg0KCQkJCWlmIGxlbihtZXNoLm1vcnBoQXJyYXkpPjA6CQkNCgkJCQkJbmFtZT1tZXNoLm9iamVjdC5uYW1lDQoJCQkJCWFjdGlvbj1BY3Rpb24oKQkJDQoJCQkJCWFjdGlvbi5NRVNIU1BBQ0U9VHJ1ZQ0KCQkJCQlhY3Rpb24ubmFtZT1uYW1lDQoJCQkJCWZvciBpLG1vcnBoIGluIGVudW1lcmF0ZShtZXNoLm1vcnBoQXJyYXkpOg0KCQkJCQkJI21vcnBoTWVzaD1NZXNoKCkNCgkJCQkJCSNtb3JwaE1lc2gudmVydFBvc0xpc3Q9bWVzaC5tb3JwaEFycmF5W21vcnBoXVswXVswXQ0KCQkJCQkJI3ByaW50IG1vcnBoDQoJCQkJCQkjbW9ycGhNZXNoLmRyYXcoKQ0KCQkJCQkJdmVydExpc3Q9bWVzaC5tb3JwaEFycmF5W21vcnBoXVswXVswXQ0KCQkJCQkJZnJhbWU9aSo1DQoJCQkJCQlhY3Rpb24uc2hhcGVGcmFtZUxpc3QuYXBwZW5kKGZyYW1lKQ0KCQkJCQkJYWN0aW9uLnNoYXBlS2V5TGlzdC5hcHBlbmQodmVydExpc3QpDQoJCQkJCWFjdGlvbi5kcmF3KCkNCgkJCQkJYWN0aW9uLnNldENvbnRleHQoKQ0KCQkJCQkiIiINCgkJCQkJCQ0KCQkJCQkJDQoJCQkJCQkNCg0KDQoJCW1vZGVsLnNldCgpCQ0KCQkJCQkJDQoNCg0KDQoNCg0KDQoNCg0KDQoJCQ0KCQkjZm9yIGksbWVzaCBpbiBlbnVtZXJhdGUobW9kZWwubWVzaExpc3QpOg0KCQkjCUJsZW5kZXIuV2luZG93LkRyYXdQcm9ncmVzc0JhcihmbG9hdChpL2Zsb2F0KGxlbihtb2RlbC5tZXNoTGlzdCkrMSkpLHN0cigtMStsZW4obW9kZWwubWVzaExpc3QpLWkpKQ0KCQkjcHJpbnQgJ3Jlc3VsdDonLHJlc3VsdA0KCQlpZiByZXN1bHQhPTI6DQoJCQlpZgliaW5kc2tlbGV0b24ub2JqZWN0Og0KCQkJCXNjZW5lID0gYnB5LmRhdGEuc2NlbmVzLmFjdGl2ZQ0KCQkJCXNjZW5lLm9iamVjdHMudW5saW5rKGJpbmRza2VsZXRvbi5vYmplY3QpDQoJCQ0KZGVmIGh0bVBhcnNlcihmaWxlbmFtZSk6DQoJeXM9WXNvbigpDQoJeXMubG9nPVRydWUNCgl5cy5maWxlbmFtZT1maWxlbmFtZQ0KCXlzLnBhcnNlKCkJCQ0KCSMjb3Muc3lzdGVtKCdjbHMnKQ0KCQ0KCQkJDQoJI3N6dWthbSBpa29ueQ0KCXByaW50ICdzenVrYW0gaWtvbnknDQoJI3ByaW50IHlzLnJvb3QNCglUSFVNQk5BSUxTPXlzLmdldCh5cy5yb290LCcidGh1bWJuYWlscyInKQ0KCXByaW50IFRIVU1CTkFJTFMNCglpa29uYT1Ob25lDQoJU0laRT0wDQoJaWYgVEhVTUJOQUlMUzoNCgkJZm9yIHRodW1ibmFpbHMgaW4gVEhVTUJOQUlMUzoNCgkJCSNwcmludCB0aHVtYm5haWxzLmhlYWRlcg0KCQkJVVJMPXlzLmdldCh0aHVtYm5haWxzLCcidXJsIicpDQoJCQlmb3IgYSBpbiBVUkw6DQoJCQkJdmFsdWVzPXlzLnZhbHVlcyhhLmRhdGEsJzonKQ0KCQkJCXVybD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJ1cmwiJywnIiInKQ0KCQkJCXNpemU9eXMuZ2V0VmFsdWUodmFsdWVzLCcic2l6ZSInLCdpJykNCgkJCQlpZiB1cmw6DQoJCQkJCWJhc2VuYW1lPW9zLnBhdGguYmFzZW5hbWUodXJsKQkJCQ0KCQkJCQlpZiAnLmpwZWcnIGluIGJhc2VuYW1lOnBhdGg9c3lzLmRpcitvcy5zZXArb3MucGF0aC5iYXNlbmFtZSh1cmwpKycuanBnJw0KCQkJCQllbHNlOnBhdGg9c3lzLmRpcitvcy5zZXArb3MucGF0aC5iYXNlbmFtZSh1cmwpDQoJCQkJCWV4aXN0cz1vcy5wYXRoLmV4aXN0cyhwYXRoKQ0KCQkJCQkjcHJpbnQgJ2lrb25hJyxleGlzdHMsb3MucGF0aC5iYXNlbmFtZSh1cmwpKycuanBnJwkJCQkJCQkNCgkJCQkJaWYgZXhpc3RzPT1UcnVlOg0KCQkJCQkJaWYgc2l6ZT5TSVpFOg0KCQkJCQkJCVNJWkU9c2l6ZQ0KCQkJCQkJCWlrb25hPXBhdGgNCgkJCQkJCQkNCglpZiBpa29uYToNCgkJI3ByaW50IGlrb25hDQoJCWZvciBmaWxlIGluIG9zLmxpc3RkaXIoc3lzLmRpcik6DQoJCQlpZiAnLmh0bScgaW4gZmlsZToNCgkJCQlpZiBvcy5wYXRoLmV4aXN0cyhzeXMuZGlyK29zLnNlcCtmaWxlKyIudGh1bWIuMTAucG5nIik9PUZhbHNlOg0KCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhpa29uYSk6DQoJCQkJCQlvcy5yZW5hbWUoaWtvbmEsc3lzLmRpcitvcy5zZXArZmlsZSsiLnRodW1iLjEwLnBuZyIpDQoJCQkJZWxzZToNCgkJCQkJaWYgb3MucGF0aC5leGlzdHMoc3lzLmRpcitvcy5zZXArZmlsZSsiLnRodW1iLjExLnBuZyIpPT1GYWxzZToNCgkJCQkJCWlmIG9zLnBhdGguZXhpc3RzKGlrb25hKToJCQkJCQkNCgkJCQkJCQlvcy5yZW5hbWUoaWtvbmEsc3lzLmRpcitvcy5zZXArZmlsZSsiLnRodW1iLjExLnBuZyIpDQoJCQkJCQ0KCQkJDQoJCQ0KCQ0KCVJFU1VMVFM9eXMuZ2V0KHlzLnJvb3QsJyJyZXN1bHRzIicpCQ0KCWlmIFJFU1VMVFM6DQoJCWZvciByZXN1bHRzIGluIFJFU1VMVFM6DQoJCQl3cml0ZShsb2csWyJyZXN1bHRzIl0sMCkNCgkJCVVJRFM9eXMuZ2V0KHJlc3VsdHMsJyJ1aWQiJykJDQoJCQlpZiBVSURTOg0KCQkJCWZvciBVSUQgaW4gVUlEUzoNCgkJCQkJI3dyaXRlKGxvZyxbVUlELmhlYWRlcl0sNCkNCgkJCQkJdWlkPU5vbmUNCgkJCQkJdmFsdWVzPU5vbmUNCgkJCQkJaWYgJyJ1aWQiJyBpbiBVSUQuaGVhZGVyOnZhbHVlcz15cy52YWx1ZXMoVUlELmhlYWRlciwnOicpDQoJCQkJCWlmICcidWlkIicgaW4gVUlELmRhdGE6dmFsdWVzPXlzLnZhbHVlcyhVSUQuZGF0YSwnOicpDQoJCQkJCWlmIHZhbHVlczp1aWQ9eXMuZ2V0VmFsdWUodmFsdWVzLCcidWlkIicsJyIiJykNCgkJCQkJd3JpdGUobG9nLFsndWlkOicsdWlkXSw0KQ0KCQkJCQlpZiB1aWQ6DQoJCQkJCQlmb3JtYXRzPXlzLmdldChVSUQsJyJmb3JtYXQiJykNCgkJCQkJCWlmIGZvcm1hdHM6CQkJCQkJCQ0KCQkJCQkJCUlNQUdFU1t1aWRdPXt9DQoJCQkJCQkJSU1BR0VTW3VpZF1bJ0EnXT1bTm9uZSxOb25lLDEwMF0NCgkJCQkJCQlJTUFHRVNbdWlkXVsnUkdCJ109W05vbmUsTm9uZSwxMDBdDQoJCQkJCQkJSU1BR0VTW3VpZF1bJ04nXT1bTm9uZSxOb25lLDEwMF0NCgkJCQkJCQlJTUFHRVNbdWlkXVsnUiddPVtOb25lLE5vbmUsMTAwXQ0KCQkJCQkJCWZvciBmb3JtYXROb2RlIGluIGZvcm1hdHM6DQoJCQkJCQkJCXdyaXRlKGxvZyxbJ2ltYWdlJ10sOCkJCQkJCQkJCQ0KCQkJCQkJCQl2YWx1ZXM9Tm9uZQ0KCQkJCQkJCQlmb3JtYXQ9Tm9uZQ0KCQkJCQkJCQlpZiAnImZvcm1hdCInIGluIGZvcm1hdE5vZGUuaGVhZGVyOnZhbHVlcz15cy52YWx1ZXMoZm9ybWF0Tm9kZS5oZWFkZXIsJzonKQ0KCQkJCQkJCQlpZiAnImZvcm1hdCInIGluIGZvcm1hdE5vZGUuZGF0YTp2YWx1ZXM9eXMudmFsdWVzKGZvcm1hdE5vZGUuZGF0YSwnOicpDQoJCQkJCQkJCWlmIHZhbHVlczpmb3JtYXQ9eXMuZ2V0VmFsdWUodmFsdWVzLCciZm9ybWF0IicsJyIiJykNCgkJCQkJCQkJd3JpdGUobG9nLFsnZm9ybWF0OicsZm9ybWF0XSwxMikJCQkJCQkJCQ0KCQkJCQkJCQl2YWx1ZXM9Tm9uZQ0KCQkJCQkJCQlxdWFsaXR5PU5vbmUNCgkJCQkJCQkJaWYgJyJxdWFsaXR5IicgaW4gZm9ybWF0Tm9kZS5oZWFkZXI6dmFsdWVzPXlzLnZhbHVlcyhmb3JtYXROb2RlLmhlYWRlciwnOicpDQoJCQkJCQkJCWlmICcicXVhbGl0eSInIGluIGZvcm1hdE5vZGUuZGF0YTp2YWx1ZXM9eXMudmFsdWVzKGZvcm1hdE5vZGUuZGF0YSwnOicpDQoJCQkJCQkJCWlmIHZhbHVlczpxdWFsaXR5PXlzLmdldFZhbHVlKHZhbHVlcywnInF1YWxpdHkiJywnaScpDQoJCQkJCQkJCXdyaXRlKGxvZyxbJ3F1YWxpdHk6JyxxdWFsaXR5XSwxMikJCQkJCQkJCQ0KCQkJCQkJCQl2YWx1ZXM9Tm9uZQ0KCQkJCQkJCQl1cmw9Tm9uZQ0KCQkJCQkJCQlpZiAnInVybCInIGluIGZvcm1hdE5vZGUuaGVhZGVyOnZhbHVlcz15cy52YWx1ZXMoZm9ybWF0Tm9kZS5oZWFkZXIsJzonKQ0KCQkJCQkJCQlpZiAnInVybCInIGluIGZvcm1hdE5vZGUuZGF0YTp2YWx1ZXM9eXMudmFsdWVzKGZvcm1hdE5vZGUuZGF0YSwnOicpDQoJCQkJCQkJCWlmIHZhbHVlczp1cmw9eXMuZ2V0VmFsdWUodmFsdWVzLCcidXJsIicsJyIiJykJCQkJCQkJCQ0KCQkJCQkJCQkjd3JpdGUobG9nLFsndXJsOicsdXJsXSwxMikNCgkJCQkJCQkJaWYgbm90IHVybDoNCgkJCQkJCQkJCWlmICcidXJsIicgaW4gZm9ybWF0Tm9kZS5wYXJlbnQuaGVhZGVyOnZhbHVlcz15cy52YWx1ZXMoZm9ybWF0Tm9kZS5wYXJlbnQuaGVhZGVyLCc6JykNCgkJCQkJCQkJCWlmICcidXJsIicgaW4gZm9ybWF0Tm9kZS5wYXJlbnQuZGF0YTp2YWx1ZXM9eXMudmFsdWVzKGZvcm1hdE5vZGUucGFyZW50LmRhdGEsJzonKQ0KCQkJCQkJCQkJaWYgdmFsdWVzOnVybD15cy5nZXRWYWx1ZSh2YWx1ZXMsJyJ1cmwiJywnIiInKQkNCgkJCQkJCQkJaWYgdXJsOg0KCQkJCQkJCQkJYmFzZW5hbWU9b3MucGF0aC5iYXNlbmFtZSh1cmwpCQkJDQoJCQkJCQkJCQlpZiAnLmpwZWcnIGluIGJhc2VuYW1lOnBhdGg9c3lzLmRpcitvcy5zZXArb3MucGF0aC5iYXNlbmFtZSh1cmwpKycuanBnJw0KCQkJCQkJCQkJZWxzZTpwYXRoPXN5cy5kaXIrb3Muc2VwK29zLnBhdGguYmFzZW5hbWUodXJsKQ0KCQkJCQkJCQkJZXhpc3RzPW9zLnBhdGguZXhpc3RzKHBhdGgpCQkJCQkJCQkNCgkJCQkJCQkJCXdyaXRlKGxvZyxbJ3BhdGg6JyxwYXRoLGV4aXN0c10sMTIpDQoJCQkJCQkJCQkNCgkJCQkJCQkJCWlmIGZvcm1hdCBub3QgaW4gSU1BR0VTW3VpZF0ua2V5cygpOg0KCQkJCQkJCQkJCXByaW50ICdOT1dZIEZPUk1BVDonLGZvcm1hdA0KCQkJCQkJCQkJCUlNQUdFU1t1aWRdW2Zvcm1hdF09W3BhdGgsZXhpc3RzLHF1YWxpdHldDQoJCQkJCQkJCQllbHNlOg0KCQkJCQkJCQkJCWlmIHF1YWxpdHkgYW5kIGZvcm1hdDoNCgkJCQkJCQkJCQkJaWYgcXVhbGl0eTw9SU1BR0VTW3VpZF1bZm9ybWF0XVsyXSBhbmQgZXhpc3RzPT1UcnVlOg0KCQkJCQkJCQkJCQkJSU1BR0VTW3VpZF1bZm9ybWF0XT1bcGF0aCxleGlzdHMscXVhbGl0eV0NCgkJCQkJCQkJCQ0KCQkJCQkJCQkJDQoJCQkJCQkJCQ0KCQkJCQkJCQ0KCQkNCgkJCQkJCQ0KCQkJCQ0KCQkJDQoJYWxsSW1hZ2VQYXRocz1bXQkJCQ0KCQkJCQkJDQoJDQoJdXNlZEltYWdlUGF0aHM9W10NCglmb3Iga2V5IGluIElNQUdFUzoNCgkJI3dyaXRlKGxvZyxba2V5XSwwKQ0KCQlmb3IgaXRlbSBpbiBJTUFHRVNba2V5XToNCgkJCSN3cml0ZShsb2csW2l0ZW0sJzonLElNQUdFU1trZXldW2l0ZW1dXSw0KQ0KCQkJaWYgSU1BR0VTW2tleV1baXRlbV1bMF06DQoJCQkJaWYgSU1BR0VTW2tleV1baXRlbV1bMF0gbm90IGluIHVzZWRJbWFnZVBhdGhzOg0KCQkJCQl1c2VkSW1hZ2VQYXRocy5hcHBlbmQoSU1BR0VTW2tleV1baXRlbV1bMF0pDQoJDQoJZm9yIGltYWdlIGluIGFsbEltYWdlUGF0aHM6DQoJCWlmIGltYWdlIG5vdCBpbiB1c2VkSW1hZ2VQYXRoczoNCgkJCWlmIG9zLnBhdGguZXhpc3RzKGltYWdlKT09VHJ1ZToNCgkJCQlwcmludCAndXN1d2FtOicsaW1hZ2UNCgkJCQkjb3MucmVtb3ZlKGltYWdlKQ0KCQ0KCW1hdGVyaWFscz15cy5nZXQoeXMucm9vdCwnIm1hdGVyaWFscyInKQ0KCWlmIG1hdGVyaWFsczoNCgkJZm9yIGEgaW4gbWF0ZXJpYWxzOg0KCQkJZm9yIGIgaW4gYS5jaGlsZHJlbjoNCgkJCQltYXROYW1lPU5vbmUJDQoJCQkJaWYgJyJuYW1lIicgaW4gYi5kYXRhOg0KCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGIuZGF0YSwnOicpDQoJCQkJCW1hdE5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCcibmFtZSInLCciIicpLnJlcGxhY2UoJzonLCcnKQ0KCQkJCQltYXROYW1lPW1hdE5hbWUucmVwbGFjZSgnOicsJycpDQoJCQkJCWlmICdcXCcgaW4gbWF0TmFtZTptYXROYW1lPW1hdE5hbWUuc3BsaXQoJ1xcJylbMF0NCgkJCQkJTUFURVJJQUxTW21hdE5hbWVdPXt9DQoJCQkJZWxzZToJDQoJCQkJCWZvciBjIGluIGIuY2hpbGRyZW46CQkNCgkJCQkJCWlmICcibmFtZSInIGluIGMuaGVhZGVyOg0KCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoYy5oZWFkZXIsJzonKQ0KCQkJCQkJCW1hdE5hbWU9eXMuZ2V0VmFsdWUodmFsdWVzLCcibmFtZSInLCciIicpDQoJCQkJCQkJTUFURVJJQUxTW21hdE5hbWVdPXt9DQoJCQkJI3ByaW50IG1hdE5hbWUNCgkJCQl3cml0ZShsb2csW21hdE5hbWVdLDApDQoJCQkJaWYJbWF0TmFtZToNCgkJCQkJI21hdE5hbWU9bWF0TmFtZS5yZXBsYWNlKCc6JywnJykNCgkJCQkJI2lmICdcXCcgaW4gbWF0TmFtZTptYXROYW1lPW1hdE5hbWUuc3BsaXQoJ1xcJylbMF0NCgkJCQkJY2hhbm5lbHM9eXMuZ2V0KGIsJyJjaGFubmVscyInKQ0KCQkJCQlpZiBjaGFubmVsczoNCgkJCQkJCWZvciBjIGluIGNoYW5uZWxzWzBdLmNoaWxkcmVuOgkJCQkJDQoJCQkJCQkJTUFURVJJQUxTW21hdE5hbWVdW2MuaGVhZGVyLnNwbGl0KCciJylbMV1dPVsnJyxbXSxbXV0NCgkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGMuZGF0YSwnOicpDQoJCQkJCQkJZW5hYmxlPXlzLmdldFZhbHVlKHZhbHVlcywnImVuYWJsZSInLCdzJykNCgkJCQkJCQlpZiBlbmFibGU6DQoJCQkJCQkJCWlmIGVuYWJsZT09J3RydWUnOg0KCQkJCQkJCQkJZm9yIGQgaW4gYy5jaGlsZHJlbjoNCgkJCQkJCQkJCQlkdmFsdWVzPXlzLnZhbHVlcyhkLmhlYWRlciwnOicpDQoJCQkJCQkJCQkJI3ByaW50IGR2YWx1ZXMNCgkJCQkJCQkJCQlpZiAnInRleHR1cmUiJyBpbiBkLmhlYWRlcjoNCgkJCQkJCQkJCQkJaWYgJyJ1aWQiJyBpbiBkLmRhdGE6DQoJCQkJCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGQuZGF0YSwnOicpDQoJCQkJCQkJCQkJCQl1aWQ9eXMuZ2V0VmFsdWUodmFsdWVzLCcidWlkIicsJyIiJykNCgkJCQkJCQkJCQkJCXdyaXRlKGxvZyxbdWlkXSw0KQ0KCQkJCQkJCQkJCQkJaWYgdWlkIGluIElNQUdFUy5rZXlzKCk6DQoJCQkJCQkJCQkJCQkJZm9yIGZvcm1hdCBpbiBJTUFHRVNbdWlkXToNCgkJCQkJCQkJCQkJCQkJd3JpdGUobG9nLFtmb3JtYXQsSU1BR0VTW3VpZF1bZm9ybWF0XV0sOCkNCgkJCQkJCQkJCQkJCQkJcGFzcw0KCQkJCQkJCQkJCQkJZWxzZToNCgkJCQkJCQkJCQkJCQl3cml0ZShsb2csWydNSVNTSU5HOicsdWlkXSw4KQ0KCQkJCQkJCQkJCQkJCXBhc3MNCgkJCQkJCQkJCQkJCQkNCgkJCQkJCQkJCQkJCU1BVEVSSUFMU1ttYXROYW1lXVtjLmhlYWRlci5zcGxpdCgnIicpWzFdXT1bJ3RleHR1cmUnLHVpZF0NCgkJCQkJCQkJCQkJCXVpZD1NQVRFUklBTFNbbWF0TmFtZV1bYy5oZWFkZXIuc3BsaXQoJyInKVsxXV1bMV0NCgkJCQkJCQkJCQkJCSNwcmludCBJTUFHRVNbdWlkXQ0KCQkJCQkJCQkJCWlmICciY29sb3IiJyBpbiBkLmhlYWRlcjoNCgkJCQkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhkLmRhdGEsJ2YnKQ0KCQkJCQkJCQkJCQlNQVRFUklBTFNbbWF0TmFtZV1bYy5oZWFkZXIuc3BsaXQoJyInKVsxXV09Wydjb2xvcicsdmFsdWVzXQ0KCQkJCQkJCWVsc2U6DQoJCQkJCQkJCQlmb3IgZCBpbiBjLmNoaWxkcmVuOg0KCQkJCQkJCQkJDQoJCQkJCQkJCQkJdmFsdWVzPXlzLnZhbHVlcyhkLmhlYWRlciwnOicpDQoJCQkJCQkJCQkJZW5hYmxlPXlzLmdldFZhbHVlKHZhbHVlcywnImVuYWJsZSInLCdzJykNCgkJCQkJCQkJCQlpZiBlbmFibGU6DQoJCQkJCQkJCQkNCgkJCQkJCQkJCQkJaWYgZW5hYmxlPT0ndHJ1ZSc6DQoJCQkJCQkJCQkJCQkNCgkJCQkJCQkJCQkJCQlkdmFsdWVzPXlzLnZhbHVlcyhkLmhlYWRlciwnOicpDQoJCQkJCQkJCQkJCQkJI3ByaW50IGR2YWx1ZXMNCgkJCQkJCQkJCQkJCQlpZiAnInRleHR1cmUiJyBpbiBkLmhlYWRlcjoNCgkJCQkJCQkJCQkJCQkJaWYgJyJ1aWQiJyBpbiBkLmRhdGE6DQoJCQkJCQkJCQkJCQkJCQl2YWx1ZXM9eXMudmFsdWVzKGQuZGF0YSwnOicpDQoJCQkJCQkJCQkJCQkJCQl1aWQ9eXMuZ2V0VmFsdWUodmFsdWVzLCcidWlkIicsJyIiJykNCgkJCQkJCQkJCQkJCQkJCXdyaXRlKGxvZyxbdWlkXSw0KQ0KCQkJCQkJCQkJCQkJCQkJaWYgdWlkIGluIElNQUdFUy5rZXlzKCk6DQoJCQkJCQkJCQkJCQkJCQkJZm9yIGZvcm1hdCBpbiBJTUFHRVNbdWlkXToNCgkJCQkJCQkJCQkJCQkJCQkJd3JpdGUobG9nLFtmb3JtYXQsSU1BR0VTW3VpZF1bZm9ybWF0XSxlbmFibGVdLDgpDQoJCQkJCQkJCQkJCQkJCQkJCXBhc3MNCgkJCQkJCQkJCQkJCQkJCWVsc2U6DQoJCQkJCQkJCQkJCQkJCQkJd3JpdGUobG9nLFsnTUlTU0lORzonLHVpZF0sOCkNCgkJCQkJCQkJCQkJCQkJCQlwYXNzDQoJCQkJCQkJCQkJCQkJCQkJDQoJCQkJCQkJCQkJCQkJCQlNQVRFUklBTFNbbWF0TmFtZV1bYy5oZWFkZXIuc3BsaXQoJyInKVsxXV09Wyd0ZXh0dXJlJyx1aWRdDQoJCQkJCQkJCQkJCQkJCQl1aWQ9TUFURVJJQUxTW21hdE5hbWVdW2MuaGVhZGVyLnNwbGl0KCciJylbMV1dWzFdDQoJCQkJCQkJCQkJCQkJCQkjcHJpbnQgSU1BR0VTW3VpZF0NCgkJCQkJCQkJCQkJCQlpZiAnImNvbG9yIicgaW4gZC5oZWFkZXI6DQoJCQkJCQkJCQkJCQkJCXZhbHVlcz15cy52YWx1ZXMoZC5kYXRhLCdmJykNCgkJCQkJCQkJCQkJCQkJTUFURVJJQUxTW21hdE5hbWVdW2MuaGVhZGVyLnNwbGl0KCciJylbMV1dPVsnY29sb3InLHZhbHVlc10NCgkJCQkJCQkJDQoNCg0KZGVmIGFjdGlvblBhcnNlcihmaWxlbmFtZSxnKToNCglhY3Rpb249QWN0aW9uKCkNCglhY3Rpb24uQk9ORVNQQUNFPVRydWUNCglhY3Rpb24uQk9ORVNPUlQ9VHJ1ZQ0KCXdoaWxlKFRydWUpOg0KCQlpZiBnLnRlbGwoKT49Zy5maWxlU2l6ZSgpOmJyZWFrDQoJCWJvbmU9QWN0aW9uQm9uZSgpDQoJCWFjdGlvbi5ib25lTGlzdC5hcHBlbmQoYm9uZSkNCgkJYm9uZS5uYW1lPWcuZmluZCgnXHgwMCcpDQoJCXR5cGU9Zy5maW5kKCdceDAwJykNCgkJI3ByaW50IGJvbmUubmFtZSx0eXBlLGcudGVsbCgpDQoJCWlmIHR5cGU9PSdzaXplJzoNCgkJCWNvdW50PWcuaSgxKVswXQ0KCQkJI3ByaW50IGNvdW50DQoJCQlmb3IgbSBpbiBzYWZlKGNvdW50KToNCgkJCQltYXRyaXg9VmVjdG9yU2NhbGVNYXRyaXgoZy5mKDMpKQ0KCQkJCWJvbmUuc2l6ZUtleUxpc3QuYXBwZW5kKG1hdHJpeCkNCgkJCWNvdW50PWcuaSgxKVswXQ0KCQkJI3ByaW50IGNvdW50DQoJCQlmb3IgbSBpbiBzYWZlKGNvdW50KToNCgkJCQlmcmFtZT1pbnQoZy5mKDEpWzBdKjMzKQ0KCQkJCWJvbmUuc2l6ZUZyYW1lTGlzdC5hcHBlbmQoZnJhbWUpDQoJCWlmIHR5cGU9PSd0cmFuc2xhdGUnOg0KCQkJY291bnQ9Zy5pKDEpWzBdDQoJCQkjcHJpbnQgY291bnQNCgkJCWZvciBtIGluIHNhZmUoY291bnQpOg0KCQkJCW1hdHJpeD1WZWN0b3JNYXRyaXgoZy5mKDMpKQ0KCQkJCWJvbmUucG9zS2V5TGlzdC5hcHBlbmQobWF0cml4KQ0KCQkJY291bnQ9Zy5pKDEpWzBdDQoJCQkjcHJpbnQgY291bnQNCgkJCWZvciBtIGluIHNhZmUoY291bnQpOg0KCQkJCWZyYW1lPWludChnLmYoMSlbMF0qMzMpDQoJCQkJYm9uZS5wb3NGcmFtZUxpc3QuYXBwZW5kKGZyYW1lKQ0KCQlpZiB0eXBlPT0ncXVhdGVybmlvbic6DQoJCQljb3VudD1nLmkoMSlbMF0NCgkJCSNwcmludCBjb3VudA0KCQkJZm9yIG0gaW4gc2FmZShjb3VudCk6DQoJCQkJcXVhdD1RdWF0ZXJuaW9uKGcuZig0KSkNCgkJCQltYXRyaXg9UXVhdE1hdHJpeChxdWF0KS5yZXNpemU0eDQoKQ0KCQkJCWJvbmUucm90S2V5TGlzdC5hcHBlbmQobWF0cml4KQ0KCQkJY291bnQ9Zy5pKDEpWzBdDQoJCQkjcHJpbnQgY291bnQNCgkJCWZvciBtIGluIHNhZmUoY291bnQpOg0KCQkJCWZyYW1lPWludChnLmYoMSlbMF0qMzMpDQoJCQkJYm9uZS5yb3RGcmFtZUxpc3QuYXBwZW5kKGZyYW1lKQ0KCWFjdGlvbi5kcmF3KCkNCglhY3Rpb24uc2V0Q29udGV4dCgpCQ0KCQ0KCQ0KCQ0KZGVmIGdldENhbm9uaWNhbChmaWxlbmFtZSk6DQoJZmlsZT1vcGVuKGZpbGVuYW1lLCdyJykNCglkYXRhPWZpbGUucmVhZCgpDQoJI3ByaW50IGRhdGENCgljYW5vbmljYWw9Tm9uZQ0KCWlmICciY2Fub25pY2FsIicgaW4gZGF0YToNCgkJY2Fub25pY2FsPWRhdGEuc3BsaXQoJyJjYW5vbmljYWwiJylbMV0uc3BsaXQoJyInKVsxXS5zcGxpdCgnLycpWzRdDQoJCSMoJzxsaW5rIHJlbD0iY2Fub25pY2FsIiBocmVmPSJodHRwczovL3NrZXRjaGZhYi5jb20vM2QtbW9kZWxzLycpWzFdLnNwbGl0KCciPicpWzBdDQoJCWlmICItIiBpbiBjYW5vbmljYWw6DQoJCQljYW5vbmljYWw9Y2Fub25pY2FsLnNwbGl0KCItIilbLTFdDQoJI2lmIAkJDQoJZmlsZS5jbG9zZSgpCQ0KCXJldHVybiBjYW5vbmljYWwNCgkJCQkJCQkJCQkNCmRlZiBQYXJzZXIocGF0aCk6DQoJZ2xvYmFsIHN5cyxNQVRFUklBTFMsSU1BR0VTLExBU1ROT0RFTkFNRSxsb2csc2tpcGRlY29kZSxmaWxlbmFtZQ0KCWxvZz1vcGVuKCdsb2cudHh0JywndycpDQoJTEFTVE5PREVOQU1FPU5vbmUNCglNQVRFUklBTFM9e30NCglJTUFHRVM9e30NCgkNCgkNCglmaWxlbmFtZT1wYXRoDQoJc3lzPVN5cyhmaWxlbmFtZSkNCglvcy5zeXN0ZW0oImNscyIpDQoJZXh0PWZpbGVuYW1lLnNwbGl0KCcuJylbLTFdLmxvd2VyKCkNCglpZiBleHQ9PSdneic6DQoJCW9zZz1zeXMuZGlyK29zLnNlcCsnZmlsZS5vc2dqcycNCgkJaWYgb3MucGF0aC5leGlzdHMob3NnKT09RmFsc2U6DQoJCQljbWQ9Q21kKCkNCgkJCWNtZC5pbnB1dD1maWxlbmFtZQ0KCQkJY21kLlpJUD1UcnVlDQoJCQljbWQucnVuKCkNCgkJCW1vZGVsPXN5cy5kaXIrb3Muc2VwKydtb2RlbF9maWxlLmJpbi5neicNCgkJCWlmIG9zLnBhdGguZXhpc3RzKG1vZGVsKT09VHJ1ZToNCgkJCQljbWQ9Q21kKCkNCgkJCQljbWQuaW5wdXQ9bW9kZWwNCgkJCQljbWQuWklQPVRydWUNCgkJCQljbWQucnVuKCkNCgkJCW9zZ1BhcnNlcihmaWxlbmFtZS5zcGxpdCgnLmd6JylbMF0pDQoJCQ0KCWlmIGV4dD09J29zZ2pzJzoNCgkJb3NnUGFyc2VyKGZpbGVuYW1lKQ0KCWlmIGV4dD09J3R4dCc6DQoJCW9zZ1BhcnNlcihmaWxlbmFtZSkNCglpZiBleHQgaW4gWydodG0nLCdodG1sJ106DQoJCW9zZz1zeXMuZGlyK29zLnNlcCsnZmlsZS5vc2dqcy5neicNCgkJaWYgb3MucGF0aC5leGlzdHMob3NnKT09VHJ1ZToNCgkJCWNtZD1DbWQoKQ0KCQkJY21kLmlucHV0PW9zZw0KCQkJY21kLlpJUD1UcnVlDQoJCQljbWQucnVuKCkNCgkJCW1vZGVsPXN5cy5kaXIrb3Muc2VwKydtb2RlbF9maWxlLmJpbi5neicNCgkJZWxzZToNCgkJCW9zZz1zeXMuZGlyK29zLnNlcCsnZmlsZS5vc2dqcycNCgkJbW9kZWw9c3lzLmRpcitvcy5zZXArJ21vZGVsX2ZpbGUuYmluLmd6Jw0KCQlpZiBvcy5wYXRoLmV4aXN0cyhtb2RlbCk9PVRydWU6DQoJCQljbWQ9Q21kKCkNCgkJCWNtZC5pbnB1dD1tb2RlbA0KCQkJY21kLlpJUD1UcnVlDQoJCQljbWQucnVuKCkNCgkJZWxzZToNCgkJCW1vZGVsPXN5cy5kaXIrb3Muc2VwKydtb2RlbF9maWxlLmJpbicNCgkJaWYgb3MucGF0aC5leGlzdHMobW9kZWwpOg0KCQkNCgkJCXJlc3VsdD0wDQoJCQkjcmVzdWx0PUJsZW5kZXIuRHJhdy5QdXBNZW51KCJTa2V0Y2hmYWIgVmlld2VyID8ldHxZZXN8Tm8iKQkNCgkJCWlmIHJlc3VsdD09MToNCgkJCQljYW5vbmljYWw9Z2V0Q2Fub25pY2FsKGZpbGVuYW1lKQ0KCQkJCWNocm9tZUV4ZT0iQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxHb29nbGVcQ2hyb21lXEFwcGxpY2F0aW9uXGNocm9tZS5leGUiDQoJCQkJI29zLnN5c3RlbShjaHJvbWVFeGUpDQoJCQkJI3N1YnByb2Nlc3MuUG9wZW4oW2Nocm9tZUV4ZSxmaWxlbmFtZV0pLndhaXQoKQ0KCQkJCSN0eHQ9aHRtMStodG0yK2h0bTMNCgkJCQl0eHQ9b3Blbigic2tldGNoZmFiLmh0bWwiLCJ3IikNCgkJCQl0eHQud3JpdGUoaHRtMS5yZXBsYWNlKCIjIiwiIikpDQoJCQkJaWYgY2Fub25pY2FsIGlzIG5vdCBOb25lOg0KCQkJCQ0KCQkJCQl0eHQud3JpdGUoY2Fub25pY2FsKQ0KCQkJCWVsc2U6CQ0KCQkJCQkjdHh0LndyaXRlKGh0bTIpDQoJCQkJCXR4dC53cml0ZShvcy5wYXRoLmRpcm5hbWUoZmlsZW5hbWUpLnNwbGl0KG9zLnNlcClbLTFdKQ0KCQkJCXR4dC53cml0ZShodG0zKQ0KCQkJCXR4dC5jbG9zZSgpDQoJCQkJc3VicHJvY2Vzcy5Qb3BlbihbY2hyb21lRXhlLGJsZW5kRGlyK29zLnNlcCsic2tldGNoZmFiLmh0bWwiXSkjLndhaXQoKQ0KCQkJZWxzZToJDQoJCQkNCgkJCQ0KCQkJCXJlc3VsdD0xDQoJCQkJZmlsZVNpemU9b3MucGF0aC5nZXRzaXplKG1vZGVsKQ0KCQkJCSNyZXN1bHQ9QmxlbmRlci5EcmF3LlB1cE1lbnUoImltcG9ydCAiK3N0cihyb3VuZChmaWxlU2l6ZS8xMDAwMDAwLjAsMSkpKyIgTWIgPyV0fFllc3xObyIpDQoJCQkJDQoJCQkJaHRtUGFyc2VyKGZpbGVuYW1lKQ0KCQkJCWlmIHJlc3VsdD09MToJDQoJCQkJCXNraXBkZWNvZGU9MA0KCQkJCQkNCgkJCQkJcmVzdWx0PTANCgkJCQkJI3Jlc3VsdD1CbGVuZGVyLkRyYXcuUHVwTWVudSgiaW5kaWNlIHByb2JsZW0iKyIgPyV0fFllc3xObyIpDQoJCQkJCWlmIHJlc3VsdD09MToNCgkJCQkJCXNraXBkZWNvZGU9MQ0KCQkJCQkJDQoJCQkJCQ0KCQkJCQkNCgkJCQkJb3NnUGF0aD1zeXMuZGlyK29zLnNlcCsnZmlsZS5vc2dqcycNCgkJCQkJaWYgb3MucGF0aC5leGlzdHMob3NnUGF0aCk9PVRydWU6DQoJCQkJCQlvc2dQYXJzZXIob3NnUGF0aCkNCgkJCQkJCXBhc3MNCgkJCQkJZWxzZToNCgkJCQkJCW9zZ1BhdGg9c3lzLmRpcitvcy5zZXArJ2ZpbGUub3NnanMnDQoJCQkJCQlpZiBvcy5wYXRoLmV4aXN0cyhvc2dQYXRoKT09VHJ1ZToNCgkJCQkJCQlvc2dQYXJzZXIob3NnUGF0aCkNCgkJCQkJCQlwYXNzCQ0KCQkJCQ0KCWlmIGV4dD09J2FjdGlvbic6DQoJCWZpbGU9b3BlbihmaWxlbmFtZSwncmInKQ0KCQlnPUJpbmFyeVJlYWRlcihmaWxlKQ0KCQlhY3Rpb25QYXJzZXIoZmlsZW5hbWUsZykNCgkJZmlsZS5jbG9zZSgpDQoJbG9nLmNsb3NlKCkJDQoJCQ0KCQ0KIA0KCQ0KUGFyc2VyKCcuL19zZlRlbXAv");
			File.WriteAllBytes($"{Environment.CurrentDirectory}\\tools\\blender\\_sfTemp\\{SketchfabDL.session}\\_sketchfab-animImport.py", blenderScriptPartial);
			File.AppendAllText($"{Environment.CurrentDirectory}\\tools\\blender\\_sfTemp\\{SketchfabDL.session}\\_sketchfab-animImport.py", $"dummy.html_files/{animName}");
			File.AppendAllText($"{Environment.CurrentDirectory}\\tools\\blender\\_sfTemp\\{SketchfabDL.session}\\_sketchfab-animImport.py", "')");
		}

		public static void saveFBX(string conversionMode = "Static", bool quads = false, string tempDir = "_sfTemp")
		{
			string blenderScript = Encoding.UTF8.GetString(Convert.FromBase64String("aW1wb3J0IGJweQ0KcXVhZHMgPSBGYWxzZQ0Kc3RhdGljID0gVHJ1ZQ0KaWYgc3RhdGljOg0KCWlmIHF1YWRzOg0KCQlwcmludCgiUHJvZ3Jlc3MgOiBXcml0aW5nIEZCWCAoUXVhZHMpLi4uIiwgZmx1c2g9VHJ1ZSkNCgkJYnB5Lm9wcy5leHBvcnRfc2NlbmUuZmJ4KGZpbGVwYXRoPScuL3t0ZW1wUGF0aH0vbW9kZWxOZXcucXVhZHMuZmJ4JywgcGF0aF9tb2RlPSdSRUxBVElWRScsIGJha2VfYW5pbT1GYWxzZSwgb2JqZWN0X3R5cGVzPXsnTUVTSCd9KQ0KCWVsc2U6DQoJCXByaW50KCJQcm9ncmVzcyA6IFdyaXRpbmcgRkJYLi4uIiwgZmx1c2g9VHJ1ZSkNCgkJYnB5Lm9wcy5leHBvcnRfc2NlbmUuZmJ4KGZpbGVwYXRoPScuL3t0ZW1wUGF0aH0vbW9kZWxOZXcuZmJ4JywgcGF0aF9tb2RlPSdSRUxBVElWRScsIGJha2VfYW5pbT1GYWxzZSwgb2JqZWN0X3R5cGVzPXsnTUVTSCd9KQ0KZWxzZToNCglpZiBxdWFkczoNCgkJcHJpbnQoIlByb2dyZXNzIDogV3JpdGluZyBGQlggKFF1YWRzKS4uLiIsIGZsdXNoPVRydWUpDQoJCWJweS5vcHMuZXhwb3J0X3NjZW5lLmZieChmaWxlcGF0aD0nLi97dGVtcFBhdGh9L21vZGVsTmV3LnF1YWRzLmZieCcsIHBhdGhfbW9kZT0nUkVMQVRJVkUnLCBiYWtlX2FuaW09RmFsc2UpDQoJZWxzZToNCgkJcHJpbnQoIlByb2dyZXNzIDogV3JpdGluZyBGQlguLi4iLCBmbHVzaD1UcnVlKQ0KCQlicHkub3BzLmV4cG9ydF9zY2VuZS5mYngoZmlsZXBhdGg9Jy4ve3RlbXBQYXRofS9tb2RlbE5ldy5mYngnLCBwYXRoX21vZGU9J1JFTEFUSVZFJywgYmFrZV9hbmltPUZhbHNlKQ=="));
			blenderScript = blenderScript.Replace("{tempPath}", tempDir);
			if (conversionMode != "Static")
			{
				blenderScript = blenderScript.Replace("static = True", "static = False");
			}
			if (quads)
			{
				blenderScript = blenderScript.Replace("quads = False", "quads = True");
				File.WriteAllText($"{Environment.CurrentDirectory}\\tools\\blender-292\\_sfTemp\\{SketchfabDL.session}\\_saveFBXQuads.py", blenderScript);
				return;
			}
			File.WriteAllText($"{Environment.CurrentDirectory}\\tools\\blender-292\\_sfTemp\\{SketchfabDL.session}\\_saveFBX.py", blenderScript);
		}
	}
}
